/*! For license information please see main.d0be52e9.js.LICENSE.txt */
(()=>{var e={284:e=>{"use strict";var t,n="object"===typeof Reflect?Reflect:null,i=n&&"function"===typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"===typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!==e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,a),i(n)}function a(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}m(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&m(e,"error",t,n)}(e,r,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,a,o,c;if(s(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"===typeof o?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=l(e))>0&&o.length>r&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=u.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):f(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function m(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(a){i.once&&e.removeEventListener(t,r),n(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(void 0===l)return!1;if("function"===typeof l)i(l,this,t);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)i(u[n],this,t)}return!0},a.prototype.addListener=function(e,t){return c(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return c(this,e,t,!0)},a.prototype.once=function(e,t){return s(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,r,a,o;if(s(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},219:(e,t,n)=>{"use strict";var i=n(763),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return i.isMemo(e)?o:s[e.$$typeof]||r}s[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[i.Memo]=o;var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,i){if("string"!==typeof n){if(f){var r=p(n);r&&r!==f&&e(t,r,i)}var o=u(n);h&&(o=o.concat(h(n)));for(var s=l(t),m=l(n),g=0;g<o.length;++g){var y=o[g];if(!a[y]&&(!i||!i[y])&&(!m||!m[y])&&(!s||!s[y])){var _=d(n,y);try{c(t,y,_)}catch(v){}}}}return t}},983:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,_=n?Symbol.for("react.fundamental"):60117,v=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function b(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case u:case h:case a:case s:case o:case p:return e;default:switch(e=e&&e.$$typeof){case c:case d:case g:case m:case l:return e;default:return t}}case r:return t}}}function w(e){return b(e)===h}t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=l,t.Element=i,t.ForwardRef=d,t.Fragment=a,t.Lazy=g,t.Memo=m,t.Portal=r,t.Profiler=s,t.StrictMode=o,t.Suspense=p,t.isAsyncMode=function(e){return w(e)||b(e)===u},t.isConcurrentMode=w,t.isContextConsumer=function(e){return b(e)===c},t.isContextProvider=function(e){return b(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return b(e)===d},t.isFragment=function(e){return b(e)===a},t.isLazy=function(e){return b(e)===g},t.isMemo=function(e){return b(e)===m},t.isPortal=function(e){return b(e)===r},t.isProfiler=function(e){return b(e)===s},t.isStrictMode=function(e){return b(e)===o},t.isSuspense=function(e){return b(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===h||e===s||e===o||e===p||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===_||e.$$typeof===v||e.$$typeof===x||e.$$typeof===y)},t.typeOf=b},763:(e,t,n)=>{"use strict";e.exports=n(983)},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,i,r,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function v(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(f,e)||!h.call(p,e)&&(d.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),k=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),z=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var F,O=Object.assign;function B(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var N=!1;function V(e,t){if(!e||N)return"";N=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),a=i.stack.split("\n"),o=r.length-1,s=a.length-1;1<=o&&0<=s&&r[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(r[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||r[o]!==a[s]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{N=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function U(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case w:return"Portal";case C:return"Profiler";case T:return"StrictMode";case P:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case z:t=e._payload,e=e._init;try{return j(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Z(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=q(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=H(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&W(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ae(e,t){var n=H(t.value),i=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Se=null,Te=null;function Ce(e){if(e=vr(e)){if("function"!==typeof we)throw Error(a(280));var t=e.stateNode;t&&(t=br(t),we(e.stateNode,e.type,t))}}function Ie(e){Se?Te?Te.push(e):Te=[e]:Se=e}function ke(){if(Se){var e=Se,t=Te;if(Te=Se=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ee(e,t){return e(t)}function Pe(){}var Ae=!1;function Me(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ee(e,t,n)}finally{Ae=!1,(null!==Se||null!==Te)&&(Pe(),ke())}}function ze(e,t){var n=e.stateNode;if(null===n)return null;var i=br(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Le=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Le=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Le=!1}function Re(e,t,n,i,r,a,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Fe=!1,Oe=null,Be=!1,Ne=null,Ve={onError:function(e){Fe=!0,Oe=e}};function Ue(e,t,n,i,r,a,o,s,l){Fe=!1,Oe=null,Re.apply(Ve,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(je(e)!==e)throw Error(a(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return He(r),e;if(o===i)return He(r),t;o=o.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=o;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=o;break}if(l===i){s=!0,i=r,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,i=r;break}if(l===i){s=!0,i=o,n=r;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Ze(e):null}function Ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ze(e);if(null!==t)return t;e=e.sibling}return null}var Ge=r.unstable_scheduleCallback,We=r.unstable_cancelCallback,Ke=r.unstable_shouldYield,Xe=r.unstable_requestPaint,Ye=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~r;0!==s?i=ht(s):0!==(a&=o)&&(i=ht(a))}else 0!==(o=n&~r)?i=ht(o):0!==a&&(i=ht(a));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(a=t&-t)||16===r&&0!==(4194240&a)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function _t(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var vt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,wt,St,Tt,Ct,It=!1,kt=[],Et=null,Pt=null,At=null,Mt=new Map,zt=new Map,Lt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zt.delete(t.pointerId)}}function Ft(e,t,n,i,r,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[r]},null!==t&&(null!==(t=vr(t))&&wt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ot(e){var t=_r(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void Ct(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=vr(n))&&wt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);xe=i,n.target.dispatchEvent(i),xe=null,t.shift()}return!0}function Nt(e,t,n){Bt(e)&&n.delete(t)}function Vt(){It=!1,null!==Et&&Bt(Et)&&(Et=null),null!==Pt&&Bt(Pt)&&(Pt=null),null!==At&&Bt(At)&&(At=null),Mt.forEach(Nt),zt.forEach(Nt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,It||(It=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Vt)))}function jt(e){function t(t){return Ut(t,e)}if(0<kt.length){Ut(kt[0],e);for(var n=1;n<kt.length;n++){var i=kt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Et&&Ut(Et,e),null!==Pt&&Ut(Pt,e),null!==At&&Ut(At,e),Mt.forEach(t),zt.forEach(t),n=0;n<Lt.length;n++)(i=Lt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Lt.length&&null===(n=Lt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Lt.shift()}var $t=x.ReactCurrentBatchConfig,Ht=!0;function qt(e,t,n,i){var r=vt,a=$t.transition;$t.transition=null;try{vt=1,Gt(e,t,n,i)}finally{vt=r,$t.transition=a}}function Zt(e,t,n,i){var r=vt,a=$t.transition;$t.transition=null;try{vt=4,Gt(e,t,n,i)}finally{vt=r,$t.transition=a}}function Gt(e,t,n,i){if(Ht){var r=Kt(e,t,n,i);if(null===r)Hi(e,t,i,Wt,n),Rt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Et=Ft(Et,e,t,n,i,r),!0;case"dragenter":return Pt=Ft(Pt,e,t,n,i,r),!0;case"mouseover":return At=Ft(At,e,t,n,i,r),!0;case"pointerover":var a=r.pointerId;return Mt.set(a,Ft(Mt.get(a)||null,e,t,n,i,r)),!0;case"gotpointercapture":return a=r.pointerId,zt.set(a,Ft(zt.get(a)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Rt(e,i),4&t&&-1<Dt.indexOf(e)){for(;null!==r;){var a=vr(r);if(null!==a&&bt(a),null===(a=Kt(e,t,n,i))&&Hi(e,t,i,Wt,n),a===r)break;r=a}null!==r&&i.stopPropagation()}else Hi(e,t,i,null,n)}}var Wt=null;function Kt(e,t,n,i){if(Wt=null,null!==(e=_r(e=be(i))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Jt,i=n.length,r="value"in Yt?Yt.value:Yt.textContent,a=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[a-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,i,r,a){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),hn=O({},cn,{view:0,detail:0}),dn=an(hn),pn=O({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=an(pn),mn=an(O({},pn,{dataTransfer:0})),gn=an(O({},hn,{relatedTarget:0})),yn=an(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),_n=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=an(_n),xn=an(O({},cn,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Cn(){return Tn}var In=O({},hn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=an(In),En=an(O({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=an(O({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),An=an(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Mn=O({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zn=an(Mn),Ln=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Rn=null;u&&"documentMode"in document&&(Rn=document.documentMode);var Fn=u&&"TextEvent"in window&&!Rn,On=u&&(!Dn||Rn&&8<Rn&&11>=Rn),Bn=String.fromCharCode(32),Nn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function qn(e,t,n,i){Ie(i),0<(t=Zi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Zn=null,Gn=null;function Wn(e){Bi(e,0)}function Kn(e){if(G(xr(e)))return e}function Xn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Jn;if(u){var Qn="oninput"in document;if(!Qn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Qn="function"===typeof ei.oninput}Jn=Qn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){Zn&&(Zn.detachEvent("onpropertychange",ni),Gn=Zn=null)}function ni(e){if("value"===e.propertyName&&Kn(Gn)){var t=[];qn(t,Gn,e,be(e)),Me(Wn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Gn=n,(Zn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Gn)}function ai(e,t){if("click"===e)return Kn(t)}function oi(e,t){if("input"===e||"change"===e)return Kn(t)}var si="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(si(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!si(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=W((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,a=Math.min(i.start,r);i=void 0===i.end?a:Math.min(i.end,r),!e.extend&&a>i&&(r=i,i=a,a=r),r=ui(n,a);var o=ui(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),a>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,yi=null,_i=null,vi=!1;function xi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vi||null==gi||gi!==W(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},_i&&li(_i,i)||(_i=i,0<(i=Zi(yi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function bi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},Si={},Ti={};function Ci(e){if(Si[e])return Si[e];if(!wi[e])return e;var t,n=wi[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ti)return Si[e]=n[t];return e}u&&(Ti=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Ii=Ci("animationend"),ki=Ci("animationiteration"),Ei=Ci("animationstart"),Pi=Ci("transitionend"),Ai=new Map,Mi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zi(e,t){Ai.set(e,t),l(t,[e])}for(var Li=0;Li<Mi.length;Li++){var Di=Mi[Li];zi(Di.toLowerCase(),"on"+(Di[0].toUpperCase()+Di.slice(1)))}zi(Ii,"onAnimationEnd"),zi(ki,"onAnimationIteration"),zi(Ei,"onAnimationStart"),zi("dblclick","onDoubleClick"),zi("focusin","onFocus"),zi("focusout","onBlur"),zi(Pi,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function Oi(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,s,l,c){if(Ue.apply(this,arguments),Fe){if(!Fe)throw Error(a(198));var u=Oe;Fe=!1,Oe=null,Be||(Be=!0,Ne=u)}}(i,t,void 0,e),e.currentTarget=null}function Bi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var a=void 0;if(t)for(var o=i.length-1;0<=o;o--){var s=i[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&r.isPropagationStopped())break e;Oi(r,s,c),a=l}else for(o=0;o<i.length;o++){if(l=(s=i[o]).instance,c=s.currentTarget,s=s.listener,l!==a&&r.isPropagationStopped())break e;Oi(r,s,c),a=l}}}if(Be)throw e=Ne,Be=!1,Ne=null,e}function Ni(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||($i(t,e,2,!1),n.add(i))}function Vi(e,t,n){var i=0;t&&(i|=4),$i(n,e,i,t)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function ji(e){if(!e[Ui]){e[Ui]=!0,o.forEach((function(t){"selectionchange"!==t&&(Fi.has(t)||Vi(t,!1,e),Vi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ui]||(t[Ui]=!0,Vi("selectionchange",!1,t))}}function $i(e,t,n,i){switch(Xt(t)){case 1:var r=qt;break;case 4:r=Zt;break;default:r=Gt}n=r.bind(null,t,n,e),r=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Hi(e,t,n,i,r){var a=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var s=i.stateNode.containerInfo;if(s===r||8===s.nodeType&&s.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==s;){if(null===(o=_r(s)))return;if(5===(l=o.tag)||6===l){i=a=o;continue e}s=s.parentNode}}i=i.return}Me((function(){var i=a,r=be(n),o=[];e:{var s=Ai.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Ii:case ki:case Ei:l=yn;break;case Pi:l=An;break;case"scroll":l=dn;break;case"wheel":l=zn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==d&&(null!=(m=ze(f,d))&&u.push(qi(f,m,p)))),h)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,r),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!_r(c)&&!c[fr])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?_r(c):null)&&(c!==(h=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fn,m="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=En,m="onPointerLeave",d="onPointerEnter",f="pointer"),h=null==l?s:xr(l),p=null==c?s:xr(c),(s=new u(m,f+"leave",l,n,r)).target=h,s.relatedTarget=p,m=null,_r(r)===i&&((u=new u(d,f+"enter",c,n,r)).target=p,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,f=0,p=u=l;p;p=Gi(p))f++;for(p=0,m=d;m;m=Gi(m))p++;for(;0<f-p;)u=Gi(u),f--;for(;0<p-f;)d=Gi(d),p--;for(;f--;){if(u===d||null!==d&&u===d.alternate)break e;u=Gi(u),d=Gi(d)}u=null}else u=null;null!==l&&Wi(o,s,l,u,!1),null!==c&&null!==h&&Wi(o,h,c,u,!0)}if("select"===(l=(s=i?xr(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Xn;else if(Hn(s))if(Yn)g=oi;else{g=ri;var y=ii}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ai);switch(g&&(g=g(e,i))?qn(o,g,n,r):(y&&y(e,s,i),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=i?xr(i):window,e){case"focusin":(Hn(y)||"true"===y.contentEditable)&&(gi=y,yi=i,_i=null);break;case"focusout":_i=yi=gi=null;break;case"mousedown":vi=!0;break;case"contextmenu":case"mouseup":case"dragend":vi=!1,xi(o,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":xi(o,n,r)}var _;if(Dn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else jn?Vn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(On&&"ko"!==n.locale&&(jn||"onCompositionStart"!==v?"onCompositionEnd"===v&&jn&&(_=en()):(Jt="value"in(Yt=r)?Yt.value:Yt.textContent,jn=!0)),0<(y=Zi(i,v)).length&&(v=new xn(v,e,null,n,r),o.push({event:v,listeners:y}),_?v.data=_:null!==(_=Un(n))&&(v.data=_))),(_=Fn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Nn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Nn?null:e;default:return null}}(e,n):function(e,t){if(jn)return"compositionend"===e||!Dn&&Vn(e,t)?(e=en(),Qt=Jt=Yt=null,jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Zi(i,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=_))}Bi(o,t)}))}function qi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Zi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,a=r.stateNode;5===r.tag&&null!==a&&(r=a,null!=(a=ze(e,n))&&i.unshift(qi(e,a,r)),null!=(a=ze(e,t))&&i.push(qi(e,a,r))),e=e.return}return i}function Gi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Wi(e,t,n,i,r){for(var a=t._reactName,o=[];null!==n&&n!==i;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===i)break;5===s.tag&&null!==c&&(s=c,r?null!=(l=ze(n,a))&&o.unshift(qi(n,l,s)):r||null!=(l=ze(n,a))&&o.push(qi(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Ki=/\r\n?/g,Xi=/\u0000|\uFFFD/g;function Yi(e){return("string"===typeof e?e:""+e).replace(Ki,"\n").replace(Xi,"")}function Ji(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(a(425))}function Qi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,ar="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ar?function(e){return ar.resolve(null).then(e).catch(sr)}:ir;function sr(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void jt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);jt(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,fr="__reactContainer$"+hr,mr="__reactEvents$"+hr,gr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function _r(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[dr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function vr(e){return!(e=e[dr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function br(e){return e[pr]||null}var wr=[],Sr=-1;function Tr(e){return{current:e}}function Cr(e){0>Sr||(e.current=wr[Sr],wr[Sr]=null,Sr--)}function Ir(e,t){Sr++,wr[Sr]=e.current,e.current=t}var kr={},Er=Tr(kr),Pr=Tr(!1),Ar=kr;function Mr(e,t){var n=e.type.contextTypes;if(!n)return kr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,a={};for(r in n)a[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function zr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Lr(){Cr(Pr),Cr(Er)}function Dr(e,t,n){if(Er.current!==kr)throw Error(a(168));Ir(Er,t),Ir(Pr,n)}function Rr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(a(108,$(e)||"Unknown",r));return O({},n,i)}function Fr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||kr,Ar=Er.current,Ir(Er,e),Ir(Pr,Pr.current),!0}function Or(e,t,n){var i=e.stateNode;if(!i)throw Error(a(169));n?(e=Rr(e,t,Ar),i.__reactInternalMemoizedMergedChildContext=e,Cr(Pr),Cr(Er),Ir(Er,e)):Cr(Pr),Ir(Pr,n)}var Br=null,Nr=!1,Vr=!1;function Ur(e){null===Br?Br=[e]:Br.push(e)}function jr(){if(!Vr&&null!==Br){Vr=!0;var e=0,t=vt;try{var n=Br;for(vt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Br=null,Nr=!1}catch(r){throw null!==Br&&(Br=Br.slice(e+1)),Ge(Qe,jr),r}finally{vt=t,Vr=!1}}return null}var $r=[],Hr=0,qr=null,Zr=0,Gr=[],Wr=0,Kr=null,Xr=1,Yr="";function Jr(e,t){$r[Hr++]=Zr,$r[Hr++]=qr,qr=e,Zr=t}function Qr(e,t,n){Gr[Wr++]=Xr,Gr[Wr++]=Yr,Gr[Wr++]=Kr,Kr=e;var i=Xr;e=Yr;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var a=32-ot(t)+r;if(30<a){var o=r-r%5;a=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Xr=1<<32-ot(t)+r|n<<r|i,Yr=a+e}else Xr=1<<a|n<<r|i,Yr=e}function ea(e){null!==e.return&&(Jr(e,1),Qr(e,1,0))}function ta(e){for(;e===qr;)qr=$r[--Hr],$r[Hr]=null,Zr=$r[--Hr],$r[Hr]=null;for(;e===Kr;)Kr=Gr[--Wr],Gr[Wr]=null,Yr=Gr[--Wr],Gr[Wr]=null,Xr=Gr[--Wr],Gr[Wr]=null}var na=null,ia=null,ra=!1,aa=null;function oa(e,t){var n=Mc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ia=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ia=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Kr?{id:Xr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Mc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ia=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ra){var t=ia;if(t){var n=t;if(!sa(e,t)){if(la(e))throw Error(a(418));t=cr(n.nextSibling);var i=na;t&&sa(e,t)?oa(i,n):(e.flags=-4097&e.flags|2,ra=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ra=!1,na=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ha(e){if(e!==na)return!1;if(!ra)return ua(e),ra=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=ia)){if(la(e))throw da(),Error(a(418));for(;t;)oa(e,t),t=cr(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ia=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ia=null}}else ia=na?cr(e.stateNode.nextSibling):null;return!0}function da(){for(var e=ia;e;)e=cr(e.nextSibling)}function pa(){ia=na=null,ra=!1}function fa(e){null===aa?aa=[e]:aa.push(e)}var ma=x.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var i=n.stateNode}if(!i)throw Error(a(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _a(e){return(0,e._init)(e._payload)}function va(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Oc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var a=n.type;return a===S?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===z&&_a(a)===t.type)?((i=r(t,n.props)).ref=ga(e,t,n),i.return=e,i):((i=Dc(n.type,n.key,n.props,null,e.mode,i)).ref=ga(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,a){return null===t||7!==t.tag?((t=Rc(n,e.mode,i,a)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case w:return(t=Bc(t,e.mode,n)).return=e,t;case z:return d(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Rc(t,e.mode,n,null)).return=e,t;ya(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===r?c(e,t,n,i):null;case w:return n.key===r?u(e,t,n,i):null;case z:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||R(n))return null!==r?null:h(e,t,n,i,null);ya(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case b:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case w:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case z:return f(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||R(i))return h(t,e=e.get(n)||null,i,r,null);ya(t,i)}return null}function m(r,a,s,l){for(var c=null,u=null,h=a,m=a=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=p(r,h,s[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(r,h),a=o(y,a,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===s.length)return n(r,h),ra&&Jr(r,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(r,s[m],l))&&(a=o(h,a,m),null===u?c=h:u.sibling=h,u=h);return ra&&Jr(r,m),c}for(h=i(r,h);m<s.length;m++)null!==(g=f(h,r,m,s[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),a=o(g,a,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(r,e)})),ra&&Jr(r,m),c}function g(r,s,l,c){var u=R(l);if("function"!==typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,m=s,g=s=0,y=null,_=l.next();null!==m&&!_.done;g++,_=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var v=p(r,m,_.value,c);if(null===v){null===m&&(m=y);break}e&&m&&null===v.alternate&&t(r,m),s=o(v,s,g),null===h?u=v:h.sibling=v,h=v,m=y}if(_.done)return n(r,m),ra&&Jr(r,g),u;if(null===m){for(;!_.done;g++,_=l.next())null!==(_=d(r,_.value,c))&&(s=o(_,s,g),null===h?u=_:h.sibling=_,h=_);return ra&&Jr(r,g),u}for(m=i(r,m);!_.done;g++,_=l.next())null!==(_=f(m,r,g,_.value,c))&&(e&&null!==_.alternate&&m.delete(null===_.key?g:_.key),s=o(_,s,g),null===h?u=_:h.sibling=_,h=_);return e&&m.forEach((function(e){return t(r,e)})),ra&&Jr(r,g),u}return function e(i,a,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var c=o.key,u=a;null!==u;){if(u.key===c){if((c=o.type)===S){if(7===u.tag){n(i,u.sibling),(a=r(u,o.props.children)).return=i,i=a;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===z&&_a(c)===u.type){n(i,u.sibling),(a=r(u,o.props)).ref=ga(i,u,o),a.return=i,i=a;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===S?((a=Rc(o.props.children,i.mode,l,o.key)).return=i,i=a):((l=Dc(o.type,o.key,o.props,null,i.mode,l)).ref=ga(i,a,o),l.return=i,i=l)}return s(i);case w:e:{for(u=o.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(i,a.sibling),(a=r(a,o.children||[])).return=i,i=a;break e}n(i,a);break}t(i,a),a=a.sibling}(a=Bc(o,i.mode,l)).return=i,i=a}return s(i);case z:return e(i,a,(u=o._init)(o._payload),l)}if(te(o))return m(i,a,o,l);if(R(o))return g(i,a,o,l);ya(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(i,a.sibling),(a=r(a,o)).return=i,i=a):(n(i,a),(a=Oc(o,i.mode,l)).return=i,i=a),s(i)):n(i,a)}}var xa=va(!0),ba=va(!1),wa=Tr(null),Sa=null,Ta=null,Ca=null;function Ia(){Ca=Ta=Sa=null}function ka(e){var t=wa.current;Cr(wa),e._currentValue=t}function Ea(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Pa(e,t){Sa=e,Ca=Ta=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vs=!0),e.firstContext=null)}function Aa(e){var t=e._currentValue;if(Ca!==e)if(e={context:e,memoizedValue:t,next:null},null===Ta){if(null===Sa)throw Error(a(308));Ta=e,Sa.dependencies={lanes:0,firstContext:e}}else Ta=Ta.next=e;return t}var Ma=null;function za(e){null===Ma?Ma=[e]:Ma.push(e)}function La(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,za(t)):(n.next=r.next,r.next=n),t.interleaved=n,Da(e,i)}function Da(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ra=!1;function Fa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Na(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&El)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Da(e,n)}return null===(r=i.interleaved)?(t.next=t,za(i)):(t.next=r.next,r.next=t),i.interleaved=t,Da(e,n)}function Va(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,_t(e,n)}}function Ua(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?r=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?r=a=t:a=a.next=t}else r=a=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ja(e,t,n,i){var r=e.updateQueue;Ra=!1;var a=r.firstBaseUpdate,o=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=r.baseState;for(o=0,u=c=l=null,s=a;;){var d=s.lane,p=s.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(d=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(d="function"===typeof(f=m.payload)?f.call(p,h,d):f)||void 0===d)break e;h=O({},h,d);break e;case 2:Ra=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[s]:d.push(s))}else p={eventTime:p,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(d=s).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===a&&(r.shared.lanes=0);Fl|=o,e.lanes=o,e.memoizedState=h}}function $a(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(a(191,r));r.call(i)}}}var Ha={},qa=Tr(Ha),Za=Tr(Ha),Ga=Tr(Ha);function Wa(e){if(e===Ha)throw Error(a(174));return e}function Ka(e,t){switch(Ir(Ga,t),Ir(Za,e),Ir(qa,Ha),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Cr(qa),Ir(qa,t)}function Xa(){Cr(qa),Cr(Za),Cr(Ga)}function Ya(e){Wa(Ga.current);var t=Wa(qa.current),n=le(t,e.type);t!==n&&(Ir(Za,e),Ir(qa,n))}function Ja(e){Za.current===e&&(Cr(qa),Cr(Za))}var Qa=Tr(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var io=x.ReactCurrentDispatcher,ro=x.ReactCurrentBatchConfig,ao=0,oo=null,so=null,lo=null,co=!1,uo=!1,ho=0,po=0;function fo(){throw Error(a(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!si(e[n],t[n]))return!1;return!0}function go(e,t,n,i,r,o){if(ao=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,io.current=null===e||null===e.memoizedState?Qo:es,e=n(i,r),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(a(301));o+=1,lo=so=null,t.updateQueue=null,io.current=ts,e=n(i,r)}while(uo)}if(io.current=Jo,t=null!==so&&null!==so.next,ao=0,lo=so=oo=null,co=!1,t)throw Error(a(300));return e}function yo(){var e=0!==ho;return ho=0,e}function _o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function vo(){if(null===so){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=so.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,so=e;else{if(null===e)throw Error(a(310));e={memoizedState:(so=e).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function xo(e,t){return"function"===typeof t?t(e):t}function bo(e){var t=vo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=so,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=s=null,c=null,u=o;do{var h=u.lane;if((ao&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=i):c=c.next=d,oo.lanes|=h,Fl|=h}u=u.next}while(null!==u&&u!==o);null===c?s=i:c.next=l,si(i,t.memoizedState)||(vs=!0),t.memoizedState=i,t.baseState=s,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,oo.lanes|=o,Fl|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wo(e){var t=vo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{o=e(o,s.action),s=s.next}while(s!==r);si(o,t.memoizedState)||(vs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function So(){}function To(e,t){var n=oo,i=vo(),r=t(),o=!si(i.memoizedState,r);if(o&&(i.memoizedState=r,vs=!0),i=i.queue,Fo(ko.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Mo(9,Io.bind(null,n,i,r,t),void 0,null),null===Pl)throw Error(a(349));0!==(30&ao)||Co(n,t,r)}return r}function Co(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Io(e,t,n,i){t.value=n,t.getSnapshot=i,Eo(t)&&Po(e)}function ko(e,t,n){return n((function(){Eo(t)&&Po(e)}))}function Eo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!si(e,n)}catch(i){return!0}}function Po(e){var t=Da(e,1);null!==t&&nc(t,e,1,-1)}function Ao(e){var t=_o();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:e},t.queue=e,e=e.dispatch=Wo.bind(null,oo,e),[t.memoizedState,e]}function Mo(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function zo(){return vo().memoizedState}function Lo(e,t,n,i){var r=_o();oo.flags|=e,r.memoizedState=Mo(1|t,n,void 0,void 0===i?null:i)}function Do(e,t,n,i){var r=vo();i=void 0===i?null:i;var a=void 0;if(null!==so){var o=so.memoizedState;if(a=o.destroy,null!==i&&mo(i,o.deps))return void(r.memoizedState=Mo(t,n,a,i))}oo.flags|=e,r.memoizedState=Mo(1|t,n,a,i)}function Ro(e,t){return Lo(8390656,8,e,t)}function Fo(e,t){return Do(2048,8,e,t)}function Oo(e,t){return Do(4,2,e,t)}function Bo(e,t){return Do(4,4,e,t)}function No(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Do(4,4,No.bind(null,t,e),n)}function Uo(){}function jo(e,t){var n=vo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function $o(e,t){var n=vo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&ao)?(e.baseState&&(e.baseState=!1,vs=!0),e.memoizedState=n):(si(n,t)||(n=mt(),oo.lanes|=n,Fl|=n,e.baseState=!0),t)}function qo(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var i=ro.transition;ro.transition={};try{e(!1),t()}finally{vt=n,ro.transition=i}}function Zo(){return vo().memoizedState}function Go(e,t,n){var i=tc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Ko(e))Xo(t,n);else if(null!==(n=La(e,t,n,i))){nc(n,e,i,ec()),Yo(n,t,i)}}function Wo(e,t,n){var i=tc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ko(e))Xo(t,r);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(r.hasEagerState=!0,r.eagerState=s,si(s,o)){var l=t.interleaved;return null===l?(r.next=r,za(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=La(e,t,r,i))&&(nc(n,e,i,r=ec()),Yo(n,t,i))}}function Ko(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Xo(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yo(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,_t(e,n)}}var Jo={readContext:Aa,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Qo={readContext:Aa,useCallback:function(e,t){return _o().memoizedState=[e,void 0===t?null:t],e},useContext:Aa,useEffect:Ro,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4194308,4,No.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var n=_o();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=_o();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Go.bind(null,oo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},_o().memoizedState=e},useState:Ao,useDebugValue:Uo,useDeferredValue:function(e){return _o().memoizedState=e},useTransition:function(){var e=Ao(!1),t=e[0];return e=qo.bind(null,e[1]),_o().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=oo,r=_o();if(ra){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Pl)throw Error(a(349));0!==(30&ao)||Co(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Ro(ko.bind(null,i,o,e),[e]),i.flags|=2048,Mo(9,Io.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=_o(),t=Pl.identifierPrefix;if(ra){var n=Yr;t=":"+t+"R"+(n=(Xr&~(1<<32-ot(Xr)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Aa,useCallback:jo,useContext:Aa,useEffect:Fo,useImperativeHandle:Vo,useInsertionEffect:Oo,useLayoutEffect:Bo,useMemo:$o,useReducer:bo,useRef:zo,useState:function(){return bo(xo)},useDebugValue:Uo,useDeferredValue:function(e){return Ho(vo(),so.memoizedState,e)},useTransition:function(){return[bo(xo)[0],vo().memoizedState]},useMutableSource:So,useSyncExternalStore:To,useId:Zo,unstable_isNewReconciler:!1},ts={readContext:Aa,useCallback:jo,useContext:Aa,useEffect:Fo,useImperativeHandle:Vo,useInsertionEffect:Oo,useLayoutEffect:Bo,useMemo:$o,useReducer:wo,useRef:zo,useState:function(){return wo(xo)},useDebugValue:Uo,useDeferredValue:function(e){var t=vo();return null===so?t.memoizedState=e:Ho(t,so.memoizedState,e)},useTransition:function(){return[wo(xo)[0],vo().memoizedState]},useMutableSource:So,useSyncExternalStore:To,useId:Zo,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function is(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var rs={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),a=Ba(i,r);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Na(e,a,r))&&(nc(t,e,r,i),Va(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ec(),r=tc(e),a=Ba(i,r);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Na(e,a,r))&&(nc(t,e,r,i),Va(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),i=tc(e),r=Ba(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Na(e,r,i))&&(nc(t,e,i,n),Va(t,e,i))}};function as(e,t,n,i,r,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,a))}function os(e,t,n){var i=!1,r=kr,a=t.contextType;return"object"===typeof a&&null!==a?a=Aa(a):(r=zr(t)?Ar:Er.current,a=(i=null!==(i=t.contextTypes)&&void 0!==i)?Mr(e,r):kr),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rs,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function ss(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&rs.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Fa(e);var a=t.contextType;"object"===typeof a&&null!==a?r.context=Aa(a):(a=zr(t)?Ar:Er.current,r.context=Mr(e,a)),r.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(is(e,t,a,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&rs.enqueueReplaceState(r,r.state,null),ja(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",i=t;do{n+=U(i),i=i.return}while(i);var r=n}catch(a){r="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:r,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Ba(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Hl||(Hl=!0,ql=i),hs(0,t)},n}function fs(e,t,n){(n=Ba(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){hs(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof i&&(null===Zl?Zl=new Set([this]):Zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ds;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ba(-1,1)).tag=2,Na(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var _s=x.ReactCurrentOwner,vs=!1;function xs(e,t,n,i){t.child=null===e?ba(t,null,n,i):xa(t,e.child,n,i)}function bs(e,t,n,i,r){n=n.render;var a=t.ref;return Pa(t,r),i=go(e,t,n,i,a,r),n=yo(),null===e||vs?(ra&&n&&ea(t),t.flags|=1,xs(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Hs(e,t,r))}function ws(e,t,n,i,r){if(null===e){var a=n.type;return"function"!==typeof a||zc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ss(e,t,a,i,r))}if(a=e.child,0===(e.lanes&r)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return Hs(e,t,r)}return t.flags|=1,(e=Lc(a,i)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,i,r){if(null!==e){var a=e.memoizedProps;if(li(a,i)&&e.ref===t.ref){if(vs=!1,t.pendingProps=i=a,0===(e.lanes&r))return t.lanes=e.lanes,Hs(e,t,r);0!==(131072&e.flags)&&(vs=!0)}}return Is(e,t,n,i,r)}function Ts(e,t,n){var i=t.pendingProps,r=i.children,a=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ir(Ll,zl),zl|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ir(Ll,zl),zl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==a?a.baseLanes:n,Ir(Ll,zl),zl|=i}else null!==a?(i=a.baseLanes|n,t.memoizedState=null):i=n,Ir(Ll,zl),zl|=i;return xs(e,t,r,n),t.child}function Cs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Is(e,t,n,i,r){var a=zr(n)?Ar:Er.current;return a=Mr(t,a),Pa(t,r),n=go(e,t,n,i,a,r),i=yo(),null===e||vs?(ra&&i&&ea(t),t.flags|=1,xs(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Hs(e,t,r))}function ks(e,t,n,i,r){if(zr(n)){var a=!0;Fr(t)}else a=!1;if(Pa(t,r),null===t.stateNode)$s(e,t),os(t,n,i),ls(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Aa(c):c=Mr(t,c=zr(n)?Ar:Er.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==i||l!==c)&&ss(t,o,i,c),Ra=!1;var d=t.memoizedState;o.state=d,ja(t,i,o,r),l=t.memoizedState,s!==i||d!==l||Pr.current||Ra?("function"===typeof u&&(is(t,n,u,i),l=t.memoizedState),(s=Ra||as(t,n,s,i,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Oa(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Aa(l):l=Mr(t,l=zr(n)?Ar:Er.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==l)&&ss(t,o,i,l),Ra=!1,d=t.memoizedState,o.state=d,ja(t,i,o,r);var f=t.memoizedState;s!==h||d!==f||Pr.current||Ra?("function"===typeof p&&(is(t,n,p,i),f=t.memoizedState),(c=Ra||as(t,n,c,i,d,f,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Es(e,t,n,i,a,r)}function Es(e,t,n,i,r,a){Cs(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&Or(t,n,!1),Hs(e,t,a);i=t.stateNode,_s.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,s,a)):xs(e,t,s,a),t.memoizedState=i.state,r&&Or(t,n,!0),t.child}function Ps(e){var t=e.stateNode;t.pendingContext?Dr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Dr(0,t.context,!1),Ka(e,t.containerInfo)}function As(e,t,n,i,r){return pa(),fa(r),t.flags|=256,xs(e,t,n,i),t.child}var Ms,zs,Ls,Ds,Rs={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Os(e,t,n){var i,r=t.pendingProps,o=Qa.current,s=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ir(Qa,1&o),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,s?(r=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Fc(l,r,0,null),e=Rc(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(n),t.memoizedState=Rs,e):Bs(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,s){if(n)return 256&t.flags?(t.flags&=-257,Ns(e,t,s,i=us(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=Fc({mode:"visible",children:i.children},r,0,null),(o=Rc(o,r,s,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&xa(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=Rs,o);if(0===(1&t.mode))return Ns(e,t,s,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ns(e,t,s,i=us(o=Error(a(419)),i,void 0))}if(l=0!==(s&e.childLanes),vs||l){if(null!==(i=Pl)){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|s))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Da(e,r),nc(i,e,r,-1))}return mc(),Ns(e,t,s,i=us(Error(a(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=kc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,ia=cr(r.nextSibling),na=t,ra=!0,aa=null,null!==e&&(Gr[Wr++]=Xr,Gr[Wr++]=Yr,Gr[Wr++]=Kr,Xr=e.id,Yr=e.overflow,Kr=t),t=Bs(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(s){s=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Lc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?s=Lc(i,s):(s=Rc(s,l,n,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,l=null===(l=e.child.memoizedState)?Fs(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Rs,r}return e=(s=e.child).sibling,r=Lc(s,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Bs(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ns(e,t,n,i){return null!==i&&fa(i),xa(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vs(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ea(e.return,t,n)}function Us(e,t,n,i,r){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r)}function js(e,t,n){var i=t.pendingProps,r=i.revealOrder,a=i.tail;if(xs(e,t,i.children,n),0!==(2&(i=Qa.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vs(e,n,t);else if(19===e.tag)Vs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Ir(Qa,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Us(t,!1,r,n,a);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===eo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Us(t,!0,n,null,a);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $s(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qs(e,t){if(!ra)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Zs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Gs(e,t,n){var i=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zs(t),null;case 1:case 17:return zr(t.type)&&Lr(),Zs(t),null;case 3:return i=t.stateNode,Xa(),Cr(Pr),Cr(Er),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(oc(aa),aa=null))),zs(e,t),Zs(t),null;case 5:Ja(t);var r=Wa(Ga.current);if(n=t.type,null!==e&&null!=t.stateNode)Ls(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(a(166));return Zs(t),null}if(e=Wa(qa.current),ha(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[dr]=t,i[pr]=o,e=0!==(1&t.mode),n){case"dialog":Ni("cancel",i),Ni("close",i);break;case"iframe":case"object":case"embed":Ni("load",i);break;case"video":case"audio":for(r=0;r<Ri.length;r++)Ni(Ri[r],i);break;case"source":Ni("error",i);break;case"img":case"image":case"link":Ni("error",i),Ni("load",i);break;case"details":Ni("toggle",i);break;case"input":X(i,o),Ni("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ni("invalid",i);break;case"textarea":re(i,o),Ni("invalid",i)}for(var l in _e(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ni("scroll",i)}switch(n){case"input":Z(i),Q(i,o,!0);break;case"textarea":Z(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Qi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[pr]=i,Ms(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,i),n){case"dialog":Ni("cancel",e),Ni("close",e),r=i;break;case"iframe":case"object":case"embed":Ni("load",e),r=i;break;case"video":case"audio":for(r=0;r<Ri.length;r++)Ni(Ri[r],e);r=i;break;case"source":Ni("error",e),r=i;break;case"img":case"image":case"link":Ni("error",e),Ni("load",e),r=i;break;case"details":Ni("toggle",e),r=i;break;case"input":X(e,i),r=K(e,i),Ni("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=O({},i,{value:void 0}),Ni("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ni("invalid",e)}for(o in _e(n,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ni("scroll",e):null!=u&&v(e,o,u,l))}switch(n){case"input":Z(e),Q(e,i,!1);break;case"textarea":Z(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+H(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Zs(t),null;case 6:if(e&&null!=t.stateNode)Ds(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(a(166));if(n=Wa(Ga.current),Wa(qa.current),ha(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(o=i.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return Zs(t),null;case 13:if(Cr(Qa),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ra&&null!==ia&&0!==(1&t.mode)&&0===(128&t.flags))da(),pa(),t.flags|=98560,o=!1;else if(o=ha(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[dr]=t}else pa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Zs(t),o=!1}else null!==aa&&(oc(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Qa.current)?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Zs(t),null);case 4:return Xa(),zs(e,t),null===e&&ji(t.stateNode.containerInfo),Zs(t),null;case 10:return ka(t.type._context),Zs(t),null;case 19:if(Cr(Qa),null===(o=t.memoizedState))return Zs(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)qs(o,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,qs(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ir(Qa,1&Qa.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>jl&&(t.flags|=128,i=!0,qs(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=eo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ra)return Zs(t),null}else 2*Ye()-o.renderingStartTime>jl&&1073741824!==n&&(t.flags|=128,i=!0,qs(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=Qa.current,Ir(Qa,i?1&n|2:1&n),t):(Zs(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&zl)&&(Zs(t),6&t.subtreeFlags&&(t.flags|=8192)):Zs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ws(e,t){switch(ta(t),t.tag){case 1:return zr(t.type)&&Lr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xa(),Cr(Pr),Cr(Er),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ja(t),null;case 13:if(Cr(Qa),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Cr(Qa),null;case 4:return Xa(),null;case 10:return ka(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ms=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},zs=function(){},Ls=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Wa(qa.current);var a,o=null;switch(n){case"input":r=K(e,r),i=K(e,i),o=[];break;case"select":r=O({},r,{value:void 0}),i=O({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Qi)}for(u in _e(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ni("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Ds=function(e,t,n,i){n!==i&&(t.flags|=4)};var Ks=!1,Xs=!1,Ys="function"===typeof WeakSet?WeakSet:Set,Js=null;function Qs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Tc(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){Tc(e,t,i)}}var tl=!1;function nl(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,void 0!==a&&el(t,n,a)}r=r.next}while(r!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[pr],delete t[mr],delete t[gr],delete t[yr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qi));else if(4!==i&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(rt,n)}catch(s){}switch(n.tag){case 5:Xs||Qs(n,t);case 6:var i=ul,r=hl;ul=null,dl(e,t,n),hl=r,null!==(ul=i)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),jt(e)):lr(ul,n.stateNode));break;case 4:i=ul,r=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=i,hl=r;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var a=r,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&el(n,t,o),r=r.next}while(r!==i)}dl(e,t,n);break;case 1:if(!Xs&&(Qs(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(s){Tc(n,t,s)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Xs=(i=Xs)||null!==n.memoizedState,dl(e,t,n),Xs=i):dl(e,t,n);break;default:dl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach((function(t){var i=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));pl(o,s,r),ul=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Tc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&i){try{nl(3,e,e.return),il(3,e)}catch(g){Tc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Tc(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&i&&null!==n&&Qs(n,n.return);break;case 5:if(ml(t,e),yl(e),512&i&&null!==n&&Qs(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(g){Tc(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(r,o),ve(l,s);var u=ve(l,o);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?ge(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):v(r,h,d,u)}switch(l){case"input":J(r,o);break;case"textarea":ae(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(r,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[pr]=o}catch(g){Tc(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&i){if(null===e.stateNode)throw Error(a(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(g){Tc(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(g){Tc(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Ul=Ye())),4&i&&fl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(u=Xs)||h,ml(t,e),Xs=u):ml(t,e),yl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Js=e,h=e.child;null!==h;){for(d=Js=h;null!==Js;){switch(f=(p=Js).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:Qs(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Tc(i,n,g)}}break;case 5:Qs(p,p.return);break;case 22:if(null!==p.memoizedState){bl(d);continue}}null!==f?(f.return=p,Js=f):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(g){Tc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Tc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&i&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var i=n;break e}n=n.return}throw Error(a(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),cl(e,sl(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;ll(e,sl(e),o);break;default:throw Error(a(161))}}catch(s){Tc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,n){Js=e,vl(e,t,n)}function vl(e,t,n){for(var i=0!==(1&e.mode);null!==Js;){var r=Js,a=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Ks;if(!o){var s=r.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Ks;var c=Xs;if(Ks=o,(Xs=l)&&!c)for(Js=r;null!==Js;)l=(o=Js).child,22===o.tag&&null!==o.memoizedState?wl(r):null!==l?(l.return=o,Js=l):wl(r);for(;null!==a;)Js=a,vl(a,t,n),a=a.sibling;Js=r,Ks=s,Xs=c}xl(e)}else 0!==(8772&r.subtreeFlags)&&null!==a?(a.return=r,Js=a):xl(e)}}function xl(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Xs)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&$a(t,o,i);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}$a(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&jt(d)}}}break;default:throw Error(a(163))}Xs||512&t.flags&&rl(t)}catch(p){Tc(t,t.return,p)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function bl(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function wl(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Tc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Tc(t,r,l)}}var a=t.return;try{rl(t)}catch(l){Tc(t,a,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){Tc(t,o,l)}}}catch(l){Tc(t,t.return,l)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Sl,Tl=Math.ceil,Cl=x.ReactCurrentDispatcher,Il=x.ReactCurrentOwner,kl=x.ReactCurrentBatchConfig,El=0,Pl=null,Al=null,Ml=0,zl=0,Ll=Tr(0),Dl=0,Rl=null,Fl=0,Ol=0,Bl=0,Nl=null,Vl=null,Ul=0,jl=1/0,$l=null,Hl=!1,ql=null,Zl=null,Gl=!1,Wl=null,Kl=0,Xl=0,Yl=null,Jl=-1,Ql=0;function ec(){return 0!==(6&El)?Ye():-1!==Jl?Jl:Jl=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==Ml?Ml&-Ml:null!==ma.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function nc(e,t,n,i){if(50<Xl)throw Xl=0,Yl=null,Error(a(185));yt(e,n,i),0!==(2&El)&&e===Pl||(e===Pl&&(0===(2&El)&&(Ol|=n),4===Dl&&sc(e,Ml)),ic(e,i),1===n&&0===El&&0===(1&t.mode)&&(jl=Ye()+500,Nr&&jr()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,l=r[o];-1===l?0!==(s&n)&&0===(s&i)||(r[o]=pt(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var i=dt(e,e===Pl?Ml:0);if(0===i)null!==n&&We(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&We(n),1===t)0===e.tag?function(e){Nr=!0,Ur(e)}(lc.bind(null,e)):Ur(lc.bind(null,e)),or((function(){0===(6&El)&&jr()})),n=null;else{switch(xt(i)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Pc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Jl=-1,Ql=0,0!==(6&El))throw Error(a(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var i=dt(e,e===Pl?Ml:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var r=El;El|=2;var o=fc();for(Pl===e&&Ml===t||($l=null,jl=Ye()+500,dc(e,t));;)try{_c();break}catch(l){pc(e,l)}Ia(),Cl.current=o,El=r,null!==Al?t=0:(Pl=null,Ml=0,t=Dl)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(i=r,t=ac(e,r))),1===t)throw n=Rl,dc(e,0),sc(e,i),ic(e,Ye()),n;if(6===t)sc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],a=r.getSnapshot;r=r.value;try{if(!si(a(),r))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gc(e,i))&&(0!==(o=ft(e))&&(i=o,t=ac(e,o))),1===t))throw n=Rl,dc(e,0),sc(e,i),ic(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(a(345));case 2:case 5:bc(e,Vl,$l);break;case 3:if(sc(e,i),(130023424&i)===i&&10<(t=Ul+500-Ye())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(bc.bind(null,e,Vl,$l),t);break}bc(e,Vl,$l);break;case 4:if(sc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var s=31-ot(i);o=1<<s,(s=t[s])>r&&(r=s),i&=~o}if(i=r,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Tl(i/1960))-i)){e.timeoutHandle=ir(bc.bind(null,e,Vl,$l),i);break}bc(e,Vl,$l);break;default:throw Error(a(329))}}}return ic(e,Ye()),e.callbackNode===n?rc.bind(null,e):null}function ac(e,t){var n=Nl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Vl,Vl=n,null!==t&&oc(t)),e}function oc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function sc(e,t){for(t&=~Bl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function lc(e){if(0!==(6&El))throw Error(a(327));wc();var t=dt(e,0);if(0===(1&t))return ic(e,Ye()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=ac(e,i))}if(1===n)throw n=Rl,dc(e,0),sc(e,t),ic(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Vl,$l),ic(e,Ye()),null}function cc(e,t){var n=El;El|=1;try{return e(t)}finally{0===(El=n)&&(jl=Ye()+500,Nr&&jr())}}function uc(e){null!==Wl&&0===Wl.tag&&0===(6&El)&&wc();var t=El;El|=1;var n=kl.transition,i=vt;try{if(kl.transition=null,vt=1,e)return e()}finally{vt=i,kl.transition=n,0===(6&(El=t))&&jr()}}function hc(){zl=Ll.current,Cr(Ll)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Al)for(n=Al.return;null!==n;){var i=n;switch(ta(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Lr();break;case 3:Xa(),Cr(Pr),Cr(Er),no();break;case 5:Ja(i);break;case 4:Xa();break;case 13:case 19:Cr(Qa);break;case 10:ka(i.type._context);break;case 22:case 23:hc()}n=n.return}if(Pl=e,Al=e=Lc(e.current,null),Ml=zl=t,Dl=0,Rl=null,Bl=Ol=Fl=0,Vl=Nl=null,null!==Ma){for(t=0;t<Ma.length;t++)if(null!==(i=(n=Ma[t]).interleaved)){n.interleaved=null;var r=i.next,a=n.pending;if(null!==a){var o=a.next;a.next=r,i.next=o}n.pending=i}Ma=null}return e}function pc(e,t){for(;;){var n=Al;try{if(Ia(),io.current=Jo,co){for(var i=oo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}co=!1}if(ao=0,lo=so=oo=null,uo=!1,ho=0,Il.current=null,null===n||null===n.return){Dl=1,Rl=t,Al=null;break}e:{var o=e,s=n.return,l=n,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,ys(f,s,l,0,t),1&f.mode&&ms(o,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ms(o,u,t),mc();break e}c=Error(a(426))}else if(ra&&1&l.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,t),fa(cs(c,l));break e}}o=c=cs(c,l),4!==Dl&&(Dl=2),null===Nl?Nl=[o]:Nl.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ua(o,ps(0,c,t));break e;case 1:l=c;var _=o.type,v=o.stateNode;if(0===(128&o.flags)&&("function"===typeof _.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Zl||!Zl.has(v)))){o.flags|=65536,t&=-t,o.lanes|=t,Ua(o,fs(o,l,t));break e}}o=o.return}while(null!==o)}xc(n)}catch(x){t=x,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function fc(){var e=Cl.current;return Cl.current=Jo,null===e?Jo:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Pl||0===(268435455&Fl)&&0===(268435455&Ol)||sc(Pl,Ml)}function gc(e,t){var n=El;El|=2;var i=fc();for(Pl===e&&Ml===t||($l=null,dc(e,t));;)try{yc();break}catch(r){pc(e,r)}if(Ia(),El=n,Cl.current=i,null!==Al)throw Error(a(261));return Pl=null,Ml=0,Dl}function yc(){for(;null!==Al;)vc(Al)}function _c(){for(;null!==Al&&!Ke();)vc(Al)}function vc(e){var t=Sl(e.alternate,e,zl);e.memoizedProps=e.pendingProps,null===t?xc(e):Al=t,Il.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Gs(n,t,zl)))return void(Al=n)}else{if(null!==(n=Ws(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Dl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Dl&&(Dl=5)}function bc(e,t,n){var i=vt,r=kl.transition;try{kl.transition=null,vt=1,function(e,t,n,i){do{wc()}while(null!==Wl);if(0!==(6&El))throw Error(a(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),a=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~a}}(e,o),e===Pl&&(Al=Pl=null,Ml=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Pc(tt,(function(){return wc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=kl.transition,kl.transition=null;var s=vt;vt=1;var l=El;El|=4,Il.current=null,function(e,t){if(er=Ht,pi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(b){n=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==r&&3!==d.nodeType||(l=s+r),d!==o||0!==i&&3!==d.nodeType||(c=s+i),3===d.nodeType&&(s+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++u===r&&(l=s),p===o&&++h===i&&(c=s),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Ht=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,_=t.stateNode,v=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),y);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(b){Tc(t,t.return,b)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}m=tl,tl=!1}(e,n),gl(n,e),fi(tr),Ht=!!er,tr=er=null,e.current=n,_l(n,e,r),Xe(),El=l,vt=s,kl.transition=o}else e.current=n;if(Gl&&(Gl=!1,Wl=e,Kl=r),o=e.pendingLanes,0===o&&(Zl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Hl)throw Hl=!1,e=ql,ql=null,e;0!==(1&Kl)&&0!==e.tag&&wc(),o=e.pendingLanes,0!==(1&o)?e===Yl?Xl++:(Xl=0,Yl=e):Xl=0,jr()}(e,t,n,i)}finally{kl.transition=r,vt=i}return null}function wc(){if(null!==Wl){var e=xt(Kl),t=kl.transition,n=vt;try{if(kl.transition=null,vt=16>e?16:e,null===Wl)var i=!1;else{if(e=Wl,Wl=null,Kl=0,0!==(6&El))throw Error(a(331));var r=El;for(El|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Js=u;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Js=d;else for(;null!==Js;){var p=(h=Js).sibling,f=h.return;if(al(h),h===u){Js=null;break}if(null!==p){p.return=f,Js=p;break}Js=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var _=o.sibling;if(null!==_){_.return=o.return,Js=_;break e}Js=o.return}}var v=e.current;for(Js=v;null!==Js;){var x=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Js=x;else e:for(s=v;null!==Js;){if(0!==(2048&(l=Js).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(w){Tc(l,l.return,w)}if(l===s){Js=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Js=b;break e}Js=l.return}}if(El=r,jr(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(rt,e)}catch(w){}i=!0}return i}finally{vt=n,kl.transition=t}}return!1}function Sc(e,t,n){e=Na(e,t=ps(0,t=cs(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),ic(e,t))}function Tc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Zl||!Zl.has(i))){t=Na(t,e=fs(t,e=cs(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),ic(t,e));break}}t=t.return}}function Cc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Pl===e&&(Ml&n)===n&&(4===Dl||3===Dl&&(130023424&Ml)===Ml&&500>Ye()-Ul?dc(e,0):Bl|=n),ic(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Da(e,t))&&(yt(e,t,n),ic(e,n))}function kc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(a(314))}null!==i&&i.delete(t),Ic(e,n)}function Pc(e,t){return Ge(e,t)}function Ac(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,n,i){return new Ac(e,t,n,i)}function zc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,i,r,o){var s=2;if(i=e,"function"===typeof e)zc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Rc(n.children,r,o,t);case T:s=8,r|=8;break;case C:return(e=Mc(12,n,t,2|r)).elementType=C,e.lanes=o,e;case P:return(e=Mc(13,n,t,r)).elementType=P,e.lanes=o,e;case A:return(e=Mc(19,n,t,r)).elementType=A,e.lanes=o,e;case L:return Fc(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:s=10;break e;case k:s=9;break e;case E:s=11;break e;case M:s=14;break e;case z:s=16,i=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Mc(s,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Rc(e,t,n,i){return(e=Mc(7,e,i,t)).lanes=n,e}function Fc(e,t,n,i){return(e=Mc(22,e,i,t)).elementType=L,e.lanes=n,e.stateNode={isHidden:!1},e}function Oc(e,t,n){return(e=Mc(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,i,r,a,o,s,l){return e=new Nc(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Mc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fa(a),e}function Uc(e){if(!e)return kr;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(zr(n))return Rr(e,n,t)}return t}function jc(e,t,n,i,r,a,o,s,l){return(e=Vc(n,i,!0,e,0,a,0,s,l)).context=Uc(null),n=e.current,(a=Ba(i=ec(),r=tc(n))).callback=void 0!==t&&null!==t?t:null,Na(n,a,r),e.current.lanes=r,yt(e,r,i),ic(e,i),e}function $c(e,t,n,i){var r=t.current,a=ec(),o=tc(r);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ba(a,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Na(r,t,o))&&(nc(e,r,o,a),Va(e,r,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Zc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pr.current)vs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return vs=!1,function(e,t,n){switch(t.tag){case 3:Ps(t),pa();break;case 5:Ya(t);break;case 1:zr(t.type)&&Fr(t);break;case 4:Ka(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Ir(wa,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Ir(Qa,1&Qa.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Os(e,t,n):(Ir(Qa,1&Qa.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ir(Qa,1&Qa.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return js(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ir(Qa,Qa.current),i)break;return null;case 22:case 23:return t.lanes=0,Ts(e,t,n)}return Hs(e,t,n)}(e,t,n);vs=0!==(131072&e.flags)}else vs=!1,ra&&0!==(1048576&t.flags)&&Qr(t,Zr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;$s(e,t),e=t.pendingProps;var r=Mr(t,Er.current);Pa(t,n),r=go(null,t,i,e,r,n);var o=yo();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zr(i)?(o=!0,Fr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Fa(t),r.updater=rs,t.stateNode=r,r._reactInternals=t,ls(t,i,e,n),t=Es(null,t,i,!0,o,n)):(t.tag=0,ra&&o&&ea(t),xs(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch($s(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return zc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===M)return 14}return 2}(i),e=ns(i,e),r){case 0:t=Is(null,t,i,e,n);break e;case 1:t=ks(null,t,i,e,n);break e;case 11:t=bs(null,t,i,e,n);break e;case 14:t=ws(null,t,i,ns(i.type,e),n);break e}throw Error(a(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Is(e,t,i,r=t.elementType===i?r:ns(i,r),n);case 1:return i=t.type,r=t.pendingProps,ks(e,t,i,r=t.elementType===i?r:ns(i,r),n);case 3:e:{if(Ps(t),null===e)throw Error(a(387));i=t.pendingProps,r=(o=t.memoizedState).element,Oa(e,t),ja(t,i,null,n);var s=t.memoizedState;if(i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,i,n,r=cs(Error(a(423)),t));break e}if(i!==r){t=As(e,t,i,n,r=cs(Error(a(424)),t));break e}for(ia=cr(t.stateNode.containerInfo.firstChild),na=t,ra=!0,aa=null,n=ba(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pa(),i===r){t=Hs(e,t,n);break e}xs(e,t,i,n)}t=t.child}return t;case 5:return Ya(t),null===e&&ca(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,s=r.children,nr(i,r)?s=null:null!==o&&nr(i,o)&&(t.flags|=32),Cs(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Os(e,t,n);case 4:return Ka(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=xa(t,null,i,n):xs(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,bs(e,t,i,r=t.elementType===i?r:ns(i,r),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,s=r.value,Ir(wa,i._currentValue),i._currentValue=s,null!==o)if(si(o.value,s)){if(o.children===r.children&&!Pr.current){t=Hs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Ba(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ea(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ea(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}xs(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Pa(t,n),i=i(r=Aa(r)),t.flags|=1,xs(e,t,i,n),t.child;case 14:return r=ns(i=t.type,t.pendingProps),ws(e,t,i,r=ns(i.type,r),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ns(i,r),$s(e,t),t.tag=1,zr(i)?(e=!0,Fr(t)):e=!1,Pa(t,n),os(t,i,r),ls(t,i,r,n),Es(null,t,i,!0,e,n);case 19:return js(e,t,n);case 22:return Ts(e,t,n)}throw Error(a(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Wc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Qc(e,t,n,i,r){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof r){var s=r;r=function(){var e=Hc(o);s.call(e)}}$c(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var a=i;i=function(){var e=Hc(o);a.call(e)}}var o=jc(t,i,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[fr]=o.current,ji(8===e.nodeType?e.parentNode:e),uc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var s=i;i=function(){var e=Hc(l);s.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[fr]=l.current,ji(8===e.nodeType?e.parentNode:e),uc((function(){$c(t,l,n,i)})),l}(n,t,e,r,i);return Hc(o)}Kc.prototype.render=Wc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));$c(e,t,null,null)},Kc.prototype.unmount=Wc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){$c(null,e,null,null)})),t[fr]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Lt.length&&0!==t&&t<Lt[n].priority;n++);Lt.splice(n,0,e),0===n&&Ot(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(_t(t,1|n),ic(t,Ye()),0===(6&El)&&(jl=Ye()+500,jr()))}break;case 13:uc((function(){var t=Da(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Zc(e,1)}},wt=function(e){if(13===e.tag){var t=Da(e,134217728);if(null!==t)nc(t,e,134217728,ec());Zc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Da(e,t);if(null!==n)nc(n,e,t,ec());Zc(e,t)}},Tt=function(){return vt},Ct=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=br(i);if(!r)throw Error(a(90));G(i),J(i,r)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=cc,Pe=uc;var eu={usingClientEntryPoint:!1,Events:[vr,xr,br,Ie,ke,cc]},tu={findFiberByHostInstance:_r,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{rt=iu.inject(nu),at=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(a(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(a(299));var n=!1,i="",r=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,i,r),e[fr]=t.current,ji(8===e.nodeType?e.parentNode:e),new Wc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(a(200));return Qc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(a(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",s=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jc(t,null,e,1,null!=n?n:null,r,0,o,s),e[fr]=t.current,ji(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Kc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(a(200));return Qc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fr]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Yc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Qc(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,a={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:a,_owner:s.current}}t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function _(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=y.prototype;var x=v.prototype=new _;x.constructor=v,m(x,y.prototype),x.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,i){var r,a={},o=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,r)&&!T.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:S.current}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,r,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===a?"."+E(l,0):a,b(o)?(r="",null!=e&&(r=e.replace(k,"$&/")+"/"),P(o,t,r,"",(function(e){return e}))):null!=o&&(I(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e)),t.push(o)),1;if(l=0,a=""===a?".":a+":",b(e))for(var c=0;c<e.length;c++){var u=a+E(s=e[c],c);l+=P(s,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=P(s=s.value,t,r,u=a+E(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var i=[],r=0;return P(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var z={current:null},L={transition:null},D={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:L,ReactCurrentOwner:S};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=o,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=R,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!T.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:a,ref:o,props:r,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return z.current.useCallback(e,t)},t.useContext=function(e){return z.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return z.current.useDeferredValue(e)},t.useEffect=function(e,t){return z.current.useEffect(e,t)},t.useId=function(){return z.current.useId()},t.useImperativeHandle=function(e,t,n){return z.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return z.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return z.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return z.current.useMemo(e,t)},t.useReducer=function(e,t,n){return z.current.useReducer(e,t,n)},t.useRef=function(e){return z.current.useRef(e)},t.useState=function(e){return z.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return z.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return z.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{"use strict";e.exports=n(202)},579:(e,t,n)=>{"use strict";e.exports=n(153)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<a(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var s=2*(i+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<r&&0>a(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[s]=n,i=s);else{if(!(c<r&&0>a(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function b(e){if(g=!1,x(e),!m)if(null!==i(c))m=!0,L(w);else{var t=i(u);null!==t&&D(b,t.startTime-e)}}function w(e,n){m=!1,g&&(g=!1,_(I),I=-1),f=!0;var a=p;try{for(x(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var s=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?d.callback=s:d===i(c)&&r(c),x(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&D(b,h.startTime-n),l=!1}return l}finally{d=null,p=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,T=!1,C=null,I=-1,k=5,E=-1;function P(){return!(t.unstable_now()-E<k)}function A(){if(null!==C){var e=t.unstable_now();E=e;var n=!0;try{n=C(!0,e)}finally{n?S():(T=!1,C=null)}}else T=!1}if("function"===typeof v)S=function(){v(A)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,z=M.port2;M.port1.onmessage=A,S=function(){z.postMessage(null)}}else S=function(){y(A,0)};function L(e){C=e,T||(T=!0,S())}function D(e,n){I=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,L(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(u,e),null===i(c)&&e===i(u)&&(g?(_(I),I=-1):g=!0,D(b,a-o))):(e.sortIndex=s,n(c,e),m||f||(m=!0,L(w))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(234)},719:function(e){e.exports=function(){"use strict";var e={},t={};function n(n,i,r){if(t[n]=r,"index"===n){var a="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",o={};return t.shared(o),t.index(e,o),"undefined"!==typeof window&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),e}}return n("shared",["exports"],(function(e){function t(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}"function"==typeof SuppressedError&&SuppressedError;var i=r;function r(e,t){this.x=e,this.y=t}r.prototype={clone:function(){return new r(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=i,this},_rotateAround:function(e,t){var n=Math.cos(e),i=Math.sin(e),r=t.y+i*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-i*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(e){return e instanceof r?e:Array.isArray(e)?new r(e[0],e[1]):e};var a=n(i),o=s;function s(e,t,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=i}s.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var r=this.sampleCurveX(n)-e;if(Math.abs(r)<t)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=r/a}var o=0,s=1;for(n=e,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-e)<t));i++)e>r?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var l=n(o);let c,u;function h(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function d(){if(null==u&&(u=!1,h())){const e=5,t=new OffscreenCanvas(e,e).getContext("2d",{willReadFrequently:!0});if(t){for(let i=0;i<e*e;i++){const n=4*i;t.fillStyle=`rgb(${n},${n+1},${n+2})`,t.fillRect(i%e,Math.floor(i/e),1,1)}const n=t.getImageData(0,0,e,e).data;for(let t=0;t<e*e*4;t++)if(t%4!=3&&n[t]!==t){u=!0;break}}}return u||!1}function p(e,t,n,i){const r=new l(e,t,n,i);return e=>r.solve(e)}const f=p(.25,.1,.25,1);function m(e,t,n){return Math.min(n,Math.max(t,e))}function g(e,t,n){const i=n-t,r=((e-t)%i+i)%i+t;return r===t?n:r}function y(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)for(const t in r)e[t]=r[t];return e}let _=1;function v(e,t,n){const i={};for(const r in e)i[r]=t.call(this,e[r],r,e);return i}function x(e,t,n){const i={};for(const r in e)t.call(this,e[r],r,e)&&(i[r]=e[r]);return i}function b(e){return Array.isArray(e)?e.map(b):"object"==typeof e&&e?v(e,b):e}const w={};function S(e){w[e]||("undefined"!=typeof console&&console.warn(e),w[e]=!0)}function T(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function C(e){return"undefined"!=typeof WorkerGlobalScope&&void 0!==e&&e instanceof WorkerGlobalScope}let I=null;function k(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const E="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function P(e,n,i,r,a){return t(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const t=new VideoFrame(e,{timestamp:0});try{const o=null==t?void 0:t.format;if(!o||!o.startsWith("BGR")&&!o.startsWith("RGB"))throw new Error(`Unrecognized format ${o}`);const s=o.startsWith("BGR"),l=new Uint8ClampedArray(r*a*4);if(yield t.copyTo(l,function(e,t,n,i,r){const a=4*Math.max(-t,0),o=(Math.max(0,n)-n)*i*4+a,s=4*i,l=Math.max(0,t),c=Math.max(0,n);return{rect:{x:l,y:c,width:Math.min(e.width,t+i)-l,height:Math.min(e.height,n+r)-c},layout:[{offset:o,stride:s}]}}(e,n,i,r,a)),s)for(let e=0;e<l.length;e+=4){const t=l[e];l[e]=l[e+2],l[e+2]=t}return l}finally{t.close()}}))}let A,M;const z="AbortError";function L(){return new Error(z)}const D={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function R(e){return D.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}const F="global-dispatcher";class O extends Error{constructor(e,t,n,i){super(`AJAXError: ${t} (${e}): ${n}`),this.status=e,this.statusText=t,this.url=n,this.body=i}}const B=()=>C(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,N=function(e,n){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){const t=R(e.url);if(t)return t(e,n);if(C(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:F},n)}if(!(/^file:/.test(i=e.url)||/^file:/.test(B())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(e,n){return t(this,void 0,void 0,(function*(){const t=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:B(),signal:n.signal});"json"!==e.type||t.headers.has("Accept")||t.headers.set("Accept","application/json");const i=yield fetch(t);if(!i.ok){const t=yield i.blob();throw new O(i.status,i.statusText,e.url,t)}let r;r="arrayBuffer"===e.type||"image"===e.type?i.arrayBuffer():"json"===e.type?i.json():i.text();const a=yield r;if(n.signal.aborted)throw L();return{data:a,cacheControl:i.headers.get("Cache-Control"),expires:i.headers.get("Expires")}}))}(e,n);if(C(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:F},n)}var i;return function(e,t){return new Promise(((n,i)=>{var r;const a=new XMLHttpRequest;a.open(e.method||"GET",e.url,!0),"arrayBuffer"!==e.type&&"image"!==e.type||(a.responseType="arraybuffer");for(const t in e.headers)a.setRequestHeader(t,e.headers[t]);"json"===e.type&&(a.responseType="text",(null===(r=e.headers)||void 0===r?void 0:r.Accept)||a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===e.credentials,a.onerror=()=>{i(new Error(a.statusText))},a.onload=()=>{if(!t.signal.aborted)if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){let t=a.response;if("json"===e.type)try{t=JSON.parse(a.response)}catch(e){return void i(e)}n({data:t,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{const t=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});i(new O(a.status,a.statusText,e.url,t))}},t.signal.addEventListener("abort",(()=>{a.abort(),i(L())})),a.send(e.body)}))}(e,n)};function V(e){if(!e||e.indexOf("://")<=0||0===e.indexOf("data:image/")||0===e.indexOf("blob:"))return!0;const t=new URL(e),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function U(e,t,n){n[e]&&-1!==n[e].indexOf(t)||(n[e]=n[e]||[],n[e].push(t))}function j(e,t,n){if(n&&n[e]){const i=n[e].indexOf(t);-1!==i&&n[e].splice(i,1)}}class ${constructor(e){y(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=e}}class H extends ${constructor(e){super("error",y({error:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class q{on(e,t){return this._listeners=this._listeners||{},U(e,t,this._listeners),this}off(e,t){return j(e,t,this._listeners),j(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},U(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){"string"==typeof e&&(e=new $(e,t||{}));const n=e.type;if(this.listens(n)){e.target=this;const t=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of t)n.call(this,e);const i=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const a of i)j(n,a,this._oneTimeListeners),a.call(this,e);const r=this._eventedParent;r&&(y(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(e))}else e instanceof H&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var Z={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const G=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function W(e,t){const n={};for(const i in e)"ref"!==i&&(n[i]=e[i]);return G.forEach((e=>{e in t&&(n[e]=t[e])})),n}function K(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!K(e[n],t[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!K(e[n],t[n]))return!1;return!0}return e===t}function X(e,t){e.push(t)}function Y(e,t,n){X(n,{command:"addSource",args:[e,t[e]]})}function J(e,t,n){X(t,{command:"removeSource",args:[e]}),n[e]=!0}function Q(e,t,n,i){J(e,n,i),Y(e,t,n)}function ee(e,t,n){let i;for(i in e[n])if(Object.prototype.hasOwnProperty.call(e[n],i)&&"data"!==i&&!K(e[n][i],t[n][i]))return!1;for(i in t[n])if(Object.prototype.hasOwnProperty.call(t[n],i)&&"data"!==i&&!K(e[n][i],t[n][i]))return!1;return!0}function te(e,t,n,i,r,a){e=e||{},t=t||{};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(K(e[o],t[o])||n.push({command:a,args:[i,o,t[o],r]}));for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&!Object.prototype.hasOwnProperty.call(e,o)&&(K(e[o],t[o])||n.push({command:a,args:[i,o,t[o],r]}))}function ne(e){return e.id}function ie(e,t){return e[t.id]=t,e}class re{constructor(e,t,n,i){this.message=(e?`${e}: `:"")+n,i&&(this.identifier=i),null!=t&&t.__line__&&(this.line=t.__line__)}}function ae(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(const r of n)for(const t in r)e[t]=r[t];return e}class oe extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class se{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=e,this.bindings={};for(const[n,i]of t)this.bindings[n]=i}concat(e){return new se(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const le={kind:"null"},ce={kind:"number"},ue={kind:"string"},he={kind:"boolean"},de={kind:"color"},pe={kind:"object"},fe={kind:"value"},me={kind:"collator"},ge={kind:"formatted"},ye={kind:"padding"},_e={kind:"resolvedImage"},ve={kind:"variableAnchorOffsetCollection"};function xe(e,t){return{kind:"array",itemType:e,N:t}}function be(e){if("array"===e.kind){const t=be(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const we=[le,ce,ue,he,de,ge,pe,xe(fe),ye,_e,ve];function Se(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Se(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of we)if(!Se(e,t))return null}return`Expected ${be(e)} but found ${be(t)} instead.`}function Te(e,t){return t.some((t=>t.kind===e.kind))}function Ce(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}function Ie(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const ke=.96422,Ee=.82521,Pe=4/29,Ae=6/29,Me=3*Ae*Ae,ze=Ae*Ae*Ae,Le=Math.PI/180,De=180/Math.PI;function Re(e){return(e%=360)<0&&(e+=360),e}function Fe(e){let t,n,[i,r,a,o]=e;const s=Be((.2225045*(i=Oe(i))+.7168786*(r=Oe(r))+.0606169*(a=Oe(a)))/1);i===r&&r===a?t=n=s:(t=Be((.4360747*i+.3850649*r+.1430804*a)/ke),n=Be((.0139322*i+.0971045*r+.7141733*a)/Ee));const l=116*s-16;return[l<0?0:l,500*(t-s),200*(s-n),o]}function Oe(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Be(e){return e>ze?Math.pow(e,1/3):e/Me+Pe}function Ne(e){let[t,n,i,r]=e,a=(t+16)/116,o=isNaN(n)?a:a+n/500,s=isNaN(i)?a:a-i/200;return a=1*Ue(a),o=ke*Ue(o),s=Ee*Ue(s),[Ve(3.1338561*o-1.6168667*a-.4906146*s),Ve(-.9787684*o+1.9161415*a+.033454*s),Ve(.0719453*o-.2289914*a+1.4052427*s),r]}function Ve(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function Ue(e){return e>Ae?e*e*e:Me*(e-Pe)}function je(e){return parseInt(e.padEnd(2,e),16)/255}function $e(e,t){return He(t?e/100:e,0,1)}function He(e,t,n){return Math.min(Math.max(t,e),n)}function qe(e){return!e.some(Number.isNaN)}const Ze={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ge{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.r=e,this.g=t,this.b=n,this.a=i,r||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,t,n,i]))}static parse(e){if(e instanceof Ge)return e;if("string"!=typeof e)return;const t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=Ze[e];if(t){const[e,n,i]=t;return[e/255,n/255,i/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let n=1;return[je(e.slice(n,n+=t)),je(e.slice(n,n+=t)),je(e.slice(n,n+=t)),je(e.slice(n,n+t)||"ff")]}if(e.startsWith("rgb")){const t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){const[e,n,i,r,a,o,s,l,c,u,h,d]=t,p=[r||" ",s||" ",u].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const e=[i,o,c].join(""),t="%%%"===e?100:""===e?255:0;if(t){const e=[He(+n/t,0,1),He(+a/t,0,1),He(+l/t,0,1),h?$e(+h,d):1];if(qe(e))return e}}return}}const n=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(n){const[e,t,i,r,a,o,s,l,c]=n,u=[i||" ",a||" ",s].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const e=[+t,He(+r,0,100),He(+o,0,100),l?$e(+l,c):1];if(qe(e))return function(e){let[t,n,i,r]=e;function a(e){const r=(e+t/30)%12,a=n*Math.min(i,1-i);return i-a*Math.max(-1,Math.min(r-3,9-r,1))}return t=Re(t),n/=100,i/=100,[a(0),a(8),a(4),r]}(e)}}}(e);return t?new Ge(...t,!1):void 0}get rgb(){const{r:e,g:t,b:n,a:i}=this,r=i||1/0;return this.overwriteGetter("rgb",[e/r,t/r,n/r,i])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,n,i,r]=Fe(e),a=Math.sqrt(n*n+i*i);return[Math.round(1e4*a)?Re(Math.atan2(i,n)*De):NaN,a,t,r]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Fe(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,n,i]=this.rgb;return`rgba(${[e,t,n].map((e=>Math.round(255*e))).join(",")},${i})`}}Ge.black=new Ge(0,0,0,1),Ge.white=new Ge(1,1,1,1),Ge.transparent=new Ge(0,0,0,0),Ge.red=new Ge(1,0,0,1);class We{constructor(e,t,n){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ke{constructor(e,t,n,i,r){this.text=e,this.image=t,this.scale=n,this.fontStack=i,this.textColor=r}}class Xe{constructor(e){this.sections=e}static fromString(e){return new Xe([new Ke(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Xe?e:Xe.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}}class Ye{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ye)return e;if("number"==typeof e)return new Ye([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Ye(e)}}toString(){return JSON.stringify(this.values)}}const Je=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Qe{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Qe)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const n=e[t],i=e[t+1];if("string"!=typeof n||!Je.has(n))return;if(!Array.isArray(i)||2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])return}return new Qe(e)}}toString(){return JSON.stringify(this.values)}}class et{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new et({name:e,available:!1}):null}}function tt(e,t,n,i){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[e,t,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[e,t,n,i]:[e,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function nt(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Ge||e instanceof We||e instanceof Xe||e instanceof Ye||e instanceof Qe||e instanceof et)return!0;if(Array.isArray(e)){for(const t of e)if(!nt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!nt(e[t]))return!1;return!0}return!1}function it(e){if(null===e)return le;if("string"==typeof e)return ue;if("boolean"==typeof e)return he;if("number"==typeof e)return ce;if(e instanceof Ge)return de;if(e instanceof We)return me;if(e instanceof Xe)return ge;if(e instanceof Ye)return ye;if(e instanceof Qe)return ve;if(e instanceof et)return _e;if(Array.isArray(e)){const t=e.length;let n;for(const i of e){const e=it(i);if(n){if(n===e)continue;n=fe;break}n=e}return xe(n||fe,t)}return pe}function rt(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Ge||e instanceof Xe||e instanceof Ye||e instanceof Qe||e instanceof et?e.toString():JSON.stringify(e)}class at{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!nt(e[1]))return t.error("invalid value");const n=e[1];let i=it(n);const r=t.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new at(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ot{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const st={string:ue,number:ce,boolean:he,object:pe};class lt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n,i=1;const r=e[0];if("array"===r){let r,a;if(e.length>2){const n=e[1];if("string"!=typeof n||!(n in st)||"object"===n)return t.error('The item type argument of "array" must be one of string, number, boolean',1);r=st[n],i++}else r=fe;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],i++}n=xe(r,a)}else{if(!st[r])throw new Error(`Types doesn't contain name = ${r}`);n=st[r]}const a=[];for(;i<e.length;i++){const n=t.parse(e[i],i,fe);if(!n)return null;a.push(n)}return new lt(n,a)}evaluate(e){for(let t=0;t<this.args.length;t++){const n=this.args[t].evaluate(e);if(!Se(this.type,it(n)))return n;if(t===this.args.length-1)throw new ot(`Expected value to be of type ${be(this.type)}, but found ${be(it(n))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const ct={"to-boolean":he,"to-color":de,"to-number":ce,"to-string":ue};class ut{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[0];if(!ct[n])throw new Error(`Can't parse ${n} as it is not part of the known types`);if(("to-boolean"===n||"to-string"===n)&&2!==e.length)return t.error("Expected one argument.");const i=ct[n],r=[];for(let a=1;a<e.length;a++){const n=t.parse(e[a],a,fe);if(!n)return null;r.push(n)}return new ut(i,r)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,n;for(const i of this.args){if(t=i.evaluate(e),n=null,t instanceof Ge)return t;if("string"==typeof t){const n=e.parseColor(t);if(n)return n}else if(Array.isArray(t)&&(n=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:tt(t[0],t[1],t[2],t[3]),!n))return new Ge(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ot(n||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const n of this.args){t=n.evaluate(e);const i=Ye.parse(t);if(i)return i}throw new ot(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const n of this.args){t=n.evaluate(e);const i=Qe.parse(t);if(i)return i}throw new ot(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const n of this.args){if(t=n.evaluate(e),null===t)return 0;const i=Number(t);if(!isNaN(i))return i}throw new ot(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Xe.fromString(rt(this.args[0].evaluate(e)));case"resolvedImage":return et.fromString(rt(this.args[0].evaluate(e)));default:return rt(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const ht=["Unknown","Point","LineString","Polygon"];class dt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ht[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Ge.parse(e)),t}}class pt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new se,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];this.registry=e,this.path=n,this.key=n.map((e=>`[${e}]`)).join(""),this.scope=r,this.errors=a,this.expectedType=i,this._isConstant=t}parse(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?this.concat(t,n,i)._parse(e,r):this._parse(e,r)}_parse(e,t){function n(e,t,n){return"assert"===n?new lt(t,[e]):"coerce"===n?new ut(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=e[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[i];if(r){let i=r.parse(e,this);if(!i)return null;if(this.expectedType){const e=this.expectedType,r=i.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==r.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==r.kind&&"string"!==r.kind)if("padding"!==e.kind||"value"!==r.kind&&"number"!==r.kind&&"array"!==r.kind)if("variableAnchorOffsetCollection"!==e.kind||"value"!==r.kind&&"array"!==r.kind){if(this.checkSubtype(e,r))return null}else i=n(i,e,t.typeAnnotation||"coerce");else i=n(i,e,t.typeAnnotation||"coerce");else i=n(i,e,t.typeAnnotation||"coerce");else i=n(i,e,t.typeAnnotation||"assert")}if(!(i instanceof at)&&"resolvedImage"!==i.type.kind&&this._isConstant(i)){const t=new dt;try{i=new at(i.type,i.evaluate(t))}catch(e){return this.error(e.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,n){const i="number"==typeof e?this.path.concat(e):this.path,r=n?this.scope.concat(n):this.scope;return new pt(this.registry,this._isConstant,i,t||null,r,this.errors)}error(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=`${this.key}${n.map((e=>`[${e}]`)).join("")}`;this.errors.push(new oe(r,e))}checkSubtype(e,t){const n=Se(e,t);return n&&this.error(n),n}}class ft{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const n=[];for(let r=1;r<e.length-1;r+=2){const i=e[r];if("string"!=typeof i)return t.error(`Expected string, but found ${typeof i} instead.`,r);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);const a=t.parse(e[r+1],r+1);if(!a)return null;n.push([i,a])}const i=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return i?new ft(n,i):null}outputDefined(){return this.result.outputDefined()}}class mt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const n=e[1];return t.scope.has(n)?new mt(n,t.scope.get(n)):t.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class gt{constructor(e,t,n){this.type=e,this.index=t,this.input=n}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,ce),i=t.parse(e[2],2,xe(t.expectedType||fe));return n&&i?new gt(i.type.itemType,n,i):null}evaluate(e){const t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new ot(`Array index out of bounds: ${t} < 0.`);if(t>=n.length)throw new ot(`Array index out of bounds: ${t} > ${n.length-1}.`);if(t!==Math.floor(t))throw new ot(`Array index must be an integer, but found ${t} instead.`);return n[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class yt{constructor(e,t){this.type=he,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,fe),i=t.parse(e[2],2,fe);return n&&i?Te(n.type,[he,ue,ce,le,fe])?new yt(n,i):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${be(n.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Ce(t,["boolean","string","number","null"]))throw new ot(`Expected first argument to be of type boolean, string, number or null, but found ${be(it(t))} instead.`);if(!Ce(n,["string","array"]))throw new ot(`Expected second argument to be of type array or string, but found ${be(it(n))} instead.`);return n.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class _t{constructor(e,t,n){this.type=ce,this.needle=e,this.haystack=t,this.fromIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,fe),i=t.parse(e[2],2,fe);if(!n||!i)return null;if(!Te(n.type,[he,ue,ce,le,fe]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${be(n.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,ce);return r?new _t(n,i,r):null}return new _t(n,i)}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Ce(t,["boolean","string","number","null"]))throw new ot(`Expected first argument to be of type boolean, string, number or null, but found ${be(it(t))} instead.`);if(!Ce(n,["string","array"]))throw new ot(`Expected second argument to be of type array or string, but found ${be(it(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(e);return n.indexOf(t,i)}return n.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class vt{constructor(e,t,n,i,r,a){this.inputType=e,this.type=t,this.input=n,this.cases=i,this.outputs=r,this.otherwise=a}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let n,i;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);const r={},a=[];for(let l=2;l<e.length-1;l+=2){let o=e[l];const s=e[l+1];Array.isArray(o)||(o=[o]);const c=t.concat(l);if(0===o.length)return c.error("Expected at least one branch label.");for(const e of o){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,it(e)))return null}else n=it(e);if(void 0!==r[String(e)])return c.error("Branch labels must be unique.");r[String(e)]=a.length}const u=t.parse(s,l,i);if(!u)return null;i=i||u.type,a.push(u)}const o=t.parse(e[1],1,fe);if(!o)return null;const s=t.parse(e[e.length-1],e.length-1,i);return s?"value"!==o.type.kind&&t.concat(1).checkSubtype(n,o.type)?null:new vt(n,i,o,r,a,s):null}evaluate(e){const t=this.input.evaluate(e);return(it(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class xt{constructor(e,t,n){this.type=e,this.branches=t,this.otherwise=n}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i=[];for(let a=1;a<e.length-1;a+=2){const r=t.parse(e[a],a,he);if(!r)return null;const o=t.parse(e[a+1],a+1,n);if(!o)return null;i.push([r,o]),n=n||o.type}const r=t.parse(e[e.length-1],e.length-1,n);if(!r)return null;if(!n)throw new Error("Can't infer output type");return new xt(n,i,r)}evaluate(e){for(const[t,n]of this.branches)if(t.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,n]of this.branches)e(t),e(n);e(this.otherwise)}outputDefined(){return this.branches.every((e=>{let[t,n]=e;return n.outputDefined()}))&&this.otherwise.outputDefined()}}class bt{constructor(e,t,n,i){this.type=e,this.input=t,this.beginIndex=n,this.endIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,fe),i=t.parse(e[2],2,ce);if(!n||!i)return null;if(!Te(n.type,[xe(fe),ue,fe]))return t.error(`Expected first argument to be of type array or string, but found ${be(n.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,ce);return r?new bt(n.type,n,i,r):null}return new bt(n.type,n,i)}evaluate(e){const t=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!Ce(t,["string","array"]))throw new ot(`Expected first argument to be of type array or string, but found ${be(it(t))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(e);return t.slice(n,i)}return t.slice(n)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function wt(e,t){const n=e.length-1;let i,r,a=0,o=n,s=0;for(;a<=o;)if(s=Math.floor((a+o)/2),i=e[s],r=e[s+1],i<=t){if(s===n||t<r)return s;a=s+1}else{if(!(i>t))throw new ot("Input is not a number.");o=s-1}return 0}class St{constructor(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[i,r]of n)this.labels.push(i),this.outputs.push(r)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const n=t.parse(e[1],1,ce);if(!n)return null;const i=[];let r=null;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(let a=1;a<e.length;a+=2){const n=1===a?-1/0:e[a],o=e[a+1],s=a,l=a+1;if("number"!=typeof n)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(i.length&&i[i.length-1][0]>=n)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=t.parse(o,l,r);if(!c)return null;r=r||c.type,i.push([n,c])}return new St(r,n,i)}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);const r=t.length;return i>=t[r-1]?n[r-1].evaluate(e):n[wt(t,i)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Tt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ct=It;function It(e,t,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=i}It.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var r=this.sampleCurveX(n)-e;if(Math.abs(r)<t)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=r/a}var o=0,s=1;for(n=e,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-e)<t));i++)e>r?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var kt=Tt(Ct);function Et(e,t,n){return e+n*(t-e)}function Pt(e,t,n){return e.map(((e,i)=>Et(e,t[i],n)))}const At={number:Et,color:function(e,t,n){switch(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb"){case"rgb":{const[i,r,a,o]=Pt(e.rgb,t.rgb,n);return new Ge(i,r,a,o,!1)}case"hcl":{const[i,r,a,o]=e.hcl,[s,l,c,u]=t.hcl;let h,d;if(isNaN(i)||isNaN(s))isNaN(i)?isNaN(s)?h=NaN:(h=s,1!==a&&0!==a||(d=l)):(h=i,1!==c&&0!==c||(d=r));else{let e=s-i;s>i&&e>180?e-=360:s<i&&i-s>180&&(e+=360),h=i+n*e}const[p,f,m,g]=function(e){let[t,n,i,r]=e;return t=isNaN(t)?0:t*Le,Ne([i,Math.cos(t)*n,Math.sin(t)*n,r])}([h,null!=d?d:Et(r,l,n),Et(a,c,n),Et(o,u,n)]);return new Ge(p,f,m,g,!1)}case"lab":{const[i,r,a,o]=Ne(Pt(e.lab,t.lab,n));return new Ge(i,r,a,o,!1)}}},array:Pt,padding:function(e,t,n){return new Ye(Pt(e.values,t.values,n))},variableAnchorOffsetCollection:function(e,t,n){const i=e.values,r=t.values;if(i.length!==r.length)throw new ot(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const a=[];for(let o=0;o<i.length;o+=2){if(i[o]!==r[o])throw new ot(`Cannot interpolate values containing mismatched anchors. from[${o}]: ${i[o]}, to[${o}]: ${r[o]}`);a.push(i[o]);const[e,t]=i[o+1],[s,l]=r[o+1];a.push([Et(e,s,n),Et(t,l,n)])}return new Qe(a)}};class Mt{constructor(e,t,n,i,r){this.type=e,this.operator=t,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[a,o]of r)this.labels.push(a),this.outputs.push(o)}static interpolationFactor(e,t,n,i){let r=0;if("exponential"===e.name)r=zt(t,e.base,n,i);else if("linear"===e.name)r=zt(t,1,n,i);else if("cubic-bezier"===e.name){const a=e.controlPoints;r=new kt(a[0],a[1],a[2],a[3]).solve(zt(t,1,n,i))}return r}static parse(e,t){let[n,i,r,...a]=e;if(!Array.isArray(i)||0===i.length)return t.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const e=i[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:e}}else{if("cubic-bezier"!==i[0])return t.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const e=i.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(r=t.parse(r,2,ce),!r)return null;const o=[];let s=null;"interpolate-hcl"===n||"interpolate-lab"===n?s=de:t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType);for(let l=0;l<a.length;l+=2){const e=a[l],n=a[l+1],i=l+3,r=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(o.length&&o[o.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const c=t.parse(n,r,s);if(!c)return null;s=s||c.type,o.push([e,c])}return Ie(s,ce)||Ie(s,de)||Ie(s,ye)||Ie(s,ve)||Ie(s,xe(ce))?new Mt(s,n,i,r,o):t.error(`Type ${be(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);const r=t.length;if(i>=t[r-1])return n[r-1].evaluate(e);const a=wt(t,i),o=Mt.interpolationFactor(this.interpolation,i,t[a],t[a+1]),s=n[a].evaluate(e),l=n[a+1].evaluate(e);switch(this.operator){case"interpolate":return At[this.type.kind](s,l,o);case"interpolate-hcl":return At.color(s,l,o,"hcl");case"interpolate-lab":return At.color(s,l,o,"lab")}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function zt(e,t,n,i){const r=i-n,a=e-n;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}class Lt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let n=null;const i=t.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const o of e.slice(1)){const e=t.parse(o,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!e)return null;n=n||e.type,r.push(e)}if(!n)throw new Error("No output type");const a=i&&r.some((e=>Se(i,e.type)));return new Lt(a?fe:n,r)}evaluate(e){let t,n=null,i=0;for(const r of this.args)if(i++,n=r.evaluate(e),n&&n instanceof et&&!n.available&&(t||(t=n.name),n=null,i===this.args.length&&(n=t)),null!==n)break;return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Dt(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Rt(e,t,n,i){return 0===i.compare(t,n)}function Ft(e,t,n){const i="=="!==e&&"!="!==e;return class r{constructor(e,t,n){this.type=he,this.lhs=e,this.rhs=t,this.collator=n,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const n=e[0];let a=t.parse(e[1],1,fe);if(!a)return null;if(!Dt(n,a.type))return t.concat(1).error(`"${n}" comparisons are not supported for type '${be(a.type)}'.`);let o=t.parse(e[2],2,fe);if(!o)return null;if(!Dt(n,o.type))return t.concat(2).error(`"${n}" comparisons are not supported for type '${be(o.type)}'.`);if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error(`Cannot compare types '${be(a.type)}' and '${be(o.type)}'.`);i&&("value"===a.type.kind&&"value"!==o.type.kind?a=new lt(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new lt(a.type,[o])));let s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,me),!s)return null}return new r(a,o,s)}evaluate(r){const a=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const t=it(a),n=it(o);if(t.kind!==n.kind||"string"!==t.kind&&"number"!==t.kind)throw new ot(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const e=it(a),n=it(o);if("string"!==e.kind||"string"!==n.kind)return t(r,a,o)}return this.collator?n(r,a,o,this.collator.evaluate(r)):t(r,a,o)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const Ot=Ft("==",(function(e,t,n){return t===n}),Rt),Bt=Ft("!=",(function(e,t,n){return t!==n}),(function(e,t,n,i){return!Rt(0,t,n,i)})),Nt=Ft("<",(function(e,t,n){return t<n}),(function(e,t,n,i){return i.compare(t,n)<0})),Vt=Ft(">",(function(e,t,n){return t>n}),(function(e,t,n,i){return i.compare(t,n)>0})),Ut=Ft("<=",(function(e,t,n){return t<=n}),(function(e,t,n,i){return i.compare(t,n)<=0})),jt=Ft(">=",(function(e,t,n){return t>=n}),(function(e,t,n,i){return i.compare(t,n)>=0}));class $t{constructor(e,t,n){this.type=me,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const n=e[1];if("object"!=typeof n||Array.isArray(n))return t.error("Collator options argument must be an object.");const i=t.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,he);if(!i)return null;const r=t.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,he);if(!r)return null;let a=null;return n.locale&&(a=t.parse(n.locale,1,ue),!a)?null:new $t(i,r,a)}evaluate(e){return new We(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Ht{constructor(e,t,n,i,r){this.type=ue,this.number=e,this.locale=t,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const n=t.parse(e[1],1,ce);if(!n)return null;const i=e[2];if("object"!=typeof i||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=t.parse(i.locale,1,ue),!r))return null;let a=null;if(i.currency&&(a=t.parse(i.currency,1,ue),!a))return null;let o=null;if(i["min-fraction-digits"]&&(o=t.parse(i["min-fraction-digits"],1,ce),!o))return null;let s=null;return i["max-fraction-digits"]&&(s=t.parse(i["max-fraction-digits"],1,ce),!s)?null:new Ht(n,r,a,o,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class qt{constructor(e){this.type=ge,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&"object"==typeof n)return t.error("First argument must be an image or text section.");const i=[];let r=!1;for(let a=1;a<=e.length-1;++a){const n=e[a];if(r&&"object"==typeof n&&!Array.isArray(n)){r=!1;let e=null;if(n["font-scale"]&&(e=t.parse(n["font-scale"],1,ce),!e))return null;let a=null;if(n["text-font"]&&(a=t.parse(n["text-font"],1,xe(ue)),!a))return null;let o=null;if(n["text-color"]&&(o=t.parse(n["text-color"],1,de),!o))return null;const s=i[i.length-1];s.scale=e,s.font=a,s.textColor=o}else{const n=t.parse(e[a],1,fe);if(!n)return null;const o=n.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:n,scale:null,font:null,textColor:null})}}return new qt(i)}evaluate(e){return new Xe(this.sections.map((t=>{const n=t.content.evaluate(e);return it(n)===_e?new Ke("",n,null,null,null):new Ke(rt(n),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}}class Zt{constructor(e){this.type=_e,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const n=t.parse(e[1],1,ue);return n?new Zt(n):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),n=et.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}}class Gt{constructor(e){this.type=ce,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const n=t.parse(e[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?t.error(`Expected argument of type string or array, but found ${be(n.type)} instead.`):new Gt(n):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new ot(`Expected value to be of type string or array, but found ${be(it(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Wt=8192;function Kt(e,t){const n=(180+e[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(n*r*Wt),Math.round(i*r*Wt)]}function Xt(e,t){const n=Math.pow(2,t.z);return[(r=(e[0]/Wt+t.x)/n,360*r-180),(i=(e[1]/Wt+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90)];var i,r}function Yt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Jt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Qt(e,t,n){const i=e[0]-t[0],r=e[1]-t[1],a=e[0]-n[0],o=e[1]-n[1];return i*o-a*r==0&&i*a<=0&&r*o<=0}function en(e,t,n,i){return 0!=(r=[i[0]-n[0],i[1]-n[1]])[0]*(a=[t[0]-e[0],t[1]-e[1]])[1]-r[1]*a[0]&&!(!sn(e,t,n,i)||!sn(n,i,e,t));var r,a}function tn(e,t,n){for(const i of n)for(let n=0;n<i.length-1;++n)if(en(e,t,i[n],i[n+1]))return!0;return!1}function nn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1;for(const s of t)for(let t=0;t<s.length-1;t++){if(Qt(e,s[t],s[t+1]))return n;(a=s[t])[1]>(r=e)[1]!=(o=s[t+1])[1]>r[1]&&r[0]<(o[0]-a[0])*(r[1]-a[1])/(o[1]-a[1])+a[0]&&(i=!i)}var r,a,o;return i}function rn(e,t){for(const n of t)if(nn(e,n))return!0;return!1}function an(e,t){for(const n of e)if(!nn(n,t))return!1;for(let n=0;n<e.length-1;++n)if(tn(e[n],e[n+1],t))return!1;return!0}function on(e,t){for(const n of t)if(an(e,n))return!0;return!1}function sn(e,t,n,i){const r=i[0]-n[0],a=i[1]-n[1],o=(e[0]-n[0])*a-r*(e[1]-n[1]),s=(t[0]-n[0])*a-r*(t[1]-n[1]);return o>0&&s<0||o<0&&s>0}function ln(e,t,n){const i=[];for(let r=0;r<e.length;r++){const a=[];for(let i=0;i<e[r].length;i++){const o=Kt(e[r][i],n);Yt(t,o),a.push(o)}i.push(a)}return i}function cn(e,t,n){const i=[];for(let r=0;r<e.length;r++){const a=ln(e[r],t,n);i.push(a)}return i}function un(e,t,n,i){if(e[0]<n[0]||e[0]>n[2]){const t=.5*i;let r=e[0]-n[0]>t?-i:n[0]-e[0]>t?i:0;0===r&&(r=e[0]-n[2]>t?-i:n[2]-e[0]>t?i:0),e[0]+=r}Yt(t,e)}function hn(e,t,n,i){const r=Math.pow(2,i.z)*Wt,a=[i.x*Wt,i.y*Wt],o=[];for(const s of e)for(const e of s){const i=[e.x+a[0],e.y+a[1]];un(i,t,n,r),o.push(i)}return o}function dn(e,t,n,i){const r=Math.pow(2,i.z)*Wt,a=[i.x*Wt,i.y*Wt],o=[];for(const l of e){const e=[];for(const n of l){const i=[n.x+a[0],n.y+a[1]];Yt(t,i),e.push(i)}o.push(e)}if(t[2]-t[0]<=r/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of o)for(const i of e)un(i,t,n,r)}var s;return o}class pn{constructor(e,t){this.type=he,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(nt(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const n of t.features){const{type:t,coordinates:i}=n.geometry;"Polygon"===t&&e.push(i),"MultiPolygon"===t&&e.push(...i)}if(e.length)return new pn(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new pn(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new pn(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if("Polygon"===t.type){const a=ln(t.coordinates,i,r),o=hn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;for(const e of o)if(!nn(e,a))return!1}if("MultiPolygon"===t.type){const a=cn(t.coordinates,i,r),o=hn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;for(const e of o)if(!rn(e,a))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if("Polygon"===t.type){const a=ln(t.coordinates,i,r),o=dn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;for(const e of o)if(!an(e,a))return!1}if("MultiPolygon"===t.type){const a=cn(t.coordinates,i,r),o=dn(e.geometry(),n,i,r);if(!Jt(n,i))return!1;for(const e of o)if(!on(e,a))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let fn=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,i=t[e];for(;e>0;){const r=e-1>>1,a=t[r];if(n(i,a)>=0)break;t[e]=a,e=r}t[e]=i}_down(e){const{data:t,compare:n}=this,i=this.length>>1,r=t[e];for(;e<i;){let i=1+(e<<1),a=t[i];const o=i+1;if(o<this.length&&n(t[o],a)<0&&(i=o,a=t[o]),n(a,r)>=0)break;t[e]=a,e=i}t[e]=r}};function mn(e,t){return e<t?-1:e>t?1:0}function gn(e,t,n,i,r){yn(e,t,n,i||e.length-1,r||vn)}function yn(e,t,n,i,r){for(;i>n;){if(i-n>600){var a=i-n+1,o=t-n+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);yn(e,t,Math.max(n,Math.floor(t-o*l/a+c)),Math.min(i,Math.floor(t+(a-o)*l/a+c)),r)}var u=e[t],h=n,d=i;for(_n(e,n,t),r(e[i],u)>0&&_n(e,n,i);h<d;){for(_n(e,h,d),h++,d--;r(e[h],u)<0;)h++;for(;r(e[d],u)>0;)d--}0===r(e[n],u)?_n(e,n,d):_n(e,++d,i),d<=t&&(n=d+1),t<=d&&(i=d-1)}}function _n(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function vn(e,t){return e<t?-1:e>t?1:0}function xn(e,t){if(e.length<=1)return[e];const n=[];let i,r;for(const a of e){const e=wn(a);0!==e&&(a.area=Math.abs(e),void 0===r&&(r=e<0),r===e<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(gn(n[a],t,1,n[a].length-1,bn),n[a]=n[a].slice(0,t));return n}function bn(e,t){return t.area-e.area}function wn(e){let t=0;for(let n,i,r=0,a=e.length,o=a-1;r<a;o=r++)n=e[r],i=e[o],t+=(i.x-n.x)*(n.y+i.y);return t}const Sn=1/298.257223563,Tn=Sn*(2-Sn),Cn=Math.PI/180;class In{constructor(e){const t=6378.137*Cn*1e3,n=Math.cos(e*Cn),i=1/(1-Tn*(1-n*n)),r=Math.sqrt(i);this.kx=t*r*n,this.ky=t*r*i*(1-Tn)}distance(e,t){const n=this.wrap(e[0]-t[0])*this.kx,i=(e[1]-t[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(e,t){let n,i,r,a,o=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],c=e[s][1],u=this.wrap(e[s+1][0]-l)*this.kx,h=(e[s+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(this.wrap(t[0]-l)*this.kx*u+(t[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=e[s+1][0],c=e[s+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=this.wrap(t[0]-l)*this.kx,h=(t[1]-c)*this.ky;const p=u*u+h*h;p<o&&(o=p,n=l,i=c,r=s,a=d)}return{point:[n,i],index:r,t:Math.max(0,Math.min(1,a))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function kn(e,t){return t[0]-e[0]}function En(e){return e[1]-e[0]+1}function Pn(e,t){return e[1]>=e[0]&&e[1]<t}function An(e,t){if(e[0]>e[1])return[null,null];const n=En(e);if(t){if(2===n)return[e,null];const t=Math.floor(n/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===n)return[e,null];const i=Math.floor(n/2)-1;return[[e[0],e[0]+i],[e[0]+i+1,e[1]]]}function Mn(e,t){if(!Pn(t,e.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let i=t[0];i<=t[1];++i)Yt(n,e[i]);return n}function zn(e){const t=[1/0,1/0,-1/0,-1/0];for(const n of e)for(const e of n)Yt(t,e);return t}function Ln(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function Dn(e,t,n){if(!Ln(e)||!Ln(t))return NaN;let i=0,r=0;return e[2]<t[0]&&(i=t[0]-e[2]),e[0]>t[2]&&(i=e[0]-t[2]),e[1]>t[3]&&(r=e[1]-t[3]),e[3]<t[1]&&(r=t[1]-e[3]),n.distance([0,0],[i,r])}function Rn(e,t,n){const i=n.pointOnLine(t,e);return n.distance(e,i.point)}function Fn(e,t,n,i,r){const a=Math.min(Rn(e,[n,i],r),Rn(t,[n,i],r)),o=Math.min(Rn(n,[e,t],r),Rn(i,[e,t],r));return Math.min(a,o)}function On(e,t,n,i,r){if(!Pn(t,e.length)||!Pn(i,n.length))return 1/0;let a=1/0;for(let o=t[0];o<t[1];++o){const t=e[o],s=e[o+1];for(let e=i[0];e<i[1];++e){const i=n[e],o=n[e+1];if(en(t,s,i,o))return 0;a=Math.min(a,Fn(t,s,i,o,r))}}return a}function Bn(e,t,n,i,r){if(!Pn(t,e.length)||!Pn(i,n.length))return NaN;let a=1/0;for(let o=t[0];o<=t[1];++o)for(let t=i[0];t<=i[1];++t)if(a=Math.min(a,r.distance(e[o],n[t])),0===a)return a;return a}function Nn(e,t,n){if(nn(e,t,!0))return 0;let i=1/0;for(const r of t){const t=r[0],a=r[r.length-1];if(t!==a&&(i=Math.min(i,Rn(e,[a,t],n)),0===i))return i;const o=n.pointOnLine(r,e);if(i=Math.min(i,n.distance(e,o.point)),0===i)return i}return i}function Vn(e,t,n,i){if(!Pn(t,e.length))return NaN;for(let a=t[0];a<=t[1];++a)if(nn(e[a],n,!0))return 0;let r=1/0;for(let a=t[0];a<t[1];++a){const t=e[a],o=e[a+1];for(const e of n)for(let n=0,a=e.length,s=a-1;n<a;s=n++){const a=e[s],l=e[n];if(en(t,o,a,l))return 0;r=Math.min(r,Fn(t,o,a,l,i))}}return r}function Un(e,t){for(const n of e)for(const e of n)if(nn(e,t,!0))return!0;return!1}function jn(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;const r=zn(e),a=zn(t);if(i!==1/0&&Dn(r,a,n)>=i)return i;if(Jt(r,a)){if(Un(e,t))return 0}else if(Un(t,e))return 0;let o=1/0;for(const s of e)for(let e=0,i=s.length,r=i-1;e<i;r=e++){const i=s[r],a=s[e];for(const e of t)for(let t=0,r=e.length,s=r-1;t<r;s=t++){const r=e[s],l=e[t];if(en(i,a,r,l))return 0;o=Math.min(o,Fn(i,a,r,l,n))}}return o}function $n(e,t,n,i,r,a){if(!a)return;const o=Dn(Mn(i,a),r,n);o<t&&e.push([o,a,[0,0]])}function Hn(e,t,n,i,r,a,o){if(!a||!o)return;const s=Dn(Mn(i,a),Mn(r,o),n);s<t&&e.push([s,a,o])}function qn(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=Math.min(i.distance(e[0],n[0][0]),r);if(0===a)return a;const o=new fn([[0,[0,e.length-1],[0,0]]],kn),s=zn(n);for(;o.length>0;){const r=o.pop();if(r[0]>=a)continue;const l=r[1],c=t?50:100;if(En(l)<=c){if(!Pn(l,e.length))return NaN;if(t){const t=Vn(e,l,n,i);if(isNaN(t)||0===t)return t;a=Math.min(a,t)}else for(let t=l[0];t<=l[1];++t){const r=Nn(e[t],n,i);if(a=Math.min(a,r),0===a)return 0}}else{const n=An(l,t);$n(o,a,i,e,s,n[0]),$n(o,a,i,e,s,n[1])}}return a}function Zn(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,o=Math.min(a,r.distance(e[0],n[0]));if(0===o)return o;const s=new fn([[0,[0,e.length-1],[0,n.length-1]]],kn);for(;s.length>0;){const a=s.pop();if(a[0]>=o)continue;const l=a[1],c=a[2],u=t?50:100,h=i?50:100;if(En(l)<=u&&En(c)<=h){if(!Pn(l,e.length)&&Pn(c,n.length))return NaN;let a;if(t&&i)a=On(e,l,n,c,r),o=Math.min(o,a);else if(t&&!i){const t=e.slice(l[0],l[1]+1);for(let e=c[0];e<=c[1];++e)if(a=Rn(n[e],t,r),o=Math.min(o,a),0===o)return o}else if(!t&&i){const t=n.slice(c[0],c[1]+1);for(let n=l[0];n<=l[1];++n)if(a=Rn(e[n],t,r),o=Math.min(o,a),0===o)return o}else a=Bn(e,l,n,c,r),o=Math.min(o,a)}else{const a=An(l,t),u=An(c,i);Hn(s,o,r,e,n,a[0],u[0]),Hn(s,o,r,e,n,a[0],u[1]),Hn(s,o,r,e,n,a[1],u[0]),Hn(s,o,r,e,n,a[1],u[1])}}return o}function Gn(e){return"MultiPolygon"===e.type?e.coordinates.map((e=>({type:"Polygon",coordinates:e}))):"MultiLineString"===e.type?e.coordinates.map((e=>({type:"LineString",coordinates:e}))):"MultiPoint"===e.type?e.coordinates.map((e=>({type:"Point",coordinates:e}))):[e]}class Wn{constructor(e,t){this.type=ce,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(nt(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new Wn(t,t.features.map((e=>Gn(e.geometry))).flat());if("Feature"===t.type)return new Wn(t,Gn(t.geometry));if("type"in t&&"coordinates"in t)return new Wn(t,Gn(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const n=e.geometry(),i=n.flat().map((t=>Xt([t.x,t.y],e.canonical)));if(0===n.length)return NaN;const r=new In(i[0][1]);let a=1/0;for(const o of t){switch(o.type){case"Point":a=Math.min(a,Zn(i,!1,[o.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,Zn(i,!1,o.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,qn(i,!1,o.coordinates,r,a))}if(0===a)return a}return a}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const n=e.geometry(),i=n.flat().map((t=>Xt([t.x,t.y],e.canonical)));if(0===n.length)return NaN;const r=new In(i[0][1]);let a=1/0;for(const o of t){switch(o.type){case"Point":a=Math.min(a,Zn(i,!0,[o.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,Zn(i,!0,o.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,qn(i,!0,o.coordinates,r,a))}if(0===a)return a}return a}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){const n=e.geometry();if(0===n.length||0===n[0].length)return NaN;const i=xn(n,0).map((t=>t.map((t=>t.map((t=>Xt([t.x,t.y],e.canonical))))))),r=new In(i[0][0][0][1]);let a=1/0;for(const o of t)for(const e of i){switch(o.type){case"Point":a=Math.min(a,qn([o.coordinates],!1,e,r,a));break;case"LineString":a=Math.min(a,qn(o.coordinates,!0,e,r,a));break;case"Polygon":a=Math.min(a,jn(e,o.coordinates,r,a))}if(0===a)return a}return a}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Kn={"==":Ot,"!=":Bt,">":Vt,"<":Nt,">=":jt,"<=":Ut,array:lt,at:gt,boolean:lt,case:xt,coalesce:Lt,collator:$t,format:qt,image:Zt,in:yt,"index-of":_t,interpolate:Mt,"interpolate-hcl":Mt,"interpolate-lab":Mt,length:Gt,let:ft,literal:at,match:vt,number:lt,"number-format":Ht,object:lt,slice:bt,step:St,string:lt,"to-boolean":ut,"to-color":ut,"to-number":ut,"to-string":ut,var:mt,within:pn,distance:Wn};class Xn{constructor(e,t,n,i){this.name=e,this.type=t,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const n=e[0],i=Xn.definitions[n];if(!i)return t.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,o=a.filter((t=>{let[n]=t;return!Array.isArray(n)||n.length===e.length-1}));let s=null;for(const[l,c]of o){s=new pt(t.registry,ti,t.path,null,t.scope);const i=[];let a=!1;for(let t=1;t<e.length;t++){const n=e[t],r=Array.isArray(l)?l[t-1]:l.type,o=s.parse(n,1+i.length,r);if(!o){a=!0;break}i.push(o)}if(!a)if(Array.isArray(l)&&l.length!==i.length)s.error(`Expected ${l.length} arguments, but found ${i.length} instead.`);else{for(let e=0;e<i.length;e++){const t=Array.isArray(l)?l[e]:l.type,n=i[e];s.concat(e+1).checkSubtype(t,n.type)}if(0===s.errors.length)return new Xn(n,r,c,i)}}if(1===o.length)t.errors.push(...s.errors);else{const n=(o.length?o:a).map((e=>{let[t]=e;return n=t,Array.isArray(n)?`(${n.map(be).join(", ")})`:`(${be(n.type)}...)`;var n})).join(" | "),i=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],1+i.length);if(!n)return null;i.push(be(n.type))}t.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(e,t){Xn.definitions=t;for(const n in t)e[n]=Xn}}function Yn(e,t){let[n,i,r,a]=t;n=n.evaluate(e),i=i.evaluate(e),r=r.evaluate(e);const o=a?a.evaluate(e):1,s=tt(n,i,r,o);if(s)throw new ot(s);return new Ge(n/255,i/255,r/255,o,!1)}function Jn(e,t){return e in t}function Qn(e,t){const n=t[e];return void 0===n?null:n}function ei(e){return{type:e}}function ti(e){if(e instanceof mt)return ti(e.boundExpression);if(e instanceof Xn&&"error"===e.name)return!1;if(e instanceof $t)return!1;if(e instanceof pn)return!1;if(e instanceof Wn)return!1;const t=e instanceof ut||e instanceof lt;let n=!0;return e.eachChild((e=>{n=t?n&&ti(e):n&&e instanceof at})),!!n&&ni(e)&&ri(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ni(e){if(e instanceof Xn){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof pn)return!1;if(e instanceof Wn)return!1;let t=!0;return e.eachChild((e=>{t&&!ni(e)&&(t=!1)})),t}function ii(e){if(e instanceof Xn&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!ii(e)&&(t=!1)})),t}function ri(e,t){if(e instanceof Xn&&t.indexOf(e.name)>=0)return!1;let n=!0;return e.eachChild((e=>{n&&!ri(e,t)&&(n=!1)})),n}function ai(e){return{result:"success",value:e}}function oi(e){return{result:"error",value:e}}function si(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function li(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ci(e){return!!e.expression&&e.expression.interpolated}function ui(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function hi(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function di(e){return e}function pi(e,t){const n="color"===t.type,i=e.stops&&"object"==typeof e.stops[0][0],r=i||!(i||void 0!==e.property),a=e.type||(ci(t)?"exponential":"interval");if(n||"padding"===t.type){const i=n?Ge.parse:Ye.parse;(e=ae({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],i(e[1])]))),e.default=i(e.default?e.default:t.default)}if(e.colorSpace&&"rgb"!==(o=e.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error(`Unknown color space: "${e.colorSpace}"`);var o;let s,l,c;if("exponential"===a)s=yi;else if("interval"===a)s=gi;else if("categorical"===a){s=mi,l=Object.create(null);for(const t of e.stops)l[t[0]]=t[1];c=typeof e.stops[0][0]}else{if("identity"!==a)throw new Error(`Unknown function type "${a}"`);s=_i}if(i){const n={},i=[];for(let t=0;t<e.stops.length;t++){const r=e.stops[t],a=r[0].zoom;void 0===n[a]&&(n[a]={zoom:a,type:e.type,property:e.property,default:e.default,stops:[]},i.push(a)),n[a].stops.push([r[0].value,r[1]])}const r=[];for(const e of i)r.push([n[e].zoom,pi(n[e],t)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:Mt.interpolationFactor.bind(void 0,a),zoomStops:r.map((e=>e[0])),evaluate:(n,i)=>{let{zoom:a}=n;return yi({stops:r,base:e.base},t,a).evaluate(a,i)}}}if(r){const n="exponential"===a?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:Mt.interpolationFactor.bind(void 0,n),zoomStops:e.stops.map((e=>e[0])),evaluate:n=>{let{zoom:i}=n;return s(e,t,i,l,c)}}}return{kind:"source",evaluate(n,i){const r=i&&i.properties?i.properties[e.property]:void 0;return void 0===r?fi(e.default,t.default):s(e,t,r,l,c)}}}function fi(e,t,n){return void 0!==e?e:void 0!==t?t:void 0!==n?n:void 0}function mi(e,t,n,i,r){return fi(typeof n===r?i[n]:void 0,e.default,t.default)}function gi(e,t,n){if("number"!==ui(n))return fi(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[i-1][0])return e.stops[i-1][1];const r=wt(e.stops.map((e=>e[0])),n);return e.stops[r][1]}function yi(e,t,n){const i=void 0!==e.base?e.base:1;if("number"!==ui(n))return fi(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[r-1][0])return e.stops[r-1][1];const a=wt(e.stops.map((e=>e[0])),n),o=function(e,t,n,i){const r=i-n,a=e-n;return 0===r?0:1===t?a/r:(Math.pow(t,a)-1)/(Math.pow(t,r)-1)}(n,i,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],l=e.stops[a+1][1],c=At[t.type]||di;return"function"==typeof s.evaluate?{evaluate(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];const r=s.evaluate.apply(void 0,n),a=l.evaluate.apply(void 0,n);if(void 0!==r&&void 0!==a)return c(r,a,o,e.colorSpace)}}:c(s,l,o,e.colorSpace)}function _i(e,t,n){switch(t.type){case"color":n=Ge.parse(n);break;case"formatted":n=Xe.fromString(n.toString());break;case"resolvedImage":n=et.fromString(n.toString());break;case"padding":n=Ye.parse(n);break;default:ui(n)===t.type||"enum"===t.type&&t.values[n]||(n=void 0)}return fi(n,e.default,t.default)}Xn.register(Kn,{error:[{kind:"error"},[ue],(e,t)=>{let[n]=t;throw new ot(n.evaluate(e))}],typeof:[ue,[fe],(e,t)=>{let[n]=t;return be(it(n.evaluate(e)))}],"to-rgba":[xe(ce,4),[de],(e,t)=>{let[n]=t;const[i,r,a,o]=n.evaluate(e).rgb;return[255*i,255*r,255*a,o]}],rgb:[de,[ce,ce,ce],Yn],rgba:[de,[ce,ce,ce,ce],Yn],has:{type:he,overloads:[[[ue],(e,t)=>{let[n]=t;return Jn(n.evaluate(e),e.properties())}],[[ue,pe],(e,t)=>{let[n,i]=t;return Jn(n.evaluate(e),i.evaluate(e))}]]},get:{type:fe,overloads:[[[ue],(e,t)=>{let[n]=t;return Qn(n.evaluate(e),e.properties())}],[[ue,pe],(e,t)=>{let[n,i]=t;return Qn(n.evaluate(e),i.evaluate(e))}]]},"feature-state":[fe,[ue],(e,t)=>{let[n]=t;return Qn(n.evaluate(e),e.featureState||{})}],properties:[pe,[],e=>e.properties()],"geometry-type":[ue,[],e=>e.geometryType()],id:[fe,[],e=>e.id()],zoom:[ce,[],e=>e.globals.zoom],"heatmap-density":[ce,[],e=>e.globals.heatmapDensity||0],"line-progress":[ce,[],e=>e.globals.lineProgress||0],accumulated:[fe,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[ce,ei(ce),(e,t)=>{let n=0;for(const i of t)n+=i.evaluate(e);return n}],"*":[ce,ei(ce),(e,t)=>{let n=1;for(const i of t)n*=i.evaluate(e);return n}],"-":{type:ce,overloads:[[[ce,ce],(e,t)=>{let[n,i]=t;return n.evaluate(e)-i.evaluate(e)}],[[ce],(e,t)=>{let[n]=t;return-n.evaluate(e)}]]},"/":[ce,[ce,ce],(e,t)=>{let[n,i]=t;return n.evaluate(e)/i.evaluate(e)}],"%":[ce,[ce,ce],(e,t)=>{let[n,i]=t;return n.evaluate(e)%i.evaluate(e)}],ln2:[ce,[],()=>Math.LN2],pi:[ce,[],()=>Math.PI],e:[ce,[],()=>Math.E],"^":[ce,[ce,ce],(e,t)=>{let[n,i]=t;return Math.pow(n.evaluate(e),i.evaluate(e))}],sqrt:[ce,[ce],(e,t)=>{let[n]=t;return Math.sqrt(n.evaluate(e))}],log10:[ce,[ce],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))/Math.LN10}],ln:[ce,[ce],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))}],log2:[ce,[ce],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))/Math.LN2}],sin:[ce,[ce],(e,t)=>{let[n]=t;return Math.sin(n.evaluate(e))}],cos:[ce,[ce],(e,t)=>{let[n]=t;return Math.cos(n.evaluate(e))}],tan:[ce,[ce],(e,t)=>{let[n]=t;return Math.tan(n.evaluate(e))}],asin:[ce,[ce],(e,t)=>{let[n]=t;return Math.asin(n.evaluate(e))}],acos:[ce,[ce],(e,t)=>{let[n]=t;return Math.acos(n.evaluate(e))}],atan:[ce,[ce],(e,t)=>{let[n]=t;return Math.atan(n.evaluate(e))}],min:[ce,ei(ce),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[ce,ei(ce),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[ce,[ce],(e,t)=>{let[n]=t;return Math.abs(n.evaluate(e))}],round:[ce,[ce],(e,t)=>{let[n]=t;const i=n.evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[ce,[ce],(e,t)=>{let[n]=t;return Math.floor(n.evaluate(e))}],ceil:[ce,[ce],(e,t)=>{let[n]=t;return Math.ceil(n.evaluate(e))}],"filter-==":[he,[ue,fe],(e,t)=>{let[n,i]=t;return e.properties()[n.value]===i.value}],"filter-id-==":[he,[fe],(e,t)=>{let[n]=t;return e.id()===n.value}],"filter-type-==":[he,[ue],(e,t)=>{let[n]=t;return e.geometryType()===n.value}],"filter-<":[he,[ue,fe],(e,t)=>{let[n,i]=t;const r=e.properties()[n.value],a=i.value;return typeof r==typeof a&&r<a}],"filter-id-<":[he,[fe],(e,t)=>{let[n]=t;const i=e.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[he,[ue,fe],(e,t)=>{let[n,i]=t;const r=e.properties()[n.value],a=i.value;return typeof r==typeof a&&r>a}],"filter-id->":[he,[fe],(e,t)=>{let[n]=t;const i=e.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[he,[ue,fe],(e,t)=>{let[n,i]=t;const r=e.properties()[n.value],a=i.value;return typeof r==typeof a&&r<=a}],"filter-id-<=":[he,[fe],(e,t)=>{let[n]=t;const i=e.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[he,[ue,fe],(e,t)=>{let[n,i]=t;const r=e.properties()[n.value],a=i.value;return typeof r==typeof a&&r>=a}],"filter-id->=":[he,[fe],(e,t)=>{let[n]=t;const i=e.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[he,[fe],(e,t)=>{let[n]=t;return n.value in e.properties()}],"filter-has-id":[he,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[he,[xe(ue)],(e,t)=>{let[n]=t;return n.value.indexOf(e.geometryType())>=0}],"filter-id-in":[he,[xe(fe)],(e,t)=>{let[n]=t;return n.value.indexOf(e.id())>=0}],"filter-in-small":[he,[ue,xe(fe)],(e,t)=>{let[n,i]=t;return i.value.indexOf(e.properties()[n.value])>=0}],"filter-in-large":[he,[ue,xe(fe)],(e,t)=>{let[n,i]=t;return function(e,t,n,i){for(;n<=i;){const r=n+i>>1;if(t[r]===e)return!0;t[r]>e?i=r-1:n=r+1}return!1}(e.properties()[n.value],i.value,0,i.value.length-1)}],all:{type:he,overloads:[[[he,he],(e,t)=>{let[n,i]=t;return n.evaluate(e)&&i.evaluate(e)}],[ei(he),(e,t)=>{for(const n of t)if(!n.evaluate(e))return!1;return!0}]]},any:{type:he,overloads:[[[he,he],(e,t)=>{let[n,i]=t;return n.evaluate(e)||i.evaluate(e)}],[ei(he),(e,t)=>{for(const n of t)if(n.evaluate(e))return!0;return!1}]]},"!":[he,[he],(e,t)=>{let[n]=t;return!n.evaluate(e)}],"is-supported-script":[he,[ue],(e,t)=>{let[n]=t;const i=e.globals&&e.globals.isSupportedScript;return!i||i(n.evaluate(e))}],upcase:[ue,[ue],(e,t)=>{let[n]=t;return n.evaluate(e).toUpperCase()}],downcase:[ue,[ue],(e,t)=>{let[n]=t;return n.evaluate(e).toLowerCase()}],concat:[ue,ei(fe),(e,t)=>t.map((t=>rt(t.evaluate(e)))).join("")],"resolved-locale":[ue,[me],(e,t)=>{let[n]=t;return n.evaluate(e).resolvedLocale()}]});class vi{constructor(e,t){var n;this.expression=e,this._warningHistory={},this._evaluator=new dt,this._defaultValue=t?"color"===(n=t).type&&hi(n.default)?new Ge(0,0,0,0):"color"===n.type?Ge.parse(n.default)||null:"padding"===n.type?Ye.parse(n.default)||null:"variableAnchorOffsetCollection"===n.type?Qe.parse(n.default)||null:void 0===n.default?null:n.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,n,i,r,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,t,n,i,r,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new ot(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function xi(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Kn}function bi(e,t){const n=new pt(Kn,ti,[],t?function(e){const t={color:de,string:ue,number:ce,enum:ue,boolean:he,formatted:ge,padding:ye,resolvedImage:_e,variableAnchorOffsetCollection:ve};return"array"===e.type?xe(t[e.value]||fe,e.length):t[e.type]}(t):void 0),i=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?ai(new vi(i,t)):oi(n.errors)}class wi{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!ii(t.expression)}evaluateWithoutErrorHandling(e,t,n,i,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,r,a)}evaluate(e,t,n,i,r,a){return this._styleExpression.evaluate(e,t,n,i,r,a)}}class Si{constructor(e,t,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent="camera"!==e&&!ii(t.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,t,n,i,r,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,r,a)}evaluate(e,t,n,i,r,a){return this._styleExpression.evaluate(e,t,n,i,r,a)}interpolationFactor(e,t,n){return this.interpolationType?Mt.interpolationFactor(this.interpolationType,e,t,n):0}}function Ti(e,t){const n=bi(e,t);if("error"===n.result)return n;const i=n.value.expression,r=ni(i);if(!r&&!si(t))return oi([new oe("","data expressions not supported")]);const a=ri(i,["zoom"]);if(!a&&!li(t))return oi([new oe("","zoom expressions not supported")]);const o=Ii(i);return o||a?o instanceof oe?oi([o]):o instanceof Mt&&!ci(t)?oi([new oe("",'"interpolate" expressions cannot be used with this property')]):ai(o?new Si(r?"camera":"composite",n.value,o.labels,o instanceof Mt?o.interpolation:void 0):new wi(r?"constant":"source",n.value)):oi([new oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ci{constructor(e,t){this._parameters=e,this._specification=t,ae(this,pi(this._parameters,this._specification))}static deserialize(e){return new Ci(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Ii(e){let t=null;if(e instanceof ft)t=Ii(e.result);else if(e instanceof Lt){for(const n of e.args)if(t=Ii(n),t)break}else(e instanceof St||e instanceof Mt)&&e.input instanceof Xn&&"zoom"===e.input.name&&(t=e);return t instanceof oe||e.eachChild((e=>{const n=Ii(e);n instanceof oe?t=n:!t&&n?t=new oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&n&&t!==n&&(t=new oe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function ki(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!ki(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const Ei={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Pi(e){if(null==e)return{filter:()=>!0,needGeometry:!1};ki(e)||(e=zi(e));const t=bi(e,Ei);if("error"===t.result)throw new Error(t.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return{filter:(e,n,i)=>t.value.evaluate(e,n,{},i),needGeometry:Mi(e)}}function Ai(e,t){return e<t?-1:e>t?1:0}function Mi(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(Mi(e[t]))return!0;return!1}function zi(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?Li(e[1],e[2],"=="):"!="===t?Fi(Li(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Li(e[1],e[2],t):"any"===t?(n=e.slice(1),["any"].concat(n.map(zi))):"all"===t?["all"].concat(e.slice(1).map(zi)):"none"===t?["all"].concat(e.slice(1).map(zi).map(Fi)):"in"===t?Di(e[1],e.slice(2)):"!in"===t?Fi(Di(e[1],e.slice(2))):"has"===t?Ri(e[1]):"!has"!==t||Fi(Ri(e[1]));var n}function Li(e,t,n){switch(e){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,e,t]}}function Di(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(Ai)]]:["filter-in-small",e,["literal",t]]}}function Ri(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Fi(e){return["!",e]}function Oi(e){const t=typeof e;if("number"===t||"boolean"===t||"string"===t||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const n of e)t+=`${Oi(n)},`;return`${t}]`}const n=Object.keys(e).sort();let i="{";for(let r=0;r<n.length;r++)i+=`${JSON.stringify(n[r])}:${Oi(e[n[r]])},`;return`${i}}`}function Bi(e){let t="";for(const n of G)t+=`/${Oi(e[n])}`;return t}function Ni(e){const t=e.value;return t?[new re(e.key,t,"constants have been deprecated as of v8")]:[]}function Vi(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ui(e){if(Array.isArray(e))return e.map(Ui);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const n in e)t[n]=Ui(e[n]);return t}return Vi(e)}function ji(e){const t=e.key,n=e.value,i=e.valueSpec||{},r=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=e.validateSpec;let l=[];const c=ui(n);if("object"!==c)return[new re(t,n,`object expected, ${c} found`)];for(const u in n){const e=u.split(".")[0],c=i[e]||i["*"];let h;if(r[e])h=r[e];else if(i[e])h=s;else if(r["*"])h=r["*"];else{if(!i["*"]){l.push(new re(t,n[u],`unknown property "${u}"`));continue}h=s}l=l.concat(h({key:(t?`${t}.`:t)+u,value:n[u],valueSpec:c,style:a,styleSpec:o,object:n,objectKey:u,validateSpec:s},n))}for(const u in i)r[u]||i[u].required&&void 0===i[u].default&&void 0===n[u]&&l.push(new re(t,n,`missing required property "${u}"`));return l}function $i(e){const t=e.value,n=e.valueSpec,i=e.style,r=e.styleSpec,a=e.key,o=e.arrayElementValidator||e.validateSpec;if("array"!==ui(t))return[new re(a,t,`array expected, ${ui(t)} found`)];if(n.length&&t.length!==n.length)return[new re(a,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new re(a,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let s={type:n.value,values:n.values};r.$version<7&&(s.function=n.function),"object"===ui(n.value)&&(s=n.value);let l=[];for(let c=0;c<t.length;c++)l=l.concat(o({array:t,arrayIndex:c,value:t[c],valueSpec:s,validateSpec:e.validateSpec,style:i,styleSpec:r,key:`${a}[${c}]`}));return l}function Hi(e){const t=e.key,n=e.value,i=e.valueSpec;let r=ui(n);return"number"===r&&n!=n&&(r="NaN"),"number"!==r?[new re(t,n,`number expected, ${r} found`)]:"minimum"in i&&n<i.minimum?[new re(t,n,`${n} is less than the minimum value ${i.minimum}`)]:"maximum"in i&&n>i.maximum?[new re(t,n,`${n} is greater than the maximum value ${i.maximum}`)]:[]}function qi(e){const t=e.valueSpec,n=Vi(e.value.type);let i,r,a,o={};const s="categorical"!==n&&void 0===e.value.property,l=!s,c="array"===ui(e.value.stops)&&"array"===ui(e.value.stops[0])&&"object"===ui(e.value.stops[0][0]),u=ji({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===n)return[new re(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const i=e.value;return t=t.concat($i({key:e.key,value:i,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===ui(i)&&0===i.length&&t.push(new re(e.key,i,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===n&&s&&u.push(new re(e.key,e.value,'missing required property "property"')),"identity"===n||e.value.stops||u.push(new re(e.key,e.value,'missing required property "stops"')),"exponential"===n&&e.valueSpec.expression&&!ci(e.valueSpec)&&u.push(new re(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!si(e.valueSpec)?u.push(new re(e.key,e.value,"property functions not supported")):s&&!li(e.valueSpec)&&u.push(new re(e.key,e.value,"zoom functions not supported"))),"categorical"!==n&&!c||void 0!==e.value.property||u.push(new re(e.key,e.value,'"property" property is required')),u;function h(e){let n=[];const i=e.value,s=e.key;if("array"!==ui(i))return[new re(s,i,`array expected, ${ui(i)} found`)];if(2!==i.length)return[new re(s,i,`array length 2 expected, length ${i.length} found`)];if(c){if("object"!==ui(i[0]))return[new re(s,i,`object expected, ${ui(i[0])} found`)];if(void 0===i[0].zoom)return[new re(s,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new re(s,i,"object stop key must have value")];if(a&&a>Vi(i[0].zoom))return[new re(s,i[0].zoom,"stop zoom values must appear in ascending order")];Vi(i[0].zoom)!==a&&(a=Vi(i[0].zoom),r=void 0,o={}),n=n.concat(ji({key:`${s}[0]`,value:i[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Hi,value:d}}))}else n=n.concat(d({key:`${s}[0]`,value:i[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},i));return xi(Ui(i[1]))?n.concat([new re(`${s}[1]`,i[1],"expressions are not allowed in function stops.")]):n.concat(e.validateSpec({key:`${s}[1]`,value:i[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function d(e,a){const s=ui(e.value),l=Vi(e.value),c=null!==e.value?e.value:a;if(i){if(s!==i)return[new re(e.key,c,`${s} stop domain type must match previous stop domain type ${i}`)]}else i=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new re(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==n){let i=`number expected, ${s} found`;return si(t)&&void 0===n&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new re(e.key,c,i)]}return"categorical"!==n||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===s&&void 0!==r&&l<r?[new re(e.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===n&&l in o?[new re(e.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new re(e.key,c,`integer expected, found ${l}`)]}}function Zi(e){const t=("property"===e.expressionContext?Ti:bi)(Ui(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new re(`${e.key}${t.key}`,e.value,t.message)));const n=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!n.outputDefined())return[new re(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!ii(n))return[new re(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!ii(n))return[new re(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!ri(n,["zoom","feature-state"]))return[new re(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!ni(n))return[new re(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Gi(e){const t=e.key,n=e.value,i=e.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(Vi(n))&&r.push(new re(t,n,`expected one of [${i.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(i.values).indexOf(Vi(n))&&r.push(new re(t,n,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(n)} found`)),r}function Wi(e){return ki(Ui(e.value))?Zi(ae({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ki(e)}function Ki(e){const t=e.value,n=e.key;if("array"!==ui(t))return[new re(n,t,`array expected, ${ui(t)} found`)];const i=e.styleSpec;let r,a=[];if(t.length<1)return[new re(n,t,"filter array must have at least 1 element")];switch(a=a.concat(Gi({key:`${n}[0]`,value:t[0],valueSpec:i.filter_operator,style:e.style,styleSpec:e.styleSpec})),Vi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===Vi(t[1])&&a.push(new re(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&a.push(new re(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(r=ui(t[1]),"string"!==r&&a.push(new re(`${n}[1]`,t[1],`string expected, ${r} found`)));for(let o=2;o<t.length;o++)r=ui(t[o]),"$type"===Vi(t[1])?a=a.concat(Gi({key:`${n}[${o}]`,value:t[o],valueSpec:i.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new re(`${n}[${o}]`,t[o],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let i=1;i<t.length;i++)a=a.concat(Ki({key:`${n}[${i}]`,value:t[i],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=ui(t[1]),2!==t.length?a.push(new re(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==r&&a.push(new re(`${n}[1]`,t[1],`string expected, ${r} found`))}return a}function Xi(e,t){const n=e.key,i=e.validateSpec,r=e.style,a=e.styleSpec,o=e.value,s=e.objectKey,l=a[`${t}_${e.layerType}`];if(!l)return[];const c=s.match(/^(.*)-transition$/);if("paint"===t&&c&&l[c[1]]&&l[c[1]].transition)return i({key:n,value:o,valueSpec:a.transition,style:r,styleSpec:a});const u=e.valueSpec||l[s];if(!u)return[new re(n,o,`unknown property "${s}"`)];let h;if("string"===ui(o)&&si(u)&&!u.tokens&&(h=/^{([^}]+)}$/.exec(o)))return[new re(n,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const d=[];return"symbol"===e.layerType&&("text-field"===s&&r&&!r.glyphs&&d.push(new re(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&hi(Ui(o))&&"identity"===Vi(o.type)&&d.push(new re(n,o,'"text-font" does not support identity functions'))),d.concat(i({key:e.key,value:o,valueSpec:u,style:r,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:s}))}function Yi(e){return Xi(e,"paint")}function Ji(e){return Xi(e,"layout")}function Qi(e){let t=[];const n=e.value,i=e.key,r=e.style,a=e.styleSpec;n.type||n.ref||t.push(new re(i,n,'either "type" or "ref" is required'));let o=Vi(n.type);const s=Vi(n.ref);if(n.id){const a=Vi(n.id);for(let o=0;o<e.arrayIndex;o++){const e=r.layers[o];Vi(e.id)===a&&t.push(new re(i,n.id,`duplicate layer id "${n.id}", previously used at line ${e.id.__line__}`))}}if("ref"in n){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in n&&t.push(new re(i,n[e],`"${e}" is prohibited for ref layers`))})),r.layers.forEach((t=>{Vi(t.id)===s&&(e=t)})),e?e.ref?t.push(new re(i,n.ref,"ref cannot reference another ref layer")):o=Vi(e.type):t.push(new re(i,n.ref,`ref layer "${s}" not found`))}else if("background"!==o)if(n.source){const e=r.sources&&r.sources[n.source],a=e&&Vi(e.type);e?"vector"===a&&"raster"===o?t.push(new re(i,n.source,`layer "${n.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===o?t.push(new re(i,n.source,`layer "${n.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==o?t.push(new re(i,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==a||n["source-layer"]?"raster-dem"===a&&"hillshade"!==o?t.push(new re(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!n.paint||!n.paint["line-gradient"]||"geojson"===a&&e.lineMetrics||t.push(new re(i,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new re(i,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new re(i,n.source,`source "${n.source}" not found`))}else t.push(new re(i,n,'missing required property "source"'));return t=t.concat(ji({key:i,value:n,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${i}.type`,value:n.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:n,objectKey:"type"}),filter:Wi,layout:e=>ji({layer:n,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Ji(ae({layerType:o},e))}}),paint:e=>ji({layer:n,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Yi(ae({layerType:o},e))}})}})),t}function er(e){const t=e.value,n=e.key,i=ui(t);return"string"!==i?[new re(n,t,`string expected, ${i} found`)]:[]}const tr={promoteId:function(e){let{key:t,value:n}=e;if("string"===ui(n))return er({key:t,value:n});{const e=[];for(const i in n)e.push(...er({key:`${t}.${i}`,value:n[i]}));return e}}};function nr(e){const t=e.value,n=e.key,i=e.styleSpec,r=e.style,a=e.validateSpec;if(!t.type)return[new re(n,t,'"type" is required')];const o=Vi(t.type);let s;switch(o){case"vector":case"raster":return s=ji({key:n,value:t,valueSpec:i[`source_${o.replace("-","_")}`],style:e.style,styleSpec:i,objectElementValidators:tr,validateSpec:a}),s;case"raster-dem":return s=function(e){var t;const n=null!==(t=e.sourceName)&&void 0!==t?t:"",i=e.value,r=e.styleSpec,a=r.source_raster_dem,o=e.style;let s=[];const l=ui(i);if(void 0===i)return s;if("object"!==l)return s.push(new re("source_raster_dem",i,`object expected, ${l} found`)),s;const c="custom"===Vi(i.encoding),u=["redFactor","greenFactor","blueFactor","baseShift"],h=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const d in i)!c&&u.includes(d)?s.push(new re(d,i[d],`In "${n}": "${d}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):a[d]?s=s.concat(e.validateSpec({key:d,value:i[d],valueSpec:a[d],validateSpec:e.validateSpec,style:o,styleSpec:r})):s.push(new re(d,i[d],`unknown property "${d}"`));return s}({sourceName:n,value:t,style:e.style,styleSpec:i,validateSpec:a}),s;case"geojson":if(s=ji({key:n,value:t,valueSpec:i.source_geojson,style:r,styleSpec:i,validateSpec:a,objectElementValidators:tr}),t.cluster)for(const e in t.clusterProperties){const[i,r]=t.clusterProperties[e],o="string"==typeof i?[i,["accumulated"],["get",e]]:i;s.push(...Zi({key:`${n}.${e}.map`,value:r,validateSpec:a,expressionContext:"cluster-map"})),s.push(...Zi({key:`${n}.${e}.reduce`,value:o,validateSpec:a,expressionContext:"cluster-reduce"}))}return s;case"video":return ji({key:n,value:t,valueSpec:i.source_video,style:r,validateSpec:a,styleSpec:i});case"image":return ji({key:n,value:t,valueSpec:i.source_image,style:r,validateSpec:a,styleSpec:i});case"canvas":return[new re(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Gi({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,validateSpec:a,styleSpec:i})}}function ir(e){const t=e.value,n=e.styleSpec,i=n.light,r=e.style;let a=[];const o=ui(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new re("light",t,`object expected, ${o} found`)]),a;for(const s in t){const o=s.match(/^(.*)-transition$/);a=a.concat(o&&i[o[1]]&&i[o[1]].transition?e.validateSpec({key:s,value:t[s],valueSpec:n.transition,validateSpec:e.validateSpec,style:r,styleSpec:n}):i[s]?e.validateSpec({key:s,value:t[s],valueSpec:i[s],validateSpec:e.validateSpec,style:r,styleSpec:n}):[new re(s,t[s],`unknown property "${s}"`)])}return a}function rr(e){const t=e.value,n=e.styleSpec,i=n.sky,r=e.style,a=ui(t);if(void 0===t)return[];if("object"!==a)return[new re("sky",t,`object expected, ${a} found`)];let o=[];for(const s in t)o=o.concat(i[s]?e.validateSpec({key:s,value:t[s],valueSpec:i[s],style:r,styleSpec:n}):[new re(s,t[s],`unknown property "${s}"`)]);return o}function ar(e){const t=e.value,n=e.styleSpec,i=n.terrain,r=e.style;let a=[];const o=ui(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new re("terrain",t,`object expected, ${o} found`)]),a;for(const s in t)a=a.concat(i[s]?e.validateSpec({key:s,value:t[s],valueSpec:i[s],validateSpec:e.validateSpec,style:r,styleSpec:n}):[new re(s,t[s],`unknown property "${s}"`)]);return a}function or(e){let t=[];const n=e.value,i=e.key;if(Array.isArray(n)){const r=[],a=[];for(const o in n)n[o].id&&r.includes(n[o].id)&&t.push(new re(i,n,`all the sprites' ids must be unique, but ${n[o].id} is duplicated`)),r.push(n[o].id),n[o].url&&a.includes(n[o].url)&&t.push(new re(i,n,`all the sprites' URLs must be unique, but ${n[o].url} is duplicated`)),a.push(n[o].url),t=t.concat(ji({key:`${i}[${o}]`,value:n[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return er({key:i,value:n})}const sr={"*":()=>[],array:$i,boolean:function(e){const t=e.value,n=e.key,i=ui(t);return"boolean"!==i?[new re(n,t,`boolean expected, ${i} found`)]:[]},number:Hi,color:function(e){const t=e.key,n=e.value,i=ui(n);return"string"!==i?[new re(t,n,`color expected, ${i} found`)]:Ge.parse(String(n))?[]:[new re(t,n,`color expected, "${n}" found`)]},constants:Ni,enum:Gi,filter:Wi,function:qi,layer:Qi,object:ji,source:nr,light:ir,sky:rr,terrain:ar,projection:function(e){const t=e.value,n=e.styleSpec,i=n.projection,r=e.style,a=ui(t);if(void 0===t)return[];if("object"!==a)return[new re("projection",t,`object expected, ${a} found`)];let o=[];for(const s in t)o=o.concat(i[s]?e.validateSpec({key:s,value:t[s],valueSpec:i[s],style:r,styleSpec:n}):[new re(s,t[s],`unknown property "${s}"`)]);return o},string:er,formatted:function(e){return 0===er(e).length?[]:Zi(e)},resolvedImage:function(e){return 0===er(e).length?[]:Zi(e)},padding:function(e){const t=e.key,n=e.value;if("array"===ui(n)){if(n.length<1||n.length>4)return[new re(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const i={type:"number"};let r=[];for(let a=0;a<n.length;a++)r=r.concat(e.validateSpec({key:`${t}[${a}]`,value:n[a],validateSpec:e.validateSpec,valueSpec:i}));return r}return Hi({key:t,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(e){const t=e.key,n=e.value,i=ui(n),r=e.styleSpec;if("array"!==i||n.length<1||n.length%2!=0)return[new re(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<n.length;o+=2)a=a.concat(Gi({key:`${t}[${o}]`,value:n[o],valueSpec:r.layout_symbol["text-anchor"]})),a=a.concat($i({key:`${t}[${o+1}]`,value:n[o+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:r}));return a},sprite:or};function lr(e){const t=e.value,n=e.valueSpec,i=e.styleSpec;return e.validateSpec=lr,n.expression&&hi(Vi(t))?qi(e):n.expression&&xi(Ui(t))?Zi(e):n.type&&sr[n.type]?sr[n.type](e):ji(ae({},e,{valueSpec:n.type?i[n.type]:n}))}function cr(e){const t=e.value,n=e.key,i=er(e);return i.length||(-1===t.indexOf("{fontstack}")&&i.push(new re(n,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&i.push(new re(n,t,'"glyphs" url must include a "{range}" token'))),i}function ur(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z,n=[];return n=n.concat(lr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:lr,objectElementValidators:{glyphs:cr,"*":()=>[]}})),e.constants&&(n=n.concat(Ni({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:lr}))),dr(n)}function hr(e){return function(t){return e({...t,validateSpec:lr})}}function dr(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function pr(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return dr(e.apply(this,n))}}ur.source=pr(hr(nr)),ur.sprite=pr(hr(or)),ur.glyphs=pr(hr(cr)),ur.light=pr(hr(ir)),ur.sky=pr(hr(rr)),ur.terrain=pr(hr(ar)),ur.layer=pr(hr(Qi)),ur.filter=pr(hr(Wi)),ur.paintProperty=pr(hr(Yi)),ur.layoutProperty=pr(hr(Ji));const fr=ur,mr=fr.light,gr=fr.paintProperty,yr=fr.layoutProperty;function _r(e,t){let n=!1;if(t&&t.length)for(const i of t)e.fire(new H(new Error(i.message))),n=!0;return n}class vr{constructor(e,t,n){const i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const r=new Int32Array(this.arrayBuffer);e=r[0],this.d=(t=r[1])+2*(n=r[2]);for(let e=0;e<this.d*this.d;e++){const t=r[3+e],n=r[3+e+1];i.push(t===n?null:r.subarray(t,n))}const a=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],a),this.bboxes=r.subarray(a),this.insert=this._insertReadonly}else{this.d=t+2*n;for(let e=0;e<this.d*this.d;e++)i.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=n,this.scale=t/e,this.uid=0;const r=n/t*e;this.min=-r,this.max=e+r}insert(e,t,n,i,r){this._forEachCell(t,n,i,r,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,n,i,r,a){this.cells[r].push(a)}query(e,t,n,i,r){const a=this.min,o=this.max;if(e<=a&&t<=a&&o<=n&&o<=i&&!r)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(e,t,n,i,this._queryCell,a,{},r),a}}_queryCell(e,t,n,i,r,a,o,s){const l=this.cells[r];if(null!==l){const r=this.keys,c=this.bboxes;for(let u=0;u<l.length;u++){const h=l[u];if(void 0===o[h]){const l=4*h;(s?s(c[l+0],c[l+1],c[l+2],c[l+3]):e<=c[l+2]&&t<=c[l+3]&&n>=c[l+0]&&i>=c[l+1])?(o[h]=!0,a.push(r[h])):o[h]=!1}}}}_forEachCell(e,t,n,i,r,a,o,s){const l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(n),h=this._convertToCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++){const c=this.d*l+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&r.call(this,e,t,n,i,c,a,o,s))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,t=3+this.cells.length+1+1;let n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;const i=new Int32Array(t+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let r=t;for(let a=0;a<e.length;a++){const t=e[a];i[3+a]=r,i.set(t,r),r+=t.length}return i[3+e.length]=r,i.set(this.keys,r),r+=this.keys.length,i[3+e.length+1]=r,i.set(this.bboxes,r),r+=this.bboxes.length,i.buffer}static serialize(e,t){const n=e.toArrayBuffer();return t&&t.push(n),{buffer:n}}static deserialize(e){return new vr(e.buffer)}}const xr={};function br(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(xr[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),xr[e]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}br("Object",Object),br("TransferableGridIndex",vr),br("Color",Ge),br("Error",Error),br("AJAXError",O),br("ResolvedImage",et),br("StylePropertyFunction",Ci),br("StyleExpression",vi,{omit:["_evaluator"]}),br("ZoomDependentExpression",Si),br("ZoomConstantExpression",wi),br("CompoundExpression",Xn,{omit:["_evaluate"]});for(const Fh in Kn)Kn[Fh]._classRegistryKey||br(`Expression_${Fh}`,Kn[Fh]);function wr(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Sr(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error)return e;if(wr(e))return t&&t.push(e),e;if(k(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){const n=e;return t&&t.push(n.buffer),n}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const n=[];for(const i of e)n.push(Sr(i,t));return n}if("object"==typeof e){const n=e.constructor,i=n._classRegistryKey;if(!i)throw new Error(`can't serialize object of unregistered class ${n.name}`);if(!xr[i])throw new Error(`${i} is not registered.`);const r=n.serialize?n.serialize(e,t):{};if(n.serialize){if(t&&r===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const n in e){if(!e.hasOwnProperty(n))continue;if(xr[i].omit.indexOf(n)>=0)continue;const a=e[n];r[n]=xr[i].shallow.indexOf(n)>=0?a:Sr(a,t)}e instanceof Error&&(r.message=e.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(r.$name=i),r}throw new Error("can't serialize object of type "+typeof e)}function Tr(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||wr(e)||k(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(Tr);if("object"==typeof e){const t=e.$name||"Object";if(!xr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=xr[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(e);const i=Object.create(n.prototype);for(const r of Object.keys(e)){if("$name"===r)continue;const n=e[r];i[r]=xr[t].shallow.indexOf(r)>=0?n:Tr(n)}return i}throw new Error("can't deserialize object of type "+typeof e)}class Cr{constructor(){this.first=!0}update(e,t){const n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=n,!0))}}const Ir={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function kr(e){for(const t of e)if(Ar(t.charCodeAt(0)))return!0;return!1}function Er(e){for(const t of e)if(!Pr(t.charCodeAt(0)))return!1;return!0}function Pr(e){return!(Ir.Arabic(e)||Ir["Arabic Supplement"](e)||Ir["Arabic Extended-A"](e)||Ir["Arabic Presentation Forms-A"](e)||Ir["Arabic Presentation Forms-B"](e))}function Ar(e){return!(746!==e&&747!==e&&(e<4352||!(Ir["Bopomofo Extended"](e)||Ir.Bopomofo(e)||Ir["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Ir["CJK Compatibility Ideographs"](e)||Ir["CJK Compatibility"](e)||Ir["CJK Radicals Supplement"](e)||Ir["CJK Strokes"](e)||!(!Ir["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||Ir["CJK Unified Ideographs Extension A"](e)||Ir["CJK Unified Ideographs"](e)||Ir["Enclosed CJK Letters and Months"](e)||Ir["Hangul Compatibility Jamo"](e)||Ir["Hangul Jamo Extended-A"](e)||Ir["Hangul Jamo Extended-B"](e)||Ir["Hangul Jamo"](e)||Ir["Hangul Syllables"](e)||Ir.Hiragana(e)||Ir["Ideographic Description Characters"](e)||Ir.Kanbun(e)||Ir["Kangxi Radicals"](e)||Ir["Katakana Phonetic Extensions"](e)||Ir.Katakana(e)&&12540!==e||!(!Ir["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!Ir["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Ir["Unified Canadian Aboriginal Syllabics"](e)||Ir["Unified Canadian Aboriginal Syllabics Extended"](e)||Ir["Vertical Forms"](e)||Ir["Yijing Hexagram Symbols"](e)||Ir["Yi Syllables"](e)||Ir["Yi Radicals"](e))))}function Mr(e){return!(Ar(e)||function(e){return!!(Ir["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Ir["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Ir["Letterlike Symbols"](e)||Ir["Number Forms"](e)||Ir["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ir["Control Pictures"](e)&&9251!==e||Ir["Optical Character Recognition"](e)||Ir["Enclosed Alphanumerics"](e)||Ir["Geometric Shapes"](e)||Ir["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ir["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ir["CJK Symbols and Punctuation"](e)||Ir.Katakana(e)||Ir["Private Use Area"](e)||Ir["CJK Compatibility Forms"](e)||Ir["Small Form Variants"](e)||Ir["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function zr(e){return e>=1424&&e<=2303||Ir["Arabic Presentation Forms-A"](e)||Ir["Arabic Presentation Forms-B"](e)}function Lr(e,t){return!(!t&&zr(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Ir.Khmer(e))}function Dr(e){for(const t of e)if(zr(t.charCodeAt(0)))return!0;return!1}const Rr=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Fr{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Cr,this.transition={})}isSupportedScript(e){return function(e,t){for(const n of e)if(!Lr(n.charCodeAt(0),t))return!1;return!0}(e,"loaded"===Rr.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,t=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*t}}}class Or{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(hi(e))return new Ci(e,t);if(xi(e)){const n=Ti(e,t);if("error"===n.result)throw new Error(n.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return n.value}{let n=e;return"color"===t.type&&"string"==typeof e?n=Ge.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)&&(n=Qe.parse(e)):n=Ye.parse(e),{kind:"constant",evaluate:()=>n}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,n){return this.property.possiblyEvaluate(this,e,t,n)}}class Br{constructor(e){this.property=e,this.value=new Or(e,void 0)}transitioned(e,t){return new Vr(this.property,this.value,t,y({},e.transition,this.transition),e.now)}untransitioned(){return new Vr(this.property,this.value,null,{},0)}}class Nr{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return b(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Br(this._values[e].property)),this._values[e].value=new Or(this._values[e].property,null===t?void 0:b(t))}getTransition(e){return b(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Br(this._values[e].property)),this._values[e].transition=b(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n);const i=this.getTransition(t);void 0!==i&&(e[`${t}-transition`]=i)}return e}transitioned(e,t){const n=new Ur(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(e,t._values[i]);return n}untransitioned(){const e=new Ur(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Vr{constructor(e,t,n,i,r){this.property=e,this.value=t,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,e.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(e,t,n){const i=e.now||0,r=this.value.possiblyEvaluate(e,t,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return a.possiblyEvaluate(e,t,n);{const o=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,n),r,function(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}(o))}}return r}}class Ur{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,n){const i=new Hr(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(e,t,n);return i}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class jr{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return void 0!==this._values[e].value}getValue(e){return b(this._values[e].value)}setValue(e,t){this._values[e]=new Or(this._values[e].property,null===t?void 0:b(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n)}return e}possiblyEvaluate(e,t,n){const i=new Hr(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(e,t,n);return i}}class $r{constructor(e,t,n){this.property=e,this.value=t,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,n,i){return this.property.evaluate(this.value,this.parameters,e,t,n,i)}}class Hr{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class qr{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,n){const i=At[this.specification.type];return i?i(e,t,n):e}}class Zr{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,n,i){return new $r(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},n,i)}:e.expression,t)}interpolate(e,t,n){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new $r(this,{kind:"constant",value:void 0},e.parameters);const i=At[this.specification.type];if(i){const r=i(e.value.value,t.value.value,n);return new $r(this,{kind:"constant",value:r},e.parameters)}return e}evaluate(e,t,n,i,r,a){return"constant"===e.kind?e.value:e.evaluate(t,n,i,r,a)}}class Gr extends Zr{possiblyEvaluate(e,t,n,i){if(void 0===e.value)return new $r(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){const r=e.expression.evaluate(t,null,{},n,i),a="resolvedImage"===e.property.specification.type&&"string"!=typeof r?r.name:r,o=this._calculate(a,a,a,t);return new $r(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){const n=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new $r(this,{kind:"constant",value:n},t)}return new $r(this,e.expression,t)}evaluate(e,t,n,i,r,a){if("source"===e.kind){const o=e.evaluate(t,n,i,r,a);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},n,i),e.evaluate({zoom:Math.floor(t.zoom)},n,i),e.evaluate({zoom:Math.floor(t.zoom)+1},n,i),t):e.value}_calculate(e,t,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}}interpolate(e){return e}}class Wr{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,i){if(void 0!==e.value){if("constant"===e.expression.kind){const r=e.expression.evaluate(t,null,{},n,i);return this._calculate(r,r,r,t)}return this._calculate(e.expression.evaluate(new Fr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Fr(Math.floor(t.zoom),t)),e.expression.evaluate(new Fr(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}}interpolate(e){return e}}class Kr{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,i){return!!e.expression.evaluate(t,null,{},n,i)}interpolate(){return!1}}class Xr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const t in e){const n=e[t];n.specification.overridable&&this.overridableProperties.push(t);const i=this.defaultPropertyValues[t]=new Or(n,void 0),r=this.defaultTransitionablePropertyValues[t]=new Br(n);this.defaultTransitioningPropertyValues[t]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=i.possiblyEvaluate({})}}}br("DataDrivenProperty",Zr),br("DataConstantProperty",qr),br("CrossFadedDataDrivenProperty",Gr),br("CrossFadedProperty",Wr),br("ColorRampProperty",Kr);const Yr="-transition";class Jr extends q{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new jr(t.layout)),t.paint)){this._transitionablePaint=new Nr(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Hr(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&this._validate(yr,`layers.${this.id}.layout.${e}`,e,t,n)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return e.endsWith(Yr)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t&&this._validate(gr,`layers.${this.id}.paint.${e}`,e,t,n))return!1;if(e.endsWith(Yr))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const n=this._transitionablePaint._values[e],i="cross-faded-data-driven"===n.property.specification["property-type"],r=n.value.isDataDriven(),a=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value;return o.isDataDriven()||r||i||this._handleOverridablePaintPropertyUpdate(e,a,o)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,n){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),x(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!r||!1!==r.validate)&&_r(this,e.call(fr,{key:t,layerType:this.type,objectKey:n,value:i,styleSpec:Z,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof $r&&si(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}const Qr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ea{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ta{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function na(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,i=0;return{members:e.map((e=>{const r=Qr[e.type].BYTES_PER_ELEMENT,a=n=ia(n,Math.max(t,r)),o=e.components||1;return i=Math.max(i,r),n+=r*o,{name:e.name,type:e.type,components:o,offset:a}})),size:ia(n,Math.max(i,t)),alignment:t}}function ia(e,t){return Math.ceil(e/t)*t}class ra extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const i=2*e;return this.int16[i+0]=t,this.int16[i+1]=n,e}}ra.prototype.bytesPerElement=4,br("StructArrayLayout2i4",ra);class aa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=3*e;return this.int16[r+0]=t,this.int16[r+1]=n,this.int16[r+2]=i,e}}aa.prototype.bytesPerElement=6,br("StructArrayLayout3i6",aa);class oa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}emplace(e,t,n,i,r){const a=4*e;return this.int16[a+0]=t,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=r,e}}oa.prototype.bytesPerElement=8,br("StructArrayLayout4i8",oa);class sa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r,a)}emplace(e,t,n,i,r,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=a,this.int16[s+5]=o,e}}sa.prototype.bytesPerElement=12,br("StructArrayLayout2i4i12",sa);class la extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r,a)}emplace(e,t,n,i,r,a,o){const s=4*e,l=8*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.uint8[l+4]=i,this.uint8[l+5]=r,this.uint8[l+6]=a,this.uint8[l+7]=o,e}}la.prototype.bytesPerElement=8,br("StructArrayLayout2i4ub8",la);class ca extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const i=2*e;return this.float32[i+0]=t,this.float32[i+1]=n,e}}ca.prototype.bytesPerElement=8,br("StructArrayLayout2f8",ca);class ua extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a,o,s,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,e,t,n,i,r,a,o,s,l,c)}emplace(e,t,n,i,r,a,o,s,l,c,u){const h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=n,this.uint16[h+2]=i,this.uint16[h+3]=r,this.uint16[h+4]=a,this.uint16[h+5]=o,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,e}}ua.prototype.bytesPerElement=20,br("StructArrayLayout10ui20",ua);class ha extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a,o,s,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,n,i,r,a,o,s,l,c,u,h)}emplace(e,t,n,i,r,a,o,s,l,c,u,h,d){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=r,this.uint16[p+4]=a,this.uint16[p+5]=o,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,e}}ha.prototype.bytesPerElement=24,br("StructArrayLayout4i4ui4i24",ha);class da extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=3*e;return this.float32[r+0]=t,this.float32[r+1]=n,this.float32[r+2]=i,e}}da.prototype.bytesPerElement=12,br("StructArrayLayout3f12",da);class pa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}pa.prototype.bytesPerElement=4,br("StructArrayLayout1ul4",pa);class fa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a,o,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,n,i,r,a,o,s,l)}emplace(e,t,n,i,r,a,o,s,l,c){const u=10*e,h=5*e;return this.int16[u+0]=t,this.int16[u+1]=n,this.int16[u+2]=i,this.int16[u+3]=r,this.int16[u+4]=a,this.int16[u+5]=o,this.uint32[h+3]=s,this.uint16[u+8]=l,this.uint16[u+9]=c,e}}fa.prototype.bytesPerElement=20,br("StructArrayLayout6i1ul2ui20",fa);class ma extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r,a)}emplace(e,t,n,i,r,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=a,this.int16[s+5]=o,e}}ma.prototype.bytesPerElement=12,br("StructArrayLayout2i2i2i12",ma);class ga extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,i,r)}emplace(e,t,n,i,r,a){const o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=i,this.int16[s+6]=r,this.int16[s+7]=a,e}}ga.prototype.bytesPerElement=16,br("StructArrayLayout2f1f2i16",ga);class ya extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r,a)}emplace(e,t,n,i,r,a,o){const s=16*e,l=4*e,c=8*e;return this.uint8[s+0]=t,this.uint8[s+1]=n,this.float32[l+1]=i,this.float32[l+2]=r,this.int16[c+6]=a,this.int16[c+7]=o,e}}ya.prototype.bytesPerElement=16,br("StructArrayLayout2ub2f2i16",ya);class _a extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=3*e;return this.uint16[r+0]=t,this.uint16[r+1]=n,this.uint16[r+2]=i,e}}_a.prototype.bytesPerElement=6,br("StructArrayLayout3ui6",_a);class va extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g)}emplace(e,t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g,y){const _=24*e,v=12*e,x=48*e;return this.int16[_+0]=t,this.int16[_+1]=n,this.uint16[_+2]=i,this.uint16[_+3]=r,this.uint32[v+2]=a,this.uint32[v+3]=o,this.uint32[v+4]=s,this.uint16[_+10]=l,this.uint16[_+11]=c,this.uint16[_+12]=u,this.float32[v+7]=h,this.float32[v+8]=d,this.uint8[x+36]=p,this.uint8[x+37]=f,this.uint8[x+38]=m,this.uint32[v+10]=g,this.int16[_+22]=y,e}}va.prototype.bytesPerElement=48,br("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",va);class xa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,C,I,k){const E=this.length;return this.resize(E+1),this.emplace(E,e,t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,C,I,k)}emplace(e,t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,S,T,C,I,k,E){const P=32*e,A=16*e;return this.int16[P+0]=t,this.int16[P+1]=n,this.int16[P+2]=i,this.int16[P+3]=r,this.int16[P+4]=a,this.int16[P+5]=o,this.int16[P+6]=s,this.int16[P+7]=l,this.uint16[P+8]=c,this.uint16[P+9]=u,this.uint16[P+10]=h,this.uint16[P+11]=d,this.uint16[P+12]=p,this.uint16[P+13]=f,this.uint16[P+14]=m,this.uint16[P+15]=g,this.uint16[P+16]=y,this.uint16[P+17]=_,this.uint16[P+18]=v,this.uint16[P+19]=x,this.uint16[P+20]=b,this.uint16[P+21]=w,this.uint16[P+22]=S,this.uint32[A+12]=T,this.float32[A+13]=C,this.float32[A+14]=I,this.uint16[P+30]=k,this.uint16[P+31]=E,e}}xa.prototype.bytesPerElement=64,br("StructArrayLayout8i15ui1ul2f2ui64",xa);class ba extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}ba.prototype.bytesPerElement=4,br("StructArrayLayout1f4",ba);class wa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=3*e;return this.uint16[6*e+0]=t,this.float32[r+1]=n,this.float32[r+2]=i,e}}wa.prototype.bytesPerElement=12,br("StructArrayLayout1ui2f12",wa);class Sa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=4*e;return this.uint32[2*e+0]=t,this.uint16[r+2]=n,this.uint16[r+3]=i,e}}Sa.prototype.bytesPerElement=8,br("StructArrayLayout1ul2ui8",Sa);class Ta extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const i=2*e;return this.uint16[i+0]=t,this.uint16[i+1]=n,e}}Ta.prototype.bytesPerElement=4,br("StructArrayLayout2ui4",Ta);class Ca extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}Ca.prototype.bytesPerElement=2,br("StructArrayLayout1ui2",Ca);class Ia extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}emplace(e,t,n,i,r){const a=4*e;return this.float32[a+0]=t,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=r,e}}Ia.prototype.bytesPerElement=16,br("StructArrayLayout4f16",Ia);class ka extends ea{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new a(this.anchorPointX,this.anchorPointY)}}ka.prototype.size=20;class Ea extends fa{get(e){return new ka(this,e)}}br("CollisionBoxArray",Ea);class Pa extends ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Pa.prototype.size=48;class Aa extends va{get(e){return new Pa(this,e)}}br("PlacedSymbolArray",Aa);class Ma extends ea{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ma.prototype.size=64;class za extends xa{get(e){return new Ma(this,e)}}br("SymbolInstanceArray",za);class La extends ba{getoffsetX(e){return this.float32[1*e+0]}}br("GlyphOffsetArray",La);class Da extends aa{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}br("SymbolLineVertexArray",Da);class Ra extends ea{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ra.prototype.size=12;class Fa extends wa{get(e){return new Ra(this,e)}}br("TextAnchorOffsetArray",Fa);class Oa extends ea{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Oa.prototype.size=8;class Ba extends Sa{get(e){return new Oa(this,e)}}br("FeatureIndexArray",Ba);class Na extends ra{}class Va extends ra{}class Ua extends ra{}class ja extends sa{}class $a extends la{}class Ha extends ca{}class qa extends ua{}class Za extends ha{}class Ga extends da{}class Wa extends pa{}class Ka extends ma{}class Xa extends ya{}class Ya extends _a{}class Ja extends Ta{}const Qa=na([{name:"a_pos",components:2,type:"Int16"}],4),{members:eo}=Qa;class to{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=e}prepareSegment(e,t,n,i){let r=this.segments[this.segments.length-1];return e>to.MAX_VERTEX_ARRAY_LENGTH&&S(`Max vertices per segment is ${to.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!r||r.vertexLength+e>to.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i)&&(r={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(r.sortKey=i),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,n,i){return new to([{vertexOffset:e,primitiveOffset:t,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}function no(e,t){return 256*(e=m(Math.floor(e),0,255))+m(Math.floor(t),0,255)}to.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,br("SegmentVector",to);const io=na([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ro={exports:{}},ao={exports:{}};ao.exports=function(e,t){var n,i,r,a,o,s,l,c;for(i=e.length-(n=3&e.length),r=t,o=3432918353,s=461845907,c=0;c<i;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,r=27492+(65535&(a=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};var oo=ao.exports,so={exports:{}};so.exports=function(e,t){for(var n,i=e.length,r=t^i,a=0;i>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++a;switch(i){case 3:r^=(255&e.charCodeAt(a+2))<<16;case 2:r^=(255&e.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};var lo=oo,co=so.exports;ro.exports=lo,ro.exports.murmur3=lo,ro.exports.murmur2=co;var uo=n(ro.exports);class ho{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,n,i){this.ids.push(po(e)),this.positions.push(t,n,i)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const t=po(e);let n=0,i=this.ids.length-1;for(;n<i;){const e=n+i>>1;this.ids[e]>=t?i=e:n=e+1}const r=[];for(;this.ids[n]===t;)r.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return r}static serialize(e,t){const n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return fo(n,i,0,n.length-1),t&&t.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(e){const t=new ho;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function po(e){const t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:uo(String(e))}function fo(e,t,n,i){for(;n<i;){const r=e[n+i>>1];let a=n-1,o=i+1;for(;;){do{a++}while(e[a]<r);do{o--}while(e[o]>r);if(a>=o)break;mo(e,a,o),mo(t,3*a,3*o),mo(t,3*a+1,3*o+1),mo(t,3*a+2,3*o+2)}o-n<i-o?(fo(e,t,n,o),n=o+1):(fo(e,t,o+1,i),i=o)}}function mo(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}br("FeaturePositionMap",ho);class go{constructor(e,t){this.gl=e.gl,this.location=t}}class yo extends go{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class _o extends go{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class vo extends go{constructor(e,t){super(e,t),this.current=Ge.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const xo=new Float32Array(16);function bo(e){return[no(255*e.r,255*e.g),no(255*e.b,255*e.a)]}class wo{constructor(e,t,n){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=n}setUniform(e,t,n){e.set(n.constantOr(this.value))}getBinding(e,t,n){return"color"===this.type?new vo(e,t):new yo(e,t)}}class So{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,n,i){const r="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;r&&e.set(r)}getBinding(e,t,n){return"u_pattern"===n.substr(0,9)?new _o(e,t):new yo(e,t)}}class To{constructor(e,t,n,i){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new i}populatePaintArray(e,t,n,i,r){const a=this.paintVertexArray.length,o=this.expression.evaluate(new Fr(0),t,{},i,[],r);this.paintVertexArray.resize(e),this._setPaintValue(a,e,o)}updatePaintArray(e,t,n,i){const r=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(e,t,r)}_setPaintValue(e,t,n){if("color"===this.type){const i=bo(n);for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i[0],i[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Co{constructor(e,t,n,i,r,a){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(e,t,n,i,r){const a=this.expression.evaluate(new Fr(this.zoom),t,{},i,[],r),o=this.expression.evaluate(new Fr(this.zoom+1),t,{},i,[],r),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,a,o)}updatePaintArray(e,t,n,i){const r=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(e,t,r,a)}_setPaintValue(e,t,n,i){if("color"===this.type){const r=bo(n),a=bo(i);for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r[0],r[1],a[0],a[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){const n=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,i=m(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(i)}getBinding(e,t,n){return new yo(e,t)}}class Io{constructor(e,t,n,i,r,a){this.expression=e,this.type=t,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new r,this.zoomOutPaintVertexArray=new r}populatePaintArray(e,t,n){const i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(i,e,t.patterns&&t.patterns[this.layerId],n)}updatePaintArray(e,t,n,i,r){this._setPaintValues(e,t,n.patterns&&n.patterns[this.layerId],r)}_setPaintValues(e,t,n,i){if(!i||!n)return;const{min:r,mid:a,max:o}=n,s=i[r],l=i[a],c=i[o];if(s&&l&&c)for(let u=e;u<t;u++)this.zoomInPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],l.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,io.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,io.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ko{constructor(e,t,n){this.binders={},this._buffers=[];const i=[];for(const r in e.paint._values){if(!n(r))continue;const a=e.paint.get(r);if(!(a instanceof $r&&si(a.property.specification)))continue;const o=Po(r,e.type),s=a.value,l=a.property.specification.type,c=a.property.useIntegerZoom,u=a.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===s.kind)this.binders[r]=h?new So(s.value,o):new wo(s.value,o,l),i.push(`/u_${r}`);else if("source"===s.kind||h){const n=Ao(r,l,"source");this.binders[r]=h?new Io(s,l,c,t,n,e.id):new To(s,o,l,n),i.push(`/a_${r}`)}else{const e=Ao(r,l,"composite");this.binders[r]=new Co(s,o,l,c,t,e),i.push(`/z_${r}`)}}this.cacheKey=i.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof To||t instanceof Co?t.maxValue:0}populatePaintArrays(e,t,n,i,r){for(const a in this.binders){const o=this.binders[a];(o instanceof To||o instanceof Co||o instanceof Io)&&o.populatePaintArray(e,t,n,i,r)}}setConstantPatternPositions(e,t){for(const n in this.binders){const i=this.binders[n];i instanceof So&&i.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,n,i,r){let a=!1;for(const o in e){const s=t.getPositions(o);for(const t of s){const s=n.feature(t.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof To||l instanceof Co||l instanceof Io)&&!0===l.expression.isStateDependent){const c=i.paint.get(n);l.expression=c.value,l.updatePaintArray(t.start,t.end,s,e[o],r),a=!0}}}}return a}defines(){const e=[];for(const t in this.binders){const n=this.binders[t];(n instanceof wo||n instanceof So)&&e.push(...n.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof To||n instanceof Co)for(let t=0;t<n.paintVertexAttributes.length;t++)e.push(n.paintVertexAttributes[t].name);else if(n instanceof Io)for(let t=0;t<io.members.length;t++)e.push(io.members[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof wo||n instanceof So||n instanceof Co)for(const t of n.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){const n=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof wo||r instanceof So||r instanceof Co)for(const a of r.uniformNames)if(t[a]){const o=r.getBinding(e,t[a],a);n.push({name:a,property:i,binding:o})}}return n}setUniforms(e,t,n,i){for(const{name:r,property:a,binding:o}of t)this.binders[a].setUniform(o,i,n.get(a),r)}updatePaintBuffers(e){this._buffers=[];for(const t in this.binders){const n=this.binders[t];if(e&&n instanceof Io){const t=2===e.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(n instanceof To||n instanceof Co)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const t in this.binders){const n=this.binders[t];(n instanceof To||n instanceof Co||n instanceof Io)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof To||t instanceof Co||t instanceof Io)&&t.destroy()}}}class Eo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const i of e)this.programConfigurations[i.id]=new ko(i,t,n);this.needsUpload=!1,this._featureMap=new ho,this._bufferOffset=0}populatePaintArrays(e,t,n,i,r,a){for(const o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(e,t,i,r,a);void 0!==t.id&&this._featureMap.add(t.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,n,i){for(const r of n)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(e,this._featureMap,t,r,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Po(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function Ao(e,t,n){const i={color:{source:ca,composite:Ia},number:{source:ba,composite:ca}},r=function(e){return{"line-pattern":{source:qa,composite:qa},"fill-pattern":{source:qa,composite:qa},"fill-extrusion-pattern":{source:qa,composite:qa}}[e]}(e);return r&&r[n]||i[t][n]}br("ConstantBinder",wo),br("CrossFadedConstantBinder",So),br("SourceExpressionBinder",To),br("CrossFadedCompositeBinder",Io),br("CompositeExpressionBinder",Co),br("ProgramConfiguration",ko,{omit:["_buffers"]}),br("ProgramConfigurationSet",Eo);const Mo=8192,zo=Math.pow(2,14)-1,Lo=-zo-1;function Do(e){const t=Mo/e.extent,n=e.loadGeometry();for(let i=0;i<n.length;i++){const e=n[i];for(let n=0;n<e.length;n++){const i=e[n],r=Math.round(i.x*t),a=Math.round(i.y*t);i.x=m(r,Lo,zo),i.y=m(a,Lo,zo),(r<i.x||r>i.x+1||a<i.y||a>i.y+1)&&S("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Ro(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Do(e):[]}}function Fo(e,t,n,i,r){e.emplaceBack(2*t+(i+1)/2,2*n+(r+1)/2)}class Oo{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Va,this.indexArray=new Ya,this.segments=new to,this.programConfigurations=new Eo(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,n){const i=this.layers[0],r=[];let a=null,o=!1;"circle"===i.type&&(a=i.layout.get("circle-sort-key"),o=!a.isConstant());for(const{feature:s,id:l,index:c,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Ro(s,e);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),t,n))continue;const i=o?a.evaluate(t,{},n):void 0,h={id:l,properties:s.properties,type:s.type,sourceLayerIndex:u,index:c,geometry:e?t.geometry:Do(s),patterns:{},sortKey:i};r.push(h)}o&&r.sort(((e,t)=>e.sortKey-t.sortKey));for(const s of r){const{geometry:i,index:r,sourceLayerIndex:a}=s,o=e[r].feature;this.addFeature(s,i,r,n),t.featureIndex.insert(o,i,r,a,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,eo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,n,i){for(const r of t)for(const t of r){const n=t.x,i=t.y;if(n<0||n>=Mo||i<0||i>=Mo)continue;const r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=r.vertexLength;Fo(this.layoutVertexArray,n,i,-1,-1),Fo(this.layoutVertexArray,n,i,1,-1),Fo(this.layoutVertexArray,n,i,1,1),Fo(this.layoutVertexArray,n,i,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),r.vertexLength+=4,r.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i)}}function Bo(e,t){for(let n=0;n<e.length;n++)if(Go(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(Go(e,t[n]))return!0;return!!jo(e,t)}function No(e,t,n){return!!Go(e,t)||!!Ho(t,e,n)}function Vo(e,t){if(1===e.length)return Zo(t,e[0]);for(let n=0;n<t.length;n++){const i=t[n];for(let t=0;t<i.length;t++)if(Go(e,i[t]))return!0}for(let n=0;n<e.length;n++)if(Zo(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(jo(e,t[n]))return!0;return!1}function Uo(e,t,n){if(e.length>1){if(jo(e,t))return!0;for(let i=0;i<t.length;i++)if(Ho(t[i],e,n))return!0}for(let i=0;i<e.length;i++)if(Ho(e[i],t,n))return!0;return!1}function jo(e,t){if(0===e.length||0===t.length)return!1;for(let n=0;n<e.length-1;n++){const i=e[n],r=e[n+1];for(let e=0;e<t.length-1;e++)if($o(i,r,t[e],t[e+1]))return!0}return!1}function $o(e,t,n,i){return T(e,n,i)!==T(t,n,i)&&T(e,t,n)!==T(e,t,i)}function Ho(e,t,n){const i=n*n;if(1===t.length)return e.distSqr(t[0])<i;for(let r=1;r<t.length;r++)if(qo(e,t[r-1],t[r])<i)return!0;return!1}function qo(e,t,n){const i=t.distSqr(n);if(0===i)return e.distSqr(t);const r=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/i;return e.distSqr(r<0?t:r>1?n:n.sub(t)._mult(r)._add(t))}function Zo(e,t){let n,i,r,a=!1;for(let o=0;o<e.length;o++){n=e[o];for(let e=0,o=n.length-1;e<n.length;o=e++)i=n[e],r=n[o],i.y>t.y!=r.y>t.y&&t.x<(r.x-i.x)*(t.y-i.y)/(r.y-i.y)+i.x&&(a=!a)}return a}function Go(e,t){let n=!1;for(let i=0,r=e.length-1;i<e.length;r=i++){const a=e[i],o=e[r];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(n=!n)}return n}function Wo(e,t,n){const i=n[0],r=n[2];if(e.x<i.x&&t.x<i.x||e.x>r.x&&t.x>r.x||e.y<i.y&&t.y<i.y||e.y>r.y&&t.y>r.y)return!1;const a=T(e,t,n[0]);return a!==T(e,t,n[1])||a!==T(e,t,n[2])||a!==T(e,t,n[3])}function Ko(e,t,n){const i=t.paint.get(e).value;return"constant"===i.kind?i.value:n.programConfigurations.get(t.id).getMaxValue(e)}function Xo(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Yo(e,t,n,i,r){if(!t[0]&&!t[1])return e;const o=a.convert(t)._mult(r);"viewport"===n&&o._rotate(-i);const s=[];for(let a=0;a<e.length;a++)s.push(e[a].sub(o));return s}let Jo,Qo;br("CircleBucket",Oo,{omit:["layers"]});var es={get paint(){return Qo=Qo||new Xr({"circle-radius":new Zr(Z.paint_circle["circle-radius"]),"circle-color":new Zr(Z.paint_circle["circle-color"]),"circle-blur":new Zr(Z.paint_circle["circle-blur"]),"circle-opacity":new Zr(Z.paint_circle["circle-opacity"]),"circle-translate":new qr(Z.paint_circle["circle-translate"]),"circle-translate-anchor":new qr(Z.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qr(Z.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qr(Z.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zr(Z.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Zr(Z.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zr(Z.paint_circle["circle-stroke-opacity"])})},get layout(){return Jo=Jo||new Xr({"circle-sort-key":new Zr(Z.layout_circle["circle-sort-key"])})}},ts=1e-6,ns="undefined"!=typeof Float32Array?Float32Array:Array;function is(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function rs(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],_=t[15],v=n[0],x=n[1],b=n[2],w=n[3];return e[0]=v*i+x*s+b*h+w*m,e[1]=v*r+x*l+b*d+w*g,e[2]=v*a+x*c+b*p+w*y,e[3]=v*o+x*u+b*f+w*_,e[4]=(v=n[4])*i+(x=n[5])*s+(b=n[6])*h+(w=n[7])*m,e[5]=v*r+x*l+b*d+w*g,e[6]=v*a+x*c+b*p+w*y,e[7]=v*o+x*u+b*f+w*_,e[8]=(v=n[8])*i+(x=n[9])*s+(b=n[10])*h+(w=n[11])*m,e[9]=v*r+x*l+b*d+w*g,e[10]=v*a+x*c+b*p+w*y,e[11]=v*o+x*u+b*f+w*_,e[12]=(v=n[12])*i+(x=n[13])*s+(b=n[14])*h+(w=n[15])*m,e[13]=v*r+x*l+b*d+w*g,e[14]=v*a+x*c+b*p+w*y,e[15]=v*o+x*u+b*f+w*_,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var as,os=rs;function ss(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*a+n[12]*o,e[1]=n[1]*i+n[5]*r+n[9]*a+n[13]*o,e[2]=n[2]*i+n[6]*r+n[10]*a+n[14]*o,e[3]=n[3]*i+n[7]*r+n[11]*a+n[15]*o,e}as=new ns(4),ns!=Float32Array&&(as[0]=0,as[1]=0,as[2]=0,as[3]=0);class ls extends Jr{constructor(e){super(e,es)}createBucket(e){return new Oo(e)}queryRadius(e){const t=e;return Ko("circle-radius",this,t)+Ko("circle-stroke-width",this,t)+Xo(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,n,i,r,a,o,s){const l=Yo(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,o),c=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n),u="map"===this.paint.get("circle-pitch-alignment"),h=u?l:function(e,t){return e.map((e=>cs(e,t)))}(l,s),d=u?c*o:c;for(const p of i)for(const e of p){const t=u?e:cs(e,s);let n=d;const i=ss([],[e.x,e.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?n*=i[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(n*=a.cameraToCenterDistance/i[3]),No(h,t,n))return!0}return!1}}function cs(e,t){const n=ss([],[e.x,e.y,0,1],t);return new a(n[0]/n[3],n[1]/n[3])}class us extends Oo{}let hs;br("HeatmapBucket",us,{omit:["layers"]});var ds={get paint(){return hs=hs||new Xr({"heatmap-radius":new Zr(Z.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zr(Z.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qr(Z.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Kr(Z.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qr(Z.paint_heatmap["heatmap-opacity"])})}};function ps(e,t,n,i){let{width:r,height:a}=t;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==r*a*n)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${r*a*n}`)}else i=new Uint8Array(r*a*n);return e.width=r,e.height=a,e.data=i,e}function fs(e,t,n){let{width:i,height:r}=t;if(i===e.width&&r===e.height)return;const a=ps({},{width:i,height:r},n);ms(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,i),height:Math.min(e.height,r)},n),e.width=i,e.height=r,e.data=a.data}function ms(e,t,n,i,r,a){if(0===r.width||0===r.height)return t;if(r.width>e.width||r.height>e.height||n.x>e.width-r.width||n.y>e.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>t.width||r.height>t.height||i.x>t.width-r.width||i.y>t.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const o=e.data,s=t.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<r.height;l++){const c=((n.y+l)*e.width+n.x)*a,u=((i.y+l)*t.width+i.x)*a;for(let e=0;e<r.width*a;e++)s[u+e]=o[c+e]}return t}class gs{constructor(e,t){ps(this,e,1,t)}resize(e){fs(this,e,1)}clone(){return new gs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,i,r){ms(e,t,n,i,r,1)}}class ys{constructor(e,t){ps(this,e,4,t)}resize(e){fs(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ys({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,i,r){ms(e,t,n,i,r,4)}}function _s(e){const t={},n=e.resolution||256,i=e.clips?e.clips.length:1,r=e.image||new ys({width:n,height:i});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const a=(n,i,a)=>{t[e.evaluationKey]=a;const o=e.expression.evaluate(t);r.data[n+i+0]=Math.floor(255*o.r/o.a),r.data[n+i+1]=Math.floor(255*o.g/o.a),r.data[n+i+2]=Math.floor(255*o.b/o.a),r.data[n+i+3]=Math.floor(255*o.a)};if(e.clips)for(let o=0,s=0;o<i;++o,s+=4*n)for(let t=0,i=0;t<n;t++,i+=4){const r=t/(n-1),{start:l,end:c}=e.clips[o];a(s,i,l*(1-r)+c*r)}else for(let o=0,s=0;o<n;o++,s+=4)a(0,s,o/(n-1));return r}br("AlphaImage",gs),br("RGBAImage",ys);class vs extends Jr{createBucket(e){return new us(e)}constructor(e){super(e,ds),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_s({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let xs;var bs={get paint(){return xs=xs||new Xr({"hillshade-illumination-direction":new qr(Z.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qr(Z.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qr(Z.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qr(Z.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qr(Z.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qr(Z.paint_hillshade["hillshade-accent-color"])})}};class ws extends Jr{constructor(e){super(e,bs)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const Ss=na([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ts}=Ss;var Cs={exports:{}};function Is(e,t,n){n=n||2;var i,r,a,o,s,l,c,u=t&&t.length,h=u?t[0]*n:e.length,d=ks(e,0,h,n,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(e,t,n,i){var r,a,o,s=[];for(r=0,a=t.length;r<a;r++)(o=ks(e,t[r]*i,r<a-1?t[r+1]*i:e.length,i,!1))===o.next&&(o.steiner=!0),s.push(Bs(o));for(s.sort(Ds),r=0;r<s.length;r++)n=Rs(s[r],n);return n}(e,t,d,n)),e.length>80*n){i=a=e[0],r=o=e[1];for(var f=n;f<h;f+=n)(s=e[f])<i&&(i=s),(l=e[f+1])<r&&(r=l),s>a&&(a=s),l>o&&(o=l);c=0!==(c=Math.max(a-i,o-r))?32767/c:0}return Ps(d,p,n,i,r,c,0),p}function ks(e,t,n,i,r){var a,o;if(r===Ys(e,t,n,i)>0)for(a=t;a<n;a+=i)o=Ws(a,e[a],e[a+1],o);else for(a=n-i;a>=t;a-=i)o=Ws(a,e[a],e[a+1],o);return o&&js(o,o.next)&&(Ks(o),o=o.next),o}function Es(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!js(i,i.next)&&0!==Us(i.prev,i,i.next))i=i.next;else{if(Ks(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function Ps(e,t,n,i,r,a,o){if(e){!o&&a&&function(e,t,n,i){var r=e;do{0===r.z&&(r.z=Os(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,a,o,s,l,c=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,i=n,s=0,t=0;t<c&&(s++,i=i.nextZ);t++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;n=i}a.nextZ=null,c*=2}while(o>1)}(r)}(e,i,r,a);for(var s,l,c=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?Ms(e,i,r,a):As(e))t.push(s.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),Ks(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?Ps(e=zs(Es(e),t,n),t,n,i,r,a,2):2===o&&Ls(e,t,n,i,r,a):Ps(Es(e),t,n,i,r,a,1);break}}}function As(e){var t=e.prev,n=e,i=e.next;if(Us(t,n,i)>=0)return!1;for(var r=t.x,a=n.x,o=i.x,s=t.y,l=n.y,c=i.y,u=r<a?r<o?r:o:a<o?a:o,h=s<l?s<c?s:c:l<c?l:c,d=r>a?r>o?r:o:a>o?a:o,p=s>l?s>c?s:c:l>c?l:c,f=i.next;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Ns(r,s,a,l,o,c,f.x,f.y)&&Us(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ms(e,t,n,i){var r=e.prev,a=e,o=e.next;if(Us(r,a,o)>=0)return!1;for(var s=r.x,l=a.x,c=o.x,u=r.y,h=a.y,d=o.y,p=s<l?s<c?s:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,m=s>l?s>c?s:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,y=Os(p,f,t,n,i),_=Os(m,g,t,n,i),v=e.prevZ,x=e.nextZ;v&&v.z>=y&&x&&x.z<=_;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==r&&v!==o&&Ns(s,u,l,h,c,d,v.x,v.y)&&Us(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==o&&Ns(s,u,l,h,c,d,x.x,x.y)&&Us(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;v&&v.z>=y;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=g&&v!==r&&v!==o&&Ns(s,u,l,h,c,d,v.x,v.y)&&Us(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;x&&x.z<=_;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==o&&Ns(s,u,l,h,c,d,x.x,x.y)&&Us(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function zs(e,t,n){var i=e;do{var r=i.prev,a=i.next.next;!js(r,a)&&$s(r,i,i.next,a)&&Zs(r,a)&&Zs(a,r)&&(t.push(r.i/n|0),t.push(i.i/n|0),t.push(a.i/n|0),Ks(i),Ks(i.next),i=e=a),i=i.next}while(i!==e);return Es(i)}function Ls(e,t,n,i,r,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Vs(o,s)){var l=Gs(o,s);return o=Es(o,o.next),l=Es(l,l.next),Ps(o,t,n,i,r,a,0),void Ps(l,t,n,i,r,a,0)}s=s.next}o=o.next}while(o!==e)}function Ds(e,t){return e.x-t.x}function Rs(e,t){var n=function(e,t){var n,i=t,r=e.x,a=e.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o&&(o=s,n=i.x<i.next.x?i:i.next,s===r))return n}i=i.next}while(i!==t);if(!n)return null;var l,c=n,u=n.x,h=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&Ns(a<h?r:o,a,u,h,a<h?o:r,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(r-i.x),Zs(i,e)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&Fs(n,i)))&&(n=i,d=l)),i=i.next}while(i!==c);return n}(e,t);if(!n)return t;var i=Gs(n,e);return Es(i,i.next),Es(n,n.next)}function Fs(e,t){return Us(e.prev,e,t.prev)<0&&Us(t.next,e,e.next)<0}function Os(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Bs(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Ns(e,t,n,i,r,a,o,s){return(r-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(i-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(r-o)*(i-s)}function Vs(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&$s(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Zs(e,t)&&Zs(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(Us(e.prev,e,t.prev)||Us(e,t.prev,t))||js(e,t)&&Us(e.prev,e,e.next)>0&&Us(t.prev,t,t.next)>0)}function Us(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function js(e,t){return e.x===t.x&&e.y===t.y}function $s(e,t,n,i){var r=qs(Us(e,t,n)),a=qs(Us(e,t,i)),o=qs(Us(n,i,e)),s=qs(Us(n,i,t));return r!==a&&o!==s||!(0!==r||!Hs(e,n,t))||!(0!==a||!Hs(e,i,t))||!(0!==o||!Hs(n,e,i))||!(0!==s||!Hs(n,t,i))}function Hs(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function qs(e){return e>0?1:e<0?-1:0}function Zs(e,t){return Us(e.prev,e,e.next)<0?Us(e,t,e.next)>=0&&Us(e,e.prev,t)>=0:Us(e,t,e.prev)<0||Us(e,e.next,t)<0}function Gs(e,t){var n=new Xs(e.i,e.x,e.y),i=new Xs(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function Ws(e,t,n,i){var r=new Xs(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ks(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Xs(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ys(e,t,n,i){for(var r=0,a=t,o=n-i;a<n;a+=i)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}Cs.exports=Is,Cs.exports.default=Is,Is.deviation=function(e,t,n,i){var r=t&&t.length,a=Math.abs(Ys(e,0,r?t[0]*n:e.length,n));if(r)for(var o=0,s=t.length;o<s;o++)a-=Math.abs(Ys(e,t[o]*n,o<s-1?t[o+1]*n:e.length,n));var l=0;for(o=0;o<i.length;o+=3){var c=i[o]*n,u=i[o+1]*n,h=i[o+2]*n;l+=Math.abs((e[c]-e[h])*(e[u+1]-e[c+1])-(e[c]-e[u])*(e[h+1]-e[c+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},Is.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var a=0;a<e[r].length;a++)for(var o=0;o<t;o++)n.vertices.push(e[r][a][o]);r>0&&n.holes.push(i+=e[r-1].length)}return n};var Js=n(Cs.exports);function Qs(e,t,n){const i=n.patternDependencies;let r=!1;for(const a of t){const t=a.paint.get(`${e}-pattern`);t.isConstant()||(r=!0);const n=t.constantOr(null);n&&(r=!0,i[n.to]=!0,i[n.from]=!0)}return r}function el(e,t,n,i,r){const a=r.patternDependencies;for(const o of t){const t=o.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:i-1},n,{},r.availableImages),s=t.evaluate({zoom:i},n,{},r.availableImages),l=t.evaluate({zoom:i+1},n,{},r.availableImages);e=e&&e.name?e.name:e,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,a[e]=!0,a[s]=!0,a[l]=!0,n.patterns[o.id]={min:e,mid:s,max:l}}}return n}class tl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ua,this.indexArray=new Ya,this.indexArray2=new Ja,this.programConfigurations=new Eo(e.layers,e.zoom),this.segments=new to,this.segments2=new to,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,n){this.hasPattern=Qs("fill",this.layers,t);const i=this.layers[0].layout.get("fill-sort-key"),r=!i.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=Ro(o,e);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),u,n))continue;const h=r?i.evaluate(u,{},n,t.availableImages):void 0,d={id:s,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:Do(o),patterns:{},sortKey:h};a.push(d)}r&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(const o of a){const{geometry:i,index:r,sourceLayerIndex:a}=o;if(this.hasPattern){const e=el("fill",this.layers,o,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(o,i,r,n,{});t.featureIndex.insert(e[r].feature,i,r,a,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}addFeatures(e,t,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,t,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ts),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,n,i,r){for(const a of xn(t,500)){let e=0;for(const s of a)e+=s.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),n=t.vertexLength,i=[],r=[];for(const s of a){if(0===s.length)continue;s!==a[0]&&r.push(i.length/2);const e=this.segments2.prepareSegment(s.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(s[0].x,s[0].y),this.indexArray2.emplaceBack(t+s.length-1,t),i.push(s[0].x),i.push(s[0].y);for(let n=1;n<s.length;n++)this.layoutVertexArray.emplaceBack(s[n].x,s[n].y),this.indexArray2.emplaceBack(t+n-1,t+n),i.push(s[n].x),i.push(s[n].y);e.vertexLength+=s.length,e.primitiveLength+=s.length}const o=Js(i,r);for(let a=0;a<o.length;a+=3)this.indexArray.emplaceBack(n+o[a],n+o[a+1],n+o[a+2]);t.vertexLength+=e,t.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,i)}}let nl,il;br("FillBucket",tl,{omit:["layers","patternFeatures"]});var rl={get paint(){return il=il||new Xr({"fill-antialias":new qr(Z.paint_fill["fill-antialias"]),"fill-opacity":new Zr(Z.paint_fill["fill-opacity"]),"fill-color":new Zr(Z.paint_fill["fill-color"]),"fill-outline-color":new Zr(Z.paint_fill["fill-outline-color"]),"fill-translate":new qr(Z.paint_fill["fill-translate"]),"fill-translate-anchor":new qr(Z.paint_fill["fill-translate-anchor"]),"fill-pattern":new Gr(Z.paint_fill["fill-pattern"])})},get layout(){return nl=nl||new Xr({"fill-sort-key":new Zr(Z.layout_fill["fill-sort-key"])})}};class al extends Jr{constructor(e){super(e,rl)}recalculate(e,t){super.recalculate(e,t);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new tl(e)}queryRadius(){return Xo(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,n,i,r,a,o){return Vo(Yo(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,o),i)}isTileClipped(){return!0}}const ol=na([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),sl=na([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ll}=ol;var cl={},ul=i,hl=dl;function dl(e,t,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=r,e.readFields(pl,this,t)}function pl(e,t,n){1==e?t.id=n.readVarint():2==e?function(e,t){for(var n=e.readVarint()+e.pos;e.pos<n;){var i=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[i]=r}}(n,t):3==e?t.type=n.readVarint():4==e&&(t._geometry=n.pos)}function fl(e){for(var t,n,i=0,r=0,a=e.length,o=a-1;r<a;o=r++)i+=((n=e[o]).x-(t=e[r]).x)*(t.y+n.y);return i}dl.types=["Unknown","Point","LineString","Polygon"],dl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,n=e.readVarint()+e.pos,i=1,r=0,a=0,o=0,s=[];e.pos<n;){if(r<=0){var l=e.readVarint();i=7&l,r=l>>3}if(r--,1===i||2===i)a+=e.readSVarint(),o+=e.readSVarint(),1===i&&(t&&s.push(t),t=[]),t.push(new ul(a,o));else{if(7!==i)throw new Error("unknown command "+i);t&&t.push(t[0].clone())}}return t&&s.push(t),s},dl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,i=0,r=0,a=0,o=1/0,s=-1/0,l=1/0,c=-1/0;e.pos<t;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)(r+=e.readSVarint())<o&&(o=r),r>s&&(s=r),(a+=e.readSVarint())<l&&(l=a),a>c&&(c=a);else if(7!==n)throw new Error("unknown command "+n)}return[o,l,s,c]},dl.prototype.toGeoJSON=function(e,t,n){var i,r,a=this.extent*Math.pow(2,n),o=this.extent*e,s=this.extent*t,l=this.loadGeometry(),c=dl.types[this.type];function u(e){for(var t=0;t<e.length;t++){var n=e[t];e[t]=[360*(n.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];u(l=h);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var n,i,r=[],a=0;a<t;a++){var o=fl(e[a]);0!==o&&(void 0===i&&(i=o<0),i===o<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)u(l[i][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var ml=hl,gl=yl;function yl(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(_l,this,t),this.length=this._features.length}function _l(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){for(var t=null,n=e.readVarint()+e.pos;e.pos<n;){var i=e.readVarint()>>3;t=1===i?e.readString():2===i?e.readFloat():3===i?e.readDouble():4===i?e.readVarint64():5===i?e.readVarint():6===i?e.readSVarint():7===i?e.readBoolean():null}return t}(n))}yl.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ml(this._pbf,t,this.extent,this._keys,this._values)};var vl=gl;function xl(e,t,n){if(3===e){var i=new vl(n,n.readVarint()+n.pos);i.length&&(t[i.name]=i)}}cl.VectorTile=function(e,t){this.layers=e.readFields(xl,{},t)},cl.VectorTileFeature=hl,cl.VectorTileLayer=gl;const bl=cl.VectorTileFeature.types,wl=Math.pow(2,13);function Sl(e,t,n,i,r,a,o,s){e.emplaceBack(t,n,2*Math.floor(i*wl)+o,r*wl*2,a*wl*2,Math.round(s))}class Tl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ja,this.centroidVertexArray=new Na,this.indexArray=new Ya,this.programConfigurations=new Eo(e.layers,e.zoom),this.segments=new to,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,n){this.features=[],this.hasPattern=Qs("fill-extrusion",this.layers,t);for(const{feature:i,id:r,index:a,sourceLayerIndex:o}of e){const e=this.layers[0]._featureFilter.needGeometry,s=Ro(i,e);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),s,n))continue;const l={id:r,sourceLayerIndex:o,index:a,geometry:e?s.geometry:Do(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(el("fill-extrusion",this.layers,l,this.zoom,t)):this.addFeature(l,l.geometry,a,n,{}),t.featureIndex.insert(i,l.geometry,a,o,this.index,!0)}}addFeatures(e,t,n){for(const i of this.features){const{geometry:e}=i;this.addFeature(i,e,i.index,t,n)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ll),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,sl.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,n,i,r){for(const a of xn(t,500)){const t={x:0,y:0,vertexCount:0};let n=0;for(const e of a)n+=e.length;let i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const e of a){if(0===e.length)continue;if(Il(e))continue;let n=0;for(let r=0;r<e.length;r++){const a=e[r];if(r>=1){const o=e[r-1];if(!Cl(a,o)){i.vertexLength+4>to.MAX_VERTEX_ARRAY_LENGTH&&(i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const e=a.sub(o)._perp()._unit(),r=o.dist(a);n+r>32768&&(n=0),Sl(this.layoutVertexArray,a.x,a.y,e.x,e.y,0,0,n),Sl(this.layoutVertexArray,a.x,a.y,e.x,e.y,0,1,n),t.x+=2*a.x,t.y+=2*a.y,t.vertexCount+=2,n+=r,Sl(this.layoutVertexArray,o.x,o.y,e.x,e.y,0,0,n),Sl(this.layoutVertexArray,o.x,o.y,e.x,e.y,0,1,n),t.x+=2*o.x,t.y+=2*o.y,t.vertexCount+=2;const s=i.vertexLength;this.indexArray.emplaceBack(s,s+2,s+1),this.indexArray.emplaceBack(s+1,s+2,s+3),i.vertexLength+=4,i.primitiveLength+=2}}}}if(i.vertexLength+n>to.MAX_VERTEX_ARRAY_LENGTH&&(i=this.segments.prepareSegment(n,this.layoutVertexArray,this.indexArray)),"Polygon"!==bl[e.type])continue;const r=[],o=[],s=i.vertexLength;for(const e of a)if(0!==e.length){e!==a[0]&&o.push(r.length/2);for(let n=0;n<e.length;n++){const i=e[n];Sl(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),t.x+=i.x,t.y+=i.y,t.vertexCount+=1,r.push(i.x),r.push(i.y)}}const l=Js(r,o);for(let e=0;e<l.length;e+=3)this.indexArray.emplaceBack(s+l[e],s+l[e+2],s+l[e+1]);i.primitiveLength+=l.length/3,i.vertexLength+=n;for(let e=0;e<t.vertexCount;e++){const e=Math.floor(t.x/t.vertexCount),n=Math.floor(t.y/t.vertexCount);this.centroidVertexArray.emplaceBack(e,n)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,i)}}function Cl(e,t){return e.x===t.x&&(e.x<0||e.x>Mo)||e.y===t.y&&(e.y<0||e.y>Mo)}function Il(e){return e.every((e=>e.x<0))||e.every((e=>e.x>Mo))||e.every((e=>e.y<0))||e.every((e=>e.y>Mo))}let kl;br("FillExtrusionBucket",Tl,{omit:["layers","features"]});var El={get paint(){return kl=kl||new Xr({"fill-extrusion-opacity":new qr(Z["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Zr(Z["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qr(Z["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qr(Z["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Gr(Z["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Zr(Z["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zr(Z["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new qr(Z["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Pl extends Jr{constructor(e){super(e,El)}createBucket(e){return new Tl(e)}queryRadius(){return Xo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,n,i,r,o,s,l){const c=Yo(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s),u=this.paint.get("fill-extrusion-height").evaluate(t,n),h=this.paint.get("fill-extrusion-base").evaluate(t,n),d=function(e,t){const n=[];for(const i of e){const e=[i.x,i.y,0,1];ss(e,e,t),n.push(new a(e[0]/e[3],e[1]/e[3]))}return n}(c,l),p=function(e,t,n,i){const r=[],o=[],s=i[8]*t,l=i[9]*t,c=i[10]*t,u=i[11]*t,h=i[8]*n,d=i[9]*n,p=i[10]*n,f=i[11]*n;for(const m of e){const e=[],t=[];for(const n of m){const r=n.x,o=n.y,m=i[0]*r+i[4]*o+i[12],g=i[1]*r+i[5]*o+i[13],y=i[2]*r+i[6]*o+i[14],_=i[3]*r+i[7]*o+i[15],v=y+c,x=_+u,b=m+h,w=g+d,S=y+p,T=_+f,C=new a((m+s)/x,(g+l)/x);C.z=v/x,e.push(C);const I=new a(b/T,w/T);I.z=S/T,t.push(I)}r.push(e),o.push(t)}return[r,o]}(i,h,u,l);return function(e,t,n){let i=1/0;Vo(n,t)&&(i=Ml(n,t[0]));for(let r=0;r<t.length;r++){const a=t[r],o=e[r];for(let e=0;e<a.length-1;e++){const t=a[e],r=[t,a[e+1],o[e+1],o[e],t];Bo(n,r)&&(i=Math.min(i,Ml(n,r)))}}return i!==1/0&&i}(p[0],p[1],d)}}function Al(e,t){return e.x*t.x+e.y*t.y}function Ml(e,t){if(1===e.length){let n=0;const i=t[n++];let r;for(;!r||i.equals(r);)if(r=t[n++],!r)return 1/0;for(;n<t.length;n++){const a=t[n],o=e[0],s=r.sub(i),l=a.sub(i),c=o.sub(i),u=Al(s,s),h=Al(s,l),d=Al(l,l),p=Al(c,s),f=Al(c,l),m=u*d-h*h,g=(d*p-h*f)/m,y=(u*f-h*p)/m,_=i.z*(1-g-y)+r.z*g+a.z*y;if(isFinite(_))return _}return 1/0}{let e=1/0;for(const n of t)e=Math.min(e,n.z);return e}}const zl=na([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ll}=zl,Dl=na([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Rl}=Dl,Fl=cl.VectorTileFeature.types,Ol=Math.cos(Math.PI/180*37.5),Bl=Math.pow(2,14)/.5;class Nl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new $a,this.layoutVertexArray2=new Ha,this.indexArray=new Ya,this.programConfigurations=new Eo(e.layers,e.zoom),this.segments=new to,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,n){this.hasPattern=Qs("line",this.layers,t);const i=this.layers[0].layout.get("line-sort-key"),r=!i.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Ro(o,e);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),t,n))continue;const u=r?i.evaluate(t,{},n):void 0,h={id:s,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:e?t.geometry:Do(o),patterns:{},sortKey:u};a.push(h)}r&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(const o of a){const{geometry:i,index:r,sourceLayerIndex:a}=o;if(this.hasPattern){const e=el("line",this.layers,o,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(o,i,r,n,{});t.featureIndex.insert(e[r].feature,i,r,a,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}addFeatures(e,t,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,t,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Rl)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ll),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,n,i,r){const a=this.layers[0].layout,o=a.get("line-join").evaluate(e,{}),s=a.get("line-cap"),l=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const u of t)this.addLine(u,e,o,s,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,i)}addLine(e,t,n,i,r,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===Fl[t.type];let s=e.length;for(;s>=2&&e[s-1].equals(e[s-2]);)s--;let l=0;for(;l<s-1&&e[l].equals(e[l+1]);)l++;if(s<(o?3:2))return;"bevel"===n&&(r=1.05);const c=this.overscaling<=16?15*Mo/(512*this.overscaling):0,u=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let h,d,p,f,m;this.e1=this.e2=-1,o&&(h=e[s-2],m=e[l].sub(h)._unit()._perp());for(let g=l;g<s;g++){if(p=g===s-1?o?e[l+1]:void 0:e[g+1],p&&e[g].equals(p))continue;m&&(f=m),h&&(d=h),h=e[g],m=p?p.sub(h)._unit()._perp():f,f=f||m;let t=f.add(m);0===t.x&&0===t.y||t._unit();const y=f.x*m.x+f.y*m.y,_=t.x*m.x+t.y*m.y,v=0!==_?1/_:1/0,x=2*Math.sqrt(2-2*_),b=_<Ol&&d&&p,w=f.x*m.y-f.y*m.x>0;if(b&&g>l){const e=h.dist(d);if(e>2*c){const t=h.sub(h.sub(d)._mult(c/e)._round());this.updateDistance(d,t),this.addCurrentVertex(t,f,0,0,u),d=t}}const S=d&&p;let T=S?n:o?"butt":i;if(S&&"round"===T&&(v<a?T="miter":v<=2&&(T="fakeround")),"miter"===T&&v>r&&(T="bevel"),"bevel"===T&&(v>2&&(T="flipbevel"),v<r&&(T="miter")),d&&this.updateDistance(d,h),"miter"===T)t._mult(v),this.addCurrentVertex(h,t,0,0,u);else if("flipbevel"===T){if(v>100)t=m.mult(-1);else{const e=v*f.add(m).mag()/f.sub(m).mag();t._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(h,t,0,0,u),this.addCurrentVertex(h,t.mult(-1),0,0,u)}else if("bevel"===T||"fakeround"===T){const e=-Math.sqrt(v*v-1),t=w?e:0,n=w?0:e;if(d&&this.addCurrentVertex(h,f,t,n,u),"fakeround"===T){const e=Math.round(180*x/Math.PI/20);for(let t=1;t<e;t++){let n=t/e;if(.5!==n){const e=n-.5;n+=n*e*(n-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*e*e+(.848013+y*(.215638*y-1.06021)))}const i=m.sub(f)._mult(n)._add(f)._unit()._mult(w?-1:1);this.addHalfVertex(h,i.x,i.y,!1,w,0,u)}}p&&this.addCurrentVertex(h,m,-t,-n,u)}else if("butt"===T)this.addCurrentVertex(h,t,0,0,u);else if("square"===T){const e=d?1:-1;this.addCurrentVertex(h,t,e,e,u)}else"round"===T&&(d&&(this.addCurrentVertex(h,f,0,0,u),this.addCurrentVertex(h,f,1,1,u,!0)),p&&(this.addCurrentVertex(h,m,-1,-1,u,!0),this.addCurrentVertex(h,m,0,0,u)));if(b&&g<s-1){const e=h.dist(p);if(e>2*c){const t=h.add(p.sub(h)._mult(c/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,m,0,0,u),h=t}}}}addCurrentVertex(e,t,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=t.y*i-t.x,s=-t.y-t.x*i;this.addHalfVertex(e,t.x+t.y*n,t.y-t.x*n,a,!1,n,r),this.addHalfVertex(e,o,s,a,!0,-i,r),this.distance>Bl/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,n,i,r,a))}addHalfVertex(e,t,n,i,r,a,o){let{x:s,y:l}=e;const c=.5*(this.lineClips?this.scaledDistance*(Bl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(i?1:0),(l<<1)+(r?1:0),Math.round(63*t)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1)|(63&c)<<2,c>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const u=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),o.primitiveLength++),r?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}let Vl,Ul;br("LineBucket",Nl,{omit:["layers","patternFeatures"]});var jl={get paint(){return Ul=Ul||new Xr({"line-opacity":new Zr(Z.paint_line["line-opacity"]),"line-color":new Zr(Z.paint_line["line-color"]),"line-translate":new qr(Z.paint_line["line-translate"]),"line-translate-anchor":new qr(Z.paint_line["line-translate-anchor"]),"line-width":new Zr(Z.paint_line["line-width"]),"line-gap-width":new Zr(Z.paint_line["line-gap-width"]),"line-offset":new Zr(Z.paint_line["line-offset"]),"line-blur":new Zr(Z.paint_line["line-blur"]),"line-dasharray":new Wr(Z.paint_line["line-dasharray"]),"line-pattern":new Gr(Z.paint_line["line-pattern"]),"line-gradient":new Kr(Z.paint_line["line-gradient"])})},get layout(){return Vl=Vl||new Xr({"line-cap":new qr(Z.layout_line["line-cap"]),"line-join":new Zr(Z.layout_line["line-join"]),"line-miter-limit":new qr(Z.layout_line["line-miter-limit"]),"line-round-limit":new qr(Z.layout_line["line-round-limit"]),"line-sort-key":new Zr(Z.layout_line["line-sort-key"])})}};class $l extends Zr{possiblyEvaluate(e,t){return t=new Fr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,n,i){return t=y({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,n,i)}}let Hl;class ql extends Jr{constructor(e){super(e,jl),this.gradientVersion=0,Hl||(Hl=new $l(jl.paint.properties["line-width"].specification),Hl.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this.gradientExpression();this.stepInterpolant=!!function(e){return void 0!==e._styleExpression}(e)&&e._styleExpression.expression instanceof St,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Hl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Nl(e)}queryRadius(e){const t=e,n=Zl(Ko("line-width",this,t),Ko("line-gap-width",this,t)),i=Ko("line-offset",this,t);return n/2+Math.abs(i)+Xo(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,n,i,r,o,s){const l=Yo(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s),c=s/2*Zl(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),u=this.paint.get("line-offset").evaluate(t,n);return u&&(i=function(e,t){const n=[];for(let i=0;i<e.length;i++){const r=e[i],o=[];for(let e=0;e<r.length;e++){const n=r[e-1],i=r[e],s=r[e+1],l=0===e?new a(0,0):i.sub(n)._unit()._perp(),c=e===r.length-1?new a(0,0):s.sub(i)._unit()._perp(),u=l._add(c)._unit(),h=u.x*c.x+u.y*c.y;0!==h&&u._mult(1/h),o.push(u._mult(t)._add(i))}n.push(o)}return n}(i,u*s)),function(e,t,n){for(let i=0;i<t.length;i++){const r=t[i];if(e.length>=3)for(let t=0;t<r.length;t++)if(Go(e,r[t]))return!0;if(Uo(e,r,n))return!0}return!1}(l,i,c)}isTileClipped(){return!0}}function Zl(e,t){return t>0?t+2*e:e}const Gl=na([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wl=na([{name:"a_projected_pos",components:3,type:"Float32"}],4);na([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Kl=na([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);na([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Xl=na([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Yl=na([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Jl(e,t,n){return e.sections.forEach((e=>{e.text=function(e,t,n){const i=t.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?e=e.toLocaleUpperCase():"lowercase"===i&&(e=e.toLocaleLowerCase()),Rr.applyArabicShaping&&(e=Rr.applyArabicShaping(e)),e}(e.text,t,n)})),e}na([{name:"triangle",components:3,type:"Uint16"}]),na([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),na([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),na([{type:"Float32",name:"offsetX"}]),na([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),na([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ql={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var ec=24,tc=rc,nc=function(e,t,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=e[t+h];for(h+=d,a=p&(1<<-u)-1,p>>=-u,u+=s;u>0;a=256*a+e[t+h],h+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=i;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),a-=c}return(p?-1:1)*o*Math.pow(2,a-i)},ic=function(e,t,n,i,r,a){var o,s,l,c=8*a-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:a-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(t*l-1)*Math.pow(2,r),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[n+p]=255&s,p+=f,s/=256,r-=8);for(o=o<<r|s,c+=r;c>0;e[n+p]=255&o,p+=f,o/=256,c-=8);e[n+p-f]|=128*m};function rc(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}rc.Varint=0,rc.Fixed64=1,rc.Bytes=2,rc.Fixed32=5;var ac=4294967296,oc=1/ac,sc="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function lc(e){return e.type===rc.Bytes?e.readVarint()+e.pos:e.pos+1}function cc(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function uc(e,t,n){var i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=e;r--)n.buf[r+i]=n.buf[r]}function hc(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function dc(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function pc(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function fc(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function mc(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function gc(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function yc(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function _c(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function vc(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function xc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function bc(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function wc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}rc.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,a=this.pos;this.type=7&i,e(r,t,this),this.pos===a&&this.skip(i)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=xc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=wc(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=xc(this.buf,this.pos)+xc(this.buf,this.pos+4)*ac;return this.pos+=8,e},readSFixed64:function(){var e=xc(this.buf,this.pos)+wc(this.buf,this.pos+4)*ac;return this.pos+=8,e},readFloat:function(){var e=nc(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=nc(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,i=this.buf;return t=127&(n=i[this.pos++]),n<128?t:(t|=(127&(n=i[this.pos++]))<<7,n<128?t:(t|=(127&(n=i[this.pos++]))<<14,n<128?t:(t|=(127&(n=i[this.pos++]))<<21,n<128?t:function(e,t,n){var i,r,a=n.buf;if(i=(112&(r=a[n.pos++]))>>4,r<128)return cc(e,i,t);if(i|=(127&(r=a[n.pos++]))<<3,r<128)return cc(e,i,t);if(i|=(127&(r=a[n.pos++]))<<10,r<128)return cc(e,i,t);if(i|=(127&(r=a[n.pos++]))<<17,r<128)return cc(e,i,t);if(i|=(127&(r=a[n.pos++]))<<24,r<128)return cc(e,i,t);if(i|=(1&(r=a[n.pos++]))<<31,r<128)return cc(e,i,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=i[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&sc?function(e,t,n){return sc.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){for(var i="",r=t;r<n;){var a,o,s,l=e[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(a=e[r+1]))&&(c=(31&l)<<6|63&a)<=127&&(c=null):3===u?(o=e[r+2],128==(192&(a=e[r+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&a)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(o=e[r+2],s=e[r+3],128==(192&(a=e[r+1]))&&128==(192&o)&&128==(192&s)&&((c=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=u}return i}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==rc.Bytes)return e.push(this.readVarint(t));var n=lc(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==rc.Bytes)return e.push(this.readSVarint());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==rc.Bytes)return e.push(this.readBoolean());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==rc.Bytes)return e.push(this.readFloat());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==rc.Bytes)return e.push(this.readDouble());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==rc.Bytes)return e.push(this.readFixed32());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==rc.Bytes)return e.push(this.readSFixed32());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==rc.Bytes)return e.push(this.readFixed64());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==rc.Bytes)return e.push(this.readSFixed64());var t=lc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===rc.Varint)for(;this.buf[this.pos++]>127;);else if(t===rc.Bytes)this.pos=this.readVarint()+this.pos;else if(t===rc.Fixed32)this.pos+=4;else{if(t!==rc.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),bc(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),bc(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),bc(this.buf,-1&e,this.pos),bc(this.buf,Math.floor(e*oc),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),bc(this.buf,-1&e,this.pos),bc(this.buf,Math.floor(e*oc),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,i;if(e>=0?(n=e%4294967296|0,i=e/4294967296|0):(i=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,i=i+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,n.buf[n.pos]=127&(e>>>=7)}(n,0,t),function(e,t){var n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(i,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var i,r,a=0;a<t.length;a++){if((i=t.charCodeAt(a))>55295&&i<57344){if(!r){i>56319||a+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):r=i;continue}if(i<56320){e[n++]=239,e[n++]=191,e[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(e[n++]=239,e[n++]=191,e[n++]=189,r=null);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(i<65536?e[n++]=i>>12|224:(e[n++]=i>>18|240,e[n++]=i>>12&63|128),e[n++]=i>>6&63|128),e[n++]=63&i|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&uc(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),ic(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ic(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var i=this.pos-n;i>=128&&uc(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(e,t,n){this.writeTag(e,rc.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,hc,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,dc,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,mc,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,pc,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,fc,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,gc,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,yc,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,_c,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,vc,t)},writeBytesField:function(e,t){this.writeTag(e,rc.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,rc.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,rc.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,rc.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,rc.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,rc.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,rc.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,rc.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,rc.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,rc.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Sc=n(tc);const Tc=3;function Cc(e,t,n){1===e&&n.readMessage(Ic,t)}function Ic(e,t,n){if(3===e){const{id:e,bitmap:i,width:r,height:a,left:o,top:s,advance:l}=n.readMessage(kc,{});t.push({id:e,bitmap:new gs({width:r+2*Tc,height:a+2*Tc},i),metrics:{width:r,height:a,left:o,top:s,advance:l}})}}function kc(e,t,n){1===e?t.id=n.readVarint():2===e?t.bitmap=n.readBytes():3===e?t.width=n.readVarint():4===e?t.height=n.readVarint():5===e?t.left=n.readSVarint():6===e?t.top=n.readSVarint():7===e&&(t.advance=n.readVarint())}const Ec=Tc;function Pc(e){let t=0,n=0;for(const o of e)t+=o.w*o.h,n=Math.max(n,o.w);e.sort(((e,t)=>t.h-e.h));const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let r=0,a=0;for(const o of e)for(let e=i.length-1;e>=0;e--){const t=i[e];if(!(o.w>t.w||o.h>t.h)){if(o.x=t.x,o.y=t.y,a=Math.max(a,o.y+o.h),r=Math.max(r,o.x+o.w),o.w===t.w&&o.h===t.h){const t=i.pop();e<i.length&&(i[e]=t)}else o.h===t.h?(t.x+=o.w,t.w-=o.w):o.w===t.w?(t.y+=o.h,t.h-=o.h):(i.push({x:t.x+o.w,y:t.y,w:t.w-o.w,h:o.h}),t.y+=o.h,t.h-=o.h);break}}return{w:r,h:a,fill:t/(r*a)||0}}const Ac=1;class Mc{constructor(e,t){let{pixelRatio:n,version:i,stretchX:r,stretchY:a,content:o,textFitWidth:s,textFitHeight:l}=t;this.paddedRect=e,this.pixelRatio=n,this.stretchX=r,this.stretchY=a,this.content=o,this.version=i,this.textFitWidth=s,this.textFitHeight=l}get tl(){return[this.paddedRect.x+Ac,this.paddedRect.y+Ac]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ac,this.paddedRect.y+this.paddedRect.h-Ac]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ac)/this.pixelRatio,(this.paddedRect.h-2*Ac)/this.pixelRatio]}}class zc{constructor(e,t){const n={},i={};this.haveRenderCallbacks=[];const r=[];this.addImages(e,n,r),this.addImages(t,i,r);const{w:a,h:o}=Pc(r),s=new ys({width:a||1,height:o||1});for(const l in e){const t=e[l],i=n[l].paddedRect;ys.copy(t.data,s,{x:0,y:0},{x:i.x+Ac,y:i.y+Ac},t.data)}for(const l in t){const e=t[l],n=i[l].paddedRect,r=n.x+Ac,a=n.y+Ac,o=e.data.width,c=e.data.height;ys.copy(e.data,s,{x:0,y:0},{x:r,y:a},e.data),ys.copy(e.data,s,{x:0,y:c-1},{x:r,y:a-1},{width:o,height:1}),ys.copy(e.data,s,{x:0,y:0},{x:r,y:a+c},{width:o,height:1}),ys.copy(e.data,s,{x:o-1,y:0},{x:r-1,y:a},{width:1,height:c}),ys.copy(e.data,s,{x:0,y:0},{x:r+o,y:a},{width:1,height:c})}this.image=s,this.iconPositions=n,this.patternPositions=i}addImages(e,t,n){for(const i in e){const r=e[i],a={x:0,y:0,w:r.data.width+2*Ac,h:r.data.height+2*Ac};n.push(a),t[i]=new Mc(a,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),t),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),t)}patchUpdatedImage(e,t,n){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[i,r]=e.tl;n.update(t.data,void 0,{x:i,y:r})}}var Lc;br("ImagePosition",Mc),br("ImageAtlas",zc),e.ah=void 0,(Lc=e.ah||(e.ah={}))[Lc.none=0]="none",Lc[Lc.horizontal=1]="horizontal",Lc[Lc.vertical=2]="vertical",Lc[Lc.horizontalOnly=3]="horizontalOnly";const Dc=-17;class Rc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const n=new Rc;return n.scale=e||1,n.fontStack=t,n}static forImage(e){const t=new Rc;return t.imageName=e,t}}class Fc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const n=new Fc;for(let i=0;i<e.sections.length;i++){const r=e.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,t)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let t="";for(let n=0;n<e.length;n++){const i=e.charCodeAt(n+1)||null,r=e.charCodeAt(n-1)||null;t+=i&&Mr(i)&&!Ql[e[n+1]]||r&&Mr(r)&&!Ql[e[n-1]]||!Ql[e[n]]?e[n]:Ql[e[n]]}return t}(this.text)}trim(){let e=0;for(let n=0;n<this.text.length&&Bc[this.text.charCodeAt(n)];n++)e++;let t=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&Bc[this.text.charCodeAt(n)];n--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const n=new Fc;return n.text=this.text.substring(e,t),n.sectionIndex=this.sectionIndex.slice(e,t),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(Rc.forText(e.scale,e.fontStack||t));const n=this.sections.length-1;for(let i=0;i<e.text.length;++i)this.sectionIndex.push(n)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void S("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Rc.forImage(t)),this.sectionIndex.push(this.sections.length-1)):S("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Oc(t,n,i,r,a,o,s,l,c,u,h,d,p,f,m){const g=Fc.fromFeature(t,a);let y;d===e.ah.vertical&&g.verticalizePunctuation();const{processBidirectionalText:_,processStyledBidirectionalText:v}=Rr;if(_&&1===g.sections.length){y=[];const e=_(g.toString(),Zc(g,u,o,n,r,f));for(const t of e){const e=new Fc;e.text=t,e.sections=g.sections;for(let n=0;n<t.length;n++)e.sectionIndex.push(0);y.push(e)}}else if(v){y=[];const e=v(g.text,g.sectionIndex,Zc(g,u,o,n,r,f));for(const t of e){const e=new Fc;e.text=t[0],e.sectionIndex=t[1],e.sections=g.sections,y.push(e)}}else y=function(e,t){const n=[],i=e.text;let r=0;for(const a of t)n.push(e.substring(r,a)),r=a;return r<i.length&&n.push(e.substring(r,i.length)),n}(g,Zc(g,u,o,n,r,f));const x=[],b={positionedLines:x,text:g.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(t,n,i,r,a,o,s,l,c,u,h,d){let p=0,f=Dc,m=0,g=0;const y="right"===l?1:"left"===l?0:.5;let _=0;for(const S of a){S.trim();const a=S.getMaxScale(),s=(a-1)*ec,l={positionedGlyphs:[],lineOffset:0};t.positionedLines[_]=l;const x=l.positionedGlyphs;let b=0;if(!S.length()){f+=o,++_;continue}for(let o=0;o<S.length();o++){const l=S.getSection(o),m=S.getSectionIndex(o),g=S.getCharCode(o);let y=0,_=null,w=null,T=null,C=ec;const I=!(c===e.ah.horizontal||!h&&!Ar(g)||h&&(Bc[g]||(v=g,Ir.Arabic(v)||Ir["Arabic Supplement"](v)||Ir["Arabic Extended-A"](v)||Ir["Arabic Presentation Forms-A"](v)||Ir["Arabic Presentation Forms-B"](v))));if(l.imageName){const e=r[l.imageName];if(!e)continue;T=l.imageName,t.iconsInText=t.iconsInText||!0,w=e.paddedRect;const n=e.displaySize;l.scale=l.scale*ec/d,_={width:n[0],height:n[1],left:Ac,top:-Ec,advance:I?n[1]:n[0]},y=s+(ec-n[1]*l.scale),C=_.advance;const i=I?n[0]*l.scale-ec*a:n[1]*l.scale-ec*a;i>0&&i>b&&(b=i)}else{const e=i[l.fontStack],t=e&&e[g];if(t&&t.rect)w=t.rect,_=t.metrics;else{const e=n[l.fontStack],t=e&&e[g];if(!t)continue;_=t.metrics}y=(a-l.scale)*ec}I?(t.verticalizable=!0,x.push({glyph:g,imageName:T,x:p,y:f+y,vertical:I,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:_,rect:w}),p+=C*l.scale+u):(x.push({glyph:g,imageName:T,x:p,y:f+y,vertical:I,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:_,rect:w}),p+=_.advance*l.scale+u)}0!==x.length&&(m=Math.max(p-u,m),Wc(x,0,x.length-1,y,b)),p=0;const w=o*a+b;l.lineOffset=Math.max(b,s),f+=w,g=Math.max(w,g),++_}var v;const x=f-Dc,{horizontalAlign:b,verticalAlign:w}=Gc(s);(function(e,t,n,i,r,a,o,s,l){const c=(t-n)*r;let u=0;u=a!==o?-s*i-Dc:(-i*l+.5)*o;for(const h of e)for(const e of h.positionedGlyphs)e.x+=c,e.y+=u})(t.positionedLines,y,b,w,m,g,o,x,a.length),t.top+=-w*x,t.bottom=t.top+x,t.left+=-b*m,t.right=t.left+m}(b,n,i,r,y,s,l,c,d,u,p,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&b}const Bc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Nc={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Vc={40:!0};function Uc(e,t,n,i,r,a){if(t.imageName){const e=i[t.imageName];return e?e.displaySize[0]*t.scale*ec/a+r:0}{const i=n[t.fontStack],a=i&&i[e];return a?a.metrics.advance*t.scale+r:0}}function jc(e,t,n,i){const r=Math.pow(e-t,2);return i?e<t?r/2:2*r:r+Math.abs(n)*n}function $c(e,t,n){let i=0;return 10===e&&(i-=1e4),n&&(i+=150),40!==e&&65288!==e||(i+=50),41!==t&&65289!==t||(i+=50),i}function Hc(e,t,n,i,r,a){let o=null,s=jc(t,n,r,a);for(const l of i){const e=jc(t-l.x,n,r,a)+l.badness;e<=s&&(o=l,s=e)}return{index:e,x:t,priorBreak:o,badness:s}}function qc(e){return e?qc(e.priorBreak).concat(e.index):[]}function Zc(e,t,n,i,r,a){if(!e)return[];const o=[],s=function(e,t,n,i,r,a){let o=0;for(let s=0;s<e.length();s++){const n=e.getSection(s);o+=Uc(e.getCharCode(s),n,i,r,t,a)}return o/Math.max(1,Math.ceil(o/n))}(e,t,n,i,r,a),l=e.text.indexOf("\u200b")>=0;let c=0;for(let h=0;h<e.length();h++){const n=e.getSection(h),d=e.getCharCode(h);if(Bc[d]||(c+=Uc(d,n,i,r,t,a)),h<e.length()-1){const t=!((u=d)<11904||!(Ir["Bopomofo Extended"](u)||Ir.Bopomofo(u)||Ir["CJK Compatibility Forms"](u)||Ir["CJK Compatibility Ideographs"](u)||Ir["CJK Compatibility"](u)||Ir["CJK Radicals Supplement"](u)||Ir["CJK Strokes"](u)||Ir["CJK Symbols and Punctuation"](u)||Ir["CJK Unified Ideographs Extension A"](u)||Ir["CJK Unified Ideographs"](u)||Ir["Enclosed CJK Letters and Months"](u)||Ir["Halfwidth and Fullwidth Forms"](u)||Ir.Hiragana(u)||Ir["Ideographic Description Characters"](u)||Ir["Kangxi Radicals"](u)||Ir["Katakana Phonetic Extensions"](u)||Ir.Katakana(u)||Ir["Vertical Forms"](u)||Ir["Yi Radicals"](u)||Ir["Yi Syllables"](u)));(Nc[d]||t||n.imageName||h!==e.length()-2&&Vc[e.getCharCode(h+1)])&&o.push(Hc(h+1,c,s,o,$c(d,e.getCharCode(h+1),t&&l),!1))}}var u;return qc(Hc(e.length(),c,s,o,0,!0))}function Gc(e){let t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Wc(e,t,n,i,r){if(!i&&!r)return;const a=e[n],o=(e[n].x+a.metrics.advance*a.scale)*i;for(let s=t;s<=n;s++)e[s].x-=o,e[s].y+=r}function Kc(e,t,n){const{horizontalAlign:i,verticalAlign:r}=Gc(n),a=t[0]-e.displaySize[0]*i,o=t[1]-e.displaySize[1]*r;return{image:e,top:o,bottom:o+e.displaySize[1],left:a,right:a+e.displaySize[0]}}function Xc(e){var t,n;let i=e.left,r=e.top,a=e.right-i,o=e.bottom-r;const s=null!==(t=e.image.textFitWidth)&&void 0!==t?t:"stretchOrShrink",l=null!==(n=e.image.textFitHeight)&&void 0!==n?n:"stretchOrShrink",c=(e.image.content[2]-e.image.content[0])/(e.image.content[3]-e.image.content[1]);if("proportional"===l){if("stretchOnly"===s&&a/o<c||"proportional"===s){const e=Math.ceil(o*c);i*=e/a,a=e}}else if("proportional"===s&&"stretchOnly"===l&&0!==c&&a/o>c){const e=Math.ceil(a/c);r*=e/o,o=e}return{x1:i,y1:r,x2:i+a,y2:r+o}}function Yc(e,t,n,i,r,a){const o=e.image;let s;if(o.content){const e=o.content,t=o.pixelRatio||1;s=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}const l=t.left*a,c=t.right*a;let u,h,d,p;"width"===n||"both"===n?(p=r[0]+l-i[3],h=r[0]+c+i[1]):(p=r[0]+(l+c-o.displaySize[0])/2,h=p+o.displaySize[0]);const f=t.top*a,m=t.bottom*a;return"height"===n||"both"===n?(u=r[1]+f-i[0],d=r[1]+m+i[2]):(u=r[1]+(f+m-o.displaySize[1])/2,d=u+o.displaySize[1]),{image:o,top:u,right:h,bottom:d,left:p,collisionPadding:s}}const Jc=255,Qc=128,eu=Jc*Qc;function tu(e,t){const{expression:n}=t;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new Fr(e+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:i}=n;let r=0;for(;r<t.length&&t[r]<=e;)r++;r=Math.max(0,r-1);let a=r;for(;a<t.length&&t[a]<e+1;)a++;a=Math.min(t.length-1,a);const o=t[r],s=t[a];return"composite"===n.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:i}:{kind:"camera",minZoom:o,maxZoom:s,minSize:n.evaluate(new Fr(o)),maxSize:n.evaluate(new Fr(s)),interpolationType:i}}}function nu(e,t,n){let i="never";const r=e.get(t);return r?i=r:e.get(n)&&(i="always"),i}const iu=cl.VectorTileFeature.types,ru=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function au(e,t,n,i,r,a,o,s,l,c,u,h,d){const p=s?Math.min(eu,Math.round(s[0])):0,f=s?Math.min(eu,Math.round(s[1])):0;e.emplaceBack(t,n,Math.round(32*i),Math.round(32*r),a,o,(p<<1)+(l?1:0),f,16*c,16*u,256*h,256*d)}function ou(e,t,n){e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n)}function su(e){for(const t of e.sections)if(Dr(t.text))return!0;return!1}class lu{constructor(e){this.layoutVertexArray=new Za,this.indexArray=new Ya,this.programConfigurations=e,this.segments=new to,this.dynamicLayoutVertexArray=new Ga,this.opacityVertexArray=new Wa,this.hasVisibleVertices=!1,this.placedSymbolArray=new Aa}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gl.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Wl.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ru,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}br("SymbolBuffers",lu);class cu{constructor(e,t,n){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new n,this.segments=new to,this.collisionVertexArray=new Xa}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Kl.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}br("CollisionBuffers",cu);class uu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=is([]),this.placementViewportMatrix=is([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tu(this.zoom,n["text-size"]),this.iconSizeData=tu(this.zoom,n["icon-size"]);const i=this.layers[0].layout,r=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap="never"!==nu(i,"text-overlap","text-allow-overlap")||"never"!==nu(i,"icon-overlap","icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!r.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map((t=>e.ah[t]))),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=t.sourceID}createArrays(){this.text=new lu(new Eo(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new lu(new Eo(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new La,this.lineVertexArray=new Da,this.symbolInstances=new za,this.textAnchorOffsets=new Fa}calculateGlyphDependencies(e,t,n,i,r){for(let a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,(n||i)&&r){const n=Ql[e.charAt(a)];n&&(t[n.charCodeAt(0)]=!0)}}populate(t,n,i){const r=this.layers[0],a=r.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),c=("constant"!==s.value.kind||s.value.value instanceof Xe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!c&&!u)return;const d=n.iconDependencies,p=n.glyphDependencies,f=n.availableImages,m=new Fr(this.zoom);for(const{feature:g,id:y,index:_,sourceLayerIndex:v}of t){const t=r._featureFilter.needGeometry,n=Ro(g,t);if(!r._featureFilter.filter(m,n,i))continue;let s,l;if(t||(n.geometry=Do(g)),c){const e=r.getValueAndResolveTokens("text-field",n,i,f),t=Xe.factory(e),a=this.hasRTLText=this.hasRTLText||su(t);(!a||"unavailable"===Rr.getRTLTextPluginStatus()||a&&Rr.isParsed())&&(s=Jl(t,r,n))}if(u){const e=r.getValueAndResolveTokens("icon-image",n,i,f);l=e instanceof et?e:et.fromString(e)}if(!s&&!l)continue;const x=this.sortFeaturesByKey?h.evaluate(n,{},i):void 0;if(this.features.push({id:y,text:s,icon:l,index:_,sourceLayerIndex:v,geometry:n.geometry,properties:g.properties,type:iu[g.type],sortKey:x}),l&&(d[l.name]=!0),s){const t=o.evaluate(n,{},i).join(","),r="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.ah.vertical)>=0;for(const e of s.sections)if(e.image)d[e.image.name]=!0;else{const n=kr(s.toString()),i=e.fontStack||t,a=p[i]=p[i]||{};this.calculateGlyphDependencies(e.text,a,r,this.allowVerticalPlacement,n)}}}"line"===a.get("symbol-placement")&&(this.features=function(e){const t={},n={},i=[];let r=0;function a(t){i.push(e[t]),r++}function o(e,t,r){const a=n[e];return delete n[e],n[t]=a,i[a].geometry[0].pop(),i[a].geometry[0]=i[a].geometry[0].concat(r[0]),a}function s(e,n,r){const a=t[n];return delete t[n],t[e]=a,i[a].geometry[0].shift(),i[a].geometry[0]=r[0].concat(i[a].geometry[0]),a}function l(e,t,n){const i=n?t[0][t[0].length-1]:t[0][0];return`${e}:${i.x}:${i.y}`}for(let c=0;c<e.length;c++){const u=e[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){a(c);continue}const p=l(d,h),f=l(d,h,!0);if(p in n&&f in t&&n[p]!==t[f]){const e=s(p,f,h),r=o(p,f,i[e].geometry);delete t[p],delete n[f],n[l(d,i[r].geometry,!0)]=r,i[e].geometry=null}else p in n?o(p,f,h):f in t?s(p,f,h):(a(c),t[p]=r-1,n[f]=r-1)}return i.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const n=this.lineVertexArray.length;if(void 0!==e.segment){let n=e.dist(t[e.segment+1]),i=e.dist(t[e.segment]);const r={};for(let a=e.segment+1;a<t.length;a++)r[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:n},a<t.length-1&&(n+=t[a+1].dist(t[a]));for(let a=e.segment||0;a>=0;a--)r[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:i},a>0&&(i+=t[a-1].dist(t[a]));for(let e=0;e<t.length;e++){const t=r[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,n,i,r,a,o,s,l,c,u,h,d){const p=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*n.length,f,p,this.canOverlap?o.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,_=this.allowVerticalPlacement&&s===e.ah.vertical?Math.PI/2:0,v=o.text&&o.text.sections;for(let e=0;e<n.length;e++){const{tl:r,tr:a,bl:s,br:c,tex:u,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:y,minFontScaleY:x,glyphOffset:b,isSDF:w,sectionIndex:S}=n[e],T=m.vertexLength,C=b[1];au(f,l.x,l.y,r.x,C+r.y,u.x,u.y,i,w,h.x,h.y,y,x),au(f,l.x,l.y,a.x,C+a.y,u.x+u.w,u.y,i,w,g.x,h.y,y,x),au(f,l.x,l.y,s.x,C+s.y,u.x,u.y+u.h,i,w,h.x,g.y,y,x),au(f,l.x,l.y,c.x,C+c.y,u.x+u.w,u.y+u.h,i,w,g.x,g.y,y,x),ou(t.dynamicLayoutVertexArray,l,_),p.emplaceBack(T,T+1,T+2),p.emplaceBack(T+1,T+2,T+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),e!==n.length-1&&S===n[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,o,o.index,{},d,v&&v[S])}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,c,u,l.segment,i?i[0]:0,i?i[1]:0,r[0],r[1],s,0,!1,0,h)}_addCollisionDebugVertex(e,t,n,i,r,a){return t.emplaceBack(0,0),e.emplaceBack(n.x,n.y,i,r,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,t,n,i,r,o,s){const l=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),c=l.vertexLength,u=r.layoutVertexArray,h=r.collisionVertexArray,d=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(u,h,o,d,p,new a(e,t)),this._addCollisionDebugVertex(u,h,o,d,p,new a(n,t)),this._addCollisionDebugVertex(u,h,o,d,p,new a(n,i)),this._addCollisionDebugVertex(u,h,o,d,p,new a(e,i)),l.vertexLength+=4;const f=r.indexArray;f.emplaceBack(c,c+1),f.emplaceBack(c+1,c+2),f.emplaceBack(c+2,c+3),f.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,n,i){for(let r=e;r<t;r++){const e=this.collisionBoxArray.get(r);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,i?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cu(Ka,Xl.members,Ja),this.iconCollisionBox=new cu(Ka,Xl.members,Ja);for(let e=0;e<this.symbolInstances.length;e++){const t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,n,i,r,a,o,s,l){const c={};for(let u=t;u<n;u++){const t=e.get(u);c.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.textFeatureIndex=t.featureIndex;break}for(let u=i;u<r;u++){const t=e.get(u);c.verticalTextBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.verticalTextFeatureIndex=t.featureIndex;break}for(let u=a;u<o;u++){const t=e.get(u);c.iconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.iconFeatureIndex=t.featureIndex;break}for(let u=s;u<l;u++){const t=e.get(u);c.verticalIconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},c.verticalIconFeatureIndex=t.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const n=e.placedSymbolArray.get(t),i=n.vertexStartIndex+4*n.numGlyphs;for(let r=n.vertexStartIndex;r<i;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),n=Math.cos(e),i=[],r=[],a=[];for(let o=0;o<this.symbolInstances.length;++o){a.push(o);const e=this.symbolInstances.get(o);i.push(0|Math.round(t*e.anchorX+n*e.anchorY)),r.push(e.featureIndex)}return a.sort(((e,t)=>i[e]-i[t]||r[t]-r[e])),a}addToSortKeyRanges(e,t){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===t?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach(((e,t,n)=>{e>=0&&n.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)})),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let hu,du;br("SymbolBucket",uu,{omit:["layers","collisionBoxArray","features","compareText"]}),uu.MAX_GLYPHS=65535,uu.addDynamicAttributes=ou;var pu={get paint(){return du=du||new Xr({"icon-opacity":new Zr(Z.paint_symbol["icon-opacity"]),"icon-color":new Zr(Z.paint_symbol["icon-color"]),"icon-halo-color":new Zr(Z.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zr(Z.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zr(Z.paint_symbol["icon-halo-blur"]),"icon-translate":new qr(Z.paint_symbol["icon-translate"]),"icon-translate-anchor":new qr(Z.paint_symbol["icon-translate-anchor"]),"text-opacity":new Zr(Z.paint_symbol["text-opacity"]),"text-color":new Zr(Z.paint_symbol["text-color"],{runtimeType:de,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Zr(Z.paint_symbol["text-halo-color"]),"text-halo-width":new Zr(Z.paint_symbol["text-halo-width"]),"text-halo-blur":new Zr(Z.paint_symbol["text-halo-blur"]),"text-translate":new qr(Z.paint_symbol["text-translate"]),"text-translate-anchor":new qr(Z.paint_symbol["text-translate-anchor"])})},get layout(){return hu=hu||new Xr({"symbol-placement":new qr(Z.layout_symbol["symbol-placement"]),"symbol-spacing":new qr(Z.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qr(Z.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zr(Z.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qr(Z.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new qr(Z.layout_symbol["icon-allow-overlap"]),"icon-overlap":new qr(Z.layout_symbol["icon-overlap"]),"icon-ignore-placement":new qr(Z.layout_symbol["icon-ignore-placement"]),"icon-optional":new qr(Z.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qr(Z.layout_symbol["icon-rotation-alignment"]),"icon-size":new Zr(Z.layout_symbol["icon-size"]),"icon-text-fit":new qr(Z.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qr(Z.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zr(Z.layout_symbol["icon-image"]),"icon-rotate":new Zr(Z.layout_symbol["icon-rotate"]),"icon-padding":new Zr(Z.layout_symbol["icon-padding"]),"icon-keep-upright":new qr(Z.layout_symbol["icon-keep-upright"]),"icon-offset":new Zr(Z.layout_symbol["icon-offset"]),"icon-anchor":new Zr(Z.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qr(Z.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qr(Z.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qr(Z.layout_symbol["text-rotation-alignment"]),"text-field":new Zr(Z.layout_symbol["text-field"]),"text-font":new Zr(Z.layout_symbol["text-font"]),"text-size":new Zr(Z.layout_symbol["text-size"]),"text-max-width":new Zr(Z.layout_symbol["text-max-width"]),"text-line-height":new qr(Z.layout_symbol["text-line-height"]),"text-letter-spacing":new Zr(Z.layout_symbol["text-letter-spacing"]),"text-justify":new Zr(Z.layout_symbol["text-justify"]),"text-radial-offset":new Zr(Z.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qr(Z.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Zr(Z.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Zr(Z.layout_symbol["text-anchor"]),"text-max-angle":new qr(Z.layout_symbol["text-max-angle"]),"text-writing-mode":new qr(Z.layout_symbol["text-writing-mode"]),"text-rotate":new Zr(Z.layout_symbol["text-rotate"]),"text-padding":new qr(Z.layout_symbol["text-padding"]),"text-keep-upright":new qr(Z.layout_symbol["text-keep-upright"]),"text-transform":new Zr(Z.layout_symbol["text-transform"]),"text-offset":new Zr(Z.layout_symbol["text-offset"]),"text-allow-overlap":new qr(Z.layout_symbol["text-allow-overlap"]),"text-overlap":new qr(Z.layout_symbol["text-overlap"]),"text-ignore-placement":new qr(Z.layout_symbol["text-ignore-placement"]),"text-optional":new qr(Z.layout_symbol["text-optional"])})}};class fu{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:le,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}br("FormatSectionOverride",fu,{omit:["defaultValue"]});class mu extends Jr{constructor(e){super(e,pu)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const e=this.layout.get("text-writing-mode");if(e){const t=[];for(const n of e)t.indexOf(n)<0&&t.push(n);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,n,i){const r=this.layout.get(e).evaluate(t,{},n,i),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||xi(a.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,((t,n)=>e&&n in e?String(e[n]):""))}(t.properties,r)}createBucket(e){return new uu(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of pu.paint.overridableProperties){if(!mu.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),n=new fu(t),i=new vi(n,t.property.specification);let r=null;r="constant"===t.value.kind||"source"===t.value.kind?new wi("source",i):new Si("composite",i,t.value.zoomStops),this.paint._values[e]=new $r(t.property,r,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven())&&mu.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const n=e.get("text-field"),i=pu.paint.properties[t];let r=!1;const a=e=>{for(const t of e)if(i.overrides&&i.overrides.hasOverride(t))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof Xe)a(n.value.value.sections);else if("source"===n.value.kind){const e=t=>{r||(t instanceof at&&it(t.value)===ge?a(t.value.sections):t instanceof qt?a(t.sections):t.eachChild(e))},t=n.value;t._styleExpression&&e(t._styleExpression.expression)}return r}}let gu;var yu={get paint(){return gu=gu||new Xr({"background-color":new qr(Z.paint_background["background-color"]),"background-pattern":new Wr(Z.paint_background["background-pattern"]),"background-opacity":new qr(Z.paint_background["background-opacity"])})}};class _u extends Jr{constructor(e){super(e,yu)}}let vu;var xu={get paint(){return vu=vu||new Xr({"raster-opacity":new qr(Z.paint_raster["raster-opacity"]),"raster-hue-rotate":new qr(Z.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qr(Z.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qr(Z.paint_raster["raster-brightness-max"]),"raster-saturation":new qr(Z.paint_raster["raster-saturation"]),"raster-contrast":new qr(Z.paint_raster["raster-contrast"]),"raster-resampling":new qr(Z.paint_raster["raster-resampling"]),"raster-fade-duration":new qr(Z.paint_raster["raster-fade-duration"])})}};class bu extends Jr{constructor(e){super(e,xu)}}class wu extends Jr{constructor(e){super(e,{}),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Su{constructor(e){this._methodToThrottle=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Tu=6371008.8;class Cu{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Cu(g(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,n=this.lat*t,i=e.lat*t,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*t);return Tu*Math.acos(Math.min(r,1))}static convert(e){if(e instanceof Cu)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Cu(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Cu(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Iu=2*Math.PI*Tu;function ku(e){return Iu*Math.cos(e*Math.PI/180)}function Eu(e){return(180+e)/360}function Pu(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Au(e,t){return e/ku(t)}function Mu(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}class zu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+e,this.y=+t,this.z=+n}static fromLngLat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Cu.convert(e);return new zu(Eu(n.lng),Pu(n.lat),Au(t,n.lat))}toLngLat(){return new Cu(360*this.x-180,Mu(this.y))}toAltitude(){return this.z*ku(Mu(this.y))}meterInMercatorCoordinateUnits(){return 1/Iu*(e=Mu(this.y),1/Math.cos(e*Math.PI/180));var e}}function Lu(e,t,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[e*i-2*Math.PI*6378137/2,t*i-2*Math.PI*6378137/2]}class Du{constructor(e,t,n){if(e<0||e>25||n<0||n>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error(`x=${t}, y=${n}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=n,this.key=Ou(0,e,e,t,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,n){const i=(a=this.y,o=this.z,s=Lu(256*(r=this.x),256*(a=Math.pow(2,o)-a-1),o),l=Lu(256*(r+1),256*(a+1),o),s[0]+","+s[1]+","+l[0]+","+l[1]);var r,a,o,s,l;const c=function(e,t,n){let i,r="";for(let a=e;a>0;a--)i=1<<a-1,r+=(t&i?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,i)}isChildOf(e){const t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){const t=Math.pow(2,this.z);return new a((e.x*t-this.x)*Mo,(e.y*t-this.y)*Mo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ru{constructor(e,t){this.wrap=e,this.canonical=t,this.key=Ou(e,t.z,t.z,t.x,t.y)}}class Fu{constructor(e,t,n,i,r){if(e<n)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${n}`);this.overscaledZ=e,this.wrap=t,this.canonical=new Du(n,+i,+r),this.key=Ou(t,e,n,i,r)}clone(){return new Fu(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const t=this.canonical.z-e;return e>this.canonical.z?new Fu(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Fu(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?Ou(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Ou(this.wrap*+t,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new Fu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new Fu(t,this.wrap,t,n,i),new Fu(t,this.wrap,t,n+1,i),new Fu(t,this.wrap,t,n,i+1),new Fu(t,this.wrap,t,n+1,i+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Fu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Fu(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ru(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new zu(e.x-this.wrap,e.y))}}function Ou(e,t,n,i,r){(e*=2)<0&&(e=-1*e-1);const a=1<<n;return(a*a*e+a*r+i).toString(36)+n.toString(36)+t.toString(36)}br("CanonicalTileID",Du),br("OverscaledTileID",Fu,{omit:["posMatrix"]});class Bu{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n))return void S(`"${n}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=t.height;const s=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=r,this.blueFactor=a,this.baseShift=o;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let l=0;l<s;l++)this.data[this._idx(-1,l)]=this.data[this._idx(0,l)],this.data[this._idx(s,l)]=this.data[this._idx(s-1,l)],this.data[this._idx(l,-1)]=this.data[this._idx(l,0)],this.data[this._idx(l,s)]=this.data[this._idx(l,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let l=0;l<s;l++)for(let e=0;e<s;e++){const t=this.get(l,e);t>this.max&&(this.max=t),t<this.min&&(this.min=t)}}get(e,t){const n=new Uint8Array(this.data.buffer),i=4*this._idx(e,t);return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,n){return e*this.redFactor+t*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new ys({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=t*this.dim,r=t*this.dim+this.dim,a=n*this.dim,o=n*this.dim+this.dim;switch(t){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:a=o-1;break;case 1:o=a+1}const s=-t*this.dim,l=-n*this.dim;for(let c=a;c<o;c++)for(let t=i;t<r;t++)this.data[this._idx(t,c)]=e.data[this._idx(t+s,c+l)]}}br("DEMData",Bu);class Nu{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const n=e[t];this._stringToNumber[n]=t,this._numberToString[t]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Vu{constructor(e,t,n,i,r){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=n,e._y=i,this.properties=e.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class Uu{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new vr(Mo,16,0),this.grid3D=new vr(Mo,16,0),this.featureIndexArray=new Ba,this.promoteId=t}insert(e,t,n,i,r,a){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);const s=a?this.grid3D:this.grid;for(let l=0;l<t.length;l++){const e=t[l],n=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const i=e[t];n[0]=Math.min(n[0],i.x),n[1]=Math.min(n[1],i.y),n[2]=Math.max(n[2],i.x),n[3]=Math.max(n[3],i.y)}n[0]<Mo&&n[1]<Mo&&n[2]>=0&&n[3]>=0&&s.insert(o,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new cl.VectorTile(new Sc(this.rawTileData)).layers,this.sourceLayerCoder=new Nu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,n,i){this.loadVTLayers();const r=e.params||{},o=Mo/e.tileSize/e.scale,s=Pi(r.filter),l=e.queryGeometry,c=e.queryPadding*o,u=$u(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c),d=$u(e.cameraQueryGeometry),p=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,((t,n,i,r)=>function(e,t,n,i,r){for(const a of e)if(t<=a.x&&n<=a.y&&i>=a.x&&r>=a.y)return!0;const o=[new a(t,n),new a(t,r),new a(i,r),new a(i,n)];if(e.length>2)for(const a of o)if(Go(e,a))return!0;for(let a=0;a<e.length-1;a++)if(Wo(e[a],e[a+1],o))return!0;return!1}(e.cameraQueryGeometry,t-c,n-c,i+c,r+c)));for(const a of p)h.push(a);h.sort(Hu);const f={};let m;for(let a=0;a<h.length;a++){const c=h[a];if(c===m)continue;m=c;const u=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(f,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,s,r.layers,r.availableImages,t,n,i,((t,n,i)=>(d||(d=Do(t)),n.queryIntersectsFeature(l,t,i,d,this.z,e.transform,o,e.pixelPosMatrix))))}return f}loadMatchingFeature(e,t,n,i,r,a,o,s,l,c,u){const h=this.bucketLayerIDs[t];if(a&&!function(e,t){for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return!0;return!1}(a,h))return;const d=this.sourceLayerCoder.decode(n),p=this.vtLayers[d].feature(i);if(r.needGeometry){const e=Ro(p,!0);if(!r.filter(new Fr(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!r.filter(new Fr(this.tileID.overscaledZ),p))return;const f=this.getId(p,d);for(let m=0;m<h.length;m++){const t=h[m];if(a&&a.indexOf(t)<0)continue;const n=s[t];if(!n)continue;let r={};f&&c&&(r=c.getState(n.sourceLayer||"_geojsonTileLayer",f));const d=y({},l[t]);d.paint=ju(d.paint,n.paint,p,r,o),d.layout=ju(d.layout,n.layout,p,r,o);const g=!u||u(p,n,r);if(!g)continue;const _=new Vu(p,this.z,this.x,this.y,f);_.layer=d;let v=e[t];void 0===v&&(v=e[t]=[]),v.push({featureIndex:i,feature:_,intersectionZ:g})}}lookupSymbolFeatures(e,t,n,i,r,a,o,s){const l={};this.loadVTLayers();const c=Pi(r);for(const u of e)this.loadMatchingFeature(l,n,i,u,c,a,o,s,t);return l}hasLayer(e){for(const t of this.bucketLayerIDs)for(const n of t)if(e===n)return!0;return!1}getId(e,t){let n=e.id;return this.promoteId&&(n=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]],"boolean"==typeof n&&(n=Number(n))),n}}function ju(e,t,n,i,r){return v(e,((e,a)=>{const o=t instanceof Hr?t.get(a):null;return o&&o.evaluate?o.evaluate(n,i,r):o}))}function $u(e){let t=1/0,n=1/0,i=-1/0,r=-1/0;for(const a of e)t=Math.min(t,a.x),n=Math.min(n,a.y),i=Math.max(i,a.x),r=Math.max(r,a.y);return{minX:t,minY:n,maxX:i,maxY:r}}function Hu(e,t){return t-e}function qu(e,t,n,i,r){const o=[];for(let s=0;s<e.length;s++){const l=e[s];let c;for(let e=0;e<l.length-1;e++){let s=l[e],u=l[e+1];s.x<t&&u.x<t||(s.x<t?s=new a(t,s.y+(t-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x<t&&(u=new a(t,s.y+(t-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y<n&&u.y<n||(s.y<n?s=new a(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round():u.y<n&&(u=new a(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round()),s.x>=i&&u.x>=i||(s.x>=i?s=new a(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x>=i&&(u=new a(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y>=r&&u.y>=r||(s.y>=r?s=new a(s.x+(r-s.y)/(u.y-s.y)*(u.x-s.x),r)._round():u.y>=r&&(u=new a(s.x+(r-s.y)/(u.y-s.y)*(u.x-s.x),r)._round()),c&&s.equals(c[c.length-1])||(c=[s],o.push(c)),c.push(u)))))}}return o}br("FeatureIndex",Uu,{omit:["rawTileData","sourceLayerCoder"]});class Zu extends a{constructor(e,t,n,i){super(e,t),this.angle=n,void 0!==i&&(this.segment=i)}clone(){return new Zu(this.x,this.y,this.angle,this.segment)}}function Gu(e,t,n,i,r){if(void 0===t.segment||0===n)return!0;let a=t,o=t.segment+1,s=0;for(;s>-n/2;){if(o--,o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;const l=[];let c=0;for(;s<n/2;){const t=e[o],n=e[o+1];if(!n)return!1;let a=e[o-1].angleTo(t)-t.angleTo(n);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:a}),c+=a;s-l[0].distance>i;)c-=l.shift().angleDelta;if(c>r)return!1;o++,s+=t.dist(n)}return!0}function Wu(e){let t=0;for(let n=0;n<e.length-1;n++)t+=e[n].dist(e[n+1]);return t}function Ku(e,t,n){return e?.6*t*n:0}function Xu(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Yu(e,t,n,i,r,a){const o=Ku(n,r,a),s=Xu(n,i)*a;let l=0;const c=Wu(e)/2;for(let u=0;u<e.length-1;u++){const n=e[u],i=e[u+1],r=n.dist(i);if(l+r>c){const a=(c-l)/r,h=At.number(n.x,i.x,a),d=At.number(n.y,i.y,a),p=new Zu(h,d,i.angleTo(n),u);return p._round(),!o||Gu(e,p,s,o,t)?p:void 0}l+=r}}function Ju(e,t,n,i,r,a,o,s,l){const c=Ku(i,a,o),u=Xu(i,r),h=u*o,d=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),Qu(e,d?t/2*s%t:(u/2+2*a)*o*s%t,t,c,n,h,d,!1,l)}function Qu(e,t,n,i,r,a,o,s,l){const c=a/2,u=Wu(e);let h=0,d=t-n,p=[];for(let f=0;f<e.length-1;f++){const t=e[f],o=e[f+1],s=t.dist(o),m=o.angleTo(t);for(;d+n<h+s;){d+=n;const g=(d-h)/s,y=At.number(t.x,o.x,g),_=At.number(t.y,o.y,g);if(y>=0&&y<l&&_>=0&&_<l&&d-c>=0&&d+c<=u){const t=new Zu(y,_,m,f);t._round(),i&&!Gu(e,t,a,i,r)||p.push(t)}}h+=s}return s||p.length||o||(p=Qu(e,h/2,n,i,r,a,o,!0,l)),p}br("Anchor",Zu);const eh=Ac;function th(e,t,n,i){const r=[],o=e.image,s=o.pixelRatio,l=o.paddedRect.w-2*eh,c=o.paddedRect.h-2*eh;let u={x1:e.left,y1:e.top,x2:e.right,y2:e.bottom};const h=o.stretchX||[[0,l]],d=o.stretchY||[[0,c]],p=(e,t)=>e+t[1]-t[0],f=h.reduce(p,0),m=d.reduce(p,0),g=l-f,y=c-m;let _=0,v=f,x=0,b=m,w=0,S=g,T=0,C=y;if(o.content&&i){const t=o.content,n=t[2]-t[0],i=t[3]-t[1];(o.textFitWidth||o.textFitHeight)&&(u=Xc(e)),_=nh(h,0,t[0]),x=nh(d,0,t[1]),v=nh(h,t[0],t[2]),b=nh(d,t[1],t[3]),w=t[0]-_,T=t[1]-x,S=n-v,C=i-b}const I=u.x1,k=u.y1,E=u.x2-I,P=u.y2-k,A=(e,i,r,l)=>{const c=rh(e.stretch-_,v,E,I),u=ah(e.fixed-w,S,e.stretch,f),h=rh(i.stretch-x,b,P,k),d=ah(i.fixed-T,C,i.stretch,m),p=rh(r.stretch-_,v,E,I),g=ah(r.fixed-w,S,r.stretch,f),y=rh(l.stretch-x,b,P,k),A=ah(l.fixed-T,C,l.stretch,m),M=new a(c,h),z=new a(p,h),L=new a(p,y),D=new a(c,y),R=new a(u/s,d/s),F=new a(g/s,A/s),O=t*Math.PI/180;if(O){const e=Math.sin(O),t=Math.cos(O),n=[t,-e,e,t];M._matMult(n),z._matMult(n),D._matMult(n),L._matMult(n)}const B=e.stretch+e.fixed,N=i.stretch+i.fixed;return{tl:M,tr:z,bl:D,br:L,tex:{x:o.paddedRect.x+eh+B,y:o.paddedRect.y+eh+N,w:r.stretch+r.fixed-B,h:l.stretch+l.fixed-N},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:F,minFontScaleX:S/s/E,minFontScaleY:C/s/P,isSDF:n}};if(i&&(o.stretchX||o.stretchY)){const e=ih(h,g,f),t=ih(d,y,m);for(let n=0;n<e.length-1;n++){const i=e[n],a=e[n+1];for(let e=0;e<t.length-1;e++)r.push(A(i,t[e],a,t[e+1]))}}else r.push(A({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return r}function nh(e,t,n){let i=0;for(const r of e)i+=Math.max(t,Math.min(n,r[1]))-Math.max(t,Math.min(n,r[0]));return i}function ih(e,t,n){const i=[{fixed:-eh,stretch:0}];for(const[r,a]of e){const e=i[i.length-1];i.push({fixed:r-e.stretch,stretch:e.stretch}),i.push({fixed:r-e.stretch,stretch:e.stretch+(a-r)})}return i.push({fixed:t+eh,stretch:n}),i}function rh(e,t,n,i){return e/t*n+i}function ah(e,t,n,i){return e-t*n/i}class oh{constructor(e,t,n,i,r,o,s,l,c,u){var h;if(this.boxStartIndex=e.length,c){let e=o.top,t=o.bottom;const n=o.collisionPadding;n&&(e-=n[1],t+=n[3]);let i=t-e;i>0&&(i=Math.max(10,i),this.circleDiameter=i)}else{const c=(null===(h=o.image)||void 0===h?void 0:h.content)&&(o.image.textFitWidth||o.image.textFitHeight)?Xc(o):{x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};c.y1=c.y1*s-l[0],c.y2=c.y2*s+l[2],c.x1=c.x1*s-l[3],c.x2=c.x2*s+l[1];const d=o.collisionPadding;if(d&&(c.x1-=d[0]*s,c.y1-=d[1]*s,c.x2+=d[2]*s,c.y2+=d[3]*s),u){const e=new a(c.x1,c.y1),t=new a(c.x2,c.y1),n=new a(c.x1,c.y2),i=new a(c.x2,c.y2),r=u*Math.PI/180;e._rotate(r),t._rotate(r),n._rotate(r),i._rotate(r),c.x1=Math.min(e.x,t.x,n.x,i.x),c.x2=Math.max(e.x,t.x,n.x,i.x),c.y1=Math.min(e.y,t.y,n.y,i.y),c.y2=Math.max(e.y,t.y,n.y,i.y)}e.emplaceBack(t.x,t.y,c.x1,c.y1,c.x2,c.y2,n,i,r)}this.boxEndIndex=e.length}}class sh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lh;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,i=t[e];for(;e>0;){const r=e-1>>1,a=t[r];if(n(i,a)>=0)break;t[e]=a,e=r}t[e]=i}_down(e){const{data:t,compare:n}=this,i=this.length>>1,r=t[e];for(;e<i;){let i=1+(e<<1),a=t[i];const o=i+1;if(o<this.length&&n(t[o],a)<0&&(i=o,a=t[o]),n(a,r)>=0)break;t[e]=a,e=i}t[e]=r}}function lh(e,t){return e<t?-1:e>t?1:0}function ch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=1/0,r=1/0,o=-1/0,s=-1/0;const l=e[0];for(let a=0;a<l.length;a++){const e=l[a];(!a||e.x<i)&&(i=e.x),(!a||e.y<r)&&(r=e.y),(!a||e.x>o)&&(o=e.x),(!a||e.y>s)&&(s=e.y)}const c=Math.min(o-i,s-r);let u=c/2;const h=new sh([],uh);if(0===c)return new a(i,r);for(let a=i;a<o;a+=c)for(let t=r;t<s;t+=c)h.push(new hh(a+u,t+u,u,e));let d=function(e){let t=0,n=0,i=0;const r=e[0];for(let a=0,o=r.length,s=o-1;a<o;s=a++){const e=r[a],o=r[s],l=e.x*o.y-o.x*e.y;n+=(e.x+o.x)*l,i+=(e.y+o.y)*l,t+=3*l}return new hh(n/t,i/t,0,e)}(e),p=h.length;for(;h.length;){const i=h.pop();(i.d>d.d||!d.d)&&(d=i,n&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,p)),i.max-d.d<=t||(u=i.h/2,h.push(new hh(i.p.x-u,i.p.y-u,u,e)),h.push(new hh(i.p.x+u,i.p.y-u,u,e)),h.push(new hh(i.p.x-u,i.p.y+u,u,e)),h.push(new hh(i.p.x+u,i.p.y+u,u,e)),p+=4)}return n&&(console.log(`num probes: ${p}`),console.log(`best distance: ${d.d}`)),d.p}function uh(e,t){return t.max-e.max}function hh(e,t,n,i){this.p=new a(e,t),this.h=n,this.d=function(e,t){let n=!1,i=1/0;for(let r=0;r<t.length;r++){const a=t[r];for(let t=0,r=a.length,o=r-1;t<r;o=t++){const r=a[t],s=a[o];r.y>e.y!=s.y>e.y&&e.x<(s.x-r.x)*(e.y-r.y)/(s.y-r.y)+r.x&&(n=!n),i=Math.min(i,qo(e,r,s))}}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}var dh;e.aq=void 0,(dh=e.aq||(e.aq={}))[dh.center=1]="center",dh[dh.left=2]="left",dh[dh.right=3]="right",dh[dh.top=4]="top",dh[dh.bottom=5]="bottom",dh[dh["top-left"]=6]="top-left",dh[dh["top-right"]=7]="top-right",dh[dh["bottom-left"]=8]="bottom-left",dh[dh["bottom-right"]=9]="bottom-right";const ph=7,fh=Number.POSITIVE_INFINITY;function mh(e,t){return t[1]!==fh?function(e,t,n){let i=0,r=0;switch(t=Math.abs(t),n=Math.abs(n),e){case"top-right":case"top-left":case"top":r=n-ph;break;case"bottom-right":case"bottom-left":case"bottom":r=-n+ph}switch(e){case"top-right":case"bottom-right":case"right":i=-t;break;case"top-left":case"bottom-left":case"left":i=t}return[i,r]}(e,t[0],t[1]):function(e,t){let n=0,i=0;t<0&&(t=0);const r=t/Math.SQRT2;switch(e){case"top-right":case"top-left":i=r-ph;break;case"bottom-right":case"bottom-left":i=-r+ph;break;case"bottom":i=-t+ph;break;case"top":i=t-ph}switch(e){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=t;break;case"right":n=-t}return[n,i]}(e,t[0])}function gh(e,t,n){var i;const r=e.layout,a=null===(i=r.get("text-variable-anchor-offset"))||void 0===i?void 0:i.evaluate(t,{},n);if(a){const e=a.values,t=[];for(let n=0;n<e.length;n+=2){const i=t[n]=e[n],r=e[n+1].map((e=>e*ec));i.startsWith("top")?r[1]-=ph:i.startsWith("bottom")&&(r[1]+=ph),t[n+1]=r}return new Qe(t)}const o=r.get("text-variable-anchor");if(o){let i;i=void 0!==e._unevaluatedLayout.getValue("text-radial-offset")?[r.get("text-radial-offset").evaluate(t,{},n)*ec,fh]:r.get("text-offset").evaluate(t,{},n).map((e=>e*ec));const a=[];for(const e of o)a.push(e,mh(e,i));return new Qe(a)}return null}function yh(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _h(t,n,i,r,a,o,s,l,c,u,h){let d=o.textMaxSize.evaluate(n,{});void 0===d&&(d=s);const p=t.layers[0].layout,f=p.get("icon-offset").evaluate(n,{},h),m=xh(i.horizontal),g=s/24,y=t.tilePixelRatio*g,_=t.tilePixelRatio*d/24,v=t.tilePixelRatio*l,x=t.tilePixelRatio*p.get("symbol-spacing"),b=p.get("text-padding")*t.tilePixelRatio,w=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=e.get("icon-padding").evaluate(t,{},n),a=r&&r.values;return[a[0]*i,a[1]*i,a[2]*i,a[3]*i]}(p,n,h,t.tilePixelRatio),T=p.get("text-max-angle")/180*Math.PI,C="viewport"!==p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),I="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),k=p.get("symbol-placement"),E=x/2,P=p.get("icon-text-fit");let A;r&&"none"!==P&&(t.allowVerticalPlacement&&i.vertical&&(A=Yc(r,i.vertical,P,p.get("icon-text-fit-padding"),f,g)),m&&(r=Yc(r,m,P,p.get("icon-text-fit-padding"),f,g)));const M=(l,d)=>{d.x<0||d.x>=Mo||d.y<0||d.y>=Mo||function(t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g,y,_,v,x,b,w,T,C,I){const k=t.addToLineVertexArray(n,i);let E,P,A,M,z=0,L=0,D=0,R=0,F=-1,O=-1;const B={};let N=uo("");if(t.allowVerticalPlacement&&r.vertical){const e=l.layout.get("text-rotate").evaluate(b,{},C)+90;A=new oh(c,n,u,h,d,r.vertical,p,f,m,e),s&&(M=new oh(c,n,u,h,d,s,y,_,m,e))}if(a){const i=l.layout.get("icon-rotate").evaluate(b,{}),r="none"!==l.layout.get("icon-text-fit"),o=th(a,i,T,r),p=s?th(s,i,T,r):void 0;P=new oh(c,n,u,h,d,a,y,_,!1,i),z=4*o.length;const f=t.iconSizeData;let m=null;"source"===f.kind?(m=[Qc*l.layout.get("icon-size").evaluate(b,{})],m[0]>eu&&S(`${t.layerIds[0]}: Value for "icon-size" is >= ${Jc}. Reduce your "icon-size".`)):"composite"===f.kind&&(m=[Qc*w.compositeIconSizes[0].evaluate(b,{},C),Qc*w.compositeIconSizes[1].evaluate(b,{},C)],(m[0]>eu||m[1]>eu)&&S(`${t.layerIds[0]}: Value for "icon-size" is >= ${Jc}. Reduce your "icon-size".`)),t.addSymbols(t.icon,o,m,x,v,b,e.ah.none,n,k.lineStartIndex,k.lineLength,-1,C),F=t.icon.placedSymbolArray.length-1,p&&(L=4*p.length,t.addSymbols(t.icon,p,m,x,v,b,e.ah.vertical,n,k.lineStartIndex,k.lineLength,-1,C),O=t.icon.placedSymbolArray.length-1)}const V=Object.keys(r.horizontal);for(const S of V){const i=r.horizontal[S];if(!E){N=uo(i.text);const e=l.layout.get("text-rotate").evaluate(b,{},C);E=new oh(c,n,u,h,d,i,p,f,m,e)}const a=1===i.positionedLines.length;if(D+=vh(t,n,i,o,l,m,b,g,k,r.vertical?e.ah.horizontal:e.ah.horizontalOnly,a?V:[S],B,F,w,C),a)break}r.vertical&&(R+=vh(t,n,r.vertical,o,l,m,b,g,k,e.ah.vertical,["vertical"],B,O,w,C));const U=E?E.boxStartIndex:t.collisionBoxArray.length,j=E?E.boxEndIndex:t.collisionBoxArray.length,$=A?A.boxStartIndex:t.collisionBoxArray.length,H=A?A.boxEndIndex:t.collisionBoxArray.length,q=P?P.boxStartIndex:t.collisionBoxArray.length,Z=P?P.boxEndIndex:t.collisionBoxArray.length,G=M?M.boxStartIndex:t.collisionBoxArray.length,W=M?M.boxEndIndex:t.collisionBoxArray.length;let K=-1;const X=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;K=X(E,K),K=X(A,K),K=X(P,K),K=X(M,K);const Y=K>-1?1:0;Y&&(K*=I/ec),t.glyphOffsetArray.length>=uu.MAX_GLYPHS&&S("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey);const J=gh(l,b,C),[Q,ee]=function(t,n){const i=t.length,r=null==n?void 0:n.values;if((null==r?void 0:r.length)>0)for(let a=0;a<r.length;a+=2){const n=r[a+1];t.emplaceBack(e.aq[r[a]],n[0],n[1])}return[i,t.length]}(t.textAnchorOffsets,J);t.symbolInstances.emplaceBack(n.x,n.y,B.right>=0?B.right:-1,B.center>=0?B.center:-1,B.left>=0?B.left:-1,B.vertical||-1,F,O,N,U,j,$,H,q,Z,G,W,u,D,R,z,L,Y,0,p,K,Q,ee)}(t,d,l,i,r,a,A,t.layers[0],t.collisionBoxArray,n.index,n.sourceLayerIndex,t.index,y,[b,b,b,b],C,c,v,w,I,f,n,o,u,h,s)};if("line"===k)for(const e of qu(n.geometry,0,0,Mo,Mo)){const n=Ju(e,x,T,i.vertical||m,r,24,_,t.overscaling,Mo);for(const i of n)m&&bh(t,m.text,E,i)||M(e,i)}else if("line-center"===k){for(const e of n.geometry)if(e.length>1){const t=Yu(e,T,i.vertical||m,r,24,_);t&&M(e,t)}}else if("Polygon"===n.type)for(const e of xn(n.geometry,0)){const t=ch(e,16);M(e[0],new Zu(t.x,t.y,0))}else if("LineString"===n.type)for(const e of n.geometry)M(e,new Zu(e[0].x,e[0].y,0));else if("Point"===n.type)for(const e of n.geometry)for(const t of e)M([t],new Zu(t.x,t.y,0))}function vh(e,t,n,i,r,o,s,l,c,u,h,d,p,f,m){const g=function(e,t,n,i,r,o,s,l){const c=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(const h of t.positionedLines)for(const e of h.positionedGlyphs){if(!e.rect)continue;const i=e.rect||{};let o=Ec+1,d=!0,p=1,f=0;const m=(r||l)&&e.vertical,g=e.metrics.advance*e.scale/2;if(l&&t.verticalizable&&(f=h.lineOffset/2-(e.imageName?-(ec-e.metrics.width*e.scale)/2:(e.scale-1)*ec)),e.imageName){const t=s[e.imageName];d=t.sdf,p=t.pixelRatio,o=Ac/p}const y=r?[e.x+g,e.y]:[0,0];let _=r?[0,0]:[e.x+g+n[0],e.y+n[1]-f],v=[0,0];m&&(v=_,_=[0,0]);const x=e.metrics.isDoubleResolution?2:1,b=(e.metrics.left-o)*e.scale-g+_[0],w=(-e.metrics.top-o)*e.scale+_[1],S=b+i.w/x*e.scale/p,T=w+i.h/x*e.scale/p,C=new a(b,w),I=new a(S,w),k=new a(b,T),E=new a(S,T);if(m){const t=new a(-g,g-Dc),n=-Math.PI/2,i=ec/2-g,r=new a(5-Dc-i,-(e.imageName?i:0)),o=new a(...v);C._rotateAround(n,t)._add(r)._add(o),I._rotateAround(n,t)._add(r)._add(o),k._rotateAround(n,t)._add(r)._add(o),E._rotateAround(n,t)._add(r)._add(o)}if(c){const e=Math.sin(c),t=Math.cos(c),n=[t,-e,e,t];C._matMult(n),I._matMult(n),k._matMult(n),E._matMult(n)}const P=new a(0,0),A=new a(0,0);u.push({tl:C,tr:I,bl:k,br:E,tex:i,writingMode:t.writingMode,glyphOffset:y,sectionIndex:e.sectionIndex,isSDF:d,pixelOffsetTL:P,pixelOffsetBR:A,minFontScaleX:0,minFontScaleY:0})}return u}(0,n,l,r,o,s,i,e.allowVerticalPlacement),y=e.textSizeData;let _=null;"source"===y.kind?(_=[Qc*r.layout.get("text-size").evaluate(s,{})],_[0]>eu&&S(`${e.layerIds[0]}: Value for "text-size" is >= ${Jc}. Reduce your "text-size".`)):"composite"===y.kind&&(_=[Qc*f.compositeTextSizes[0].evaluate(s,{},m),Qc*f.compositeTextSizes[1].evaluate(s,{},m)],(_[0]>eu||_[1]>eu)&&S(`${e.layerIds[0]}: Value for "text-size" is >= ${Jc}. Reduce your "text-size".`)),e.addSymbols(e.text,g,_,l,o,s,u,t,c.lineStartIndex,c.lineLength,p,m);for(const a of h)d[a]=e.text.placedSymbolArray.length-1;return 4*g.length}function xh(e){for(const t in e)return e[t];return null}function bh(e,t,n,i){const r=e.compareText;if(t in r){const e=r[t];for(let t=e.length-1;t>=0;t--)if(i.dist(e[t])<n)return!0}else r[t]=[];return r[t].push(i),!1}const wh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Sh{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(1!==i)throw new Error(`Got v${i} data when expected v1.`);const r=wh[15&n];if(!r)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[o]=new Uint32Array(e,4,1);return new Sh(o,a,r,e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,i=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=wh.indexOf(this.ArrayType),a=2*e*this.ArrayType.BYTES_PER_ELEMENT,o=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-o%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+a+o+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Th(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:a,nodeSize:o}=this,s=[0,r.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=o){for(let o=h;o<=u;o++){const s=a[2*o],c=a[2*o+1];s>=e&&s<=n&&c>=t&&c<=i&&l.push(r[o])}continue}const d=h+u>>1,p=a[2*d],f=a[2*d+1];p>=e&&p<=n&&f>=t&&f<=i&&l.push(r[d]),(0===c?e<=p:t<=f)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?n>=p:i>=f)&&(s.push(d+1),s.push(u),s.push(1-c))}return l}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:a}=this,o=[0,i.length-1,0],s=[],l=n*n;for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=a){for(let n=h;n<=u;n++)Eh(r[2*n],r[2*n+1],e,t)<=l&&s.push(i[n]);continue}const d=h+u>>1,p=r[2*d],f=r[2*d+1];Eh(p,f,e,t)<=l&&s.push(i[d]),(0===c?e-n<=p:t-n<=f)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?e+n>=p:t+n>=f)&&(o.push(d+1),o.push(u),o.push(1-c))}return s}}function Th(e,t,n,i,r,a){if(r-i<=n)return;const o=i+r>>1;Ch(e,t,o,i,r,a),Th(e,t,n,i,o-1,1-a),Th(e,t,n,o+1,r,1-a)}function Ch(e,t,n,i,r,a){for(;r>i;){if(r-i>600){const o=r-i+1,s=n-i+1,l=Math.log(o),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(o-c)/o)*(s-o/2<0?-1:1);Ch(e,t,n,Math.max(i,Math.floor(n-s*c/o+u)),Math.min(r,Math.floor(n+(o-s)*c/o+u)),a)}const o=t[2*n+a];let s=i,l=r;for(Ih(e,t,i,n),t[2*r+a]>o&&Ih(e,t,i,r);s<l;){for(Ih(e,t,s,l),s++,l--;t[2*s+a]<o;)s++;for(;t[2*l+a]>o;)l--}t[2*i+a]===o?Ih(e,t,i,l):(l++,Ih(e,t,l,r)),l<=n&&(i=l+1),n<=l&&(r=l-1)}}function Ih(e,t,n,i){kh(e,n,i),kh(t,2*n,2*i),kh(t,2*n+1,2*i+1)}function kh(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function Eh(e,t,n,i){const r=e-n,a=t-i;return r*r+a*a}var Ph;e.be=void 0,(Ph=e.be||(e.be={})).create="create",Ph.load="load",Ph.fullLoad="fullLoad";let Ah=null,Mh=[];const zh=1e3/60,Lh="loadTime",Dh="fullLoadTime",Rh={mark(e){performance.mark(e)},frame(e){const t=e;null!=Ah&&Mh.push(t-Ah),Ah=t},clearMetrics(){Ah=null,Mh=[],performance.clearMeasures(Lh),performance.clearMeasures(Dh);for(const t in e.be)performance.clearMarks(e.be[t])},getPerformanceMetrics(){performance.measure(Lh,e.be.create,e.be.load),performance.measure(Dh,e.be.create,e.be.fullLoad);const t=performance.getEntriesByName(Lh)[0].duration,n=performance.getEntriesByName(Dh)[0].duration,i=Mh.length,r=1/(Mh.reduce(((e,t)=>e+t),0)/i/1e3),a=Mh.filter((e=>e>zh)).reduce(((e,t)=>e+(t-zh)/zh),0);return{loadTime:t,fullLoadTime:n,fps:r,percentDroppedFrames:a/(i+a)*100,totalFrames:i}}};e.$=to,e.A=ns,e.B=function(e){if(null==I){const t=e.navigator?e.navigator.userAgent:null;I=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return I},e.C=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Su((()=>this.process())),this.subscription=function(e,t,n){return e.addEventListener(t,n,!1),{unsubscribe:()=>{e.removeEventListener(t,n,!1)}}}(this.target,"message",(e=>this.receive(e))),this.globalScope=C(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise(((n,i)=>{const r=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[r]={resolve:n,reject:i},t&&t.signal.addEventListener("abort",(()=>{delete this.resolveRejects[r];const t={id:r,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(t)}),{once:!0});const a=[],o=Object.assign(Object.assign({},e),{id:r,sourceMapId:this.mapId,origin:location.origin,data:Sr(e.data,a)});this.target.postMessage(o,{transfer:a})}))}receive(e){const t=e.data,n=t.id;if(!("file://"!==t.origin&&"file://"!==location.origin&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if("<cancel>"===t.type){delete this.tasks[n];const e=this.abortControllers[n];return delete this.abortControllers[n],void(e&&e.abort())}if(C(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(0===this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}processTask(e,n){return t(this,void 0,void 0,(function*(){if("<response>"===n.type){const t=this.resolveRejects[e];if(delete this.resolveRejects[e],!t)return;return void(n.error?t.reject(Tr(n.error)):t.resolve(Tr(n.data)))}if(!this.messageHandlers[n.type])return void this.completeTask(e,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const t=Tr(n.data),i=new AbortController;this.abortControllers[e]=i;try{const r=yield this.messageHandlers[n.type](n.sourceMapId,t,i);this.completeTask(e,null,r)}catch(t){this.completeTask(e,t)}}))}completeTask(e,t,n){const i=[];delete this.abortControllers[e];const r={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Sr(t):null,data:Sr(n,i)};this.target.postMessage(r,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.D=qr,e.E=q,e.F=function(){var e=new ns(16);return ns!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.G=F,e.H=function(e,t,n){var i,r,a,o,s,l,c,u,h,d,p,f,m=n[0],g=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(r=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],p=t[10],f=t[11],e[0]=i=t[0],e[1]=r,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=p,e[11]=f,e[12]=i*m+s*g+h*y+t[12],e[13]=r*m+l*g+d*y+t[13],e[14]=a*m+c*g+p*y+t[14],e[15]=o*m+u*g+f*y+t[15]),e},e.I=Mc,e.J=function(e,t,n){var i=n[0],r=n[1],a=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.K=rs,e.L=function(e,t){const n={};for(let i=0;i<t.length;i++){const r=t[i];r in e&&(n[r]=e[r])}return n},e.M=Cu,e.N=Eu,e.O=Pu,e.P=a,e.Q=Fu,e.R=ys,e.S=h,e.T=Nr,e.U=d,e.V=P,e.W=Mo,e.X=na,e.Y=zu,e.Z=class extends oa{},e._=t,e.a=D,e.a$=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.a0=Du,e.a1=re,e.a2=e=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((n=>{t.onloadstart=()=>{n(t)};for(const i of e){const e=window.document.createElement("source");V(i)||(t.crossOrigin="Anonymous"),e.src=i,t.appendChild(e)}}))},e.a3=function(){return _++},e.a4=Ea,e.a5=uu,e.a6=Pi,e.a7=Ro,e.a8=Fr,e.a9=Vu,e.aA=function(e){if("custom"===e.type)return new wu(e);switch(e.type){case"background":return new _u(e);case"circle":return new ls(e);case"fill":return new al(e);case"fill-extrusion":return new Pl(e);case"heatmap":return new vs(e);case"hillshade":return new ws(e);case"line":return new ql(e);case"raster":return new bu(e);case"symbol":return new mu(e)}},e.aB=b,e.aC=function(e,t){if(!e)return[{command:"setStyle",args:[t]}];let n=[];try{if(!K(e.version,t.version))return[{command:"setStyle",args:[t]}];K(e.center,t.center)||n.push({command:"setCenter",args:[t.center]}),K(e.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),K(e.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),K(e.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),K(e.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),K(e.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),K(e.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),K(e.light,t.light)||n.push({command:"setLight",args:[t.light]}),K(e.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),K(e.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),K(e.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const i={},r=[];!function(e,t,n,i){let r;for(r in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)||J(r,n,i));for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)?K(e[r],t[r])||("geojson"===e[r].type&&"geojson"===t[r].type&&ee(e,t,r)?X(n,{command:"setGeoJSONSourceData",args:[r,t[r].data]}):Q(r,t,n,i)):Y(r,t,n))}(e.sources,t.sources,r,i);const a=[];e.layers&&e.layers.forEach((e=>{"source"in e&&i[e.source]?n.push({command:"removeLayer",args:[e.id]}):a.push(e)})),n=n.concat(r),function(e,t,n){t=t||[];const i=(e=e||[]).map(ne),r=t.map(ne),a=e.reduce(ie,{}),o=t.reduce(ie,{}),s=i.slice(),l=Object.create(null);let c,u,h,d,p;for(let f=0,m=0;f<i.length;f++)c=i[f],Object.prototype.hasOwnProperty.call(o,c)?m++:(X(n,{command:"removeLayer",args:[c]}),s.splice(s.indexOf(c,m),1));for(let f=0,m=0;f<r.length;f++)c=r[r.length-1-f],s[s.length-1-f]!==c&&(Object.prototype.hasOwnProperty.call(a,c)?(X(n,{command:"removeLayer",args:[c]}),s.splice(s.lastIndexOf(c,s.length-m),1)):m++,d=s[s.length-f],X(n,{command:"addLayer",args:[o[c],d]}),s.splice(s.length-f,0,c),l[c]=!0);for(let f=0;f<r.length;f++)if(c=r[f],u=a[c],h=o[c],!l[c]&&!K(u,h))if(K(u.source,h.source)&&K(u["source-layer"],h["source-layer"])&&K(u.type,h.type)){for(p in te(u.layout,h.layout,n,c,null,"setLayoutProperty"),te(u.paint,h.paint,n,c,null,"setPaintProperty"),K(u.filter,h.filter)||X(n,{command:"setFilter",args:[c,h.filter]}),K(u.minzoom,h.minzoom)&&K(u.maxzoom,h.maxzoom)||X(n,{command:"setLayerZoomRange",args:[c,h.minzoom,h.maxzoom]}),u)Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?te(u[p],h[p],n,c,p.slice(6),"setPaintProperty"):K(u[p],h[p])||X(n,{command:"setLayerProperty",args:[c,p,h[p]]}));for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&!Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?te(u[p],h[p],n,c,p.slice(6),"setPaintProperty"):K(u[p],h[p])||X(n,{command:"setLayerProperty",args:[c,p,h[p]]}))}else X(n,{command:"removeLayer",args:[c]}),d=s[s.lastIndexOf(c)+1],X(n,{command:"addLayer",args:[h,d]})}(a,t.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:"setStyle",args:[t]}]}return n},e.aD=function(e){const t=[],n=e.id;return void 0===n&&t.push({message:`layers.${n}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${n}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},e.aE=function e(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(!e(t[i],n[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(!e(t[i],n[i]))return!1;return!0}return t===n},e.aF=v,e.aG=x,e.aH=class extends go{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.aI=yo,e.aJ=class extends go{constructor(e,t){super(e,t),this.current=xo}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.aK=_o,e.aL=class extends go{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.aM=class extends go{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.aN=vo,e.aO=function(e,t,n,i,r,a,o){var s=1/(t-n),l=1/(i-r),c=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(r+i)*l,e[14]=(o+a)*c,e[15]=1,e},e.aP=Ge,e.aQ=os,e.aR=class extends ga{},e.aS=Yl,e.aT=class extends _a{},e.aU=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.aV=_s,e.aW=Na,e.aX=class extends Ca{},e.aY=Ya,e.aZ=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},e.a_=function(e,t){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],_=t[0],v=t[1],x=t[2],b=t[3],w=t[4],S=t[5],T=t[6],C=t[7],I=t[8],k=t[9],E=t[10],P=t[11],A=t[12],M=t[13],z=t[14],L=t[15];return Math.abs(n-_)<=ts*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-v)<=ts*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(r-x)<=ts*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-b)<=ts*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-w)<=ts*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-S)<=ts*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-T)<=ts*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-C)<=ts*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-I)<=ts*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(h-k)<=ts*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(d-E)<=ts*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(p-P)<=ts*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(f-A)<=ts*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(m-M)<=ts*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(g-z)<=ts*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(y-L)<=ts*Math.max(1,Math.abs(y),Math.abs(L))},e.aa=function(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,n,i,r)=>{const a=i||r;return t[n]=!a||a.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t},e.ab=function(e,t){const n=[];for(const i in e)i in t||n.push(i);return n},e.ac=m,e.ad=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),a=t[0],o=t[1],s=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r+c*i,e[1]=o*r+u*i,e[2]=s*r+h*i,e[3]=l*r+d*i,e[4]=c*r-a*i,e[5]=u*r-o*i,e[6]=h*r-s*i,e[7]=d*r-l*i,e},e.ae=function(e){var t=new ns(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.af=ss,e.ag=function(e,t){let n=0,i=0;if("constant"===e.kind)i=e.layoutSize;else if("source"!==e.kind){const{interpolationType:r,minZoom:a,maxZoom:o}=e,s=r?m(Mt.interpolationFactor(r,t,a,o),0,1):0;"camera"===e.kind?i=At.number(e.minSize,e.maxSize,s):n=s}return{uSizeT:n,uSize:i}},e.ai=function(e,t,n){let{uSize:i,uSizeT:r}=t,{lowerSize:a,upperSize:o}=n;return"source"===e.kind?a/Qc:"composite"===e.kind?At.number(a/Qc,o/Qc,r):i},e.aj=ou,e.ak=function(e,t,n,i){const r=t.y-e.y,o=t.x-e.x,s=i.y-n.y,l=i.x-n.x,c=s*o-l*r;if(0===c)return null;const u=(l*(e.y-n.y)-s*(e.x-n.x))/c;return new a(e.x+u*o,e.y+u*r)},e.al=qu,e.am=Bo,e.an=is,e.ao=function(e){let t=1/0,n=1/0,i=-1/0,r=-1/0;for(const a of e)t=Math.min(t,a.x),n=Math.min(n,a.y),i=Math.max(i,a.x),r=Math.max(r,a.y);return[t,n,i,r]},e.ap=ec,e.ar=nu,e.as=function(e,t){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],_=n*s-i*o,v=n*l-r*o,x=n*c-a*o,b=i*l-r*s,w=i*c-a*s,S=r*c-a*l,T=u*m-h*f,C=u*g-d*f,I=u*y-p*f,k=h*g-d*m,E=h*y-p*m,P=d*y-p*g,A=_*P-v*E+x*k+b*I-w*C+S*T;return A?(e[0]=(s*P-l*E+c*k)*(A=1/A),e[1]=(r*E-i*P-a*k)*A,e[2]=(m*S-g*w+y*b)*A,e[3]=(d*w-h*S-p*b)*A,e[4]=(l*I-o*P-c*C)*A,e[5]=(n*P-r*I+a*C)*A,e[6]=(g*x-f*S-y*v)*A,e[7]=(u*S-d*x+p*v)*A,e[8]=(o*E-s*I+c*T)*A,e[9]=(i*I-n*E-a*T)*A,e[10]=(f*w-m*x+y*_)*A,e[11]=(h*x-u*w-p*_)*A,e[12]=(s*C-o*k-l*T)*A,e[13]=(n*k-i*C+r*T)*A,e[14]=(m*v-f*b-g*_)*A,e[15]=(u*b-h*v+d*_)*A,e):null},e.at=yh,e.au=Gc,e.av=Sh,e.aw=function(){const e={},t=Z.$version;for(const n in Z.$root){const i=Z.$root[n];if(i.required){let r=null;r="version"===n?t:"array"===i.type?[]:{},null!=r&&(e[n]=r)}}return e},e.ax=Cr,e.ay=B,e.az=function(e){e=e.slice();const t=Object.create(null);for(let n=0;n<e.length;n++)t[e[n].id]=e[n];for(let n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=W(e[n],t[e[n].ref]));return e},e.b=k,e.b0=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},e.b1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.b2=g,e.b3=Ru,e.b4=Au,e.b5=function(e,t,n,i,r){var a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+i)*(a=1/(i-r)),e[14]=2*r*i*a):(e[10]=-1,e[14]=-2*i),e},e.b6=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*r+c*i,e[5]=o*r+u*i,e[6]=s*r+h*i,e[7]=l*r+d*i,e[8]=c*r-a*i,e[9]=u*r-o*i,e[10]=h*r-s*i,e[11]=d*r-l*i,e},e.b7=p,e.b8=f,e.b9=function(e){return e*Math.PI/180},e.bA=bi,e.bB=Rr,e.ba=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.bb=class extends aa{},e.bc=Tu,e.bd=Rh,e.bf=O,e.bg=function(e,t){D.REGISTERED_PROTOCOLS[e]=t},e.bh=function(e){delete D.REGISTERED_PROTOCOLS[e]},e.bi=function(e,t){const n={};for(let r=0;r<e.length;r++){const i=t&&t[e[r].id]||Bi(e[r]);t&&(t[e[r].id]=i);let a=n[i];a||(a=n[i]=[]),a.push(e[r])}const i=[];for(const r in n)i.push(n[r]);return i},e.bj=br,e.bk=Nu,e.bl=Uu,e.bm=zc,e.bn=function(t){t.bucket.createArrays(),t.bucket.tilePixelRatio=Mo/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;const n=t.bucket.layers[0],i=n.layout,r=n._unevaluatedLayout._values,a={layoutIconSize:r["icon-size"].possiblyEvaluate(new Fr(t.bucket.zoom+1),t.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new Fr(t.bucket.zoom+1),t.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new Fr(18))};if("composite"===t.bucket.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.bucket.textSizeData;a.compositeTextSizes=[r["text-size"].possiblyEvaluate(new Fr(e),t.canonical),r["text-size"].possiblyEvaluate(new Fr(n),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.bucket.iconSizeData;a.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new Fr(e),t.canonical),r["icon-size"].possiblyEvaluate(new Fr(n),t.canonical)]}const o=i.get("text-line-height")*ec,s="viewport"!==i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement"),l=i.get("text-keep-upright"),c=i.get("text-size");for(const u of t.bucket.features){const r=i.get("text-font").evaluate(u,{},t.canonical).join(","),h=c.evaluate(u,{},t.canonical),d=a.layoutTextSize.evaluate(u,{},t.canonical),p=a.layoutIconSize.evaluate(u,{},t.canonical),f={horizontal:{},vertical:void 0},m=u.text;let g,y=[0,0];if(m){const a=m.toString(),c=i.get("text-letter-spacing").evaluate(u,{},t.canonical)*ec,p=Er(a)?c:0,g=i.get("text-anchor").evaluate(u,{},t.canonical),_=gh(n,u,t.canonical);if(!_){const e=i.get("text-radial-offset").evaluate(u,{},t.canonical);y=e?mh(g,[e*ec,fh]):i.get("text-offset").evaluate(u,{},t.canonical).map((e=>e*ec))}let v=s?"center":i.get("text-justify").evaluate(u,{},t.canonical);const x="point"===i.get("symbol-placement")?i.get("text-max-width").evaluate(u,{},t.canonical)*ec:1/0,b=()=>{t.bucket.allowVerticalPlacement&&kr(a)&&(f.vertical=Oc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,x,o,g,"left",p,y,e.ah.vertical,!0,d,h))};if(!s&&_){const n=new Set;if("auto"===v)for(let e=0;e<_.values.length;e+=2)n.add(yh(_.values[e]));else n.add(v);let i=!1;for(const a of n)if(!f.horizontal[a])if(i)f.horizontal[a]=f.horizontal[0];else{const n=Oc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,x,o,"center",a,p,y,e.ah.horizontal,!1,d,h);n&&(f.horizontal[a]=n,i=1===n.positionedLines.length)}b()}else{"auto"===v&&(v=yh(g));const n=Oc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,x,o,g,v,p,y,e.ah.horizontal,!1,d,h);n&&(f.horizontal[v]=n),b(),kr(a)&&s&&l&&(f.vertical=Oc(m,t.glyphMap,t.glyphPositions,t.imagePositions,r,x,o,g,v,p,y,e.ah.vertical,!1,d,h))}}let _=!1;if(u.icon&&u.icon.name){const e=t.imageMap[u.icon.name];e&&(g=Kc(t.imagePositions[u.icon.name],i.get("icon-offset").evaluate(u,{},t.canonical),i.get("icon-anchor").evaluate(u,{},t.canonical)),_=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=_:t.bucket.sdfIcons!==_&&S("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==i.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}const v=xh(f.horizontal)||f.vertical;t.bucket.iconsInText=!!v&&v.iconsInText,(v||g)&&_h(t.bucket,u,f,g,t.imageMap,a,d,p,y,_,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.bo=Nl,e.bp=tl,e.bq=Tl,e.br=cl,e.bs=Sc,e.bt=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.bu=function(e,n,i,r,a){return t(this,void 0,void 0,(function*(){if(d())try{return yield P(e,n,i,r,a)}catch(e){}return function(e,t,n,i,r){const a=e.width,o=e.height;A&&M||(A=new OffscreenCanvas(a,o),M=A.getContext("2d",{willReadFrequently:!0})),A.width=a,A.height=o,M.drawImage(e,0,0,a,o);const s=M.getImageData(t,n,i,r);return M.clearRect(0,0,a,o),s.data}(e,n,i,r,a)}))},e.bv=Bu,e.bw=n,e.bx=i,e.by=tc,e.bz=function(e){return e.message===z},e.c=L,e.d=e=>t(void 0,void 0,void 0,(function*(){if(0===e.byteLength)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(e)],{type:"image/png"});try{return createImageBitmap(t)}catch(e){throw new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),e.e=y,e.f=e=>new Promise(((t,n)=>{const i=new Image;i.onload=()=>{t(i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame((()=>{i.src=E}))},i.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(e)],{type:"image/png"});i.src=e.byteLength?URL.createObjectURL(r):E})),e.g=R,e.h=(e,t)=>N(y(e,{type:"json"}),t),e.i=C,e.j=H,e.k=$,e.l=(e,t)=>N(y(e,{type:"arrayBuffer"}),t),e.m=N,e.n=function(e){return new Sc(e).readFields(Cc,[])},e.o=gs,e.p=Pc,e.q=Xr,e.r=mr,e.s=V,e.t=_r,e.u=Ir,e.v=Z,e.w=S,e.x=fr,e.y=function(e){let[t,n,i]=e;return n+=90,n*=Math.PI/180,i*=Math.PI/180,{x:t*Math.cos(n)*Math.sin(i),y:t*Math.sin(n)*Math.sin(i),z:t*Math.cos(i)}},e.z=At})),n("worker",["./shared"],(function(e){class t{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,n){for(const r of t){this._layerConfigs[r.id]=r;const t=this._layers[r.id]=e.aA(r);t._featureFilter=e.a6(t.filter),this.keyCache[r.id]&&delete this.keyCache[r.id]}for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const i=e.bi(Object.values(this._layerConfigs),this.keyCache);for(const e of i){const t=e.map((e=>this._layers[e.id])),n=t[0];if("none"===n.visibility)continue;const i=n.source||"";let r=this.familiesBySource[i];r||(r=this.familiesBySource[i]={});const a=n.sourceLayer||"_geojsonTileLayer";let o=r[a];o||(o=r[a]=[]),o.push(t)}}}class n{constructor(t){const n={},i=[];for(const e in t){const r=t[e],a=n[e]={};for(const e in r){const t=r[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const n={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};i.push(n),a[e]={rect:n,metrics:t.metrics}}}const{w:r,h:a}=e.p(i),o=new e.o({width:r||1,height:a||1});for(const s in t){const i=t[s];for(const t in i){const r=i[+t];if(!r||0===r.bitmap.width||0===r.bitmap.height)continue;const a=n[s][t].rect;e.o.copy(r.bitmap,o,{x:0,y:0},{x:a.x+1,y:a.y+1},r.bitmap)}}this.image=o,this.positions=n}}e.bj("GlyphAtlas",n);class i{constructor(t){this.tileID=new e.Q(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}parse(t,i,a,o){return e._(this,void 0,void 0,(function*(){this.status="parsing",this.data=t,this.collisionBoxArray=new e.a4;const s=new e.bk(Object.keys(t.layers).sort()),l=new e.bl(this.tileID,this.promoteId);l.bucketLayerIDs=[];const c={},u={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a},h=i.familiesBySource[this.source];for(const n in h){const i=t.layers[n];if(!i)continue;1===i.version&&e.w(`Vector tile source "${this.source}" layer "${n}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const o=s.encode(n),d=[];for(let e=0;e<i.length;e++){const t=i.feature(e),r=l.getId(t,n);d.push({feature:t,id:r,index:e,sourceLayerIndex:o})}for(const t of h[n]){const n=t[0];n.source!==this.source&&e.w(`layer.source = ${n.source} does not equal this.source = ${this.source}`),n.minzoom&&this.zoom<Math.floor(n.minzoom)||n.maxzoom&&this.zoom>=n.maxzoom||"none"!==n.visibility&&(r(t,this.zoom,a),(c[n.id]=n.createBucket({index:l.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(d,u,this.tileID.canonical),l.bucketLayerIDs.push(t.map((e=>e.id))))}}const d=e.aF(u.glyphDependencies,(e=>Object.keys(e).map(Number)));this.inFlightDependencies.forEach((e=>null==e?void 0:e.abort())),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(d).length){const e=new AbortController;this.inFlightDependencies.push(e),p=o.sendAsync({type:"GG",data:{stacks:d,source:this.source,tileID:this.tileID,type:"glyphs"}},e)}const f=Object.keys(u.iconDependencies);let m=Promise.resolve({});if(f.length){const e=new AbortController;this.inFlightDependencies.push(e),m=o.sendAsync({type:"GI",data:{icons:f,source:this.source,tileID:this.tileID,type:"icons"}},e)}const g=Object.keys(u.patternDependencies);let y=Promise.resolve({});if(g.length){const e=new AbortController;this.inFlightDependencies.push(e),y=o.sendAsync({type:"GI",data:{icons:g,source:this.source,tileID:this.tileID,type:"patterns"}},e)}const[_,v,x]=yield Promise.all([p,m,y]),b=new n(_),w=new e.bm(v,x);for(const t in c){const n=c[t];n instanceof e.a5?(r(n.layers,this.zoom,a),e.bn({bucket:n,glyphMap:_,glyphPositions:b.positions,imageMap:v,imagePositions:w.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):n.hasPattern&&(n instanceof e.bo||n instanceof e.bp||n instanceof e.bq)&&(r(n.layers,this.zoom,a),n.addFeatures(u,this.tileID.canonical,w.patternPositions))}return this.status="done",{buckets:Object.values(c).filter((e=>!e.isEmpty())),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:b.image,imageAtlas:w,glyphMap:this.returnDependencies?_:null,iconMap:this.returnDependencies?v:null,glyphPositions:this.returnDependencies?b.positions:null}}))}}function r(t,n,i){const r=new e.a8(n);for(const e of t)e.recalculate(r,i)}class a{constructor(e,t,n){this.actor=e,this.layerIndex=t,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(t,n){return e._(this,void 0,void 0,(function*(){const i=yield e.l(t.request,n);try{return{vectorTile:new e.br.VectorTile(new e.bs(i.data)),rawData:i.data,cacheControl:i.cacheControl,expires:i.expires}}catch(e){const r=new Uint8Array(i.data);let a=`Unable to parse the tile at ${t.request.url}, `;throw a+=31===r[0]&&139===r[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${e.message}`,new Error(a)}}))}loadTile(t){return e._(this,void 0,void 0,(function*(){const n=t.uid,r=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bt(t.request),a=new i(t);this.loading[n]=a;const o=new AbortController;a.abort=o;try{const i=yield this.loadVectorTile(t,o);if(delete this.loading[n],!i)return null;const s=i.rawData,l={};i.expires&&(l.expires=i.expires),i.cacheControl&&(l.cacheControl=i.cacheControl);const c={};if(r){const e=r.finish();e&&(c.resourceTiming=JSON.parse(JSON.stringify(e)))}a.vectorTile=i.vectorTile;const u=a.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[n]=a,this.fetching[n]={rawTileData:s,cacheControl:l,resourceTiming:c};try{const t=yield u;return e.e({rawTileData:s.slice(0)},t,l,c)}finally{delete this.fetching[n]}}catch(e){throw delete this.loading[n],a.status="done",this.loaded[n]=a,e}}))}reloadTile(t){return e._(this,void 0,void 0,(function*(){const n=t.uid;if(!this.loaded||!this.loaded[n])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const i=this.loaded[n];if(i.showCollisionBoxes=t.showCollisionBoxes,"parsing"===i.status){const t=yield i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor);let r;if(this.fetching[n]){const{rawTileData:i,cacheControl:a,resourceTiming:o}=this.fetching[n];delete this.fetching[n],r=e.e({rawTileData:i.slice(0)},t,a,o)}else r=t;return r}if("done"===i.status&&i.vectorTile)return i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(t){return e._(this,void 0,void 0,(function*(){const e=this.loading,n=t.uid;e&&e[n]&&e[n].abort&&(e[n].abort.abort(),delete e[n])}))}removeTile(t){return e._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]}))}}class o{constructor(){this.loaded={}}loadTile(t){return e._(this,void 0,void 0,(function*(){const{uid:n,encoding:i,rawImageData:r,redFactor:a,greenFactor:o,blueFactor:s,baseShift:l}=t,c=r.width+2,u=r.height+2,h=e.b(r)?new e.R({width:c,height:u},yield e.bu(r,-1,-1,c,u)):r,d=new e.bv(n,h,i,a,o,s,l);return this.loaded=this.loaded||{},this.loaded[n]=d,d}))}removeTile(e){const t=this.loaded,n=e.uid;t&&t[n]&&delete t[n]}}function s(e,t){if(0!==e.length){l(e[0],t);for(var n=1;n<e.length;n++)l(e[n],!t)}}function l(e,t){for(var n=0,i=0,r=0,a=e.length,o=a-1;r<a;o=r++){var s=(e[r][0]-e[o][0])*(e[o][1]+e[r][1]),l=n+s;i+=Math.abs(n)>=Math.abs(s)?n-l+s:s-l+n,n=l}n+i>=0!=!!t&&e.reverse()}var c=e.bw((function e(t,n){var i,r=t&&t.type;if("FeatureCollection"===r)for(i=0;i<t.features.length;i++)e(t.features[i],n);else if("GeometryCollection"===r)for(i=0;i<t.geometries.length;i++)e(t.geometries[i],n);else if("Feature"===r)e(t.geometry,n);else if("Polygon"===r)s(t.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<t.coordinates.length;i++)s(t.coordinates[i],n);return t}));const u=e.br.VectorTileFeature.prototype.toGeoJSON;var h={exports:{}},d=e.bx,p=e.br.VectorTileFeature,f=m;function m(e,t){this.options=t||{},this.features=e,this.length=e.length}function g(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}m.prototype.feature=function(e){return new g(this.features[e],this.options.extent)},g.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var n=e[t],i=[],r=0;r<n.length;r++)i.push(new d(n[r][0],n[r][1]));this.geometry.push(i)}return this.geometry},g.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,n=-1/0,i=1/0,r=-1/0,a=0;a<e.length;a++)for(var o=e[a],s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[t,i,n,r]},g.prototype.toGeoJSON=p.prototype.toGeoJSON;var y=e.by,_=f;function v(e){var t=new y;return function(e,t){for(var n in e.layers)t.writeMessage(3,x,e.layers[n])}(e,t),t.finish()}function x(e,t){var n;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<e.length;n++)i.feature=e.feature(n),t.writeMessage(2,b,i);var r=i.keys;for(n=0;n<r.length;n++)t.writeStringField(3,r[n]);var a=i.values;for(n=0;n<a.length;n++)t.writeMessage(4,I,a[n])}function b(e,t){var n=e.feature;void 0!==n.id&&t.writeVarintField(1,n.id),t.writeMessage(2,w,e),t.writeVarintField(3,n.type),t.writeMessage(4,C,n)}function w(e,t){var n=e.feature,i=e.keys,r=e.values,a=e.keycache,o=e.valuecache;for(var s in n.properties){var l=n.properties[s],c=a[s];if(null!==l){void 0===c&&(i.push(s),a[s]=c=i.length-1),t.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=o[h];void 0===d&&(r.push(l),o[h]=d=r.length-1),t.writeVarint(d)}}}function S(e,t){return(t<<3)+(7&e)}function T(e){return e<<1^e>>31}function C(e,t){for(var n=e.loadGeometry(),i=e.type,r=0,a=0,o=n.length,s=0;s<o;s++){var l=n[s],c=1;1===i&&(c=l.length),t.writeVarint(S(1,c));for(var u=3===i?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==i&&t.writeVarint(S(2,u-1));var d=l[h].x-r,p=l[h].y-a;t.writeVarint(T(d)),t.writeVarint(T(p)),r+=d,a+=p}3===i&&t.writeVarint(S(7,1))}}function I(e,t){var n=typeof e;"string"===n?t.writeStringField(1,e):"boolean"===n?t.writeBooleanField(7,e):"number"===n&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}h.exports=v,h.exports.fromVectorTileJs=v,h.exports.fromGeojsonVt=function(e,t){t=t||{};var n={};for(var i in e)n[i]=new _(e[i].features,t),n[i].name=i,n[i].version=t.version,n[i].extent=t.extent;return v({layers:n})},h.exports.GeoJSONWrapper=_;var k=e.bw(h.exports);const E={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},P=Math.fround||(A=new Float32Array(1),e=>(A[0]=+e,A[0]));var A;const M=3,z=5,L=6;class D{constructor(e){this.options=Object.assign(Object.create(E),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:i}=this.options;t&&console.time("total time");const r=`prepare ${e.length} points`;t&&console.time(r),this.points=e;const a=[];for(let s=0;s<e.length;s++){const t=e[s];if(!t.geometry)continue;const[n,i]=t.geometry.coordinates,r=P(O(n)),o=P(B(i));a.push(r,o,1/0,s,-1,1),this.options.reduce&&a.push(0)}let o=this.trees[i+1]=this._createTree(a);t&&console.timeEnd(r);for(let s=i;s>=n;s--){const e=+Date.now();o=this.trees[s]=this._createTree(this._cluster(o,s)),t&&console.log("z%d: %d clusters in %dms",s,o.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,e[1]));let r=180===e[2]?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,r=180;else if(n>r){const e=this.getClusters([n,i,180,a],t),o=this.getClusters([-180,i,r,a],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],s=o.range(O(n),B(a),O(r),B(i)),l=o.data,c=[];for(const u of s){const e=this.stride*u;c.push(l[e+z]>1?R(l,e,this.clusterProps):this.points[l[e+M]])}return c}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);const a=r.data;if(t*this.stride>=a.length)throw new Error(i);const o=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=r.within(a[t*this.stride],a[t*this.stride+1],o),l=[];for(const c of s){const t=c*this.stride;a[t+4]===e&&l.push(a[t+z]>1?R(a,t,this.clusterProps):this.points[a[t+M]])}if(0===l.length)throw new Error(i);return l}getLeaves(e,t,n){const i=[];return this._appendLeaves(i,e,t=t||10,n=n||0,0),i}getTile(e,t,n){const i=this.trees[this._limitZoom(e)],r=Math.pow(2,e),{extent:a,radius:o}=this.options,s=o/a,l=(n-s)/r,c=(n+1+s)/r,u={features:[]};return this._addTileFeatures(i.range((t-s)/r,l,(t+1+s)/r,c),i.data,t,n,r,u),0===t&&this._addTileFeatures(i.range(1-s/r,l,1,c),i.data,r,n,r,u),t===r-1&&this._addTileFeatures(i.range(0,l,s/r,c),i.data,-1,n,r,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,i,r){const a=this.getChildren(t);for(const o of a){const t=o.properties;if(t&&t.cluster?r+t.point_count<=i?r+=t.point_count:r=this._appendLeaves(e,t.cluster_id,n,i,r):r<i?r++:e.push(o),e.length===n)break}return r}_createTree(t){const n=new e.av(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)n.add(t[e],t[e+1]);return n.finish(),n.data=t,n}_addTileFeatures(e,t,n,i,r,a){for(const o of e){const e=o*this.stride,s=t[e+z]>1;let l,c,u;if(s)l=F(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const n=this.points[t[e+M]];l=n.properties;const[i,r]=n.geometry.coordinates;c=O(i),u=B(r)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*r-n)),Math.round(this.options.extent*(u*r-i))]],tags:l};let d;d=s||this.options.generateId?t[e+M]:this.points[t[e+M]].id,void 0!==d&&(h.id=d),a.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:i,reduce:r,minPoints:a}=this.options,o=n/(i*Math.pow(2,t)),s=e.data,l=[],c=this.stride;for(let u=0;u<s.length;u+=c){if(s[u+2]<=t)continue;s[u+2]=t;const n=s[u],i=s[u+1],h=e.within(s[u],s[u+1],o),d=s[u+z];let p=d;for(const e of h){const n=e*c;s[n+2]>t&&(p+=s[n+z])}if(p>d&&p>=a){let e,a=n*d,o=i*d,f=-1;const m=(u/c<<5)+(t+1)+this.points.length;for(const n of h){const i=n*c;if(s[i+2]<=t)continue;s[i+2]=t;const l=s[i+z];a+=s[i]*l,o+=s[i+1]*l,s[i+4]=m,r&&(e||(e=this._map(s,u,!0),f=this.clusterProps.length,this.clusterProps.push(e)),r(e,this._map(s,i)))}s[u+4]=m,l.push(a/p,o/p,1/0,m,-1,p),r&&l.push(f)}else{for(let e=0;e<c;e++)l.push(s[u+e]);if(p>1)for(const e of h){const n=e*c;if(!(s[n+2]<=t)){s[n+2]=t;for(let e=0;e<c;e++)l.push(s[n+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+z]>1){const i=this.clusterProps[e[t+L]];return n?Object.assign({},i):i}const i=this.points[e[t+M]].properties,r=this.options.map(i);return n&&r===i?Object.assign({},r):r}}function R(e,t,n){return{type:"Feature",id:e[t+M],properties:F(e,t,n),geometry:{type:"Point",coordinates:[(i=e[t],360*(i-.5)),N(e[t+1])]}};var i}function F(e,t,n){const i=e[t+z],r=i>=1e4?`${Math.round(i/1e3)}k`:i>=1e3?Math.round(i/100)/10+"k":i,a=e[t+L],o=-1===a?{}:Object.assign({},n[a]);return Object.assign(o,{cluster:!0,cluster_id:e[t+M],point_count:i,point_count_abbreviated:r})}function O(e){return e/360+.5}function B(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function N(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function V(e,t,n,i){for(var r,a=i,o=n-t>>1,s=n-t,l=e[t],c=e[t+1],u=e[n],h=e[n+1],d=t+3;d<n;d+=3){var p=U(e[d],e[d+1],l,c,u,h);if(p>a)r=d,a=p;else if(p===a){var f=Math.abs(d-o);f<s&&(r=d,s=f)}}a>i&&(r-t>3&&V(e,t,r,i),e[r+2]=a,n-r>3&&V(e,r,n,i))}function U(e,t,n,i,r,a){var o=r-n,s=a-i;if(0!==o||0!==s){var l=((e-n)*o+(t-i)*s)/(o*o+s*s);l>1?(n=r,i=a):l>0&&(n+=o*l,i+=s*l)}return(o=e-n)*o+(s=t-i)*s}function j(e,t,n,i){var r={id:void 0===e?null:e,type:t,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,n=e.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)$(e,t);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<t.length;i++)$(e,t[i]);else if("MultiPolygon"===n)for(i=0;i<t.length;i++)for(var r=0;r<t[i].length;r++)$(e,t[i][r])}(r),r}function $(e,t){for(var n=0;n<t.length;n+=3)e.minX=Math.min(e.minX,t[n]),e.minY=Math.min(e.minY,t[n+1]),e.maxX=Math.max(e.maxX,t[n]),e.maxY=Math.max(e.maxY,t[n+1])}function H(e,t,n,i){if(t.geometry){var r=t.geometry.coordinates,a=t.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],l=t.id;if(n.promoteId?l=t.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===a)q(r,s);else if("MultiPoint"===a)for(var c=0;c<r.length;c++)q(r[c],s);else if("LineString"===a)Z(r,s,o,!1);else if("MultiLineString"===a){if(n.lineMetrics){for(c=0;c<r.length;c++)Z(r[c],s=[],o,!1),e.push(j(l,"LineString",s,t.properties));return}G(r,s,o,!1)}else if("Polygon"===a)G(r,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(c=0;c<t.geometry.geometries.length;c++)H(e,{id:l,geometry:t.geometry.geometries[c],properties:t.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];G(r[c],u,o,!0),s.push(u)}}e.push(j(l,a,s,t.properties))}}function q(e,t){t.push(W(e[0])),t.push(K(e[1])),t.push(0)}function Z(e,t,n,i){for(var r,a,o=0,s=0;s<e.length;s++){var l=W(e[s][0]),c=K(e[s][1]);t.push(l),t.push(c),t.push(0),s>0&&(o+=i?(r*c-l*a)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-a,2))),r=l,a=c}var u=t.length-3;t[2]=1,V(t,0,u,n),t[u+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function G(e,t,n,i){for(var r=0;r<e.length;r++){var a=[];Z(e[r],a,n,i),t.push(a)}}function W(e){return e/360+.5}function K(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function X(e,t,n,i,r,a,o,s){if(i/=t,a>=(n/=t)&&o<i)return e;if(o<n||a>=i)return null;for(var l=[],c=0;c<e.length;c++){var u=e[c],h=u.geometry,d=u.type,p=0===r?u.minX:u.minY,f=0===r?u.maxX:u.maxY;if(p>=n&&f<i)l.push(u);else if(!(f<n||p>=i)){var m=[];if("Point"===d||"MultiPoint"===d)Y(h,m,n,i,r);else if("LineString"===d)J(h,m,n,i,r,!1,s.lineMetrics);else if("MultiLineString"===d)ee(h,m,n,i,r,!1);else if("Polygon"===d)ee(h,m,n,i,r,!0);else if("MultiPolygon"===d)for(var g=0;g<h.length;g++){var y=[];ee(h[g],y,n,i,r,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===d){for(g=0;g<m.length;g++)l.push(j(u.id,d,m[g],u.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===m.length?(d="LineString",m=m[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===m.length?"Point":"MultiPoint"),l.push(j(u.id,d,m,u.tags))}}}return l.length?l:null}function Y(e,t,n,i,r){for(var a=0;a<e.length;a+=3){var o=e[a+r];o>=n&&o<=i&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function J(e,t,n,i,r,a,o){for(var s,l,c=Q(e),u=0===r?ne:ie,h=e.start,d=0;d<e.length-3;d+=3){var p=e[d],f=e[d+1],m=e[d+2],g=e[d+3],y=e[d+4],_=0===r?p:f,v=0===r?g:y,x=!1;o&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-y,2))),_<n?v>n&&(l=u(c,p,f,g,y,n),o&&(c.start=h+s*l)):_>i?v<i&&(l=u(c,p,f,g,y,i),o&&(c.start=h+s*l)):te(c,p,f,m),v<n&&_>=n&&(l=u(c,p,f,g,y,n),x=!0),v>i&&_<=i&&(l=u(c,p,f,g,y,i),x=!0),!a&&x&&(o&&(c.end=h+s*l),t.push(c),c=Q(e)),o&&(h+=s)}var b=e.length-3;p=e[b],f=e[b+1],m=e[b+2],(_=0===r?p:f)>=n&&_<=i&&te(c,p,f,m),b=c.length-3,a&&b>=3&&(c[b]!==c[0]||c[b+1]!==c[1])&&te(c,c[0],c[1],c[2]),c.length&&t.push(c)}function Q(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function ee(e,t,n,i,r,a){for(var o=0;o<e.length;o++)J(e[o],t,n,i,r,a,!1)}function te(e,t,n,i){e.push(t),e.push(n),e.push(i)}function ne(e,t,n,i,r,a){var o=(a-t)/(i-t);return e.push(a),e.push(n+(r-n)*o),e.push(1),o}function ie(e,t,n,i,r,a){var o=(a-n)/(r-n);return e.push(t+(i-t)*o),e.push(a),e.push(1),o}function re(e,t){for(var n=[],i=0;i<e.length;i++){var r,a=e[i],o=a.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)r=ae(a.geometry,t);else if("MultiLineString"===o||"Polygon"===o){r=[];for(var s=0;s<a.geometry.length;s++)r.push(ae(a.geometry[s],t))}else if("MultiPolygon"===o)for(r=[],s=0;s<a.geometry.length;s++){for(var l=[],c=0;c<a.geometry[s].length;c++)l.push(ae(a.geometry[s][c],t));r.push(l)}n.push(j(a.id,o,r,a.tags))}return n}function ae(e,t){var n=[];n.size=e.size,void 0!==e.start&&(n.start=e.start,n.end=e.end);for(var i=0;i<e.length;i+=3)n.push(e[i]+t,e[i+1],e[i+2]);return n}function oe(e,t){if(e.transformed)return e;var n,i,r,a=1<<e.z,o=e.x,s=e.y;for(n=0;n<e.features.length;n++){var l=e.features[n],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(i=0;i<c.length;i+=2)l.geometry.push(se(c[i],c[i+1],t,a,o,s));else for(i=0;i<c.length;i++){var h=[];for(r=0;r<c[i].length;r+=2)h.push(se(c[i][r],c[i][r+1],t,a,o,s));l.geometry.push(h)}}return e.transformed=!0,e}function se(e,t,n,i,r,a){return[Math.round(n*(e*i-r)),Math.round(n*(t*i-a))]}function le(e,t,n,i,r){for(var a=t===r.maxZoom?0:r.tolerance/((1<<t)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,ce(o,e[s],a,r);var l=e[s].minX,c=e[s].minY,u=e[s].maxX,h=e[s].maxY;l<o.minX&&(o.minX=l),c<o.minY&&(o.minY=c),u>o.maxX&&(o.maxX=u),h>o.maxY&&(o.maxY=h)}return o}function ce(e,t,n,i){var r=t.geometry,a=t.type,o=[];if("Point"===a||"MultiPoint"===a)for(var s=0;s<r.length;s+=3)o.push(r[s]),o.push(r[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)ue(o,r,e,n,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(s=0;s<r.length;s++)ue(o,r[s],e,n,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(var l=0;l<r.length;l++){var c=r[l];for(s=0;s<c.length;s++)ue(o,c[s],e,n,!0,0===s)}if(o.length){var u=t.tags||null;if("LineString"===a&&i.lineMetrics){for(var h in u={},t.tags)u[h]=t.tags[h];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var d={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:u};null!==t.id&&(d.id=t.id),e.features.push(d)}}function ue(e,t,n,i,r,a){var o=i*i;if(i>0&&t.size<(r?o:i))n.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===i||t[l+2]>o)&&(n.numSimplified++,s.push(t[l]),s.push(t[l+1])),n.numPoints++;r&&function(e,t){for(var n=0,i=0,r=e.length,a=r-2;i<r;a=i,i+=2)n+=(e[i]-e[a])*(e[i+1]+e[a+1]);if(n>0===t)for(i=0,r=e.length;i<r/2;i+=2){var o=e[i],s=e[i+1];e[i]=e[r-2-i],e[i+1]=e[r-1-i],e[r-2-i]=o,e[r-1-i]=s}}(s,a),e.push(s)}}function he(e,t){var n=(t=this.options=function(e,t){for(var n in t)e[n]=t[n];return e}(Object.create(this.options),t)).debug;if(n&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(e,t){var n=[];if("FeatureCollection"===e.type)for(var i=0;i<e.features.length;i++)H(n,e.features[i],t,i);else H(n,"Feature"===e.type?e:{geometry:e},t);return n}(e,t);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=function(e,t){var n=t.buffer/t.extent,i=e,r=X(e,1,-1-n,n,0,-1,2,t),a=X(e,1,1-n,2+n,0,-1,2,t);return(r||a)&&(i=X(e,1,-n,1+n,0,-1,2,t)||[],r&&(i=re(r,1).concat(i)),a&&(i=i.concat(re(a,-1)))),i}(i,t),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function de(e,t,n){return 32*((1<<e)*n+t)+e}function pe(e,t){return t?e.properties[t]:e.id}function fe(e,t){if(null==e)return!0;if("Feature"===e.type)return null!=pe(e,t);if("FeatureCollection"===e.type){const n=new Set;for(const i of e.features){const e=pe(i,t);if(null==e)return!1;if(n.has(e))return!1;n.add(e)}return!0}return!1}function me(e,t){const n=new Map;if(null==e);else if("Feature"===e.type)n.set(pe(e,t),e);else for(const i of e.features)n.set(pe(i,t),i);return n}he.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},he.prototype.splitTile=function(e,t,n,i,r,a,o){for(var s=[e,t,n,i],l=this.options,c=l.debug;s.length;){i=s.pop(),n=s.pop(),t=s.pop(),e=s.pop();var u=1<<t,h=de(t,n,i),d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=le(e,t,n,i,l),this.tileCoords.push({z:t,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,n,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=e,r){if(t===l.maxZoom||t===r)continue;var f=1<<r-t;if(n!==Math.floor(a/f)||i!==Math.floor(o/f))continue}else if(t===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==e.length){c>1&&console.time("clipping");var m,g,y,_,v,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,T=1+b;m=g=y=_=null,v=X(e,u,n-b,n+S,0,d.minX,d.maxX,l),x=X(e,u,n+w,n+T,0,d.minX,d.maxX,l),e=null,v&&(m=X(v,u,i-b,i+S,1,d.minY,d.maxY,l),g=X(v,u,i+w,i+T,1,d.minY,d.maxY,l),v=null),x&&(y=X(x,u,i-b,i+S,1,d.minY,d.maxY,l),_=X(x,u,i+w,i+T,1,d.minY,d.maxY,l),x=null),c>1&&console.timeEnd("clipping"),s.push(m||[],t+1,2*n,2*i),s.push(g||[],t+1,2*n,2*i+1),s.push(y||[],t+1,2*n+1,2*i),s.push(_||[],t+1,2*n+1,2*i+1)}}},he.prototype.getTile=function(e,t,n){var i=this.options,r=i.extent,a=i.debug;if(e<0||e>24)return null;var o=1<<e,s=de(e,t=(t%o+o)%o,n);if(this.tiles[s])return oe(this.tiles[s],r);a>1&&console.log("drilling down to z%d-%d-%d",e,t,n);for(var l,c=e,u=t,h=n;!l&&c>0;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[de(c,u,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",c,u,h),a>1&&console.time("drilling down"),this.splitTile(l.source,c,u,h,e,t,n),a>1&&console.timeEnd("drilling down"),this.tiles[s]?oe(this.tiles[s],r):null):null};class ge extends a{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(t,n){return e._(this,void 0,void 0,(function*(){const n=t.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return null;const r=new class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.W,this.length=t.length,this._features=t}feature(t){return new class{constructor(t){this._feature=t,this.extent=e.W,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const n of this._feature.geometry)t.push([new e.P(n[0],n[1])]);return t}{const t=[];for(const n of this._feature.geometry){const i=[];for(const t of n)i.push(new e.P(t[0],t[1]));t.push(i)}return t}}toGeoJSON(e,t,n){return u.call(this,e,t,n)}}(this._features[t])}}(i.features);let a=k(r);return 0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),{vectorTile:r,rawData:a.buffer}}))}loadData(t){return e._(this,void 0,void 0,(function*(){var n;null===(n=this._pendingRequest)||void 0===n||n.abort();const i=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bt(t.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(t,this._pendingRequest),this._geoJSONIndex=t.cluster?new D(function(t){let{superclusterOptions:n,clusterProperties:i}=t;if(!i||!n)return n;const r={},a={},o={accumulated:null,zoom:0},s={properties:null},l=Object.keys(i);for(const c of l){const[t,n]=i[c],o=e.bA(n),s=e.bA("string"==typeof t?[t,["accumulated"],["get",c]]:t);r[c]=o.value,a[c]=s.value}return n.map=e=>{s.properties=e;const t={};for(const n of l)t[n]=r[n].evaluate(o,s);return t},n.reduce=(e,t)=>{s.properties=t;for(const n of l)o.accumulated=e[n],e[n]=a[n].evaluate(o,s)},n}(t)).load((yield this._pendingData).features):new he(yield this._pendingData,t.geojsonVtOptions),this.loaded={};const n={};if(i){const e=i.finish();e&&(n.resourceTiming={},n.resourceTiming[t.source]=JSON.parse(JSON.stringify(e)))}return n}catch(t){if(delete this._pendingRequest,e.bz(t))return{abandoned:!0};throw t}}))}getData(){return e._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(e){const t=this.loaded;return t&&t[e.uid]?super.reloadTile(e):this.loadTile(e)}loadAndProcessGeoJSON(t,n){return e._(this,void 0,void 0,(function*(){let i=yield this.loadGeoJSON(t,n);if(delete this._pendingRequest,"object"!=typeof i)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(c(i,!0),t.filter){const n=e.bA(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const r=i.features.filter((e=>n.value.evaluate({zoom:0},e)));i={type:"FeatureCollection",features:r}}return i}))}loadGeoJSON(t,n){return e._(this,void 0,void 0,(function*(){const{promoteId:i}=t;if(t.request){const r=yield e.h(t.request,n);return this._dataUpdateable=fe(r.data,i)?me(r.data,i):void 0,r.data}if("string"==typeof t.data)try{const e=JSON.parse(t.data);return this._dataUpdateable=fe(e,i)?me(e,i):void 0,e}catch(e){throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`)}if(!t.dataDiff)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${t.source}`);return function(e,t,n){var i,r,a,o;if(t.removeAll&&e.clear(),t.remove)for(const s of t.remove)e.delete(s);if(t.add)for(const s of t.add){const t=pe(s,n);null!=t&&e.set(t,s)}if(t.update)for(const s of t.update){let t=e.get(s.id);if(null==t)continue;const n=!s.removeAllProperties&&((null===(i=s.removeProperties)||void 0===i?void 0:i.length)>0||(null===(r=s.addOrUpdateProperties)||void 0===r?void 0:r.length)>0);if((s.newGeometry||s.removeAllProperties||n)&&(t=Object.assign({},t),e.set(s.id,t),n&&(t.properties=Object.assign({},t.properties))),s.newGeometry&&(t.geometry=s.newGeometry),s.removeAllProperties)t.properties={};else if((null===(a=s.removeProperties)||void 0===a?void 0:a.length)>0)for(const e of s.removeProperties)Object.prototype.hasOwnProperty.call(t.properties,e)&&delete t.properties[e];if((null===(o=s.addOrUpdateProperties)||void 0===o?void 0:o.length)>0)for(const{key:e,value:i}of s.addOrUpdateProperties)t.properties[e]=i}}(this._dataUpdateable,t.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(t){return e._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(e){return this._geoJSONIndex.getClusterExpansionZoom(e.clusterId)}getClusterChildren(e){return this._geoJSONIndex.getChildren(e.clusterId)}getClusterLeaves(e){return this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset)}}class ye{constructor(t){this.self=t,this.actor=new e.C(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(e,t)=>{if(this.externalWorkerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.externalWorkerSourceTypes[e]=t},this.self.addProtocol=e.bg,this.self.removeProtocol=e.bh,this.self.registerRTLTextPlugin=t=>{if(e.bB.isParsed())throw new Error("RTL text plugin already registered.");e.bB.setMethods(t)},this.actor.registerMessageHandler("LDT",((e,t)=>this._getDEMWorkerSource(e,t.source).loadTile(t))),this.actor.registerMessageHandler("RDT",((t,n)=>e._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(t,n.source).removeTile(n)})))),this.actor.registerMessageHandler("GCEZ",((t,n)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,n.type,n.source).getClusterExpansionZoom(n)})))),this.actor.registerMessageHandler("GCC",((t,n)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,n.type,n.source).getClusterChildren(n)})))),this.actor.registerMessageHandler("GCL",((t,n)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,n.type,n.source).getClusterLeaves(n)})))),this.actor.registerMessageHandler("LD",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadData(t))),this.actor.registerMessageHandler("GD",((e,t)=>this._getWorkerSource(e,t.type,t.source).getData())),this.actor.registerMessageHandler("LT",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadTile(t))),this.actor.registerMessageHandler("RT",((e,t)=>this._getWorkerSource(e,t.type,t.source).reloadTile(t))),this.actor.registerMessageHandler("AT",((e,t)=>this._getWorkerSource(e,t.type,t.source).abortTile(t))),this.actor.registerMessageHandler("RMT",((e,t)=>this._getWorkerSource(e,t.type,t.source).removeTile(t))),this.actor.registerMessageHandler("RS",((t,n)=>e._(this,void 0,void 0,(function*(){if(!this.workerSources[t]||!this.workerSources[t][n.type]||!this.workerSources[t][n.type][n.source])return;const e=this.workerSources[t][n.type][n.source];delete this.workerSources[t][n.type][n.source],void 0!==e.removeSource&&e.removeSource(n)})))),this.actor.registerMessageHandler("RM",(t=>e._(this,void 0,void 0,(function*(){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t]})))),this.actor.registerMessageHandler("SR",((t,n)=>e._(this,void 0,void 0,(function*(){this.referrer=n})))),this.actor.registerMessageHandler("SRPS",((e,t)=>this._syncRTLPluginState(e,t))),this.actor.registerMessageHandler("IS",((t,n)=>e._(this,void 0,void 0,(function*(){this.self.importScripts(n)})))),this.actor.registerMessageHandler("SI",((e,t)=>this._setImages(e,t))),this.actor.registerMessageHandler("UL",((t,n)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(t).update(n.layers,n.removedIds)})))),this.actor.registerMessageHandler("SL",((t,n)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(t).replace(n)}))))}_setImages(t,n){return e._(this,void 0,void 0,(function*(){this.availableImages[t]=n;for(const e in this.workerSources[t]){const i=this.workerSources[t][e];for(const e in i)i[e].availableImages=n}}))}_syncRTLPluginState(t,n){return e._(this,void 0,void 0,(function*(){if(e.bB.isParsed())return e.bB.getState();if("loading"!==n.pluginStatus)return e.bB.setState(n),n;const t=n.pluginURL;if(this.self.importScripts(t),e.bB.isParsed()){const n={pluginStatus:"loaded",pluginURL:t};return e.bB.setState(n),n}throw e.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${t}`)}))}_getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}_getLayerIndex(e){let n=this.layerIndexes[e];return n||(n=this.layerIndexes[e]=new t),n}_getWorkerSource(e,t,n){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][n]){const i={sendAsync:(t,n)=>(t.targetMapId=e,this.actor.sendAsync(t,n))};switch(t){case"vector":this.workerSources[e][t][n]=new a(i,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][t][n]=new ge(i,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][t][n]=new this.externalWorkerSourceTypes[t](i,this._getLayerIndex(e),this._getAvailableImages(e))}}return this.workerSources[e][t][n]}_getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new o),this.demWorkerSources[e][t]}}return e.i(self)&&(self.worker=new ye(self)),ye})),n("index",["exports","./shared"],(function(e,t){var n="4.4.1";let i,r;const a={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:e=>new Promise(((n,i)=>{const r=requestAnimationFrame(n);e.signal.addEventListener("abort",(()=>{cancelAnimationFrame(r),i(t.c())}))})),getImageData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){const t=window.document.createElement("canvas"),n=t.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height),n},resolveURL:e=>(i||(i=document.createElement("a")),i.href=e,i.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==r&&(r=matchMedia("(prefers-reduced-motion: reduce)")),r.matches)}};class o{static testProp(e){if(!o.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in o.docStyle)return e[t];return e[0]}static create(e,t,n){const i=window.document.createElement(e);return void 0!==t&&(i.className=t),n&&n.appendChild(i),i}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){o.docStyle&&o.selectProp&&(o.userSelect=o.docStyle[o.selectProp],o.docStyle[o.selectProp]="none")}static enableDrag(){o.docStyle&&o.selectProp&&(o.docStyle[o.selectProp]=o.userSelect)}static setTransform(e,t){e.style[o.transformProp]=t}static addEventListener(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.addEventListener(t,n,"passive"in i?i:i.capture)}static removeEventListener(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.removeEventListener(t,n,"passive"in i?i:i.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",o.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",o.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",o.suppressClickInternal,!0)}),0)}static getScale(e){const t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,n,i){const r=n.boundingClientRect;return new t.P((i.clientX-r.left)/n.x-e.clientLeft,(i.clientY-r.top)/n.y-e.clientTop)}static mousePos(e,t){const n=o.getScale(e);return o.getPoint(e,n,t)}static touchPos(e,t){const n=[],i=o.getScale(e);for(let r=0;r<t.length;r++)n.push(o.getPoint(e,i,t[r]));return n}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}o.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,o.selectProp=o.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o.transformProp=o.testProp(["transform","WebkitTransform"]);const s={supported:!1,testSupport:function(e){!u&&c&&(h?d(e):l=e)}};let l,c,u=!1,h=!1;function d(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,c),e.isContextLost())return;s.supported=!0}catch(e){}e.deleteTexture(t),u=!0}var p;"undefined"!=typeof document&&(c=document.createElement("img"),c.onload=()=>{l&&d(l),l=null,h=!0},c.onerror=()=>{u=!0,l=null},c.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let n,i,r,a;e.resetRequestQueue=()=>{n=[],i=0,r=0,a={}},e.addThrottleControl=e=>{const t=r++;return a[t]=e,t},e.removeThrottleControl=e=>{delete a[e],l()},e.getImage=function(e,i){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise(((a,o)=>{s.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),t.e(e,{type:"image"}),n.push({abortController:i,requestParameters:e,supportImageRefresh:r,state:"queued",onError:e=>{o(e)},onSuccess:e=>{a(e)}}),l()}))};const o=e=>t._(this,void 0,void 0,(function*(){e.state="running";const{requestParameters:n,supportImageRefresh:r,onError:a,onSuccess:o,abortController:s}=e,u=!1===r&&!t.i(self)&&!t.g(n.url)&&(!n.headers||Object.keys(n.headers).reduce(((e,t)=>e&&"accept"===t),!0));i++;const h=u?c(n,s):t.m(n,s);try{const n=yield h;delete e.abortController,e.state="completed",n.data instanceof HTMLImageElement||t.b(n.data)?o(n):n.data&&o({data:yield(d=n.data,"function"==typeof createImageBitmap?t.d(d):t.f(d)),cacheControl:n.cacheControl,expires:n.expires})}catch(t){delete e.abortController,a(t)}finally{i--,l()}var d})),l=()=>{const e=(()=>{for(const e of Object.keys(a))if(a[e]())return!0;return!1})()?t.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=i;t<e&&n.length>0;t++){const e=n.shift();e.abortController.signal.aborted?t--:o(e)}},c=(e,n)=>new Promise(((i,r)=>{const a=new Image,o=e.url,s=e.credentials;s&&"include"===s?a.crossOrigin="use-credentials":(s&&"same-origin"===s||!t.s(o))&&(a.crossOrigin="anonymous"),n.signal.addEventListener("abort",(()=>{a.src="",r(t.c())})),a.fetchPriority="high",a.onload=()=>{a.onerror=a.onload=null,i({data:a})},a.onerror=()=>{a.onerror=a.onload=null,n.signal.aborted||r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},a.src=o}))}(p||(p={})),p.resetRequestQueue();class f{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function m(e){var n=new t.A(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}var g,y=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e};g=new t.A(3),t.A!=Float32Array&&(g[0]=0,g[1]=0,g[2]=0);var _=function(e){var t=e[0],n=e[1];return t*t+n*n};function v(e){const t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&e.length>0){const n=[];for(const{id:i,url:r}of e){const e=`${i}${r}`;-1===n.indexOf(e)&&(n.push(e),t.push({id:i,url:r}))}}return t}function x(e,t,n){const i=e.split("?");return i[0]+=`${t}${n}`,i.join("?")}!function(){var e=new t.A(2);t.A!=Float32Array&&(e[0]=0,e[1]=0)}();class b{constructor(e,t,n,i){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(t,i)}update(e,n,i){const{width:r,height:a}=e,o=!(this.size&&this.size[0]===r&&this.size[1]===a||i),{context:s}=this,{gl:l}=s;if(this.useMipmap=Boolean(n&&n.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!n||!1!==n.premultiply)),o)this.size=[r,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,r,a,0,this.format,l.UNSIGNED_BYTE,e.data);else{const{x:n,y:o}=i||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texSubImage2D(l.TEXTURE_2D,0,n,o,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,n,o,r,a,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(e,t,n){const{context:i}=this,{gl:r}=i;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),e!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||e),this.filter=e),t!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function w(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class S extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,promiseResolve:t}of this.requestors)t(this._getImagesForIds(e));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const e=n.spriteData;n.data=new t.R({width:e.width,height:e.height},e.context.getImageData(e.x,e.y,e.width,e.height).data),n.spriteData=null}return n}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,n){let i=!0;const r=n.data||n.spriteData;return this._validateStretch(n.stretchX,r&&r.width)||(this.fire(new t.j(new Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(n.stretchY,r&&r.height)||(this.fire(new t.j(new Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(n.content,n)||(this.fire(new t.j(new Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(e,t){if(!e)return!0;let n=0;for(const i of e){if(i[0]<n||i[1]<i[0]||t<i[1])return!1;n=i[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;const n=t.spriteData,i=n&&n.width||t.data.width,r=n&&n.height||t.data.height;return!(e[0]<0||i<e[0]||e[1]<0||r<e[1]||e[2]<0||i<e[2]||e[3]<0||r<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.getImage(e);if(n&&(i.data.width!==t.data.width||i.data.height!==t.data.height))throw new Error(`size mismatch between old image (${i.data.width}x${i.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=i.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((t,n)=>{let i=!0;if(!this.isLoaded())for(const r of e)this.images[r]||(i=!1);this.isLoaded()||i?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})}))}_getImagesForIds(e){const n={};for(const i of e){let e=this.getImage(i);e||(this.fire(new t.k("styleimagemissing",{id:i})),e=this.getImage(i)),e?n[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,textFitWidth:e.textFitWidth,textFitHeight:e.textFitHeight,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){const n=this.patterns[e],i=this.getImage(e);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{const n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new t.I(n,i);this.patterns[e]={bin:n,position:r}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new b(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:i}=t.p(e),r=this.atlasImage;r.resize({width:n||1,height:i||1});for(const a in this.patterns){const{bin:e}=this.patterns[a],n=e.x+1,i=e.y+1,o=this.getImage(a).data,s=o.width,l=o.height;t.R.copy(o,r,{x:0,y:0},{x:n,y:i},{width:s,height:l}),t.R.copy(o,r,{x:0,y:l-1},{x:n,y:i-1},{width:s,height:1}),t.R.copy(o,r,{x:0,y:0},{x:n,y:i+l},{width:s,height:1}),t.R.copy(o,r,{x:s-1,y:0},{x:n-1,y:i},{width:1,height:l}),t.R.copy(o,r,{x:0,y:0},{x:n+s,y:i},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const e=this.getImage(n);e||t.w(`Image with ID: "${n}" was not found`),w(e)&&this.updateImage(n,e)}}}const T=1e20;function C(e,t,n,i,r,a,o,s,l){for(let c=t;c<t+i;c++)I(e,n*a+c,a,r,o,s,l);for(let c=n;c<n+r;c++)I(e,c*a+t,1,i,o,s,l)}function I(e,t,n,i,r,a,o){a[0]=0,o[0]=-T,o[1]=T,r[0]=e[t];for(let s=1,l=0,c=0;s<i;s++){r[s]=e[t+s*n];const i=s*s;do{const e=a[l];c=(r[s]-r[e]+i-e*e)/(s-e)/2}while(c<=o[l]&&--l>-1);l++,a[l]=s,o[l]=c,o[l+1]=T}for(let s=0,l=0;s<i;s++){for(;o[l+1]<s;)l++;const i=a[l],c=s-i;e[t+s*n]=r[i]+c*c}}class k{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return t._(this,void 0,void 0,(function*(){const t=[];for(const r in e)for(const n of e[r])t.push(this._getAndCacheGlyphsPromise(r,n));const n=yield Promise.all(t),i={};for(const{stack:e,id:r,glyph:a}of n)i[e]||(i[e]={}),i[e][r]=a&&{id:a.id,bitmap:a.bitmap.clone(),metrics:a.metrics};return i}))}_getAndCacheGlyphsPromise(e,n){return t._(this,void 0,void 0,(function*(){let t=this.entries[e];t||(t=this.entries[e]={glyphs:{},requests:{},ranges:{}});let i=t.glyphs[n];if(void 0!==i)return{stack:e,id:n,glyph:i};if(i=this._tinySDF(t,e,n),i)return t.glyphs[n]=i,{stack:e,id:n,glyph:i};const r=Math.floor(n/256);if(256*r>65535)throw new Error("glyphs > 65535 not supported");if(t.ranges[r])return{stack:e,id:n,glyph:i};if(!this.url)throw new Error("glyphsUrl is not set");if(!t.requests[r]){const n=k.loadGlyphRange(e,r,this.url,this.requestManager);t.requests[r]=n}const a=yield t.requests[r];for(const e in a)this._doesCharSupportLocalGlyph(+e)||(t.glyphs[+e]=a[+e]);return t.ranges[r]=!0,{stack:e,id:n,glyph:a[n]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(t.u["CJK Unified Ideographs"](e)||t.u["Hangul Syllables"](e)||t.u.Hiragana(e)||t.u.Katakana(e))}_tinySDF(e,n,i){const r=this.localIdeographFontFamily;if(!r)return;if(!this._doesCharSupportLocalGlyph(i))return;let a=e.tinySDF;if(!a){let t="400";/bold/i.test(n)?t="900":/medium/i.test(n)?t="500":/light/i.test(n)&&(t="200"),a=e.tinySDF=new k.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:r,fontWeight:t})}const o=a.draw(String.fromCharCode(i));return{id:i,bitmap:new t.o({width:o.width||60,height:o.height||60},o.data),metrics:{width:o.glyphWidth/2||24,height:o.glyphHeight/2||24,left:o.glyphLeft/2+.5||0,top:o.glyphTop/2-27.5||-8,advance:o.glyphAdvance/2||24,isDoubleResolution:!0}}}}k.loadGlyphRange=function(e,n,i,r){return t._(this,void 0,void 0,(function*(){const a=256*n,o=a+255,s=r.transformRequest(i.replace("{fontstack}",e).replace("{range}",`${a}-${o}`),"Glyphs"),l=yield t.l(s,new AbortController);if(!l||!l.data)throw new Error(`Could not load glyph range. range: ${n}, ${a}-${o}`);const c={};for(const e of t.n(l.data))c[e.id]=e;return c}))},k.TinySDF=class{constructor(){let{fontSize:e=24,buffer:t=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:a="normal",fontStyle:o="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=i,this.radius=n;const s=this.size=e+4*t,l=this._createCanvas(s),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${a} ${e}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:a}=this.ctx.measureText(e),o=Math.ceil(n),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-r))),l=Math.min(this.size-this.buffer,o+Math.ceil(i)),c=s+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:s,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===s||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,s,l),f.fillText(e,m,m+o);const _=f.getImageData(m,m,s,l);y.fill(T,0,h),g.fill(0,0,h);for(let v=0;v<l;v++)for(let e=0;e<s;e++){const t=_.data[4*(v*s+e)+3]/255;if(0===t)continue;const n=(v+m)*c+e+m;if(1===t)y[n]=0,g[n]=T;else{const e=.5-t;y[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}C(y,0,0,c,u,c,this.f,this.v,this.z),C(g,m,m,s,l,c,this.f,this.v,this.z);for(let v=0;v<h;v++){const e=Math.sqrt(y[v])-Math.sqrt(g[v]);d[v]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};class E{constructor(){this.specification=t.v.light.position}possiblyEvaluate(e,n){return t.y(e.expression.evaluate(n))}interpolate(e,n,i){return{x:t.z.number(e.x,n.x,i),y:t.z.number(e.y,n.y,i),z:t.z.number(e.z,n.z,i)}}}let P;class A extends t.E{constructor(e){super(),P=P||new t.q({anchor:new t.D(t.v.light.anchor),position:new E,color:new t.D(t.v.light.color),intensity:new t.D(t.v.light.intensity)}),this._transitionable=new t.T(P),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.r,e,n))for(const t in e){const n=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),n):this._transitionable.setValue(t,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,i){return(!i||!1!==i.validate)&&t.t(this,e.call(t.x,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.v}))}}class M{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){const n=e.join(",")+String(t);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(e,t)),this.dashEntry[n]}getDashRanges(e,t,n){const i=[];let r=e.length%2==1?-e[e.length-1]*n:0,a=e[0]*n,o=!0;i.push({left:r,right:a,isDash:o,zeroLength:0===e[0]});let s=e[0];for(let l=1;l<e.length;l++){o=!o;const t=e[l];r=s*n,s+=t,a=s*n,i.push({left:r,right:a,isDash:o,zeroLength:0===t})}return i}addRoundDash(e,t,n){const i=t/2;for(let r=-n;r<=n;r++){const t=this.width*(this.nextRow+n+r);let a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);const l=Math.abs(s-o.left),c=Math.abs(s-o.right),u=Math.min(l,c);let h;const d=r/n*(i+1);if(o.isDash){const e=i-Math.abs(d);h=Math.sqrt(u*u+e*e)}else h=i-Math.sqrt(u*u+d*d);this.data[t+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e){for(let o=e.length-1;o>=0;--o){const t=e[o],n=e[o+1];t.zeroLength?e.splice(o,1):n&&n.isDash===t.isDash&&(n.left=t.left,e.splice(o,1))}const t=e[0],n=e[e.length-1];t.isDash===n.isDash&&(t.left=n.left-this.width,n.right=t.right+this.width);const i=this.width*this.nextRow;let r=0,a=e[r];for(let o=0;o<this.width;o++){o/a.right>1&&(a=e[++r]);const t=Math.abs(o-a.left),n=Math.abs(o-a.right),s=Math.min(t,n);this.data[i+o]=Math.max(0,Math.min(255,(a.isDash?s:-s)+128))}}addDash(e,n){const i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return t.w("LineAtlas out of space"),null;let a=0;for(let t=0;t<e.length;t++)a+=e[t];if(0!==a){const t=this.width/a,r=this.getDashRanges(e,this.width,t);n?this.addRoundDash(r,t,i):this.addRegularDash(r)}const o={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:a};return this.nextRow+=r,this.dirty=!0,o}bind(e){const t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}const z="maplibre_preloaded_worker_pool";class L{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<L.workerCount;)this.workers.push(new Worker(t.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[z]}numActive(){return Object.keys(this.active).length}}const D=Math.floor(a.hardwareConcurrency/2);let R,F;function O(){return R||(R=new L),R}L.workerCount=t.B(globalThis)?Math.max(Math.min(D,3),1):1;class B{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const i=this.workerPool.acquire(n);for(let r=0;r<i.length;r++){const e=new t.C(i[r],n);e.name=`Worker ${r}`,this.actors.push(e)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){const n=[];for(const i of this.actors)n.push(i.sendAsync({type:e,data:t}));return Promise.all(n)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.actors.forEach((e=>{e.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(const n of this.actors)n.registerMessageHandler(e,t)}}function N(){return F||(F=new B(O(),t.G),F.registerMessageHandler("GR",((e,n,i)=>t.m(n,i)))),F}function V(e,n){const i=t.F();return t.H(i,i,[1,1,0]),t.J(i,i,[.5*e.width,.5*e.height,1]),t.K(i,i,e.calculatePosMatrix(n.toUnwrapped()))}function U(e,t,n,i,r,a){const o=function(e,t,n){if(e)for(const i of e){const e=t[i];if(e&&e.source===n&&"fill-extrusion"===e.type)return!0}else for(const i in t){const e=t[i];if(e.source===n&&"fill-extrusion"===e.type)return!0}return!1}(r&&r.layers,t,e.id),s=a.maxPitchScaleFactor(),l=e.tilesIn(i,s,o);l.sort(j);const c=[];for(const h of l)c.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,n,e._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,r,a,s,V(e.transform,h.tileID))});const u=function(e){const t={},n={};for(const i of e){const e=i.queryResults,r=i.wrappedTileID,a=n[r]=n[r]||{};for(const n in e){const i=e[n],r=a[n]=a[n]||{},o=t[n]=t[n]||[];for(const e of i)r[e.featureIndex]||(r[e.featureIndex]=!0,o.push(e))}}return t}(c);for(const h in u)u[h].forEach((t=>{const n=t.feature,i=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i}));return u}function j(e,t){const n=e.tileID,i=t.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function $(e,n,i){return t._(this,void 0,void 0,(function*(){let r=e;if(e.url?r=(yield t.h(n.transformRequest(e.url,"Source"),i)).data:yield a.frameAsync(i),!r)return null;const o=t.L(t.e(r,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(o.vectorLayerIds=r.vector_layers.map((e=>e.id))),o}))}class H{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof t.M?new t.M(e.lng,e.lat):t.M.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.M?new t.M(e.lng,e.lat):t.M.convert(e),this}extend(e){const n=this._sw,i=this._ne;let r,a;if(e instanceof t.M)r=e,a=e;else{if(!(e instanceof H))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(H.convert(e)):this.extend(t.M.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.M.convert(e)):this;if(r=e._sw,a=e._ne,!r||!a)return this}return n||i?(n.lng=Math.min(r.lng,n.lng),n.lat=Math.min(r.lat,n.lat),i.lng=Math.max(a.lng,i.lng),i.lat=Math.max(a.lat,i.lat)):(this._sw=new t.M(r.lng,r.lat),this._ne=new t.M(a.lng,a.lat)),this}getCenter(){return new t.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.M(this.getWest(),this.getNorth())}getSouthEast(){return new t.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:i}=t.M.convert(e);let r=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r}static convert(e){return e instanceof H?e:e?new H(e):e}static fromLngLat(e){const n=360*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/40075017,i=n/Math.cos(Math.PI/180*e.lat);return new H(new t.M(e.lng-i,e.lat-n),new t.M(e.lng+i,e.lat+n))}}class q{constructor(e,t,n){this.bounds=H.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=n||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),i=Math.floor(t.N(this.bounds.getWest())*n),r=Math.floor(t.O(this.bounds.getNorth())*n),a=Math.ceil(t.N(this.bounds.getEast())*n),o=Math.ceil(t.O(this.bounds.getSouth())*n);return e.x>=i&&e.x<a&&e.y>=r&&e.y<o}}class Z extends t.E{constructor(e,n,i,r){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.e(this,t.L(n,["url","scheme","tileSize","promoteId"])),this._options=t.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield $(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(t.e(this,e),e.bounds&&(this.tileBounds=new q(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.j(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return t.e({},this._options)}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request.collectResourceTiming=this._collectResourceTiming;let i="RT";if(e.actor&&"expired"!==e.state){if("loading"===e.state)return new Promise(((t,n)=>{e.reloadPromise={resolve:t,reject:n}}))}else e.actor=this.dispatcher.getActor(),i="LT";e.abortController=new AbortController;try{const t=yield e.actor.sendAsync({type:i,data:n},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,t)}catch(t){if(delete e.abortController,e.aborted)return;if(t&&404!==t.status)throw t;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){const t=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(t.resolve).catch(t.reject)}}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class G extends t.E{constructor(e,n,i,r){super(),this.id=e,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.e({type:"raster"},n),t.e(this,t.L(n,["url","scheme","tileSize"]))}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield $(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(t.e(this,e),e.bounds&&(this.tileBounds=new q(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.j(e))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return t.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const n=yield p.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(n&&n.data){this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const t=this.map.painter.context,i=t.gl,r=n.data;e.texture=this.map.painter.getTileTexture(r.width),e.texture?e.texture.update(r,{useMipmap:!0}):(e.texture=new b(t,r,i.RGBA,{useMipmap:!0}),e.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),t.extTextureFilterAnisotropic&&i.texParameterf(i.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax)),e.state="loaded"}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}}))}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class W extends G{constructor(e,n,i,r){super(e,n,i,r),this.type="raster-dem",this.maxzoom=22,this._options=t.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return t._(this,void 0,void 0,(function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const n=yield p.getImage(i,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(n&&n.data){const i=n.data;this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const r=t.b(i)&&t.S()?i:yield this.readImageNow(i),a={type:this.type,uid:e.uid,source:this.id,rawImageData:r,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||"expired"===e.state){e.actor=this.dispatcher.getActor();const t=yield e.actor.sendAsync({type:"LDT",data:a});e.dem=t,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}}))}readImageNow(e){return t._(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&t.U()){const n=e.width+2,i=e.height+2;try{return new t.R({width:n,height:i},yield t.V(e,-1,-1,n,i))}catch(e){}}return a.getImageData(e,1)}))}_getNeighboringTiles(e){const n=e.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,a=0===n.x?e.wrap-1:e.wrap,o=(n.x+1+i)%i,s=n.x+1===i?e.wrap+1:e.wrap,l={};return l[new t.Q(e.overscaledZ,a,n.z,r,n.y).key]={backfilled:!1},l[new t.Q(e.overscaledZ,s,n.z,o,n.y).key]={backfilled:!1},n.y>0&&(l[new t.Q(e.overscaledZ,a,n.z,r,n.y-1).key]={backfilled:!1},l[new t.Q(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.Q(e.overscaledZ,s,n.z,o,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new t.Q(e.overscaledZ,a,n.z,r,n.y+1).key]={backfilled:!1},l[new t.Q(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.Q(e.overscaledZ,s,n.z,o,n.y+1).key]={backfilled:!1}),l}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class K extends t.E{constructor(e,n,i,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=i.getActor(),this.setEventedParent(r),this._data=n.data,this._options=t.e({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const a=t.W/this.tileSize;this.workerOptions=t.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*a,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*a,extent:t.W,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.W,radius:(n.clusterRadius||50)*a,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return t._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return t._(this,void 0,void 0,(function*(){const e=t.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),void 0!==e.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,n){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:n}})}_updateWorkerData(e){return t._(this,void 0,void 0,(function*(){const n=t.e({type:this.type},this.workerOptions);e?n.dataDiff=e:"string"==typeof this._data?(n.request=this.map._requestManager.transformRequest(a.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new t.k("dataloading",{dataType:"source"}));try{const e=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||e.abandoned)return void this.fire(new t.k("dataabort",{dataType:"source"}));let i=null;e.resourceTiming&&e.resourceTiming[this.id]&&(i=e.resourceTiming[this.id].slice(0));const r={dataType:"source"};this._collectResourceTiming&&i&&i.length>0&&t.e(r,{resourceTiming:i}),this.fire(new t.k("data",Object.assign(Object.assign({},r),{sourceDataType:"metadata"}))),this.fire(new t.k("data",Object.assign(Object.assign({},r),{sourceDataType:"content"})))}catch(e){if(this._pendingLoads--,this._removed)return void this.fire(new t.k("dataabort",{dataType:"source"}));this.fire(new t.j(e))}}))}loaded(){return 0===this._pendingLoads}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.actor?"RT":"LT";e.actor=this.actor;const n={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const i=yield this.actor.sendAsync({type:t,data:n},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(i,this.map.painter,"RT"===t)}))}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return t.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var X=t.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Y extends t.E{constructor(e,t,n,i){super(),this.id=e,this.dispatcher=n,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=t}load(e){return t._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const t=yield p.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(e){this._request=null,this._loaded=!0,this.fire(new t.j(e))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(t.Y.fromLngLat);this.tileID=function(e){let n=1/0,i=1/0,r=-1/0,a=-1/0;for(const t of e)n=Math.min(n,t.x),i=Math.min(i,t.y),r=Math.max(r,t.x),a=Math.max(a,t.y);const o=Math.max(r-n,a-i),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,s);return new t.a0(s,Math.floor((n+r)/2*l),Math.floor((i+a)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z;const i=n.map((e=>this.tileID.getTilePoint(e)._round()));return this._boundsArray=new t.Z,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,t.W,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,t.W),this._boundsArray.emplaceBack(i[2].x,i[2].y,t.W,t.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=t.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new b(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return t._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class J extends Y{constructor(e,t,n,i){super(e,t,n,i),this.roundZoom=!0,this.type="video",this.options=t}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{const e=yield t.a2(this.urls);if(this._loaded=!0,!e)return;this.video=e,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(e){this.fire(new t.j(e))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.j(new t.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=t.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new b(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Q extends Y{constructor(e,n,i,r){super(e,n,i,r),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new t.j(new t.a1(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.j(new t.a1(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.j(new t.a1(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new t.j(new t.a1(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.j(new t.a1(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,i=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=t.$.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new b(n,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ee={},te=e=>{switch(e){case"geojson":return K;case"image":return Y;case"raster":return G;case"raster-dem":return W;case"vector":return Z;case"video":return J;case"canvas":return Q}return ee[e]},ne="RTLPluginLoaded";class ie extends t.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=N()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((e=>{throw this.status="error",e}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return t._(this,arguments,void 0,(function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){if(t.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(t.url=a.resolveURL(e),!t.url)throw new Error(`requested url ${e} is invalid`);if("unavailable"===t.status){if(!n)return t._requestImport();t.status="deferred",t._syncState(t.status)}else if("requested"===t.status)return t._requestImport()}()}))}_requestImport(){return t._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new t.k(ne))}))}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let re=null;function ae(){return re||(re=new ie),re}class oe{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=t.a3(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const n={};if(!t)return n;for(const i of e){const e=i.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){i.layers=e,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)n[t.id]=i}}return n}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const n=this.buckets[e];if(n instanceof t.a5){if(this.hasSymbolBuckets=!0,!i)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const n=this.buckets[e];if(n instanceof t.a5&&n.hasRTLText){this.hasRTLText=!0,ae().lazyLoad();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(e).queryRadius(t))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const n in this.buckets){const t=this.buckets[n];t.uploadPending()&&t.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new b(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new b(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,n,i,r,a,o,s,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:r,scale:a,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:o,queryPadding:this.queryPadding*l},e,t,n):{}}querySourceFeatures(e,n){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const r=i.loadVTLayers(),a=n&&n.sourceLayer?n.sourceLayer:"",o=r._geojsonTileLayer||r[a];if(!o)return;const s=t.a6(n&&n.filter),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let d=0;d<o.length;d++){const n=o.feature(d);if(s.needGeometry){const e=t.a7(n,!0);if(!s.filter(new t.a8(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new t.a8(this.tileID.overscaledZ),n))continue;const r=i.getId(n,a),p=new t.a9(n,l,c,u,r);p.tile=h,e.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const n=t.aa(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(n)if(this.expirationTime<n)t=!0;else{const i=this.expirationTime-n;i?this.expirationTime=e+Math.max(i,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const i in this.buckets){if(!t.style.hasLayer(i))continue;const r=this.buckets[i],a=r.layers[0].sourceLayer||"_geojsonTileLayer",o=n[a],s=e[a];if(!o||!s||0===Object.keys(s).length)continue;r.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=t&&t.style&&t.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=a.now()+e}setDependencies(e,t){const n={};for(const i of t)n[i]=!0;this.dependencies[e]=n}hasDependency(e,t){for(const n of e){const e=this.dependencies[n];if(e)for(const n of t)if(e[n])return!0}return!1}}class se{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,n){const i=e.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const r={value:t,timeout:void 0};if(void 0!==n&&(r.timeout=setTimeout((()=>{this.remove(e,r)}),n)),this.data[i].push(r),this.order.push(i),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const n=e.wrapped().key,i=void 0===t?0:this.data[n].indexOf(t),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const n in this.data)for(const i of this.data[n])e(i.value)||t.push(i);for(const n of t)this.remove(n.value.tileID,n)}}class le{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,i){const r=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][r]=this.stateChanges[e][r]||{},t.e(this.stateChanges[e][r],i),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==r&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][r]){this.deletedStates[e][r]={};for(const t in this.state[e][r])i[t]||(this.deletedStates[e][r][t]=null)}else for(const t in i)this.deletedStates[e]&&this.deletedStates[e][r]&&null===this.deletedStates[e][r][t]&&delete this.deletedStates[e][r][t]}removeFeatureState(e,t,n){if(null===this.deletedStates[e])return;const i=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&void 0!==t)null!==this.deletedStates[e][i]&&(this.deletedStates[e][i]=this.deletedStates[e][i]||{},this.deletedStates[e][i][n]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][i])for(n in this.deletedStates[e][i]={},this.stateChanges[e][i])this.deletedStates[e][i][n]=null;else this.deletedStates[e][i]=null;else this.deletedStates[e]=null}getState(e,n){const i=String(n),r=t.e({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const t=this.deletedStates[e][n];if(null===t)return{};for(const e in t)delete r[e]}return r}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,n){const i={};for(const r in this.stateChanges){this.state[r]=this.state[r]||{};const e={};for(const n in this.stateChanges[r])this.state[r][n]||(this.state[r][n]={}),t.e(this.state[r][n],this.stateChanges[r][n]),e[n]=this.state[r][n];i[r]=e}for(const r in this.deletedStates){this.state[r]=this.state[r]||{};const e={};if(null===this.deletedStates[r])for(const t in this.state[r])e[t]={},this.state[r][t]={};else for(const t in this.deletedStates[r]){if(null===this.deletedStates[r][t])this.state[r][t]={};else for(const e of Object.keys(this.deletedStates[r][t]))delete this.state[r][t][e];e[t]=this.state[r][t]}i[r]=i[r]||{},t.e(i[r],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const t in e)e[t].setFeatureState(i,n)}}class ce extends t.E{constructor(e,t,n){super(),this.id=e,this.dispatcher=n,this.on("data",(e=>this._dataHandler(e))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((e,t,n,i)=>{const r=new(te(t.type))(e,t,n,i);if(r.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${r.id}`);return r})(e,t,n,this),this._tiles={},this._cache=new se(0,(e=>this._unloadTile(e))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new le,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,i){return t._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,i)}catch(n){e.state="errored",404!==n.status?this._source.fire(new t.j(n,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new t.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const n=this._tiles[t];n.upload(e),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(ue).map((e=>e.key))}getRenderableIds(e){const n=[];for(const t in this._tiles)this._isIdRenderable(t,e)&&n.push(this._tiles[t]);return e?n.sort(((e,n)=>{const i=e.tileID,r=n.tileID,a=new t.P(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),o=new t.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-r.overscaledZ||o.y-a.y||o.x-a.x})).map((e=>e.tileID.key)):n.map((e=>e.tileID)).sort(ue).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")}}_reloadTile(e,n){return t._(this,void 0,void 0,(function*(){const t=this._tiles[e];t&&("loading"!==t.state&&(t.state=n),yield this._loadTile(t,e,n))}))}_tileLoaded(e,n,i){e.timeAdded=a.now(),"expired"===i&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const t=this.getRenderableIds();for(let i=0;i<t.length;i++){const r=t[i];if(e.neighboringTiles&&e.neighboringTiles[r]){const t=this.getTileByID(r);n(e,t),n(t,e)}}function n(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let n=t.tileID.canonical.x-e.tileID.canonical.x;const i=t.tileID.canonical.y-e.tileID.canonical.y,r=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,n,i),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,n,i){for(const r in this._tiles){let a=this._tiles[r];if(i[r]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>n)continue;let o=a.tileID;for(;a&&a.tileID.overscaledZ>t+1;){const e=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[e.key],a&&a.hasData()&&(o=e)}let s=o;for(;s.overscaledZ>t;)if(s=s.scaledTo(s.overscaledZ-1),e[s.key]){i[o.key]=o;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=t?n:null}for(let n=e.overscaledZ-1;n>=t;n--){const t=e.scaledTo(n),i=this._getLoadedTile(t);if(i)return i}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,i=Math.ceil(e.height/this._source.tileSize)+1,r=Math.floor(n*i*(null===this._maxTileCacheZoomLevels?t.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(a)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const n in this._tiles){const i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),e[i.tileID.key]=i}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}_updateCoveredAndRetainedTiles(e,t,n,i,r,o){const s={},l={},c=Object.keys(e),u=a.now();for(const a of c){const n=e[a],i=this._tiles[a];if(!i||0!==i.fadeEndTime&&i.fadeEndTime<=u)continue;const r=this.findLoadedParent(n,t),o=this.findLoadedSibling(n),c=r||o||null;c&&(this._addTile(c.tileID),s[c.tileID.key]=c.tileID),l[a]=n}this._retainLoadedChildren(l,i,n,e);for(const a in s)e[a]||(this._coveredTiles[a]=!0,e[a]=s[a]);if(o){const t={},n={};for(const e of r)this._tiles[e.key].hasData()?t[e.key]=e:n[e.key]=e;for(const i in n){const r=n[i].children(this._source.maxzoom);this._tiles[r[0].key]&&this._tiles[r[1].key]&&this._tiles[r[2].key]&&this._tiles[r[3].key]&&(t[r[0].key]=e[r[0].key]=r[0],t[r[1].key]=e[r[1].key]=r[1],t[r[2].key]=e[r[2].key]=r[2],t[r[3].key]=e[r[3].key]=r[3],delete n[i])}for(const i in n){const r=n[i],a=this.findLoadedParent(r,this._source.minzoom),o=this.findLoadedSibling(r),s=a||o||null;if(s){t[s.tileID.key]=e[s.tileID.key]=s.tileID;for(const e in t)t[e].isChildOf(s.tileID)&&delete t[e]}}for(const e in this._tiles)t[e]||(this._coveredTiles[e]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let i;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new t.Q(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(i=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n}),this._source.hasTile&&(i=i.filter((e=>this._source.hasTile(e))))):i=[];const r=e.coveringZoomLevel(this._source),a=Math.max(r-ce.maxOverzooming,this._source.minzoom),o=Math.max(r+ce.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const e={};for(const t of i)if(t.canonical.z>this._source.minzoom){const n=t.scaledTo(t.canonical.z-1);e[n.key]=n;const i=t.scaledTo(Math.max(this._source.minzoom,Math.min(t.canonical.z,5)));e[i.key]=i}i=i.concat(Object.values(e))}const s=0===i.length&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new t.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(i,r);he(this._source.type)&&this._updateCoveredAndRetainedTiles(l,a,o,r,i,n);for(const t in l)this._tiles[t].clearFadeHold();const c=t.ab(this._tiles,l);for(const t of c){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){var n;const i={},r={},a=Math.max(t-ce.maxOverzooming,this._source.minzoom),o=Math.max(t+ce.maxUnderzooming,this._source.minzoom),s={};for(const l of e){const e=this._addTile(l);i[l.key]=l,e.hasData()||t<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,t,o,i);for(const l of e){let e=this._tiles[l.key];if(e.hasData())continue;if(t+1>this._source.maxzoom){const e=l.children(this._source.maxzoom)[0],t=this.getTile(e);if(t&&t.hasData()){i[e.key]=e;continue}}else{const e=l.children(this._source.maxzoom);if(i[e[0].key]&&i[e[1].key]&&i[e[2].key]&&i[e[3].key])continue}let o=e.wasRequested();for(let t=l.overscaledZ-1;t>=a;--t){const a=l.scaledTo(t);if(r[a.key])break;if(r[a.key]=!0,e=this.getTile(a),!e&&o&&(e=this._addTile(a)),e){const t=e.hasData();if((t||!(null===(n=this.map)||void 0===n?void 0:n.cancelPendingTileRequestsWhileZooming)||o)&&(i[a.key]=a),o=e.wasRequested(),t)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let n,i=this._tiles[e].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}t.push(i.key);const e=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(e),n)break;i=e}for(const e of t)this._loadedParentTiles[e]=n}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const t=this._tiles[e].tileID,n=this._getLoadedTile(t);this._loadedSiblingTiles[t.key]=n}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const i=n;return n||(n=new oe(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,i||this._source.fire(new t.k("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),n))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){const t=e.sourceDataType;"source"===e.dataType&&"metadata"===t&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===t&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,i){const r=[],a=this.transform;if(!a)return r;const o=i?a.getCameraQueryGeometry(e):e,s=e.map((e=>a.pointCoordinate(e,this.terrain))),l=o.map((e=>a.pointCoordinate(e,this.terrain))),c=this.getIds();let u=1/0,h=1/0,d=-1/0,p=-1/0;for(const t of l)u=Math.min(u,t.x),h=Math.min(h,t.y),d=Math.max(d,t.x),p=Math.max(p,t.y);for(let f=0;f<c.length;f++){const e=this._tiles[c[f]];if(e.holdingForFade())continue;const i=e.tileID,o=Math.pow(2,a.zoom-e.tileID.overscaledZ),m=n*e.queryPadding*t.W/e.tileSize/o,g=[i.getTilePoint(new t.Y(u,h)),i.getTilePoint(new t.Y(d,p))];if(g[0].x-m<t.W&&g[0].y-m<t.W&&g[1].x+m>=0&&g[1].y+m>=0){const t=s.map((e=>i.getTilePoint(e))),n=l.map((e=>i.getTilePoint(e)));r.push({tile:e,tileID:i,queryGeometry:t,cameraQueryGeometry:n,scale:o})}}return r}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map((e=>this._tiles[e].tileID));for(const n of t)n.posMatrix=this.transform.calculatePosMatrix(n.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(he(this._source.type)){const e=a.now();for(const t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,n){this._state.updateState(e=e||"_geojsonTileLayer",t,n)}removeFeatureState(e,t,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,n)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,n){const i=this._tiles[e];i&&i.setDependencies(t,n)}reloadTilesForDependencies(e,t){for(const n in this._tiles)this._tiles[n].hasDependency(e,t)&&this._reloadTile(n,"reloading");this._cache.filter((n=>!n.hasDependency(e,t)))}}function ue(e,t){const n=Math.abs(2*e.wrap)-+(e.wrap<0),i=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||i-n||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function he(e){return"raster"===e||"image"===e||"video"===e}ce.maxOverzooming=10,ce.maxUnderzooming=3;class de{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.ac(e,0,1);let n=1,i=this._distances[n];const r=e*this.paddedLength+this.padding;for(;i<r&&n<this._distances.length;)i=this._distances[++n];const a=n-1,o=this._distances[a],s=i-o,l=s>0?(r-o)/s:0;return this.points[a].mult(1-l).add(this.points[n].mult(l))}}function pe(e,t){let n=!0;return"always"===e||"never"!==e&&"never"!==t||(n=!1),n}class fe{constructor(e,t,n){const i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(t/n);for(let a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,n,i,r){this._forEachCell(t,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}insertCircle(e,t,n,i){this._forEachCell(t-i,n-i,t+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(n),this.circles.push(i)}_insertBoxCell(e,t,n,i,r,a){this.boxCells[r].push(a)}_insertCircleCell(e,t,n,i,r,a){this.circleCells[r].push(a)}_query(e,t,n,i,r,a,o){if(n<0||e>this.width||i<0||t>this.height)return[];const s=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=i){if(r)return[{key:null,x1:e,y1:t,x2:n,y2:i}];for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],n=this.circles[3*e+1],i=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-i,y1:n-i,x2:t+i,y2:n+i})}}else this._forEachCell(e,t,n,i,this._queryCell,s,{hitTest:r,overlapMode:a,seenUids:{box:{},circle:{}}},o);return s}query(e,t,n,i){return this._query(e,t,n,i,!1,null)}hitTest(e,t,n,i,r,a){return this._query(e,t,n,i,!0,r,a).length>0}hitTestCircle(e,t,n,i,r){const a=e-n,o=e+n,s=t-n,l=t+n;if(o<0||a>this.width||l<0||s>this.height)return!1;const c=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:i,circle:{x:e,y:t,radius:n},seenUids:{box:{},circle:{}}},r),c.length>0}_queryCell(e,t,n,i,r,a,o,s){const{seenUids:l,hitTest:c,overlapMode:u}=o,h=this.boxCells[r];if(null!==h){const r=this.bboxes;for(const o of h)if(!l.box[o]){l.box[o]=!0;const h=4*o,d=this.boxKeys[o];if(e<=r[h+2]&&t<=r[h+3]&&n>=r[h+0]&&i>=r[h+1]&&(!s||s(d))&&(!c||!pe(u,d.overlapMode))&&(a.push({key:d,x1:r[h],y1:r[h+1],x2:r[h+2],y2:r[h+3]}),c))return!0}}const d=this.circleCells[r];if(null!==d){const r=this.circles;for(const o of d)if(!l.circle[o]){l.circle[o]=!0;const h=3*o,d=this.circleKeys[o];if(this._circleAndRectCollide(r[h],r[h+1],r[h+2],e,t,n,i)&&(!s||s(d))&&(!c||!pe(u,d.overlapMode))){const e=r[h],t=r[h+1],n=r[h+2];if(a.push({key:d,x1:e-n,y1:t-n,x2:e+n,y2:t+n}),c)return!0}}}return!1}_queryCellCircle(e,t,n,i,r,a,o,s){const{circle:l,seenUids:c,overlapMode:u}=o,h=this.boxCells[r];if(null!==h){const e=this.bboxes;for(const t of h)if(!c.box[t]){c.box[t]=!0;const n=4*t,i=this.boxKeys[t];if(this._circleAndRectCollide(l.x,l.y,l.radius,e[n+0],e[n+1],e[n+2],e[n+3])&&(!s||s(i))&&!pe(u,i.overlapMode))return a.push(!0),!0}}const d=this.circleCells[r];if(null!==d){const e=this.circles;for(const t of d)if(!c.circle[t]){c.circle[t]=!0;const n=3*t,i=this.circleKeys[t];if(this._circlesCollide(e[n],e[n+1],e[n+2],l.x,l.y,l.radius)&&(!s||s(i))&&!pe(u,i.overlapMode))return a.push(!0),!0}}}_forEachCell(e,t,n,i,r,a,o,s){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,e,t,n,i,this.xCellCount*l+d,a,o,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,n,i,r,a){const o=i-e,s=r-t,l=n+a;return l*l>o*o+s*s}_circleAndRectCollide(e,t,n,i,r,a,o){const s=(a-i)/2,l=Math.abs(e-(i+s));if(l>s+n)return!1;const c=(o-r)/2,u=Math.abs(t-(r+c));if(u>c+n)return!1;if(l<=s||u<=c)return!0;const h=l-s,d=u-c;return h*h+d*d<=n*n}}function me(e,n,i,r,a){const o=t.F();return n?(t.J(o,o,[1/a,1/a,1]),i||t.ad(o,o,r.angle)):t.K(o,r.labelPlaneMatrix,e),o}function ge(e,n,i,r,a){if(n){const n=t.ae(e);return t.J(n,n,[a,a,1]),i||t.ad(n,n,-r.angle),n}return r.glCoordMatrix}function ye(e,n,i){let r;i?(r=[e.x,e.y,i(e.x,e.y),1],t.af(r,r,n)):(r=[e.x,e.y,0,1],function(e,t,n){const i=t[0],r=t[1];e[0]=n[0]*i+n[4]*r+n[12],e[1]=n[1]*i+n[5]*r+n[13],e[3]=n[3]*i+n[7]*r+n[15]}(r,r,n));const a=r[3];return{point:new t.P(r[0]/a,r[1]/a),signedDistanceFromCamera:a,isOccluded:!1}}function _e(e,t){return.5+e/t*.5}function ve(e,t){return e.x>=-t[0]&&e.x<=t[0]&&e.y>=-t[1]&&e.y<=t[1]}function xe(e,n,i,r,a,o,s,l,c,u,h,d,p,f,m){const g=r?e.textSizeData:e.iconSizeData,y=t.ag(g,i.transform.zoom),_=[256/i.width*2+1,256/i.height*2+1],v=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;v.clear();const x=e.lineVertexArray,b=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,w=i.transform.width/i.transform.height;let S=!1;for(let T=0;T<b.length;T++){const r=b.get(T);if(r.hidden||r.writingMode===t.ah.vertical&&!S){Me(r.numGlyphs,v);continue}S=!1;const C=ye(new t.P(r.anchorX,r.anchorY),n,m);if(!ve(C.point,_)){Me(r.numGlyphs,v);continue}const I=_e(i.transform.cameraToCenterDistance,C.signedDistanceFromCamera),k=t.ai(g,y,r),E=s?k/I:k*I,P={getElevation:m,labelPlaneMatrix:a,lineVertexArray:x,pitchWithMap:s,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:u,tileAnchorPoint:new t.P(r.anchorX,r.anchorY),unwrappedTileID:h,width:d,height:p,translation:f},A=Se(P,r,E,!1,l,n,o,e.glyphOffsetArray,v,w,c);S=A.useVertical,(A.notEnoughRoom||S||A.needsFlipping&&Se(P,r,E,!0,l,n,o,e.glyphOffsetArray,v,w,c).notEnoughRoom)&&Me(r.numGlyphs,v)}r?e.text.dynamicLayoutVertexBuffer.updateData(v):e.icon.dynamicLayoutVertexBuffer.updateData(v)}function be(e,t,n,i,r,a,o,s){const l=a.glyphStartIndex+a.numGlyphs,c=a.lineStartIndex,u=a.lineStartIndex+a.lineLength,h=t.getoffsetX(a.glyphStartIndex),d=t.getoffsetX(l-1),p=Pe(e*h,n,i,r,a.segment,c,u,s,o);if(!p)return null;const f=Pe(e*d,n,i,r,a.segment,c,u,s,o);return f?s.projectionCache.anyProjectionOccluded?null:{first:p,last:f}:null}function we(e,n,i,r){return e===t.ah.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(e===t.ah.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function Se(e,n,i,r,a,o,s,l,c,u,h){const d=i/24,p=n.lineOffsetX*d,f=n.lineOffsetY*d;let m;if(n.numGlyphs>1){const t=n.glyphStartIndex+n.numGlyphs,i=n.lineStartIndex,o=n.lineStartIndex+n.lineLength,c=be(d,l,p,f,r,n,h,e);if(!c)return{notEnoughRoom:!0};const g=ye(c.first.point,s,e.getElevation).point,y=ye(c.last.point,s,e.getElevation).point;if(a&&!r){const e=we(n.writingMode,g,y,u);if(e)return e}m=[c.first];for(let a=n.glyphStartIndex+1;a<t-1;a++)m.push(Pe(d*l.getoffsetX(a),p,f,r,n.segment,i,o,e,h));m.push(c.last)}else{if(a&&!r){const i=ye(e.tileAnchorPoint,o,e.getElevation).point,r=n.lineStartIndex+n.segment+1,a=new t.P(e.lineVertexArray.getx(r),e.lineVertexArray.gety(r)),s=ye(a,o,e.getElevation),l=s.signedDistanceFromCamera>0?s.point:function(e,t,n,i,r,a){return Te(e,t,n,1,r,a)}(e.tileAnchorPoint,a,i,0,o,e),c=we(n.writingMode,i,l,u);if(c)return c}const i=Pe(d*l.getoffsetX(n.glyphStartIndex),p,f,r,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,e,h);if(!i||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};m=[i]}for(const g of m)t.aj(c,g.point,g.angle);return{}}function Te(e,t,n,i,r,a){const o=e.add(e.sub(t)._unit()),s=void 0!==r?ye(o,r,a.getElevation).point:Ie(o.x,o.y,a).point,l=n.sub(s);return n.add(l._mult(i/l.mag()))}function Ce(e,n,i){const r=n.projectionCache;if(r.projections[e])return r.projections[e];const a=new t.P(n.lineVertexArray.getx(e),n.lineVertexArray.gety(e)),o=Ie(a.x,a.y,n);if(o.signedDistanceFromCamera>0)return r.projections[e]=o.point,r.anyProjectionOccluded=r.anyProjectionOccluded||o.isOccluded,o.point;const s=e-i.direction;return function(e,t,n,i,r){return Te(e,t,n,i,void 0,r)}(0===i.distanceFromAnchor?n.tileAnchorPoint:new t.P(n.lineVertexArray.getx(s),n.lineVertexArray.gety(s)),a,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,n)}function Ie(e,n,i){const r=e+i.translation[0],a=n+i.translation[1];let o;return!i.pitchWithMap&&i.projection.useSpecialProjectionForSymbols?(o=i.projection.projectTileCoordinates(r,a,i.unwrappedTileID,i.getElevation),o.point.x=(.5*o.point.x+.5)*i.width,o.point.y=(.5*-o.point.y+.5)*i.height):(o=ye(new t.P(r,a),i.labelPlaneMatrix,i.getElevation),o.isOccluded=!1),o}function ke(e,t,n){return e._unit()._perp()._mult(t*n)}function Ee(e,n,i,r,a,o,s,l,c){if(l.projectionCache.offsets[e])return l.projectionCache.offsets[e];const u=i.add(n);if(e+c.direction<r||e+c.direction>=a)return l.projectionCache.offsets[e]=u,u;const h=Ce(e+c.direction,l,c),d=ke(h.sub(i),s,c.direction),p=i.add(d),f=h.add(d);return l.projectionCache.offsets[e]=t.ak(o,u,p,f)||u,l.projectionCache.offsets[e]}function Pe(e,t,n,i,r,a,o,s,l){const c=i?e-t:e+t;let u=c>0?1:-1,h=0;i&&(u*=-1,h=Math.PI),u<0&&(h+=Math.PI);let d,p=u>0?a+r:a+r+1;s.projectionCache.cachedAnchorPoint?d=s.projectionCache.cachedAnchorPoint:(d=Ie(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,s.projectionCache.cachedAnchorPoint=d);let f,m,g=d,y=d,_=0,v=0;const x=Math.abs(c),b=[];let w;for(;_+v<=x;){if(p+=u,p<a||p>=o)return null;_+=v,y=g,m=f;const e={absOffsetX:x,direction:u,distanceFromAnchor:_,previousVertex:y};if(g=Ce(p,s,e),0===n)b.push(y),w=g.sub(y);else{let t;const i=g.sub(y);t=0===i.mag()?ke(Ce(p+u,s,e).sub(g),n,u):ke(i,n,u),m||(m=y.add(t)),f=Ee(p,t,g,a,o,m,n,s,e),b.push(m),w=f.sub(m)}v=w.mag()}const S=w._mult((x-_)/v)._add(m||y),T=h+Math.atan2(g.y-y.y,g.x-y.x);return b.push(S),{point:S,angle:l?T:0,path:b}}const Ae=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Me(e,t){for(let n=0;n<e;n++){const e=t.length;t.resize(e+4),t.float32.set(Ae,3*e)}}const ze=100;class Le{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new fe(e.width+200,e.height+200,25),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new fe(e.width+200,e.height+200,25);this.transform=e,this.mapProjection=t,this.grid=n,this.ignoredGrid=i,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+ze,this.screenBottomBoundary=e.height+ze,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,n,i,r,a,o,s,l,c,u){const h=e.anchorPointX+s[0],d=e.anchorPointY+s[1],p=this.projectAndGetPerspectiveRatio(i,h,d,r,c),f=this._projectCollisionBox(e,n,i,r,a,o,s,p,c,u),[m,g,y,_]=f.box;return this.mapProjection.useSpecialProjectionForSymbols&&(a?f.allPointsOccluded:this.mapProjection.isOccluded(h,d,r))||p.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(m,g,y,_)||"always"!==t&&this.grid.hitTest(m,g,y,_,t,l)?{box:[m,g,y,_],placeable:!1,offscreen:!1}:{box:[m,g,y,_],placeable:!0,offscreen:this.isOffscreen(m,g,y,_)}}placeCollisionCircles(e,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g){const y=[],_=new t.P(n.anchorX,n.anchorY),v=this.getPerspectiveRatio(o,_.x,_.y,s,g),x=(h?a/v:a*v)/t.ap,b={getElevation:g,labelPlaneMatrix:l,lineVertexArray:i,pitchWithMap:h,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:_,unwrappedTileID:s,width:this.transform.width,height:this.transform.height,translation:m},w=be(x,r,n.lineOffsetX*x,n.lineOffsetY*x,!1,n,!1,b);let S=!1,T=!1,C=!0;if(w){const n=.5*p*v+f,i=new t.P(-100,-100),r=new t.P(this.screenRightBoundary,this.screenBottomBoundary),a=new de,o=w.first,s=w.last;let l=[];for(let e=o.path.length-1;e>=1;e--)l.push(o.path[e]);for(let e=1;e<s.path.length;e++)l.push(s.path[e]);const h=2.5*n;if(c){const e=this.projectPathToScreenSpace(l,b,c);l=e.some((e=>e.signedDistanceFromCamera<=0))?[]:e.map((e=>e.point))}let m=[];if(l.length>0){const e=l[0].clone(),n=l[0].clone();for(let t=1;t<l.length;t++)e.x=Math.min(e.x,l[t].x),e.y=Math.min(e.y,l[t].y),n.x=Math.max(n.x,l[t].x),n.y=Math.max(n.y,l[t].y);m=e.x>=i.x&&n.x<=r.x&&e.y>=i.y&&n.y<=r.y?[l]:n.x<i.x||e.x>r.x||n.y<i.y||e.y>r.y?[]:t.al([l],i.x,i.y,r.x,r.y)}for(const t of m){a.reset(t,.25*n);let i=0;i=a.length<=.5*n?1:Math.ceil(a.paddedLength/h)+1;for(let t=0;t<i;t++){const r=t/Math.max(i-1,1),o=a.lerp(r),s=o.x+ze,l=o.y+ze;y.push(s,l,n,0);const c=s-n,h=l-n,p=s+n,f=l+n;if(C=C&&this.isOffscreen(c,h,p,f),T=T||this.isInsideGrid(c,h,p,f),"always"!==e&&this.grid.hitTestCircle(s,l,n,e,d)&&(S=!0,!u))return{circles:[],offscreen:!1,collisionDetected:S}}}}return{circles:!u&&S||!T||v<this.perspectiveRatioCutoff?[]:y,offscreen:C,collisionDetected:S}}projectPathToScreenSpace(e,t,n){return e.map((e=>ye(e,n,t.getElevation)))}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let i=1/0,r=1/0,a=-1/0,o=-1/0;for(const u of e){const e=new t.P(u.x+ze,u.y+ze);i=Math.min(i,e.x),r=Math.min(r,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y),n.push(e)}const s=this.grid.query(i,r,a,o).concat(this.ignoredGrid.query(i,r,a,o)),l={},c={};for(const u of s){const e=u.key;if(void 0===l[e.bucketInstanceId]&&(l[e.bucketInstanceId]={}),l[e.bucketInstanceId][e.featureIndex])continue;const i=[new t.P(u.x1,u.y1),new t.P(u.x2,u.y1),new t.P(u.x2,u.y2),new t.P(u.x1,u.y2)];t.am(n,i)&&(l[e.bucketInstanceId][e.featureIndex]=!0,void 0===c[e.bucketInstanceId]&&(c[e.bucketInstanceId]=[]),c[e.bucketInstanceId].push(e.featureIndex))}return c}insertCollisionBox(e,t,n,i,r,a){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:r,collisionGroupID:a,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,n,i,r,a){const o=n?this.ignoredGrid:this.grid,s={bucketInstanceId:i,featureIndex:r,collisionGroupID:a,overlapMode:t};for(let l=0;l<e.length;l+=4)o.insertCircle(s,e[l],e[l+1],e[l+2])}projectAndGetPerspectiveRatio(e,n,i,r,a){const o=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(n,i,r,a):ye(new t.P(n,i),e,a);return{point:new t.P((o.point.x+1)/2*this.transform.width+ze,(1-o.point.y)/2*this.transform.height+ze),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o.signedDistanceFromCamera*.5,isOccluded:o.isOccluded,signedDistanceFromCamera:o.signedDistanceFromCamera}}getPerspectiveRatio(e,n,i,r,a){const o=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(n,i,r,a):ye(new t.P(n,i),e,a);return.5+this.transform.cameraToCenterDistance/o.signedDistanceFromCamera*.5}isOffscreen(e,t,n,i){return n<ze||e>=this.screenRightBoundary||i<ze||t>this.screenBottomBoundary}isInsideGrid(e,t,n,i){return n>=0&&e<this.gridRightBoundary&&i>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const e=t.an([]);return t.H(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,i,r,a,o,s,l,c,u){const h=n*l.perspectiveRatio;let d=new t.P(1,0),p=new t.P(0,1);const f=new t.P(e.anchorPointX+s[0],e.anchorPointY+s[1]);if(o&&!a){const e=this.projectAndGetPerspectiveRatio(i,f.x+1,f.y,r,c).point.sub(l.point).unit(),n=Math.atan(e.y/e.x)+(e.x<0?Math.PI:0),a=Math.sin(n),o=Math.cos(n);d=new t.P(o,a),p=new t.P(-a,o)}else if(!o&&a){const e=-this.transform.angle,n=Math.sin(e),i=Math.cos(e);d=new t.P(i,n),p=new t.P(-n,i)}let m=l.point,g=h;if(a){m=f;const e=this.transform.zoom-Math.floor(this.transform.zoom);g=Math.pow(2,-e),g*=this.mapProjection.getPitchedTextCorrection(this.transform,f,r),u||(g*=t.ac(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}u&&(m=m.add(d.mult(u.x*g)).add(p.mult(u.y*g)));const y=e.x1*g,_=e.x2*g,v=(y+_)/2,x=e.y1*g,b=e.y2*g,w=(x+b)/2,S=[{offsetX:y,offsetY:x},{offsetX:v,offsetY:x},{offsetX:_,offsetY:x},{offsetX:_,offsetY:w},{offsetX:_,offsetY:b},{offsetX:v,offsetY:b},{offsetX:y,offsetY:b},{offsetX:y,offsetY:w}];let T=[];for(const{offsetX:I,offsetY:k}of S)T.push(new t.P(m.x+d.x*I+p.x*k,m.y+d.y*I+p.y*k));let C=!1;if(a){const e=T.map((e=>this.projectAndGetPerspectiveRatio(i,e.x,e.y,r,c)));C=e.some((e=>!e.isOccluded)),T=e.map((e=>e.point))}else C=!0;return{box:t.ao(T),allPointsOccluded:!C}}}function De(e,n,i){return n*(t.W/(e.tileSize*Math.pow(2,i-e.tileID.overscaledZ)))}class Re{constructor(e,t,n,i){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):i&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class Fe{constructor(e,t,n,i,r){this.text=new Re(e?e.text:null,t,n,r),this.icon=new Re(e?e.icon:null,t,i,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Oe{constructor(e,t,n){this.text=e,this.icon=t,this.skipFade=n}}class Be{constructor(){this.invProjMatrix=t.F(),this.viewportMatrix=t.F(),this.circles=[]}}class Ne{constructor(e,t,n,i,r){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}}class Ve{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function Ue(e,n,i,r,a){const{horizontalAlign:o,verticalAlign:s}=t.au(e);return new t.P(-(o-.5)*n+r[0]*a,-(s-.5)*i+r[1]*a)}class je{constructor(e,t,n,i,r,a){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new Le(this.transform,t),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new Ve(r),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const t=this.terrain;return t?(n,i)=>t.getElevation(e,n,i):null}getBucketParts(e,n,i,r){const a=i.getBucket(n),o=i.latestFeatureIndex;if(!a||!o||n.id!==a.layerIds[0])return;const s=i.collisionBoxArray,l=a.layers[0].layout,c=a.layers[0].paint,u=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),h=i.tileSize/t.W,d=i.tileID.toUnwrapped(),p=this.transform.calculatePosMatrix(d),f="map"===l.get("text-pitch-alignment"),m="map"===l.get("text-rotation-alignment"),g=De(i,1,this.transform.zoom),y=this.collisionIndex.mapProjection.translatePosition(this.transform,i,c.get("text-translate"),c.get("text-translate-anchor")),_=this.collisionIndex.mapProjection.translatePosition(this.transform,i,c.get("icon-translate"),c.get("icon-translate-anchor")),v=me(p,f,m,this.transform,g);let x=null;if(f){const e=ge(p,f,m,this.transform,g);x=t.K([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[a.bucketInstanceId]=new Ne(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,i.tileID);const b={bucket:a,layout:l,translationText:y,translationIcon:_,posMatrix:p,unwrappedTileID:d,textLabelPlaneMatrix:v,labelToScreenMatrix:x,scale:u,textPixelRatio:h,holdingForFade:i.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.ag(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(r)for(const t of a.sortKeyRanges){const{sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r}=t;e.push({sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r,parameters:b})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:b})}attemptAnchorPlacement(e,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g,y,_,v){const x=t.aq[e.textAnchor],b=[e.textOffset0,e.textOffset1],w=Ue(x,i,r,b,a),S=this.collisionIndex.placeCollisionBox(n,d,l,c,u,s,o,g,h.predicate,v,w);if((!_||this.collisionIndex.placeCollisionBox(_,d,l,c,u,s,o,y,h.predicate,v,w).placeable)&&S.placeable){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(e=this.prevPlacement.variableOffsets[p.crossTileID].anchor),0===p.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:b,width:i,height:r,anchor:x,textBoxScale:a,prevAnchor:e},this.markUsedJustification(f,x,p,m),f.allowVerticalPlacement&&(this.markUsedOrientation(f,m,p),this.placedOrientations[p.crossTileID]=m),{shift:w,placedGlyphBoxes:S}}}placeLayerBucketPart(e,n,i){const{bucket:r,layout:a,translationText:o,translationIcon:s,posMatrix:l,unwrappedTileID:c,textLabelPlaneMatrix:u,labelToScreenMatrix:h,textPixelRatio:d,holdingForFade:p,collisionBoxArray:f,partiallyEvaluatedTextSize:m,collisionGroup:g}=e.parameters,y=a.get("text-optional"),_=a.get("icon-optional"),v=t.ar(a,"text-overlap","text-allow-overlap"),x="always"===v,b=t.ar(a,"icon-overlap","icon-allow-overlap"),w="always"===b,S="map"===a.get("text-rotation-alignment"),T="map"===a.get("text-pitch-alignment"),C="none"!==a.get("icon-text-fit"),I="viewport-y"===a.get("symbol-z-order"),k=x&&(w||!r.hasIconData()||_),E=w&&(x||!r.hasTextData()||y);!r.collisionArrays&&f&&r.deserializeCollisionBoxes(f);const P=this._getTerrainElevationFunc(this.retainedQueryData[r.bucketInstanceId].tileID),A=(e,f,w)=>{var I,A;if(n[e.crossTileID])return;if(p)return void(this.placements[e.crossTileID]=new Oe(!1,!1,!1));let M=!1,z=!1,L=!0,D=null,R={box:null,placeable:!1,offscreen:null},F={box:null,placeable:!1,offscreen:null},O=null,B=null,N=null,V=0,U=0,j=0;f.textFeatureIndex?V=f.textFeatureIndex:e.useRuntimeCollisionCircles&&(V=e.featureIndex),f.verticalTextFeatureIndex&&(U=f.verticalTextFeatureIndex);const $=f.textBox;if($){const n=n=>{let i=t.ah.horizontal;if(r.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,i=t,this.markUsedOrientation(r,i,e))}return i},a=(n,i)=>{if(r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&f.verticalTextBox){for(const e of r.writingModes)if(e===t.ah.vertical?(R=i(),F=R):R=n(),R&&R.placeable)break}else R=n()},u=e.textAnchorOffsetStartIndex,h=e.textAnchorOffsetEndIndex;if(h===u){const i=(t,n)=>{const i=this.collisionIndex.placeCollisionBox(t,v,d,l,c,T,S,o,g.predicate,P);return i&&i.placeable&&(this.markUsedOrientation(r,n,e),this.placedOrientations[e.crossTileID]=n),i};a((()=>i($,t.ah.horizontal)),(()=>{const n=f.verticalTextBox;return r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?i(n,t.ah.vertical):{box:null,offscreen:null}})),n(R&&R.placeable)}else{let p=t.aq[null===(A=null===(I=this.prevPlacement)||void 0===I?void 0:I.variableOffsets[e.crossTileID])||void 0===A?void 0:A.anchor];const m=(n,a,f)=>{const m=n.x2-n.x1,y=n.y2-n.y1,_=e.textBoxScale,x=C&&"never"===b?a:null;let w=null,I="never"===v?1:2,k="never";p&&I++;for(let t=0;t<I;t++){for(let t=u;t<h;t++){const i=r.textAnchorOffsets.get(t);if(p&&i.textAnchor!==p)continue;const a=this.attemptAnchorPlacement(i,n,m,y,_,S,T,d,l,c,g,k,e,r,f,o,s,x,P);if(a&&(w=a.placedGlyphBoxes,w&&w.placeable))return M=!0,D=a.shift,w}p?p=null:k=v}return i&&!w&&(w={box:this.collisionIndex.placeCollisionBox($,"always",d,l,c,T,S,o,g.predicate,P,new t.P(0,0)).box,offscreen:!1,placeable:!1}),w};a((()=>m($,f.iconBox,t.ah.horizontal)),(()=>{const n=f.verticalTextBox;return r.allowVerticalPlacement&&(!R||!R.placeable)&&e.numVerticalGlyphVertices>0&&n?m(n,f.verticalIconBox,t.ah.vertical):{box:null,occluded:!0,offscreen:null}})),R&&(M=R.placeable,L=R.offscreen);const y=n(R&&R.placeable);if(!M&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(r,t.anchor,e,y))}}}if(O=R,M=O&&O.placeable,L=O&&O.offscreen,e.useRuntimeCollisionCircles){const n=r.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),s=t.ai(r.textSizeData,m,n),d=a.get("text-padding");B=this.collisionIndex.placeCollisionCircles(v,n,r.lineVertexArray,r.glyphOffsetArray,s,l,c,u,h,i,T,g.predicate,e.collisionCircleDiameter,d,o,P),B.circles.length&&B.collisionDetected&&!i&&t.w("Collisions detected, but collision boxes are not shown"),M=x||B.circles.length>0&&!B.collisionDetected,L=L&&B.offscreen}if(f.iconFeatureIndex&&(j=f.iconFeatureIndex),f.iconBox){const e=e=>this.collisionIndex.placeCollisionBox(e,b,d,l,c,T,S,s,g.predicate,P,C&&D?D:void 0);F&&F.placeable&&f.verticalIconBox?(N=e(f.verticalIconBox),z=N.placeable):(N=e(f.iconBox),z=N.placeable),L=L&&N.offscreen}const H=y||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,q=_||0===e.numIconVertices;H||q?q?H||(z=z&&M):M=z&&M:z=M=z&&M;const Z=z&&N.placeable;if(M&&O.placeable&&this.collisionIndex.insertCollisionBox(O.box,v,a.get("text-ignore-placement"),r.bucketInstanceId,F&&F.placeable&&U?U:V,g.ID),Z&&this.collisionIndex.insertCollisionBox(N.box,b,a.get("icon-ignore-placement"),r.bucketInstanceId,j,g.ID),B&&M&&this.collisionIndex.insertCollisionCircles(B.circles,v,a.get("text-ignore-placement"),r.bucketInstanceId,V,g.ID),i&&this.storeCollisionData(r.bucketInstanceId,w,f,O,N,B),0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===r.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new Oe(M||k,z||E,L||r.justReloaded),n[e.crossTileID]=!0};if(I){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const t=r.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];A(r.symbolInstances.get(n),r.collisionArrays[n],n)}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)A(r.symbolInstances.get(t),r.collisionArrays[t],t);if(i&&r.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[r.bucketInstanceId];t.as(e.invProjMatrix,l),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}storeCollisionData(e,t,n,i,r,a){if(n.textBox||n.iconBox){let a,o;this.collisionBoxArrays.has(e)?a=this.collisionBoxArrays.get(e):(a=new Map,this.collisionBoxArrays.set(e,a)),a.has(t)?o=a.get(t):(o={text:null,icon:null},a.set(t,o)),n.textBox&&(o.text=i.box),n.iconBox&&(o.icon=r.box)}if(a){let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new Be);for(let e=0;e<a.circles.length;e+=4)t.circles.push(a.circles[e+0]),t.circles.push(a.circles[e+1]),t.circles.push(a.circles[e+2]),t.circles.push(a.collisionDetected?1:0)}}markUsedJustification(e,n,i,r){let a;a=r===t.ah.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[t.at(n)];const o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(const t of o)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=a>=0&&t!==a?0:i.crossTileID)}markUsedOrientation(e,n,i){const r=n===t.ah.horizontal||n===t.ah.horizontalOnly?n:0,a=n===t.ah.vertical?n:0,o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(const t of o)e.text.placedSymbolArray.get(t).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let n=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const i=t?t.symbolFadeChange(e):1,r=t?t.opacities:{},a=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(const s in this.placements){const e=this.placements[s],t=r[s];t?(this.opacities[s]=new Fe(t,i,e.text,e.icon),n=n||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[s]=new Fe(null,i,e.text,e.icon,e.skipFade),n=n||e.text||e.icon)}for(const s in r){const e=r[s];if(!this.opacities[s]){const t=new Fe(e,i,!1,!1);t.isHidden()||(this.opacities[s]=t,n=n||e.text.placed||e.icon.placed)}}for(const s in a)this.variableOffsets[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.variableOffsets[s]=a[s]);for(const s in o)this.placedOrientations[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.placedOrientations[s]=o[s]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const n={};for(const i of t){const t=i.getBucket(e);t&&i.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,i.tileID,n,i.collisionBoxArray)}}updateBucketOpacities(e,n,i,r){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const a=e.layers[0],o=a.layout,s=new Fe(null,0,!1,!1,!0),l=o.get("text-allow-overlap"),c=o.get("icon-allow-overlap"),u=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===o.get("text-rotation-alignment"),d="map"===o.get("text-pitch-alignment"),p="none"!==o.get("icon-text-fit"),f=new Fe(null,0,l&&(c||!e.hasIconData()||o.get("icon-optional")),c&&(l||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);const m=(e,t,n)=>{for(let i=0;i<t/4;i++)e.opacityVertexArray.emplaceBack(n);e.hasVisibleVertices=e.hasVisibleVertices||n!==Je},g=this.collisionBoxArrays.get(e.bucketInstanceId);for(let y=0;y<e.symbolInstances.length;y++){const n=e.symbolInstances.get(y),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:o}=n;let l=this.opacities[o];i[o]?l=s:l||(l=f,this.opacities[o]=l),i[o]=!0;const c=n.numIconVertices>0,_=this.placedOrientations[n.crossTileID],v=_===t.ah.vertical,x=_===t.ah.horizontal||_===t.ah.horizontalOnly;if(r>0||a>0){const t=Ye(l.text);m(e.text,r,v?Je:t),m(e.text,a,x?Je:t);const i=l.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=i||v?1:0)})),n.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=i||x?1:0);const o=this.variableOffsets[n.crossTileID];o&&this.markUsedJustification(e,o.anchor,n,_);const s=this.placedOrientations[n.crossTileID];s&&(this.markUsedJustification(e,"left",n,s),this.markUsedOrientation(e,s,n))}if(c){const t=Ye(l.icon),i=!(p&&n.verticalPlacedIconSymbolIndex&&v);n.placedIconSymbolIndex>=0&&(m(e.icon,n.numIconVertices,i?t:Je),e.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=l.icon.isHidden()),n.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,n.numVerticalIconVertices,i?Je:t),e.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=l.icon.isHidden())}const b=g&&g.has(y)?g.get(y):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[y];if(n){let i=new t.P(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(u){const e=this.variableOffsets[o];e?(i=Ue(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),h&&i._rotate(d?this.transform.angle:-this.transform.angle)):t=!1}if(n.textBox||n.verticalTextBox){let r;n.textBox&&(r=v),n.verticalTextBox&&(r=x),$e(e.textCollisionBox.collisionVertexArray,l.text.placed,!t||r,b.text,i.x,i.y)}}if(n.iconBox||n.verticalIconBox){const t=Boolean(!x&&n.verticalIconBox);let r;n.iconBox&&(r=t),n.verticalIconBox&&(r=!t),$e(e.iconCollisionBox.collisionVertexArray,l.icon.placed,r,b.icon,p?i.x:0,p?i.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const n=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*n>e}setStale(){this.stale=!0}}function $e(e,t,n,i,r,a){i&&0!==i.length||(i=[0,0,0,0]);const o=i[0]-ze,s=i[1]-ze,l=i[2]-ze,c=i[3]-ze;e.emplaceBack(t?1:0,n?1:0,r||0,a||0,o,s),e.emplaceBack(t?1:0,n?1:0,r||0,a||0,l,s),e.emplaceBack(t?1:0,n?1:0,r||0,a||0,l,c),e.emplaceBack(t?1:0,n?1:0,r||0,a||0,o,c)}const He=Math.pow(2,25),qe=Math.pow(2,24),Ze=Math.pow(2,17),Ge=Math.pow(2,16),We=Math.pow(2,9),Ke=Math.pow(2,8),Xe=Math.pow(2,1);function Ye(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,n=Math.floor(127*e.opacity);return n*He+t*qe+n*Ze+t*Ge+n*We+t*Ke+n*Xe+t}const Je=0;function Qe(){return{isOccluded:(e,t,n)=>!1,getPitchedTextCorrection:(e,t,n)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(e,t,n,i){throw new Error("Not implemented.")},translatePosition:(e,t,n,i)=>function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!n[0]&&!n[1])return[0,0];const a=r?"map"===i?e.angle:0:"viewport"===i?-e.angle:0;if(a){const e=Math.sin(a),t=Math.cos(a);n=[n[0]*t-n[1]*e,n[0]*e+n[1]*t]}return[r?n[0]:De(t,n[0],e.zoom),r?n[1]:De(t,n[1],e.zoom)]}(e,t,n,i),getCircleRadiusCorrection:e=>1}}class et{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,n,i,r){const a=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(a,i,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<a.length;)if(t.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,r())return!0;return!1}}class tt{constructor(e,t,n,i,r,a,o,s){this.placement=new je(e,Qe(),t,a,o,s),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(e,t,n){const i=a.now(),r=()=>!this._forceFullPlacement&&a.now()-i>2;for(;this._currentPlacementIndex>=0;){const i=t[e[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===i.type&&(!i.minzoom||i.minzoom<=a)&&(!i.maxzoom||i.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new et(i)),this._inProgressLayer.continuePlacement(n[i.source],this.placement,this._showCollisionBoxes,i,r))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const nt=512/t.W/2;class it{constructor(e,n,i){this.tileID=e,this.bucketInstanceId=i,this._symbolsByKey={};const r=new Map;for(let t=0;t<n.length;t++){const e=n.get(t),i=e.key,a=r.get(i);a?a.push(e):r.set(i,[e])}for(const[a,o]of r){const e={positions:o.map((e=>({x:Math.floor(e.anchorX*nt),y:Math.floor(e.anchorY*nt)}))),crossTileIDs:o.map((e=>e.crossTileID))};if(e.positions.length>128){const n=new t.av(e.positions.length,16,Uint16Array);for(const{x:t,y:i}of e.positions)n.add(t,i);n.finish(),delete e.positions,e.index=n}this._symbolsByKey[a]=e}}getScaledCoordinates(e,n){const{x:i,y:r,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=n.canonical,c=nt/Math.pow(2,l-a),u=(s*t.W+e.anchorY)*c,h=r*t.W*nt;return{x:Math.floor((o*t.W+e.anchorX)*c-i*t.W*nt),y:Math.floor(u-h)}}findMatches(e,t,n){const i=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let r=0;r<e.length;r++){const a=e.get(r);if(a.crossTileID)continue;const o=this._symbolsByKey[a.key];if(!o)continue;const s=this.getScaledCoordinates(a,t);if(o.index){const e=o.index.range(s.x-i,s.y-i,s.x+i,s.y+i).sort();for(const t of e){const e=o.crossTileIDs[t];if(!n[e]){n[e]=!0,a.crossTileID=e;break}}}else if(o.positions)for(let e=0;e<o.positions.length;e++){const t=o.positions[e],r=o.crossTileIDs[e];if(Math.abs(t.x-s.x)<=i&&Math.abs(t.y-s.y)<=i&&!n[r]){n[r]=!0,a.crossTileID=r;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((e=>{let{crossTileIDs:t}=e;return t}))}}class rt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class at{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const n in this.indexes){const e=this.indexes[n],i={};for(const n in e){const r=e[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),i[r.tileID.key]=r}this.indexes[n]=i}this.lng=e}addBucket(e,t,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let r=0;r<t.symbolInstances.length;r++)t.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const i=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const n=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in n){const a=n[r];a.tileID.isChildOf(e)&&a.findMatches(t.symbolInstances,e,i)}else{const a=n[e.scaledTo(Number(r)).key];a&&a.findMatches(t.symbolInstances,e,i)}}for(let r=0;r<t.symbolInstances.length;r++){const e=t.symbolInstances.get(r);e.crossTileID||(e.crossTileID=n.generate(),i[e.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new it(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const n of t.getCrossTileIDsLists())for(const t of n)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(const n in this.indexes){const i=this.indexes[n];for(const r in i)e[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],t=!0)}return t}}class ot{constructor(){this.layerIndexes={},this.crossTileIDs=new rt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,n){let i=this.layerIndexes[e.id];void 0===i&&(i=this.layerIndexes[e.id]=new at);let r=!1;const a={};i.handleWrapJump(n);for(const o of t){const t=o.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(o.tileID,t,this.crossTileIDs)&&(r=!0),a[t.bucketInstanceId]=!0)}return i.removeStaleBuckets(a)&&(r=!0),r}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const n in this.layerIndexes)t[n]||delete this.layerIndexes[n]}}const st=(e,n)=>t.t(e,n&&n.filter((e=>"source.canvas"!==e.identifier))),lt=t.aw();class ct extends t.E{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this._rtlPluginLoaded=()=>{for(const e in this.sourceCaches){const t=this.sourceCaches[e].getSource().type;"vector"!==t&&"geojson"!==t||this.sourceCaches[e].reload()}},this.map=e,this.dispatcher=new B(O(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((e,t)=>this.getGlyphs(e,t))),this.dispatcher.registerMessageHandler("GI",((e,t)=>this.getImages(e,t))),this.imageManager=new S,this.imageManager.setEventedParent(this),this.glyphManager=new k(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new M(256,512),this.crossTileSymbolIndex=new ot,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",t.ay()),ae().on(ne,this._rtlPluginLoaded),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.sourceCaches[e.sourceId];if(!t)return;const n=t.getSource();if(n&&n.vectorLayerIds)for(const i in this._layers){const e=this._layers[i];e.source===n.id&&this._validateLayer(e)}}))}loadURL(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this.fire(new t.k("dataloading",{dataType:"style"})),n.validate="boolean"!=typeof n.validate||n.validate;const r=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController,t.h(r,this._loadStyleRequest).then((e=>{this._loadStyleRequest=null,this._load(e.data,n,i)})).catch((e=>{this._loadStyleRequest=null,e&&this.fire(new t.j(e))}))}loadJSON(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this.fire(new t.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,n.validate=!1!==n.validate,this._load(e,n,i)})).catch((()=>{}))}loadEmpty(){this.fire(new t.k("dataloading",{dataType:"style"})),this._load(lt,{validate:!1})}_load(e,n,i){var r;const a=n.transformStyle?n.transformStyle(i,e):e;if(!n.validate||!st(this,t.x(a))){this._loaded=!0,this.stylesheet=a;for(const e in a.sources)this.addSource(e,a.sources[e],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new A(this.stylesheet.light),this.map.setTerrain(null!==(r=this.stylesheet.terrain)&&void 0!==r?r:null),this.fire(new t.k("data",{dataType:"style"})),this.fire(new t.k("style.load"))}}_createLayers(){const e=t.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map((e=>e.id)),this._layers={},this._serializedLayers=null;for(const n of e){const e=t.aA(n);e.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=e}}_loadSprite(e){let n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(e,n,i,r){return t._(this,void 0,void 0,(function*(){const o=v(e),s=i>1?"@2x":"",l={},c={};for(const{id:e,url:i}of o){const a=n.transformRequest(x(i,s,".json"),"SpriteJSON");l[e]=t.h(a,r);const o=n.transformRequest(x(i,s,".png"),"SpriteImage");c[e]=p.getImage(o,r)}return yield Promise.all([...Object.values(l),...Object.values(c)]),function(e,n){return t._(this,void 0,void 0,(function*(){const t={};for(const i in e){t[i]={};const r=a.getImageCanvasContext((yield n[i]).data),o=(yield e[i]).data;for(const e in o){const{width:n,height:a,x:s,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p,textFitWidth:f,textFitHeight:m}=o[e];t[i][e]={data:null,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p,textFitWidth:f,textFitHeight:m,spriteData:{width:n,height:a,x:s,y:l,context:r}}}}return t}))}(l,c)}))}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((e=>{if(this._spriteRequest=null,e)for(const t in e){this._spritesImagesIds[t]=[];const n=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter((t=>!(t in e))):[];for(const e of n)this.imageManager.removeImage(e),this._changedImages[e]=!0;for(const r in e[t]){const n="default"===t?r:`${t}:${r}`;this._spritesImagesIds[t].push(n),n in this.imageManager.images?this.imageManager.updateImage(n,e[t][r],!1):this.imageManager.addImage(n,e[t][r]),i&&(this._changedImages[n]=!0)}}})).catch((e=>{this._spriteRequest=null,n=e,this.fire(new t.j(n))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"})),r&&r(n)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const i=e.sourceLayer;if(!i)return;const r=n.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new t.j(new Error(`Source layer "${i}" does not exist on source "${r.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){const t=this._serializedAllLayers();if(!e||0===e.length)return Object.values(t);const n=[];for(const i of e)t[i]&&n.push(t[i]);return n}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const t=Object.keys(this._layers);for(const n of t){const t=this._layers[n];"custom"!==t.type&&(e[n]=t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const e in this._updatedSources){const t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw new Error(`Invalid action ${t}`);this._clearSource(e)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const i in this._updatedPaintProps)this._layers[i].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}const i={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];i[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)&&n.source&&(this.sourceCaches[n.source].used=!0)}for(const r in i){const e=this.sourceCaches[r];!!i[r]!=!!e.used&&e.fire(new t.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:r}))}this.light.recalculate(e),this.z=e.zoom,n&&this.fire(new t.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;this._checkLoaded();const r=this.serialize();if(e=n.transformStyle?n.transformStyle(r,e):e,(null===(i=n.validate)||void 0===i||i)&&st(this,t.x(e)))return!1;(e=t.aB(e)).layers=t.az(e.layers);const a=t.aC(r,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error(`Unimplemented: ${o.unimplemented.join(", ")}.`);if(0===o.operations.length)return!1;for(const t of o.operations)t();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const t=[],n=[];for(const i of e)switch(i.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":t.push((()=>this.addLayer.apply(this,i.args)));break;case"removeLayer":t.push((()=>this.removeLayer.apply(this,i.args)));break;case"setPaintProperty":t.push((()=>this.setPaintProperty.apply(this,i.args)));break;case"setLayoutProperty":t.push((()=>this.setLayoutProperty.apply(this,i.args)));break;case"setFilter":t.push((()=>this.setFilter.apply(this,i.args)));break;case"addSource":t.push((()=>this.addSource.apply(this,i.args)));break;case"removeSource":t.push((()=>this.removeSource.apply(this,i.args)));break;case"setLayerZoomRange":t.push((()=>this.setLayerZoomRange.apply(this,i.args)));break;case"setLight":t.push((()=>this.setLight.apply(this,i.args)));break;case"setGeoJSONSourceData":t.push((()=>this.setGeoJSONSourceData.apply(this,i.args)));break;case"setGlyphs":t.push((()=>this.setGlyphs.apply(this,i.args)));break;case"setSprite":t.push((()=>this.setSprite.apply(this,i.args)));break;case"setTerrain":t.push((()=>this.map.setTerrain.apply(this,i.args)));break;case"setTransition":t.push((()=>{}));break;default:n.push(i.command)}return{operations:t,unimplemented:n}}addImage(e,n){if(this.getImage(e))return this.fire(new t.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new t.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.x.source,`sources.${e}`,n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const r=this.sourceCaches[e]=new ce(e,n,this.dispatcher);r.style=this,r.setEventedParent(this,(()=>({isSourceLoaded:r.loaded(),source:r.serialize(),sourceId:e}))),r.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===e)return this.fire(new t.j(new Error(`Source "${e}" cannot be removed while layer "${i}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new t.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error(`There is no source with this ID=${e}`);const n=this.sourceCaches[e].getSource();if("geojson"!==n.type)throw new Error(`geojsonSource.type is ${n.type}, which is !== 'geojson`);n.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=e.id;if(this.getLayer(r))return void this.fire(new t.j(new Error(`Layer "${r}" already exists on this map.`)));let a;if("custom"===e.type){if(st(this,t.aD(e)))return;a=t.aA(e)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(r,e.source),e=t.aB(e),e=t.e(e,{source:r})),this._validate(t.x.layer,`layers.${r}`,e,{arrayIndex:-1},i))return;a=t.aA(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:r}})}const o=n?this._order.indexOf(n):this._order.length;if(n&&-1===o)this.fire(new t.j(new Error(`Cannot add layer "${r}" before non-existing layer "${n}".`)));else{if(this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=a,this._removedLayers[r]&&a.source&&"custom"!==a.type){const e=this._removedLayers[r];delete this._removedLayers[r],e.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const i=this._order.indexOf(e);this._order.splice(i,1);const r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new t.j(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(r,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.j(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const i=this._order.indexOf(e);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,i){this._checkLoaded();const r=this.getLayer(e);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new t.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=this.getLayer(e);if(r){if(!t.aE(r.filter,n))return null==n?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(t.x.filter,`layers.${r.id}.filter`,n,null,i)||(r.filter=t.aB(n),this._updateLayer(r)))}else this.fire(new t.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.aB(this.getLayer(e).filter)}setLayoutProperty(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(e);a?t.aE(a.getLayoutProperty(n),i)||(a.setLayoutProperty(n,i,r),this._updateLayer(a)):this.fire(new t.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const i=this.getLayer(e);if(i)return i.getLayoutProperty(n);this.fire(new t.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(e);a?t.aE(a.getPaintProperty(n),i)||(a.setPaintProperty(n,i,r)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new t.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,n){this._checkLoaded();const i=e.source,r=e.sourceLayer,a=this.sourceCaches[i];if(void 0===a)return void this.fire(new t.j(new Error(`The source '${i}' does not exist in the map's style.`)));const o=a.getSource().type;"geojson"===o&&r?this.fire(new t.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||r?(void 0===e.id&&this.fire(new t.j(new Error("The feature id parameter must be provided."))),a.setFeatureState(r,e.id,n)):this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const i=e.source,r=this.sourceCaches[i];if(void 0===r)return void this.fire(new t.j(new Error(`The source '${i}' does not exist in the map's style.`)));const a=r.getSource().type,o="vector"===a?e.sourceLayer:void 0;"vector"!==a||o?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.j(new Error("A feature id is required to remove its specific state property."))):r.removeFeatureState(o,e.id,n):this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,i=e.sourceLayer,r=this.sourceCaches[n];if(void 0!==r)return"vector"!==r.getSource().type||i?(void 0===e.id&&this.fire(new t.j(new Error("The feature id parameter must be provided."))),r.getFeatureState(i,e.id)):void this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.j(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return t.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=t.aF(this.sourceCaches,(e=>e.serialize())),n=this._serializeByIds(this._order),i=this.map.getTerrain()||void 0,r=this.stylesheet;return t.aG({version:r.version,name:r.name,metadata:r.metadata,light:r.light,center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch,sprite:r.sprite,glyphs:r.glyphs,transition:r.transition,sources:e,layers:n,terrain:i},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,n={},i=[];for(let a=this._order.length-1;a>=0;a--){const r=this._order[a];if(t(r)){n[r]=a;for(const t of e){const e=t[r];if(e)for(const t of e)i.push(t)}}}i.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const r=[];for(let a=this._order.length-1;a>=0;a--){const o=this._order[a];if(t(o))for(let e=i.length-1;e>=0;e--){const t=i[e].feature;if(n[t.layer.id]<a)break;r.push(t),i.pop()}else for(const t of e){const e=t[o];if(e)for(const t of e)r.push(t.feature)}}return r}queryRenderedFeatures(e,n,i){n&&n.filter&&this._validate(t.x.filter,"queryRenderedFeatures.filter",n.filter,null,n);const r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.j(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];r[n.source]=!0}}const a=[];n.availableImages=this._availableImages;const o=this._serializedAllLayers();for(const t in this.sourceCaches)n.layers&&!r[t]||a.push(U(this.sourceCaches[t],this._layers,o,e,n,i));return this.placement&&a.push(function(e,t,n,i,r,a,o){const s={},l=a.queryRenderedSymbols(i),c=[];for(const u of Object.keys(l).map(Number))c.push(o[u]);c.sort(j);for(const u of c){const n=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],t,u.bucketIndex,u.sourceLayerIndex,r.filter,r.layers,r.availableImages,e);for(const e in n){const t=s[e]=s[e]||[],i=n[e];i.sort(((e,t)=>{const n=u.featureSortOrder;if(n){const i=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-i}return t.featureIndex-e.featureIndex}));for(const e of i)t.push(e)}}for(const u in s)s[u].forEach((t=>{const i=t.feature,r=n[e[u].source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=r}));return s}(this._layers,o,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.x.filter,"querySourceFeatures.filter",n.filter,null,n);const i=this.sourceCaches[e];return i?function(e,t){const n=e.getRenderableIds().map((t=>e.getTileByID(t))),i=[],r={};for(let a=0;a<n.length;a++){const e=n[a],o=e.tileID.canonical.key;r[o]||(r[o]=!0,e.querySourceFeatures(i,t))}return i}(i,n):[]}getLight(){return this.light.getLight()}setLight(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const i=this.light.getLight();let r=!1;for(const a in e)if(!t.aE(e[a],i[a])){r=!0;break}if(!r)return;const o={now:a.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(o)}_validate(e,n,i,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!a||!1!==a.validate)&&st(this,e.call(t.x,t.e({key:n,style:this.serialize(),value:i,styleSpec:t.v},r)))}_remove(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ae().off(ne,this._rtlPluginLoaded);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1,s=!1;const l={};for(const a of this._order){const t=this._layers[a];if("symbol"!==t.type)continue;if(!l[t.source]){const e=this.sourceCaches[t.source];l[t.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const n=this.crossTileSymbolIndex.addLayer(t,l[t.source],e.center.lng);o=o||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((r=r||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.now(),e.zoom))&&(this.pauseablePlacement=new tt(e,this.map.terrain,this._order,r,t,n,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(const a of this._order){const e=this._layers[a];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return t._(this,void 0,void 0,(function*(){const e=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const t=this.sourceCaches[n.source];return t&&t.setDependencies(n.tileID.key,n.type,n.icons),e}))}getGlyphs(e,n){return t._(this,void 0,void 0,(function*(){const e=yield this.glyphManager.getGlyphs(n.stacks),t=this.sourceCaches[n.source];return t&&t.setDependencies(n.tileID.key,n.type,[""]),e}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded(),e&&this._validate(t.x.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const a=[{id:e,url:n}],o=[...v(this.stylesheet.sprite),...a];this._validate(t.x.sprite,"sprite",o,null,i)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,r))}removeSprite(e){this._checkLoaded();const n=v(this.stylesheet.sprite);if(n.find((t=>t.id===e))){if(this._spritesImagesIds[e])for(const t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;n.splice(n.findIndex((t=>t.id===e)),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}else this.fire(new t.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return v(this.stylesheet.sprite)}setSprite(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),e&&this._validate(t.x.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,i):(this._unloadSprite(),i&&i(null)))}}var ut=t.X([{name:"a_pos",type:"Int16",components:2}]),ht="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const dt={prelude:pt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:pt("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:pt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:pt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:pt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:pt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:pt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:pt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:pt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:pt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:pt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:pt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:pt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:pt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:pt("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:pt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:pt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:pt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:pt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:pt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:pt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:pt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:pt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:pt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:pt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:pt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ht),terrainDepth:pt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ht),terrainCoords:pt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ht)};function pt(e,t){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=t.match(/attribute ([\w]+) ([\w]+)/g),r=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(r):r,s={};return{fragmentSource:e=e.replace(n,((e,t,n,i,r)=>(s[r]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = u_${r};\n#endif\n`))),vertexSource:t=t.replace(n,((e,t,n,i,r)=>{const a="float"===i?"vec2":"vec4",o=r.match(/color/)?"color":a;return s[r]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${a} a_${r};\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${a} a_${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`})),staticAttributes:i,staticUniforms:o}}class ft{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,n,i,r,a,o,s,l){this.context=e;let c=this.boundPaintVertexBuffers.length!==i.length;for(let u=0;!c&&u<i.length;u++)this.boundPaintVertexBuffers[u]!==i[u]&&(c=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==n||c||this.boundIndexBuffer!==r||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,n,i,r,a,o,s,l):(e.bindVertexArray.set(this.vao),o&&o.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind(),l&&l.bind())}freshBind(e,t,n,i,r,a,o,s){const l=e.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s,t.enableAttributes(u,e);for(const h of n)h.enableAttributes(u,e);a&&a.enableAttributes(u,e),o&&o.enableAttributes(u,e),s&&s.enableAttributes(u,e),t.bind(),t.setVertexAttribPointers(u,e,r);for(const h of n)h.bind(),h.setVertexAttribPointers(u,e,r);a&&(a.bind(),a.setVertexAttribPointers(u,e,r)),i&&i.bind(),o&&(o.bind(),o.setVertexAttribPointers(u,e,r)),s&&(s.bind(),s.setVertexAttribPointers(u,e,r)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function mt(e){const t=[];for(let n=0;n<e.length;n++){if(null===e[n])continue;const i=e[n].split(" ");t.push(i.pop())}return t}class gt{constructor(e,n,i,r,a,o){const s=e.gl;this.program=s.createProgram();const l=mt(n.staticAttributes),c=i?i.getBinderAttributes():[],u=l.concat(c),h=dt.prelude.staticUniforms?mt(dt.prelude.staticUniforms):[],d=n.staticUniforms?mt(n.staticUniforms):[],p=i?i.getBinderUniforms():[],f=h.concat(d).concat(p),m=[];for(const t of f)m.indexOf(t)<0&&m.push(t);const g=i?i.defines():[];a&&g.push("#define OVERDRAW_INSPECTOR;"),o&&g.push("#define TERRAIN3D;");const y=g.concat(dt.prelude.fragmentSource,n.fragmentSource).join("\n"),_=g.concat(dt.prelude.vertexSource,n.vertexSource).join("\n"),v=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(v,y),s.compileShader(v),!s.getShaderParameter(v,s.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${s.getShaderInfoLog(v)}`);s.attachShader(this.program,v);const x=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(x,_),s.compileShader(x),!s.getShaderParameter(x,s.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${s.getShaderInfoLog(x)}`);s.attachShader(this.program,x),this.attributes={};const b={};this.numAttributes=u.length;for(let t=0;t<this.numAttributes;t++)u[t]&&(s.bindAttribLocation(this.program,t,u[t]),this.attributes[u[t]]=t);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error(`Program failed to link: ${s.getProgramInfoLog(this.program)}`);s.deleteShader(x),s.deleteShader(v);for(let t=0;t<m.length;t++){const e=m[t];if(e&&!b[e]){const t=s.getUniformLocation(this.program,e);t&&(b[e]=t)}}this.fixedUniforms=r(e,b),this.terrainUniforms=((e,n)=>({u_depth:new t.aH(e,n.u_depth),u_terrain:new t.aH(e,n.u_terrain),u_terrain_dim:new t.aI(e,n.u_terrain_dim),u_terrain_matrix:new t.aJ(e,n.u_terrain_matrix),u_terrain_unpack:new t.aK(e,n.u_terrain_unpack),u_terrain_exaggeration:new t.aI(e,n.u_terrain_exaggeration)}))(e,b),this.binderUniforms=i?i.getUniforms(e,b):[]}draw(e,t,n,i,r,a,o,s,l,c,u,h,d,p,f,m,g,y){const _=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(n),e.setStencilMode(i),e.setColorMode(r),e.setCullFace(a),s){e.activeTexture.set(_.TEXTURE2),_.bindTexture(_.TEXTURE_2D,s.depthTexture),e.activeTexture.set(_.TEXTURE3),_.bindTexture(_.TEXTURE_2D,s.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(s[e])}for(const x in this.fixedUniforms)this.fixedUniforms[x].set(o[x]);f&&f.setUniforms(e,this.binderUniforms,d,{zoom:p});let v=0;switch(t){case _.LINES:v=2;break;case _.TRIANGLES:v=3;break;case _.LINE_STRIP:v=1}for(const x of h.get()){const n=x.vaos||(x.vaos={});(n[l]||(n[l]=new ft)).bind(e,this,c,f?f.getPaintVertexBuffers():[],u,x.vertexOffset,m,g,y),_.drawElements(t,x.primitiveLength*v,_.UNSIGNED_SHORT,x.primitiveOffset*v*2)}}}function yt(e,t,n){const i=1/De(n,1,t.transform.tileZoom),r=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,t.transform.tileZoom)/r,o=a*(n.tileID.canonical.x+n.tileID.wrap*r),s=a*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}const _t=(e,n,i,r)=>{const a=n.style.light,o=a.properties.get("position"),s=[o.x,o.y,o.z],l=function(){var e=new t.A(9);return t.A!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}();"viewport"===a.properties.get("anchor")&&function(e,t){var n=Math.sin(t),i=Math.cos(t);e[0]=i,e[1]=n,e[2]=0,e[3]=-n,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1}(l,-n.transform.angle),function(e,t,n){var i=t[0],r=t[1],a=t[2];e[0]=i*n[0]+r*n[3]+a*n[6],e[1]=i*n[1]+r*n[4]+a*n[7],e[2]=i*n[2]+r*n[5]+a*n[8]}(s,s,l);const c=a.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+i,u_opacity:r}},vt=(e,n,i,r,a,o,s)=>t.e(_t(e,n,i,r),yt(o,n,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8}),xt=e=>({u_matrix:e}),bt=(e,n,i,r)=>t.e(xt(e),yt(i,n,r)),wt=(e,t)=>({u_matrix:e,u_world:t}),St=(e,n,i,r,a)=>t.e(bt(e,n,i,r),{u_world:a}),Tt=(e,t,n,i)=>{const r=e.transform;let a,o;if("map"===i.paint.get("circle-pitch-alignment")){const e=De(n,1,r.zoom);a=!0,o=[e,e]}else a=!1,o=r.pixelsToGLUnits;return{u_camera_to_center_distance:r.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(t.posMatrix,n,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:o}},Ct=(e,t,n)=>({u_matrix:e,u_inv_matrix:t,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}),It=function(e,t){return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},kt=e=>({u_matrix:e}),Et=(e,t,n,i)=>({u_matrix:e,u_extrude_scale:De(t,1,n),u_intensity:i});function Pt(e,n){const i=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new t.Y(0,r/i).toLngLat().lat,new t.Y(0,(r+1)/i).toLngLat().lat]}const At=(e,t,n,i)=>{const r=e.transform;return{u_matrix:Rt(e,t,n,i),u_ratio:1/De(t,1,r.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},Mt=(e,n,i,r,a)=>t.e(At(e,n,i,a),{u_image:0,u_image_height:r}),zt=(e,t,n,i,r)=>{const a=e.transform,o=Dt(t,a);return{u_matrix:Rt(e,t,n,r),u_texsize:t.imageAtlasTexture.size,u_ratio:1/De(t,1,a.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[o,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Lt=(e,n,i,r,a,o)=>{const s=e.lineAtlas,l=Dt(n,e.transform),c="round"===i.layout.get("line-cap"),u=s.getDash(r.from,c),h=s.getDash(r.to,c),d=u.width*a.fromScale,p=h.width*a.toScale;return t.e(At(e,n,i,o),{u_patternscale_a:[l/d,-u.height/2],u_patternscale_b:[l/p,-h.height/2],u_sdfgamma:s.width/(256*Math.min(d,p)*e.pixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:h.y,u_mix:a.t})};function Dt(e,t){return 1/De(e,1,t.tileZoom)}function Rt(e,t,n,i){return e.translatePosMatrix(i?i.posMatrix:t.tileID.posMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Ft=(e,t,n,i,r)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:n,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(o=r.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=r.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Ot(r.paint.get("raster-hue-rotate"))};var a,o};function Ot(e){e*=Math.PI/180;const t=Math.sin(e),n=Math.cos(e);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}const Bt=(e,t,n,i,r,a,o,s,l,c,u,h,d,p)=>{const f=o.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:f.cameraToCenterDistance,u_pitch:f.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:f.width/f.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:l,u_coord_matrix:c,u_is_text:+h,u_pitch_with_map:+i,u_is_along_line:r,u_is_variable_anchor:a,u_texsize:d,u_texture:0,u_translation:u,u_pitched_scale:p}},Nt=(e,n,i,r,a,o,s,l,c,u,h,d,p,f,m)=>{const g=s.transform;return t.e(Bt(e,n,i,r,a,o,s,l,c,u,h,d,p,m),{u_gamma_scale:r?Math.cos(g._pitch)*g.cameraToCenterDistance:1,u_device_pixel_ratio:s.pixelRatio,u_is_halo:+f})},Vt=(e,n,i,r,a,o,s,l,c,u,h,d,p,f)=>t.e(Nt(e,n,i,r,a,o,s,l,c,u,h,!0,d,!0,f),{u_texsize_icon:p,u_texture_icon:1}),Ut=(e,t,n)=>({u_matrix:e,u_opacity:t,u_color:n}),jt=(e,n,i,r,a,o)=>t.e(function(e,t,n,i){const r=n.imageManager.getPattern(e.from.toString()),a=n.imageManager.getPattern(e.to.toString()),{width:o,height:s}=n.imageManager.getPixelSize(),l=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,n.transform.tileZoom)/l,u=c*(i.tileID.canonical.x+i.tileID.wrap*l),h=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:t.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/De(i,1,n.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(r,o,i,a),{u_matrix:e,u_opacity:n}),$t={fillExtrusion:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_lightpos:new t.aL(e,n.u_lightpos),u_lightintensity:new t.aI(e,n.u_lightintensity),u_lightcolor:new t.aL(e,n.u_lightcolor),u_vertical_gradient:new t.aI(e,n.u_vertical_gradient),u_opacity:new t.aI(e,n.u_opacity)}),fillExtrusionPattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_lightpos:new t.aL(e,n.u_lightpos),u_lightintensity:new t.aI(e,n.u_lightintensity),u_lightcolor:new t.aL(e,n.u_lightcolor),u_vertical_gradient:new t.aI(e,n.u_vertical_gradient),u_height_factor:new t.aI(e,n.u_height_factor),u_image:new t.aH(e,n.u_image),u_texsize:new t.aM(e,n.u_texsize),u_pixel_coord_upper:new t.aM(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aM(e,n.u_pixel_coord_lower),u_scale:new t.aL(e,n.u_scale),u_fade:new t.aI(e,n.u_fade),u_opacity:new t.aI(e,n.u_opacity)}),fill:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix)}),fillPattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_image:new t.aH(e,n.u_image),u_texsize:new t.aM(e,n.u_texsize),u_pixel_coord_upper:new t.aM(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aM(e,n.u_pixel_coord_lower),u_scale:new t.aL(e,n.u_scale),u_fade:new t.aI(e,n.u_fade)}),fillOutline:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_world:new t.aM(e,n.u_world)}),fillOutlinePattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_world:new t.aM(e,n.u_world),u_image:new t.aH(e,n.u_image),u_texsize:new t.aM(e,n.u_texsize),u_pixel_coord_upper:new t.aM(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aM(e,n.u_pixel_coord_lower),u_scale:new t.aL(e,n.u_scale),u_fade:new t.aI(e,n.u_fade)}),circle:(e,n)=>({u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_scale_with_map:new t.aH(e,n.u_scale_with_map),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_extrude_scale:new t.aM(e,n.u_extrude_scale),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_matrix:new t.aJ(e,n.u_matrix)}),collisionBox:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_pixel_extrude_scale:new t.aM(e,n.u_pixel_extrude_scale)}),collisionCircle:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_inv_matrix:new t.aJ(e,n.u_inv_matrix),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_viewport_size:new t.aM(e,n.u_viewport_size)}),debug:(e,n)=>({u_color:new t.aN(e,n.u_color),u_matrix:new t.aJ(e,n.u_matrix),u_overlay:new t.aH(e,n.u_overlay),u_overlay_scale:new t.aI(e,n.u_overlay_scale)}),clippingMask:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix)}),heatmap:(e,n)=>({u_extrude_scale:new t.aI(e,n.u_extrude_scale),u_intensity:new t.aI(e,n.u_intensity),u_matrix:new t.aJ(e,n.u_matrix)}),heatmapTexture:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_world:new t.aM(e,n.u_world),u_image:new t.aH(e,n.u_image),u_color_ramp:new t.aH(e,n.u_color_ramp),u_opacity:new t.aI(e,n.u_opacity)}),hillshade:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_image:new t.aH(e,n.u_image),u_latrange:new t.aM(e,n.u_latrange),u_light:new t.aM(e,n.u_light),u_shadow:new t.aN(e,n.u_shadow),u_highlight:new t.aN(e,n.u_highlight),u_accent:new t.aN(e,n.u_accent)}),hillshadePrepare:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_image:new t.aH(e,n.u_image),u_dimension:new t.aM(e,n.u_dimension),u_zoom:new t.aI(e,n.u_zoom),u_unpack:new t.aK(e,n.u_unpack)}),line:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.aM(e,n.u_units_to_pixels)}),lineGradient:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.aM(e,n.u_units_to_pixels),u_image:new t.aH(e,n.u_image),u_image_height:new t.aI(e,n.u_image_height)}),linePattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_texsize:new t.aM(e,n.u_texsize),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_image:new t.aH(e,n.u_image),u_units_to_pixels:new t.aM(e,n.u_units_to_pixels),u_scale:new t.aL(e,n.u_scale),u_fade:new t.aI(e,n.u_fade)}),lineSDF:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.aM(e,n.u_units_to_pixels),u_patternscale_a:new t.aM(e,n.u_patternscale_a),u_patternscale_b:new t.aM(e,n.u_patternscale_b),u_sdfgamma:new t.aI(e,n.u_sdfgamma),u_image:new t.aH(e,n.u_image),u_tex_y_a:new t.aI(e,n.u_tex_y_a),u_tex_y_b:new t.aI(e,n.u_tex_y_b),u_mix:new t.aI(e,n.u_mix)}),raster:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_tl_parent:new t.aM(e,n.u_tl_parent),u_scale_parent:new t.aI(e,n.u_scale_parent),u_buffer_scale:new t.aI(e,n.u_buffer_scale),u_fade_t:new t.aI(e,n.u_fade_t),u_opacity:new t.aI(e,n.u_opacity),u_image0:new t.aH(e,n.u_image0),u_image1:new t.aH(e,n.u_image1),u_brightness_low:new t.aI(e,n.u_brightness_low),u_brightness_high:new t.aI(e,n.u_brightness_high),u_saturation_factor:new t.aI(e,n.u_saturation_factor),u_contrast_factor:new t.aI(e,n.u_contrast_factor),u_spin_weights:new t.aL(e,n.u_spin_weights)}),symbolIcon:(e,n)=>({u_is_size_zoom_constant:new t.aH(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aH(e,n.u_is_size_feature_constant),u_size_t:new t.aI(e,n.u_size_t),u_size:new t.aI(e,n.u_size),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_pitch:new t.aI(e,n.u_pitch),u_rotate_symbol:new t.aH(e,n.u_rotate_symbol),u_aspect_ratio:new t.aI(e,n.u_aspect_ratio),u_fade_change:new t.aI(e,n.u_fade_change),u_matrix:new t.aJ(e,n.u_matrix),u_label_plane_matrix:new t.aJ(e,n.u_label_plane_matrix),u_coord_matrix:new t.aJ(e,n.u_coord_matrix),u_is_text:new t.aH(e,n.u_is_text),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_is_along_line:new t.aH(e,n.u_is_along_line),u_is_variable_anchor:new t.aH(e,n.u_is_variable_anchor),u_texsize:new t.aM(e,n.u_texsize),u_texture:new t.aH(e,n.u_texture),u_translation:new t.aM(e,n.u_translation),u_pitched_scale:new t.aI(e,n.u_pitched_scale)}),symbolSDF:(e,n)=>({u_is_size_zoom_constant:new t.aH(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aH(e,n.u_is_size_feature_constant),u_size_t:new t.aI(e,n.u_size_t),u_size:new t.aI(e,n.u_size),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_pitch:new t.aI(e,n.u_pitch),u_rotate_symbol:new t.aH(e,n.u_rotate_symbol),u_aspect_ratio:new t.aI(e,n.u_aspect_ratio),u_fade_change:new t.aI(e,n.u_fade_change),u_matrix:new t.aJ(e,n.u_matrix),u_label_plane_matrix:new t.aJ(e,n.u_label_plane_matrix),u_coord_matrix:new t.aJ(e,n.u_coord_matrix),u_is_text:new t.aH(e,n.u_is_text),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_is_along_line:new t.aH(e,n.u_is_along_line),u_is_variable_anchor:new t.aH(e,n.u_is_variable_anchor),u_texsize:new t.aM(e,n.u_texsize),u_texture:new t.aH(e,n.u_texture),u_gamma_scale:new t.aI(e,n.u_gamma_scale),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_is_halo:new t.aH(e,n.u_is_halo),u_translation:new t.aM(e,n.u_translation),u_pitched_scale:new t.aI(e,n.u_pitched_scale)}),symbolTextAndIcon:(e,n)=>({u_is_size_zoom_constant:new t.aH(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aH(e,n.u_is_size_feature_constant),u_size_t:new t.aI(e,n.u_size_t),u_size:new t.aI(e,n.u_size),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_pitch:new t.aI(e,n.u_pitch),u_rotate_symbol:new t.aH(e,n.u_rotate_symbol),u_aspect_ratio:new t.aI(e,n.u_aspect_ratio),u_fade_change:new t.aI(e,n.u_fade_change),u_matrix:new t.aJ(e,n.u_matrix),u_label_plane_matrix:new t.aJ(e,n.u_label_plane_matrix),u_coord_matrix:new t.aJ(e,n.u_coord_matrix),u_is_text:new t.aH(e,n.u_is_text),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_is_along_line:new t.aH(e,n.u_is_along_line),u_is_variable_anchor:new t.aH(e,n.u_is_variable_anchor),u_texsize:new t.aM(e,n.u_texsize),u_texsize_icon:new t.aM(e,n.u_texsize_icon),u_texture:new t.aH(e,n.u_texture),u_texture_icon:new t.aH(e,n.u_texture_icon),u_gamma_scale:new t.aI(e,n.u_gamma_scale),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_is_halo:new t.aH(e,n.u_is_halo),u_translation:new t.aM(e,n.u_translation),u_pitched_scale:new t.aI(e,n.u_pitched_scale)}),background:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_opacity:new t.aI(e,n.u_opacity),u_color:new t.aN(e,n.u_color)}),backgroundPattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_opacity:new t.aI(e,n.u_opacity),u_image:new t.aH(e,n.u_image),u_pattern_tl_a:new t.aM(e,n.u_pattern_tl_a),u_pattern_br_a:new t.aM(e,n.u_pattern_br_a),u_pattern_tl_b:new t.aM(e,n.u_pattern_tl_b),u_pattern_br_b:new t.aM(e,n.u_pattern_br_b),u_texsize:new t.aM(e,n.u_texsize),u_mix:new t.aI(e,n.u_mix),u_pattern_size_a:new t.aM(e,n.u_pattern_size_a),u_pattern_size_b:new t.aM(e,n.u_pattern_size_b),u_scale_a:new t.aI(e,n.u_scale_a),u_scale_b:new t.aI(e,n.u_scale_b),u_pixel_coord_upper:new t.aM(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aM(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.aI(e,n.u_tile_units_to_pixels)}),terrain:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_texture:new t.aH(e,n.u_texture),u_ele_delta:new t.aI(e,n.u_ele_delta)}),terrainDepth:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ele_delta:new t.aI(e,n.u_ele_delta)}),terrainCoords:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_texture:new t.aH(e,n.u_texture),u_terrain_coords_id:new t.aI(e,n.u_terrain_coords_id),u_ele_delta:new t.aI(e,n.u_ele_delta)})};class Ht{constructor(e,t,n){this.context=e;const i=e.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zt{constructor(e,t,n,i){this.length=t.length,this.attributes=n,this.itemSize=t.bytesPerElement,this.dynamicDraw=i,this.context=e;const r=e.gl;this.buffer=r.createBuffer(),e.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let n=0;n<this.attributes.length;n++){const i=t.attributes[this.attributes[n].name];void 0!==i&&e.enableVertexAttribArray(i)}}setVertexAttribPointers(e,t,n){for(let i=0;i<this.attributes.length;i++){const r=this.attributes[i],a=t.attributes[r.name];void 0!==a&&e.vertexAttribPointer(a,r.components,e[qt[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gt=new WeakMap;function Wt(e){var t;if(Gt.has(e))return Gt.get(e);{const n=null===(t=e.getParameter(e.VERSION))||void 0===t?void 0:t.startsWith("WebGL 2.0");return Gt.set(e,n),n}}class Kt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xt extends Kt{getDefault(){return t.aP.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Yt extends Kt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Jt extends Kt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Qt extends Kt{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class en extends Kt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class tn extends Kt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class nn extends Kt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class rn extends Kt{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class an extends Kt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class on extends Kt{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class sn extends Kt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class ln extends Kt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class cn extends Kt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class un extends Kt{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class hn extends Kt{getDefault(){return t.aP.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class dn extends Kt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class pn extends Kt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class fn extends Kt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class mn extends Kt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class gn extends Kt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class yn extends Kt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class _n extends Kt{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class vn extends Kt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class xn extends Kt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class bn extends Kt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class wn extends Kt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Sn extends Kt{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Tn extends Kt{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;const n=this.gl;Wt(n)?n.bindVertexArray(e):null===(t=n.getExtension("OES_vertex_array_object"))||void 0===t||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Cn extends Kt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class In extends Kt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class kn extends Kt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class En extends Kt{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class Pn extends En{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class An extends En{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Mn extends En{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class zn{constructor(e,t,n,i,r){this.context=e,this.width=t,this.height=n;const a=e.gl,o=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new Pn(e,o),i)this.depthAttachment=r?new Mn(e,o):new An(e,o);else if(r)throw new Error("Stencil cannot be set without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class Ln{constructor(e,t,n){this.blendFunction=e,this.blendColor=t,this.mask=n}}Ln.Replace=[1,0],Ln.disabled=new Ln(Ln.Replace,t.aP.transparent,[!1,!1,!1,!1]),Ln.unblended=new Ln(Ln.Replace,t.aP.transparent,[!0,!0,!0,!0]),Ln.alphaBlended=new Ln([1,771],t.aP.transparent,[!0,!0,!0,!0]);class Dn{constructor(e){var t,n;if(this.gl=e,this.clearColor=new Xt(this),this.clearDepth=new Yt(this),this.clearStencil=new Jt(this),this.colorMask=new Qt(this),this.depthMask=new en(this),this.stencilMask=new tn(this),this.stencilFunc=new nn(this),this.stencilOp=new rn(this),this.stencilTest=new an(this),this.depthRange=new on(this),this.depthTest=new sn(this),this.depthFunc=new ln(this),this.blend=new cn(this),this.blendFunc=new un(this),this.blendColor=new hn(this),this.blendEquation=new dn(this),this.cullFace=new pn(this),this.cullFaceSide=new fn(this),this.frontFace=new mn(this),this.program=new gn(this),this.activeTexture=new yn(this),this.viewport=new _n(this),this.bindFramebuffer=new vn(this),this.bindRenderbuffer=new xn(this),this.bindTexture=new bn(this),this.bindVertexBuffer=new wn(this),this.bindElementBuffer=new Sn(this),this.bindVertexArray=new Tn(this),this.pixelStoreUnpack=new Cn(this),this.pixelStoreUnpackPremultiplyAlpha=new In(this),this.pixelStoreUnpackFlipY=new kn(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Wt(e)){this.HALF_FLOAT=e.HALF_FLOAT;const i=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(t=e.RGBA16F)&&void 0!==t?t:null==i?void 0:i.RGBA16F_EXT,this.RGB16F=null!==(n=e.RGB16F)&&void 0!==n?n:null==i?void 0:i.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const t=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==t?void 0:t.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new Ht(this,e,t)}createVertexBuffer(e,t,n){return new Zt(this,e,t,n)}createRenderbuffer(e,t,n){const i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,e,t,n),this.bindRenderbuffer.set(null),r}createFramebuffer(e,t,n,i){return new zn(this,e,t,n,i)}clear(e){let{color:t,depth:n,stencil:i}=e;const r=this.gl;let a=0;t&&(a|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(a|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),void 0!==i&&(a|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),r.clear(a)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.aE(e.blendFunction,Ln.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Wt(this.gl)?this.gl.createVertexArray():null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Wt(this.gl)?this.gl.deleteVertexArray(e):null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class Rn{constructor(e,t,n){this.func=e,this.mask=t,this.range=n}}Rn.ReadOnly=!1,Rn.ReadWrite=!0,Rn.disabled=new Rn(519,Rn.ReadOnly,[0,1]);const Fn=7680;class On{constructor(e,t,n,i,r,a){this.test=e,this.ref=t,this.mask=n,this.fail=i,this.depthFail=r,this.pass=a}}On.disabled=new On({func:519,mask:0},0,0,Fn,Fn,Fn);class Bn{constructor(e,t,n){this.enable=e,this.mode=t,this.frontFace=n}}let Nn;function Vn(e,n,i,r,a){const o=e.context,s=o.gl,l=e.useProgram("collisionBox"),c=[];let u=0,h=0;for(let _=0;_<r.length;_++){const p=r[_],f=n.getTile(p).getBucket(i);if(!f)continue;const m=a?f.textCollisionBox:f.iconCollisionBox,g=f.collisionCircleArray;if(g.length>0){const n=t.F();t.aQ(n,f.placementInvProjMatrix,e.transform.glCoordMatrix),t.aQ(n,n,f.placementViewportMatrix),c.push({circleArray:g,circleOffset:h,transform:p.posMatrix,invTransform:n,coord:p}),u+=g.length/4,h=u}m&&l.draw(o,s.LINES,Rn.disabled,On.disabled,e.colorModeForRenderPass(),Bn.disabled,{u_matrix:p.posMatrix,u_pixel_extrude_scale:[1/(d=e.transform).width,1/d.height]},e.style.map.terrain&&e.style.map.terrain.getTerrainData(p),i.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,e.transform.zoom,null,null,m.collisionVertexBuffer)}var d;if(!a||!c.length)return;const p=e.useProgram("collisionCircle"),f=new t.aR;f.resize(4*u),f._trim();let m=0;for(const t of c)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,i=t.circleArray[n+0],r=t.circleArray[n+1],a=t.circleArray[n+2],o=t.circleArray[n+3];f.emplace(m++,i,r,a,o,0),f.emplace(m++,i,r,a,o,1),f.emplace(m++,i,r,a,o,2),f.emplace(m++,i,r,a,o,3)}(!Nn||Nn.length<2*u)&&(Nn=function(e){const n=2*e,i=new t.aT;i.resize(n),i._trim();for(let t=0;t<n;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(u));const g=o.createIndexBuffer(Nn,!0),y=o.createVertexBuffer(f,t.aS.members,!0);for(const _ of c){const n=Ct(_.transform,_.invTransform,e.transform);p.draw(o,s.TRIANGLES,Rn.disabled,On.disabled,e.colorModeForRenderPass(),Bn.disabled,n,e.style.map.terrain&&e.style.map.terrain.getTerrainData(_.coord),i.id,y,g,t.$.simpleSegment(0,2*_.circleOffset,_.circleArray.length,_.circleArray.length/2),null,e.transform.zoom,null,null,null)}y.destroy(),g.destroy()}Bn.disabled=new Bn(!1,1029,2305),Bn.backCCW=new Bn(!0,1029,2305);const Un=t.an(new Float32Array(16));function jn(e,n,i,r,a,o){const{horizontalAlign:s,verticalAlign:l}=t.au(e);return new t.P((-(s-.5)*n/a+r[0])*o,(-(l-.5)*i/a+r[1])*o)}function $n(e,n,i,r,a,o){const s=n.tileAnchorPoint.add(new t.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let e=r.mult(o);return i||(e=e.rotate(-a)),ye(s.add(e),n.labelPlaneMatrix,n.getElevation).point}if(i){const t=Ie(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(e),i=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0);return e.add(r.rotate(i))}return e.add(r)}function Hn(e,n,i,r,a,o,s,l,c,u,h,d,p,f){const m=e.text.placedSymbolArray,g=e.text.dynamicLayoutVertexArray,y=e.icon.dynamicLayoutVertexArray,_={};g.clear();for(let v=0;v<m.length;v++){const y=m.get(v),x=y.hidden||!y.crossTileID||e.allowVerticalPlacement&&!y.placedOrientation?null:r[y.crossTileID];if(x){const r=new t.P(y.anchorX,y.anchorY),m={getElevation:f,width:a.width,height:a.height,labelPlaneMatrix:o,lineVertexArray:null,pitchWithMap:i,projection:h,projectionCache:null,tileAnchorPoint:r,translation:d,unwrappedTileID:p},v=i?ye(r,s,f):Ie(r.x,r.y,m),b=_e(a.cameraToCenterDistance,v.signedDistanceFromCamera);let w=t.ai(e.textSizeData,c,y)*b/t.ap;i&&(w*=e.tilePixelRatio/l);const{width:S,height:T,anchor:C,textOffset:I,textBoxScale:k}=x,E=jn(C,S,T,I,k,w),P=h.getPitchedTextCorrection(a,r.add(new t.P(d[0],d[1])),p),A=$n(v.point,m,n,E,a.angle,P),M=e.allowVerticalPlacement&&y.placedOrientation===t.ah.vertical?Math.PI/2:0;for(let e=0;e<y.numGlyphs;e++)t.aj(g,A,M);u&&y.associatedIconIndex>=0&&(_[y.associatedIconIndex]={shiftedAnchor:A,angle:M})}else Me(y.numGlyphs,g)}if(u){y.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const i=n.get(e);if(i.hidden)Me(i.numGlyphs,y);else{const n=_[e];if(n)for(let e=0;e<i.numGlyphs;e++)t.aj(y,n.shiftedAnchor,n.angle);else Me(i.numGlyphs,y)}}e.icon.dynamicLayoutVertexBuffer.updateData(y)}e.text.dynamicLayoutVertexBuffer.updateData(g)}function qn(e,t,n){return n.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Zn(e,n,i,r,a,o,s,l,c,u,h,d){const p=e.context,f=p.gl,m=e.transform,g=Qe(),y="map"===l,_="map"===c,v="viewport"!==l&&"point"!==i.layout.get("symbol-placement"),x=y&&!_&&!v,b=!_&&v,w=!i.layout.get("symbol-sort-key").isConstant();let S=!1;const T=e.depthModeForSublayer(0,Rn.ReadOnly),C=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),I=[],k=g.getCircleRadiusCorrection(m);for(const E of r){const r=n.getTile(E),l=r.getBucket(i);if(!l)continue;const c=a?l.text:l.icon;if(!c||!c.segments.get().length||!c.hasVisibleVertices)continue;const h=c.programConfigurations.get(i.id),d=a||l.sdfIcons,p=a?l.textSizeData:l.iconSizeData,T=_||0!==m.pitch,P=e.useProgram(qn(d,a,l),h),A=t.ag(p,m.zoom),M=e.style.map.terrain&&e.style.map.terrain.getTerrainData(E);let z,L,D,R,F=[0,0],O=null;if(a)L=r.glyphAtlasTexture,D=f.LINEAR,z=r.glyphAtlasTexture.size,l.iconsInText&&(F=r.imageAtlasTexture.size,O=r.imageAtlasTexture,R=T||e.options.rotating||e.options.zooming||"composite"===p.kind||"camera"===p.kind?f.LINEAR:f.NEAREST);else{const t=1!==i.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;L=r.imageAtlasTexture,D=d||e.options.rotating||e.options.zooming||t||T?f.LINEAR:f.NEAREST,z=r.imageAtlasTexture.size}const B=De(r,1,e.transform.zoom),N=b?E.posMatrix:Un,V=me(N,_,y,e.transform,B),U=ge(N,_,y,e.transform,B),j=ge(E.posMatrix,_,y,e.transform,B),$=g.translatePosition(e.transform,r,o,s),H=C&&l.hasTextData(),q="none"!==i.layout.get("icon-text-fit")&&H&&l.hasIconData();if(v){const t=e.style.map.terrain?(t,n)=>e.style.map.terrain.getElevation(E,t,n):null,n="map"===i.layout.get("text-rotation-alignment");xe(l,E.posMatrix,e,a,V,j,_,u,n,g,E.toUnwrapped(),m.width,m.height,$,t)}const Z=E.posMatrix,G=a&&C||q,W=v||G?Un:V,K=U,X=d&&0!==i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let Y;Y=d?l.iconsInText?Vt(p.kind,A,x,_,v,G,e,Z,W,K,$,z,F,k):Nt(p.kind,A,x,_,v,G,e,Z,W,K,$,a,z,!0,k):Bt(p.kind,A,x,_,v,G,e,Z,W,K,$,a,z,k);const J={program:P,buffers:c,uniformValues:Y,atlasTexture:L,atlasTextureIcon:O,atlasInterpolation:D,atlasInterpolationIcon:R,isSDF:d,hasHalo:X};if(w&&l.canOverlap){S=!0;const e=c.segments.get();for(const n of e)I.push({segments:new t.$([n]),sortKey:n.sortKey,state:J,terrainData:M})}else I.push({segments:c.segments,sortKey:0,state:J,terrainData:M})}S&&I.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of I){const n=t.state;if(p.activeTexture.set(f.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,f.CLAMP_TO_EDGE),n.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,Gn(n.buffers,t.segments,i,e,n.program,T,h,d,r,t.terrainData)),r.u_is_halo=0}Gn(n.buffers,t.segments,i,e,n.program,T,h,d,n.uniformValues,t.terrainData)}}function Gn(e,t,n,i,r,a,o,s,l,c){const u=i.context;r.draw(u,u.gl.TRIANGLES,a,o,s,Bn.disabled,l,c,n.id,e.layoutVertexBuffer,e.indexBuffer,t,n.paint,i.transform.zoom,e.programConfigurations.get(n.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function Wn(e,t,n,i,r){if(!n||!i||!i.imageAtlas)return;const a=i.imageAtlas.patternPositions;let o=a[n.to.toString()],s=a[n.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){const e=r.getPaintProperty(t);o=a[e],s=a[e]}o&&s&&e.setConstantPatternPositions(o,s)}function Kn(e,t,n,i,r,a,o){const s=e.context.gl,l="fill-pattern",c=n.paint.get(l),u=c&&c.constantOr(1),h=n.getCrossfadeParameters();let d,p,f,m,g;o?(p=u&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=s.LINES):(p=u?"fillPattern":"fill",d=s.TRIANGLES);const y=c.constantOr(null);for(const _ of i){const i=t.getTile(_);if(u&&!i.patternsLoaded())continue;const c=i.getBucket(n);if(!c)continue;const v=c.programConfigurations.get(n.id),x=e.useProgram(p,v),b=e.style.map.terrain&&e.style.map.terrain.getTerrainData(_);u&&(e.context.activeTexture.set(s.TEXTURE0),i.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),v.updatePaintBuffers(h)),Wn(v,l,y,i,n);const w=b?_:null,S=e.translatePosMatrix(w?w.posMatrix:_.posMatrix,i,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(o){m=c.indexBuffer2,g=c.segments2;const t=[s.drawingBufferWidth,s.drawingBufferHeight];f="fillOutlinePattern"===p&&u?St(S,e,h,i,t):wt(S,t)}else m=c.indexBuffer,g=c.segments,f=u?bt(S,e,h,i):xt(S);x.draw(e.context,d,r,e.stencilModeForClipping(_),a,Bn.disabled,f,b,n.id,c.layoutVertexBuffer,m,g,n.paint,e.transform.zoom,v)}}function Xn(e,t,n,i,r,a,o){const s=e.context,l=s.gl,c="fill-extrusion-pattern",u=n.paint.get(c),h=u.constantOr(1),d=n.getCrossfadeParameters(),p=n.paint.get("fill-extrusion-opacity"),f=u.constantOr(null);for(const m of i){const i=t.getTile(m),u=i.getBucket(n);if(!u)continue;const g=e.style.map.terrain&&e.style.map.terrain.getTerrainData(m),y=u.programConfigurations.get(n.id),_=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",y);h&&(e.context.activeTexture.set(l.TEXTURE0),i.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers(d)),Wn(y,c,f,i,n);const v=e.translatePosMatrix(m.posMatrix,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),x=n.paint.get("fill-extrusion-vertical-gradient"),b=h?vt(v,e,x,p,m,d,i):_t(v,e,x,p);_.draw(s,s.gl.TRIANGLES,r,a,o,Bn.backCCW,b,g,n.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,n.paint,e.transform.zoom,y,e.style.map.terrain&&u.centroidVertexBuffer)}}function Yn(e,t,n,i,r,a,o){const s=e.context,l=s.gl,c=n.fbo;if(!c)return;const u=e.useProgram("hillshade"),h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(t);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get()),u.draw(s,l.TRIANGLES,r,a,o,Bn.disabled,((e,t,n,i)=>{const r=n.paint.get("hillshade-shadow-color"),a=n.paint.get("hillshade-highlight-color"),o=n.paint.get("hillshade-accent-color");let s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);const l=!e.options.moving;return{u_matrix:i?i.posMatrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:Pt(0,t.tileID),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:a,u_accent:o}})(e,n,i,h?t:null),h,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function Jn(e,n,i,r,a,o){const s=e.context,l=s.gl,c=n.dem;if(c&&c.data){const u=c.dim,h=c.stride,d=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(h),n.demTexture){const e=n.demTexture;e.update(d,{premultiply:!1}),e.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else n.demTexture=new b(s,d,l.RGBA,{premultiply:!1}),n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);let p=n.fbo;if(!p){const e=new b(s,{width:u,height:u,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),p=n.fbo=s.createFramebuffer(u,u,!0,!1),p.colorAttachment.set(e.texture)}s.bindFramebuffer.set(p.framebuffer),s.viewport.set([0,0,u,u]),e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,a,o,Bn.disabled,((e,n)=>{const i=n.stride,r=t.F();return t.aO(r,0,t.W,-t.W,0,0,1),t.H(r,r,[0,-t.W,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:e.overscaledZ,u_unpack:n.getUnpackVector()}})(n.tileID,c),null,i.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Qn(e,n,i,r,o,s){const l=r.paint.get("raster-fade-duration");if(!s&&l>0){const r=a.now(),s=(r-e.timeAdded)/l,c=n?(r-n.timeAdded)/l:-1,u=i.getSource(),h=o.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),d=!n||Math.abs(n.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),p=d&&e.refreshedUponExpiration?1:t.ac(d?s:1-c,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}const ei=new t.aP(1,0,0,1),ti=new t.aP(0,1,0,1),ni=new t.aP(0,0,1,1),ii=new t.aP(1,0,1,1),ri=new t.aP(0,1,1,1);function ai(e,t,n,i){si(e,0,t+n/2,e.transform.width,n,i)}function oi(e,t,n,i){si(e,t-n/2,0,n,e.transform.height,i)}function si(e,t,n,i,r,a){const o=e.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(t*e.pixelRatio,n*e.pixelRatio,i*e.pixelRatio,r*e.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}function li(e,n,i){const r=e.context,a=r.gl,o=i.posMatrix,s=e.useProgram("debug"),l=Rn.disabled,c=On.disabled,u=e.colorModeForRenderPass(),h="$debug",d=e.style.map.terrain&&e.style.map.terrain.getTerrainData(i);r.activeTexture.set(a.TEXTURE0);const p=n.getTileByID(i.key).latestRawTileData,f=Math.floor((p&&p.byteLength||0)/1024),m=n.getTile(i).tileSize,g=512/Math.min(m,512)*(i.overscaledZ/e.transform.zoom)*.5;let y=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(y+=` => ${i.overscaledZ}`),function(e,t){e.initDebugOverlayCanvas();const n=e.debugOverlayCanvas,i=e.context.gl,r=e.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(t,5,5),r.strokeText(t,5,5),e.debugOverlayTexture.update(n),e.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(e,`${y} ${f}kB`),s.draw(r,a.TRIANGLES,l,c,Ln.alphaBlended,Bn.disabled,It(o,t.aP.transparent,g),null,h,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),s.draw(r,a.LINE_STRIP,l,c,u,Bn.disabled,It(o,t.aP.red),d,h,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function ci(e,t,n){const i=e.context,r=i.gl,a=e.colorModeForRenderPass(),o=new Rn(r.LEQUAL,Rn.ReadWrite,e.depthRangeFor3D),s=e.useProgram("terrain"),l=t.getTerrainMesh();i.bindFramebuffer.set(null),i.viewport.set([0,0,e.width,e.height]);for(const c of n){const n=e.renderToTexture.getTexture(c),u=t.getTerrainData(c.tileID);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.texture);const h={u_matrix:e.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(e.transform.zoom)};s.draw(i,r.TRIANGLES,o,On.disabled,a,Bn.backCCW,h,u,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class ui{constructor(e,n){this.context=new Dn(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ce.maxUnderzooming+ce.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ot}resize(e,t,n){if(this.width=Math.floor(e*n),this.height=Math.floor(t*n),this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const i of this.style._order)this.style._layers[i].resize()}setup(){const e=this.context,n=new t.aW;n.emplaceBack(0,0),n.emplaceBack(t.W,0),n.emplaceBack(0,t.W),n.emplaceBack(t.W,t.W),this.tileExtentBuffer=e.createVertexBuffer(n,ut.members),this.tileExtentSegments=t.$.simpleSegment(0,0,4,2);const i=new t.aW;i.emplaceBack(0,0),i.emplaceBack(t.W,0),i.emplaceBack(0,t.W),i.emplaceBack(t.W,t.W),this.debugBuffer=e.createVertexBuffer(i,ut.members),this.debugSegments=t.$.simpleSegment(0,0,4,5);const r=new t.Z;r.emplaceBack(0,0,0,0),r.emplaceBack(t.W,0,t.W,0),r.emplaceBack(0,t.W,0,t.W),r.emplaceBack(t.W,t.W,t.W,t.W),this.rasterBoundsBuffer=e.createVertexBuffer(r,X.members),this.rasterBoundsSegments=t.$.simpleSegment(0,0,4,2);const a=new t.aW;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,ut.members),this.viewportSegments=t.$.simpleSegment(0,0,4,2);const o=new t.aX;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);const s=new t.aY;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);const l=this.context.gl;this.stencilClearMode=new On({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const i=t.F();t.aO(i,0,this.width,this.height,0,0,1),t.J(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Rn.disabled,this.stencilClearMode,Ln.disabled,Bn.disabled,kt(i),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;const n=this.context,i=n.gl;this.nextStencilID+t.length>256&&this.clearStencil(),n.setColorMode(Ln.disabled),n.setDepthMode(Rn.disabled);const r=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of t){const e=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,t=this.style.map.terrain&&this.style.map.terrain.getTerrainData(a);r.draw(n,i.TRIANGLES,Rn.disabled,new On({func:i.ALWAYS,mask:0},e,255,i.KEEP,i.KEEP,i.REPLACE),Ln.disabled,Bn.disabled,kt(a.posMatrix),t,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new On({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){const t=this.context.gl;return new On({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){const t=this.context.gl,n=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),i=n[n.length-1].overscaledZ,r=n[0].overscaledZ-i+1;if(r>1){this.currentStencilSource=void 0,this.nextStencilID+r>256&&this.clearStencil();const e={};for(let n=0;n<r;n++)e[n+i]=new On({func:t.GEQUAL,mask:255},n+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=r,[e,n]}return[{[i]:On.disabled},n]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new Ln([e.CONSTANT_COLOR,e.ONE],new t.aP(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Ln.unblended:Ln.alphaBlended}depthModeForSublayer(e,t,n){if(!this.opaquePassEnabledForLayer())return Rn.disabled;const i=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Rn(n||this.context.gl.LEQUAL,t,[i,i])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(a.now()),this.imageManager.beginFrame();const i=this.style._order,r=this.style.sourceCaches,o={},s={},l={};for(const t in r){const e=r[t];e.used&&e.prepare(this.context),o[t]=e.getVisibleCoordinates(),s[t]=o[t].slice().reverse(),l[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<i.length;t++)if(this.style._layers[i[t]].is3D()){this.opaquePassCutoff=t;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const t of i){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const n=s[e.source];("custom"===e.type||n.length)&&this.renderLayer(this,r[e.source],e,n)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.aP.black:t.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[i[this.currentLayer]],t=r[e.source],n=o[e.source];this._renderTileClippingMasks(e,n),this.renderLayer(this,t,e,n)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){const e=this.style._layers[i[this.currentLayer]],t=r[e.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(e))continue;const n=("symbol"===e.type?l:s)[e.source];this._renderTileClippingMasks(e,o[e.source]),this.renderLayer(this,t,e,n)}if(this.options.showTileBoundaries){const e=function(e,t){let n=null;const i=Object.values(e._layers).flatMap((n=>n.source&&!n.isHidden(t)?[e.sourceCaches[n.source]]:[])),r=i.filter((e=>"vector"===e.getSource().type)),a=i.filter((e=>"vector"!==e.getSource().type)),o=e=>{(!n||n.getSource().maxzoom<e.getSource().maxzoom)&&(n=e)};return r.forEach((e=>o(e))),n||a.forEach((e=>o(e))),n}(this.style,this.transform.zoom);e&&function(e,t,n){for(let i=0;i<n.length;i++)li(e,t,n[i])}(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;ai(e,e.transform.height-(t.top||0),3,ei),ai(e,t.bottom||0,3,ti),oi(e,t.left||0,3,ni),oi(e,e.transform.width-(t.right||0),3,ii);const n=e.transform.centerPoint;!function(e,t,n,i){si(e,t-1,n-10,2,20,i),si(e,t-10,n-1,20,2,i)}(e,n.x,e.transform.height-n.y,ri)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,i=this.transform.modelViewProjectionMatrix;let r=this.terrainFacilitator.dirty;r||(r=e?!t.aZ(n,i):!t.a_(n,i)),r||(r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),r&&(t.a$(n,i),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,n){const i=e.context,r=i.gl,a=Ln.unblended,o=new Rn(r.LEQUAL,Rn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.sourceCache.getRenderableTiles(),c=e.useProgram("terrainDepth");i.bindFramebuffer.set(n.getFramebuffer("depth").framebuffer),i.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),i.clear({color:t.aP.transparent,depth:1});for(const t of l){const l=n.getTerrainData(t.tileID),u={u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped()),u_ele_delta:n.getMeshFrameDelta(e.transform.zoom)};c.draw(i,r.TRIANGLES,o,On.disabled,a,Bn.backCCW,u,l,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}i.bindFramebuffer.set(null),i.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,n){const i=e.context,r=i.gl,a=Ln.unblended,o=new Rn(r.LEQUAL,Rn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.getCoordsTexture(),c=n.sourceCache.getRenderableTiles(),u=e.useProgram("terrainCoords");i.bindFramebuffer.set(n.getFramebuffer("coords").framebuffer),i.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),i.clear({color:t.aP.transparent,depth:1}),n.coordsIndex=[];for(const t of c){const c=n.getTerrainData(t.tileID);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.texture);const h={u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped()),u_terrain_coords_id:(255-n.coordsIndex.length)/255,u_texture:0,u_ele_delta:n.getMeshFrameDelta(e.transform.zoom)};u.draw(i,r.TRIANGLES,o,On.disabled,a,Bn.backCCW,h,c,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),n.coordsIndex.push(t.tileID.key)}i.bindFramebuffer.set(null),i.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}renderLayer(e,n,i,r){if(!i.isHidden(this.transform.zoom)&&("background"===i.type||"custom"===i.type||(r||[]).length))switch(this.id=i.id,i.type){case"symbol":!function(e,n,i,r,a){if("translucent"!==e.renderPass)return;const o=On.disabled,s=e.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(e,n,i,r,a,o,s,l,c){const u=n.transform,h=Qe(),d="map"===a,p="map"===o;for(const f of e){const e=r.getTile(f),a=e.getBucket(i);if(!a||!a.text||!a.text.segments.get().length)continue;const o=t.ag(a.textSizeData,u.zoom),m=De(e,1,n.transform.zoom),g=me(f.posMatrix,p,d,n.transform,m),y="none"!==i.layout.get("icon-text-fit")&&a.hasIconData();if(o){const t=Math.pow(2,u.zoom-e.tileID.overscaledZ),i=n.style.map.terrain?(e,t)=>n.style.map.terrain.getElevation(f,e,t):null,r=h.translatePosition(u,e,s,l);Hn(a,d,p,c,u,g,f.posMatrix,t,o,y,h,r,f.toUnwrapped(),i)}}}(r,e,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),a),0!==i.paint.get("icon-opacity").constantOr(1)&&Zn(e,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),o,s),0!==i.paint.get("text-opacity").constantOr(1)&&Zn(e,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),o,s),n.map.showCollisionBoxes&&(Vn(e,n,i,r,!0),Vn(e,n,i,r,!1))}(e,n,i,r,this.style.placement.variableOffsets);break;case"circle":!function(e,n,i,r){if("translucent"!==e.renderPass)return;const a=i.paint.get("circle-opacity"),o=i.paint.get("circle-stroke-width"),s=i.paint.get("circle-stroke-opacity"),l=!i.layout.get("circle-sort-key").isConstant();if(0===a.constantOr(1)&&(0===o.constantOr(1)||0===s.constantOr(1)))return;const c=e.context,u=c.gl,h=e.depthModeForSublayer(0,Rn.ReadOnly),d=On.disabled,p=e.colorModeForRenderPass(),f=[];for(let m=0;m<r.length;m++){const a=r[m],o=n.getTile(a),s=o.getBucket(i);if(!s)continue;const c=s.programConfigurations.get(i.id),u=e.useProgram("circle",c),h=s.layoutVertexBuffer,d=s.indexBuffer,p=e.style.map.terrain&&e.style.map.terrain.getTerrainData(a),g={programConfiguration:c,program:u,layoutVertexBuffer:h,indexBuffer:d,uniformValues:Tt(e,a,o,i),terrainData:p};if(l){const e=s.segments.get();for(const n of e)f.push({segments:new t.$([n]),sortKey:n.sortKey,state:g})}else f.push({segments:s.segments,sortKey:0,state:g})}l&&f.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of f){const{programConfiguration:n,program:r,layoutVertexBuffer:a,indexBuffer:o,uniformValues:s,terrainData:l}=t.state;r.draw(c,u.TRIANGLES,h,d,p,Bn.disabled,s,l,i.id,a,o,t.segments,i.paint,e.transform.zoom,n)}}(e,n,i,r);break;case"heatmap":!function(e,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const a=e.context,o=a.gl,s=On.disabled,l=new Ln([o.ONE,o.ONE],t.aP.transparent,[!0,!0,!0,!0]);!function(e,t,n){const i=e.gl;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);let r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),e.bindFramebuffer.set(r.framebuffer);else{const a=i.createTexture();i.bindTexture(i.TEXTURE_2D,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),r=n.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1,!1),function(e,t,n,i){var r,a;const o=e.gl,s=null!==(r=e.HALF_FLOAT)&&void 0!==r?r:o.UNSIGNED_BYTE,l=null!==(a=e.RGBA16F)&&void 0!==a?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,l,t.width/4,t.height/4,0,o.RGBA,s,null),i.colorAttachment.set(n)}(e,t,a,r)}}(a,e,i),a.clear({color:t.aP.transparent});for(let t=0;t<r.length;t++){const c=r[t];if(n.hasRenderableParent(c))continue;const u=n.getTile(c),h=u.getBucket(i);if(!h)continue;const d=h.programConfigurations.get(i.id),p=e.useProgram("heatmap",d),{zoom:f}=e.transform;p.draw(a,o.TRIANGLES,Rn.disabled,s,l,Bn.disabled,Et(c.posMatrix,u,f,i.paint.get("heatmap-intensity")),null,i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,i.paint,e.transform.zoom,d)}a.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,n){const i=e.context,r=i.gl,a=n.heatmapFbo;if(!a)return;i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);let o=n.colorRampTexture;o||(o=n.colorRampTexture=new b(i,n.colorRamp,r.RGBA)),o.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(i,r.TRIANGLES,Rn.disabled,On.disabled,e.colorModeForRenderPass(),Bn.disabled,((e,n)=>{const i=t.F();t.aO(i,0,e.width,e.height,0,0,1);const r=e.context.gl;return{u_matrix:i,u_world:[r.drawingBufferWidth,r.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}})(e,n),null,n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom)}(e,i))}(e,n,i,r);break;case"line":!function(e,n,i,r){if("translucent"!==e.renderPass)return;const a=i.paint.get("line-opacity"),o=i.paint.get("line-width");if(0===a.constantOr(1)||0===o.constantOr(1))return;const s=e.depthModeForSublayer(0,Rn.ReadOnly),l=e.colorModeForRenderPass(),c=i.paint.get("line-dasharray"),u=i.paint.get("line-pattern"),h=u.constantOr(1),d=i.paint.get("line-gradient"),p=i.getCrossfadeParameters(),f=h?"linePattern":c?"lineSDF":d?"lineGradient":"line",m=e.context,g=m.gl;let y=!0;for(const _ of r){const r=n.getTile(_);if(h&&!r.patternsLoaded())continue;const a=r.getBucket(i);if(!a)continue;const o=a.programConfigurations.get(i.id),v=e.context.program.get(),x=e.useProgram(f,o),w=y||x.program!==v,S=e.style.map.terrain&&e.style.map.terrain.getTerrainData(_),T=u.constantOr(null);if(T&&r.imageAtlas){const e=r.imageAtlas,t=e.patternPositions[T.to.toString()],n=e.patternPositions[T.from.toString()];t&&n&&o.setConstantPatternPositions(t,n)}const C=S?_:null,I=h?zt(e,r,i,p,C):c?Lt(e,r,i,c,p,C):d?Mt(e,r,i,a.lineClipsArray.length,C):At(e,r,i,C);if(h)m.activeTexture.set(g.TEXTURE0),r.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),o.updatePaintBuffers(p);else if(c&&(w||e.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(m);else if(d){const r=a.gradients[i.id];let o=r.texture;if(i.gradientVersion!==r.version){let s=256;if(i.stepInterpolant){const i=n.getSource().maxzoom,r=_.canonical.z===i?Math.ceil(1<<e.transform.maxZoom-_.canonical.z):1;s=t.ac(t.aU(a.maxLineLength/t.W*1024*r),256,m.maxTextureSize)}r.gradient=t.aV({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:s,image:r.gradient||void 0,clips:a.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new b(m,r.gradient,g.RGBA),r.version=i.gradientVersion,o=r.texture}m.activeTexture.set(g.TEXTURE0),o.bind(i.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}x.draw(m,g.TRIANGLES,s,e.stencilModeForClipping(_),l,Bn.disabled,I,S,i.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,i.paint,e.transform.zoom,o,a.layoutVertexBuffer2),y=!1}}(e,n,i,r);break;case"fill":!function(e,n,i,r){const a=i.paint.get("fill-color"),o=i.paint.get("fill-opacity");if(0===o.constantOr(1))return;const s=e.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(t.aP.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){const t=e.depthModeForSublayer(1,"opaque"===e.renderPass?Rn.ReadWrite:Rn.ReadOnly);Kn(e,n,i,r,t,s,!1)}if("translucent"===e.renderPass&&i.paint.get("fill-antialias")){const t=e.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Rn.ReadOnly);Kn(e,n,i,r,t,s,!0)}}(e,n,i,r);break;case"fill-extrusion":!function(e,t,n,i){const r=n.paint.get("fill-extrusion-opacity");if(0!==r&&"translucent"===e.renderPass){const a=new Rn(e.context.gl.LEQUAL,Rn.ReadWrite,e.depthRangeFor3D);if(1!==r||n.paint.get("fill-extrusion-pattern").constantOr(1))Xn(e,t,n,i,a,On.disabled,Ln.disabled),Xn(e,t,n,i,a,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const r=e.colorModeForRenderPass();Xn(e,t,n,i,a,On.disabled,r)}}}(e,n,i,r);break;case"hillshade":!function(e,t,n,i){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const r=e.context,a=e.depthModeForSublayer(0,Rn.ReadOnly),o=e.colorModeForRenderPass(),[s,l]="translucent"===e.renderPass?e.stencilConfigForOverlap(i):[{},i];for(const c of l){const i=t.getTile(c);void 0!==i.needsHillshadePrepare&&i.needsHillshadePrepare&&"offscreen"===e.renderPass?Jn(e,i,n,a,On.disabled,o):"translucent"===e.renderPass&&Yn(e,c,i,n,a,s[c.overscaledZ],o)}r.viewport.set([0,0,e.width,e.height])}(e,n,i,r);break;case"raster":!function(e,t,n,i){if("translucent"!==e.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!i.length)return;const r=e.context,a=r.gl,o=t.getSource(),s=e.useProgram("raster"),l=e.colorModeForRenderPass(),[c,u]=o instanceof Y?[{},i]:e.stencilConfigForOverlap(i),h=u[u.length-1].overscaledZ,d=!e.options.moving;for(const p of u){const i=e.depthModeForSublayer(p.overscaledZ-h,1===n.paint.get("raster-opacity")?Rn.ReadWrite:Rn.ReadOnly,a.LESS),u=t.getTile(p);u.registerFadeDuration(n.paint.get("raster-fade-duration"));const f=t.findLoadedParent(p,0),m=t.findLoadedSibling(p),g=Qn(u,f||m||null,t,n,e.transform,e.style.map.terrain);let y,_;const v="nearest"===n.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;r.activeTexture.set(a.TEXTURE0),u.texture.bind(v,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),r.activeTexture.set(a.TEXTURE1),f?(f.texture.bind(v,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),y=Math.pow(2,f.tileID.overscaledZ-u.tileID.overscaledZ),_=[u.tileID.canonical.x*y%1,u.tileID.canonical.y*y%1]):u.texture.bind(v,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const x=e.style.map.terrain&&e.style.map.terrain.getTerrainData(p),b=x?p:null,w=b?b.posMatrix:e.transform.calculatePosMatrix(p.toUnwrapped(),d),S=Ft(w,_||[0,0],y||1,g,n);o instanceof Y?s.draw(r,a.TRIANGLES,i,On.disabled,l,Bn.disabled,S,x,n.id,o.boundsBuffer,e.quadTriangleIndexBuffer,o.boundsSegments):s.draw(r,a.TRIANGLES,i,c[p.overscaledZ],l,Bn.disabled,S,x,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}(e,n,i,r);break;case"background":!function(e,t,n,i){const r=n.paint.get("background-color"),a=n.paint.get("background-opacity");if(0===a)return;const o=e.context,s=o.gl,l=e.transform,c=l.tileSize,u=n.paint.get("background-pattern");if(e.isPatternMissing(u))return;const h=!u&&1===r.a&&1===a&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==h)return;const d=On.disabled,p=e.depthModeForSublayer(0,"opaque"===h?Rn.ReadWrite:Rn.ReadOnly),f=e.colorModeForRenderPass(),m=e.useProgram(u?"backgroundPattern":"background"),g=i||l.coveringTiles({tileSize:c,terrain:e.style.map.terrain});u&&(o.activeTexture.set(s.TEXTURE0),e.imageManager.bind(e.context));const y=n.getCrossfadeParameters();for(const _ of g){const t=i?_.posMatrix:e.transform.calculatePosMatrix(_.toUnwrapped()),l=u?jt(t,a,e,u,{tileID:_,tileSize:c},y):Ut(t,a,r),h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(_);m.draw(o,s.TRIANGLES,p,d,f,Bn.disabled,l,h,n.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}(e,0,i,r);break;case"custom":!function(e,t,n){const i=e.context,r=n.implementation;if("offscreen"===e.renderPass){const t=r.prerender;t&&(e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),t.call(r,i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),i.setColorMode(e.colorModeForRenderPass()),i.setStencilMode(On.disabled);const t="3d"===r.renderingMode?new Rn(e.context.gl.LEQUAL,Rn.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Rn.ReadOnly);i.setDepthMode(t),r.render(i.gl,e.transform.customLayerMatrix()),i.setDirty(),e.setBaseState(),i.bindFramebuffer.set(null)}}(e,0,i)}}translatePosMatrix(e,n,i,r,a){if(!i[0]&&!i[1])return e;const o=a?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){const e=Math.sin(o),t=Math.cos(o);i=[i[0]*t-i[1]*e,i[0]*e+i[1]*t]}const s=[a?i[0]:De(n,i[0],this.transform.zoom),a?i[1]:De(n,i[1],this.transform.zoom),0],l=new Float32Array(16);return t.H(l,e,s),l}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const t=this.imageManager.getPattern(e.from.toString()),n=this.imageManager.getPattern(e.to.toString());return!t||!n}useProgram(e,t){this.cache=this.cache||{};const n=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[n]||(this.cache[n]=new gt(this.context,dt[e],t,$t[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[n]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new b(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}class hi{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,n,i){const r=Math.pow(2,i),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((i=>{const a=1/(i=t.af([],i,e))[3]/n*r;return t.b0(i,i,[a,a,1/i[3],a])})),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const t=function(e,t){var n=t[0],i=t[1],r=t[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}([],function(e,t,n){var i=t[0],r=t[1],a=t[2],o=n[0],s=n[1],l=n[2];return e[0]=r*l-a*s,e[1]=a*o-i*l,e[2]=i*s-r*o,e}([],y([],a[e[0]],a[e[1]]),y([],a[e[2]],a[e[1]]))),n=-((i=t)[0]*(r=a[e[1]])[0]+i[1]*r[1]+i[2]*r[2]);var i,r;return t.concat(n)}));return new hi(a,o)}}class di{constructor(e,t){this.min=e,this.max=t,this.center=function(e,t){return e[0]=.5*t[0],e[1]=.5*t[1],e[2]=.5*t[2],e}([],function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}([],this.min,this.max))}quadrant(e){const t=[e%2==0,e<2],n=m(this.min),i=m(this.max);for(let r=0;r<t.length;r++)n[r]=t[r]?this.min[r]:this.center[r],i[r]=t[r]?this.center[r]:this.max[r];return i[2]=this.max[2],new di(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let i=!0;for(let r=0;r<e.planes.length;r++){const a=e.planes[r];let o=0;for(let e=0;e<n.length;e++)t.b1(a,n[e])>=0&&o++;if(0===o)return 0;o!==n.length&&(i=!1)}if(i)return 2;for(let t=0;t<3;t++){let n=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const a=e.points[r][t]-this.min[t];n=Math.min(n,a),i=Math.max(i,a)}if(i<0||n>this.max[t]-this.min[t])return 0}return 1}}class pi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=n,this.right=i}interpolate(e,n,i){return null!=n.top&&null!=e.top&&(this.top=t.z.number(e.top,n.top,i)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.z.number(e.bottom,n.bottom,i)),null!=n.left&&null!=e.left&&(this.left=t.z.number(e.left,n.left,i)),null!=n.right&&null!=e.right&&(this.right=t.z.number(e.right,n.right,i)),this}getCenter(e,n){const i=t.ac((this.left+e-this.right)/2,0,e),r=t.ac((this.top+n-this.bottom)/2,0,n);return new t.P(i,r)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new pi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const fi=85.051129;class mi{constructor(e,n,i,r,a){this.tileSize=512,this._renderWorldCopies=void 0===a||!!a,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pi,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new mi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const n=-t.b2(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=function(){var e=new t.A(4);return t.A!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}(),function(e,t,n){var i=t[0],r=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);e[0]=i*l+a*s,e[1]=r*l+o*s,e[2]=i*-s+a*l,e[3]=r*-s+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(e){const n=[new t.b3(0,e)];if(this._renderWorldCopies){const i=this.pointCoordinate(new t.P(0,0)),r=this.pointCoordinate(new t.P(this.width,0)),a=this.pointCoordinate(new t.P(this.width,this.height)),o=this.pointCoordinate(new t.P(0,this.height)),s=Math.floor(Math.min(i.x,r.x,a.x,o.x)),l=Math.floor(Math.max(i.x,r.x,a.x,o.x)),c=1;for(let u=s-c;u<=l+c;u++)0!==u&&n.push(new t.b3(u,e))}return n}coveringTiles(e){var n,i;let r=this.coveringZoomLevel(e);const a=r;if(void 0!==e.minzoom&&r<e.minzoom)return[];void 0!==e.maxzoom&&r>e.maxzoom&&(r=e.maxzoom);const o=this.pointCoordinate(this.getCameraPoint()),s=t.Y.fromLngLat(this.center),l=Math.pow(2,r),c=[l*o.x,l*o.y,0],u=[l*s.x,l*s.y,0],h=hi.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,r);let d=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(d=r);const p=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,f=e=>({aabb:new di([e*l,0,0],[(e+1)*l,l,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),m=[],g=[],y=r,v=e.reparseOverscaled?a:r;if(this._renderWorldCopies)for(let t=1;t<=3;t++)m.push(f(-t)),m.push(f(t));for(m.push(f(0));m.length>0;){const r=m.pop(),a=r.x,o=r.y;let s=r.fullyVisible;if(!s){const e=r.aabb.intersects(h);if(0===e)continue;s=2===e}const l=e.terrain?c:u,f=r.aabb.distanceX(l),x=r.aabb.distanceY(l),b=Math.max(Math.abs(f),Math.abs(x));if(r.zoom===y||b>p+(1<<y-r.zoom)-2&&r.zoom>=d){const e=y-r.zoom,n=c[0]-.5-(a<<e),i=c[1]-.5-(o<<e);g.push({tileID:new t.Q(r.zoom===y?v:r.zoom,r.wrap,r.zoom,a,o),distanceSq:_([u[0]-.5-a,u[1]-.5-o]),tileDistanceToCamera:Math.sqrt(n*n+i*i)})}else for(let c=0;c<4;c++){const l=(a<<1)+c%2,u=(o<<1)+(c>>1),h=r.zoom+1;let d=r.aabb.quadrant(c);if(e.terrain){const a=new t.Q(h,r.wrap,h,l,u),o=e.terrain.getMinMaxElevation(a),s=null!==(n=o.minElevation)&&void 0!==n?n:this.elevation,c=null!==(i=o.maxElevation)&&void 0!==i?i:this.elevation;d=new di([d.min[0],d.min[1],s],[d.max[0],d.max[1],c])}m.push({aabb:d,zoom:h,x:l,y:u,wrap:r.wrap,fullyVisible:s})}}return g.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const n=t.ac(e.lat,-85.051129,fi);return new t.P(t.N(e.lng)*this.worldSize,t.O(n)*this.worldSize)}unproject(e){return new t.Y(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const n=this.elevation,i=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,r=this.pointLocation(this.centerPoint,e),a=e.getElevationForLngLatZoom(r,this.tileZoom);if(!(this.elevation-a))return;const o=i+n-a,s=Math.cos(this._pitch)*this.cameraToCenterDistance/o/t.b4(1,r.lat),l=this.scaleZoom(s/this.tileSize);this._elevation=a,this._center=r,this.zoom=l}setLocationAtPoint(e,n){const i=this.pointCoordinate(n),r=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new t.Y(a.x-(i.x-r.x),a.y-(i.y-r.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(e){return t.Y.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,n){if(n){const t=n.pointCoordinate(e);if(null!=t)return t}const i=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.af(i,i,this.pixelMatrixInverse),t.af(r,r,this.pixelMatrixInverse);const a=i[3],o=r[3],s=i[1]/a,l=r[1]/o,c=i[2]/a,u=r[2]/o,h=c===u?0:(0-c)/(u-c);return new t.Y(t.z.number(i[0]/a,r[0]/o,h)/this.worldSize,t.z.number(s,l,h)/this.worldSize)}coordinatePoint(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pixelMatrix;const r=[e.x*this.worldSize,e.y*this.worldSize,n,1];return t.af(r,r,i),new t.P(r[0]/r[3],r[1]/r[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return(new H).extend(this.pointLocation(new t.P(0,e))).extend(this.pointLocation(new t.P(this.width,e))).extend(this.pointLocation(new t.P(this.width,this.height))).extend(this.pointLocation(new t.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new H([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,fi])}calculatePosMatrix(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e.key,r=n?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];const a=e.canonical,o=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*e.wrap,l=t.an(new Float64Array(16));return t.H(l,l,[s*o,a.y*o,0]),t.J(l,l,[o/t.W,o/t.W,1]),t.K(l,n?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,l),r[i]=new Float32Array(l),r[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,n){n=t.ac(+n,this.minZoom,this.maxZoom);const i={center:new t.M(e.lng,e.lat),zoom:n};let r=this.lngRange;if(!this._renderWorldCopies&&null===r){const e=180-1e-10;r=[-e,e]}const a=this.tileSize*this.zoomScale(i.zoom);let o=0,s=a,l=0,c=a,u=0,h=0;const{x:d,y:p}=this.size;if(this.latRange){const e=this.latRange;o=t.O(e[1])*a,s=t.O(e[0])*a,s-o<p&&(u=p/(s-o))}r&&(l=t.b2(t.N(r[0])*a,0,a),c=t.b2(t.N(r[1])*a,0,a),c<l&&(c+=a),c-l<d&&(h=d/(c-l)));const{x:f,y:m}=this.project.call({worldSize:a},e);let g,y;const _=Math.max(h||0,u||0);if(_){const e=new t.P(h?(c+l)/2:f,u?(s+o)/2:m);return i.center=this.unproject.call({worldSize:a},e).wrap(),i.zoom+=this.scaleZoom(_),i}if(this.latRange){const e=p/2;m-e<o&&(y=o+e),m+e>s&&(y=s-e)}if(r){const e=(l+c)/2;let n=f;this._renderWorldCopies&&(n=t.b2(f,e-a/2,e+a/2));const i=d/2;n-i<l&&(g=l+i),n+i>c&&(g=c-i)}if(void 0!==g||void 0!==y){const e=new t.P(null!=g?g:f,null!=y?y:m);i.center=this.unproject.call({worldSize:a},e).wrap()}return i}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:t,zoom:n}=this.getConstrained(this.center,this.zoom);this.center=t,this.zoom=n,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,n=this.point.x,i=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=t.b4(1,this.center.lat)*this.worldSize;let r=t.an(new Float64Array(16));t.J(r,r,[this.width/2,-this.height/2,1]),t.H(r,r,[1,-1,0]),this.labelPlaneMatrix=r,r=t.an(new Float64Array(16)),t.J(r,r,[1,-1,1]),t.H(r,r,[-1,-1,0]),t.J(r,r,[2/this.width,2/this.height,1]),this.glCoordMatrix=r;const a=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),o=Math.min(this.elevation,this.minElevationForCurrentTile),s=a-o*this._pixelPerMeter/Math.cos(this._pitch),l=o<0?s:a,c=Math.PI/2+this._pitch,u=this._fov*(.5+e.y/this.height),h=Math.sin(u)*l/Math.sin(t.ac(Math.PI-c-u,.01,Math.PI-.01)),d=this.getHorizon(),p=2*Math.atan(d/this.cameraToCenterDistance)*(.5+e.y/(2*d)),f=Math.sin(p)*l/Math.sin(t.ac(Math.PI-c-p,.01,Math.PI-.01)),m=Math.min(h,f),g=1.01*(Math.cos(Math.PI/2-this._pitch)*m+l),y=this.height/50;r=new Float64Array(16),t.b5(r,this._fov,this.width/this.height,y,g),r[8]=2*-e.x/this.width,r[9]=2*e.y/this.height,t.J(r,r,[1,-1,1]),t.H(r,r,[0,0,-this.cameraToCenterDistance]),t.b6(r,r,this._pitch),t.ad(r,r,this.angle),t.H(r,r,[-n,-i,0]),this.mercatorMatrix=t.J([],r,[this.worldSize,this.worldSize,this.worldSize]),t.J(r,r,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.K(new Float64Array(16),this.labelPlaneMatrix,r),t.H(r,r,[0,0,-this.elevation]),this.modelViewProjectionMatrix=r,this.invModelViewProjectionMatrix=t.as([],r),this.pixelMatrix3D=t.K(new Float64Array(16),this.labelPlaneMatrix,r);const _=this.width%2/2,v=this.height%2/2,x=Math.cos(this.angle),b=Math.sin(this.angle),w=n-Math.round(n)+x*_+b*v,S=i-Math.round(i)+x*v+b*_,T=new Float64Array(r);if(t.H(T,T,[w>.5?w-1:w,S>.5?S-1:S,0]),this.alignedModelViewProjectionMatrix=T,r=t.as(new Float64Array(16),this.pixelMatrix),!r)throw new Error("failed to invert matrix");this.pixelMatrixInverse=r,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new t.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.af(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(0,e))}getCameraQueryGeometry(e){const n=this.getCameraPoint();if(1===e.length)return[e[0],n];{let i=n.x,r=n.y,a=n.x,o=n.y;for(const t of e)i=Math.min(i,t.x),r=Math.min(r,t.y),a=Math.max(a,t.x),o=Math.max(o,t.y);return[new t.P(i,r),new t.P(a,r),new t.P(a,o),new t.P(i,o),new t.P(i,r)]}}lngLatToCameraDepth(e,n){const i=this.locationCoordinate(e),r=[i.x*this.worldSize,i.y*this.worldSize,n,1];return t.af(r,r,this.modelViewProjectionMatrix),r[2]/r[3]}}function gi(e,t){var n=this;let i,r=!1,a=null,o=null;const s=()=>{a=null,r&&(e.apply(o,i),a=setTimeout(s,t),r=!1)};return function(){for(var e=arguments.length,t=new Array(e),l=0;l<e;l++)t[l]=arguments[l];return r=!0,o=n,i=t,a||s(),a}}class yi{constructor(e){this._getCurrentHash=()=>{const e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{const e=this._getCurrentHash();if(e.length>=3&&!e.some((e=>isNaN(e)))){const t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const e=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,e)}catch(e){}},this._updateHash=gi(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const t=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,i),a=Math.round(t.lng*r)/r,o=Math.round(t.lat*r)/r,s=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=e?`/${a}/${o}/${n}`:`${n}/${o}/${a}`,(s||l)&&(c+="/"+Math.round(10*s)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const e=this._hashName;let t=!1;const n=window.location.hash.slice(1).split("&").map((n=>{const i=n.split("=")[0];return i===e?(t=!0,`${i}=${c}`):n})).filter((e=>e));return t||n.push(`${e}=${c}`),`#${n.join("&")}`}return`#${c}`}}const _i={linearity:.3,easing:t.b7(0,0,.3,1)},vi=t.e({deceleration:2500,maxSpeed:1400},_i),xi=t.e({deceleration:20,maxSpeed:1400},_i),bi=t.e({deceleration:1e3,maxSpeed:360},_i),wi=t.e({deceleration:1e3,maxSpeed:90},_i);class Si{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,t=a.now();for(;e.length>0&&t-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(n.pan.mag()){const a=Ci(n.pan.mag(),i,t.e({},vi,e||{}));r.offset=n.pan.mult(a.amount/n.pan.mag()),r.center=this._map.transform.center,Ti(r,a)}if(n.zoom){const e=Ci(n.zoom,i,xi);r.zoom=this._map.transform.zoom+e.amount,Ti(r,e)}if(n.bearing){const e=Ci(n.bearing,i,bi);r.bearing=this._map.transform.bearing+t.ac(e.amount,-179,179),Ti(r,e)}if(n.pitch){const e=Ci(n.pitch,i,wi);r.pitch=this._map.transform.pitch+e.amount,Ti(r,e)}if(r.zoom||r.bearing){const e=void 0===n.pinchAround?n.around:n.pinchAround;r.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),t.e(r,{noMoveStart:!0})}}function Ti(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Ci(e,n,i){const{maxSpeed:r,linearity:a,deceleration:o}=i,s=t.ac(e*a/(n/1e3),-r,r),l=Math.abs(s)/(o*a);return{easing:i.easing,duration:1e3*l,amount:s*(l/2)}}class Ii extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=o.mousePos(n.getCanvas(),i),s=n.unproject(a);super(e,t.e({point:a,lngLat:s,originalEvent:i},r)),this._defaultPrevented=!1,this.target=n}}class ki extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,i){const r="touchend"===e?i.changedTouches:i.touches,a=o.touchPos(n.getCanvasContainer(),r),s=a.map((e=>n.unproject(e))),l=a.reduce(((e,t,n,i)=>e.add(t.div(i.length))),new t.P(0,0));super(e,{points:a,point:l,lngLats:s,lngLat:n.unproject(l),originalEvent:i}),this._defaultPrevented=!1}}class Ei extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,n){super(e,{originalEvent:n}),this._defaultPrevented=!1}}class Pi{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Ei(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new Ii(e.type,this._map,e))}mouseup(e){this._map.fire(new Ii(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Ii(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ii(e.type,this._map,e))}mouseover(e){this._map.fire(new Ii(e.type,this._map,e))}mouseout(e){this._map.fire(new Ii(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ki(e.type,this._map,e))}touchmove(e){this._map.fire(new ki(e.type,this._map,e))}touchend(e){this._map.fire(new ki(e.type,this._map,e))}touchcancel(e){this._map.fire(new ki(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ai{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ii(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ii("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ii(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mi{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(t.P.convert(e),this._map.terrain)}}class zi{constructor(e,t){this._map=e,this._tr=new Mi(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(o.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const n=t;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const i=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const r=Math.min(i.x,n.x),a=Math.max(i.x,n.x),s=Math.min(i.y,n.y),l=Math.max(i.y,n.y);o.setTransform(this._box,`translate(${r}px,${s}px)`),this._box.style.width=a-r+"px",this._box.style.height=l-s+"px"}mouseupWindow(e,n){if(!this._active)return;if(0!==e.button)return;const i=this._startPos,r=n;if(this.reset(),o.suppressClick(),i.x!==r.x||i.y!==r.y)return this._map.fire(new t.k("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(i,r,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.k(e,{originalEvent:n}))}}function Li(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);const n={};for(let i=0;i<e.length;i++)n[e[i].identifier]=t[i];return n}class Di{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(e){const n=new t.P(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=Li(i,n)))}touchmove(e,t,n){if(this.aborted||!this.centroid)return;const i=Li(n,t);for(const r in this.touches){const e=i[r];(!e||e.dist(this.touches[r])>30)&&(this.aborted=!0)}}touchend(e,t,n){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class Ri{constructor(e){this.singleTap=new Di(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,n){this.singleTap.touchstart(e,t,n)}touchmove(e,t,n){this.singleTap.touchmove(e,t,n)}touchend(e,t,n){const i=this.singleTap.touchend(e,t,n);if(i){const t=e.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(i)<30;if(t&&n||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class Fi{constructor(e){this._tr=new Mi(e),this._zoomIn=new Ri({numTouches:1,numTaps:2}),this._zoomOut=new Ri({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,n){this._zoomIn.touchstart(e,t,n),this._zoomOut.touchstart(e,t,n)}touchmove(e,t,n){this._zoomIn.touchmove(e,t,n),this._zoomOut.touchmove(e,t,n)}touchend(e,t,n){const i=this._zoomIn.touchend(e,t,n),r=this._zoomOut.touchend(e,t,n),a=this._tr;return i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(i)},{originalEvent:e})}):r?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(r)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oi{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(){const e=this._moveFunction(...arguments);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;const n=this._lastPoint;if(!n)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const i=t.length?t[0]:t;return!this._moved&&i.dist(n)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=i,this._move(n,i))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&o.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Bi={0:1,2:2};class Ni{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const t=o.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){const n=Bi[t];return void 0===e.buttons||(e.buttons&n)!==n}(e,this._eventButton)}isValidEndEvent(e){return o.mouseButton(e)===this._eventButton}}class Vi{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const Ui=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=e=>{e.preventDefault()}},ji=e=>{let{enable:t,clickTolerance:n,bearingDegreesPerPixelMoved:i=.8}=e;const r=new Ni({checkCorrectEvent:e=>0===o.mouseButton(e)&&e.ctrlKey||2===o.mouseButton(e)});return new Oi({clickTolerance:n,move:(e,t)=>({bearingDelta:(t.x-e.x)*i}),moveStateManager:r,enable:t,assignEvents:Ui})},$i=e=>{let{enable:t,clickTolerance:n,pitchDegreesPerPixelMoved:i=-.5}=e;const r=new Ni({checkCorrectEvent:e=>0===o.mouseButton(e)&&e.ctrlKey||2===o.mouseButton(e)});return new Oi({clickTolerance:n,move:(e,t)=>({pitchDelta:(t.y-e.y)*i}),moveStateManager:r,enable:t,assignEvents:Ui})};class Hi{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,t,n){return this._calculateTransform(e,t,n)}touchmove(e,t,n){if(this._active&&!(n.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,t,n)}touchend(e,t,n){this._calculateTransform(e,t,n),this._active&&n.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,i){i.length>0&&(this._active=!0);const r=Li(i,n),a=new t.P(0,0),o=new t.P(0,0);let s=0;for(const t in r){const e=r[t],n=this._touches[t];n&&(a._add(e),o._add(e.sub(n)),s++,r[t]=e)}if(this._touches=r,s<this.minTouchs()||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,n){if(!this._firstTwoTouches)return;e.preventDefault();const[i,r]=this._firstTwoTouches,a=Zi(n,t,i),o=Zi(n,t,r);if(!a||!o)return;const s=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],s,e)}touchend(e,t,n){if(!this._firstTwoTouches)return;const[i,r]=this._firstTwoTouches,a=Zi(n,t,i),s=Zi(n,t,r);a&&s||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Zi(e,t,n){for(let i=0;i<e.length;i++)if(e[i].identifier===n)return t[i]}function Gi(e,t){return Math.log(e/t)/Math.LN2}class Wi extends qi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const n=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Gi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gi(this._distance,n),pinchAround:t}}}function Ki(e,t){return 180*e.angleWith(t)/Math.PI}class Xi extends qi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,n){const i=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ki(this._vector,i),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,n=Ki(e,this._startVector);return Math.abs(n)<t}}function Yi(e){return Math.abs(e.y)>Math.abs(e.x)}class Ji extends qi{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,n){super.touchstart(e,t,n),this._currentTouchCount=n.length}_start(e){this._lastPoints=e,Yi(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,n){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const i=e[0].sub(this._lastPoints[0]),r=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(i,r,n.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(i.y+r.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,n){if(void 0!==this._valid)return this._valid;const i=e.mag()>=2,r=t.mag()>=2;if(!i&&!r)return;if(!i||!r)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const a=e.y>0==t.y>0;return Yi(e)&&Yi(t)&&a}}const Qi={panStep:100,bearingStep:15,pitchStep:10};class er{constructor(e){this._tr=new Mi(e);const t=Qi;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,n=0,i=0,r=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),r=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),r=1);break;case 38:e.shiftKey?i=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?i=-1:(e.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:o=>{const s=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:tr,zoom:t?Math.round(s.zoom)+t*(e.shiftKey?2:1):s.zoom,bearing:s.bearing+n*this._bearingStep,pitch:s.pitch+i*this._pitchStep,offset:[-r*this._panStep,-a*this._panStep],center:s.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tr(e){return e*(2-e)}const nr=4.000244140625;class ir{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new Mi(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled())return;if(this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const n=a.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==t&&t%nr==0?this._type="wheel":0!==t&&Math.abs(t)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(i*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t/=4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=o.mousePos(this._map.getCanvas(),e),i=this._tr;this._around=n.y>i.transform.height/2-i.transform.getHorizon()?t.M.convert(this._aroundCenter?i.center:i.unproject(n)):t.M.convert(i.center),this._aroundPoint=i.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._tr.transform;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>nr?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==n&&(n=1/n);const i="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(i*n))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:e.zoom,i=this._startZoom,r=this._easing;let o,s=!1;if("wheel"===this._type&&i&&r){const e=Math.min((a.now()-this._lastWheelEventTime)/200,1),l=r(e);o=t.z.number(i,n,l),e<1?this._frameId||(this._frameId=!0):s=!0}else o=n,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.b8;if(this._prevEase){const e=this._prevEase,i=(a.now()-e.start)/e.duration,r=e.easing(i+.01)-e.easing(i),o=.27/Math.sqrt(r*r+1e-4)*.01,s=Math.sqrt(.0729-o*o);n=t.b7(o,s,.25,1)}return this._prevEase={start:a.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class rr{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ar{constructor(e){this._tr=new Mi(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class or{constructor(){this._tap=new Ri({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,n){if(!this._swipePoint)if(this._tapTime){const i=t[0],r=e.timeStamp-this._tapTime<500,a=this._tapPoint.dist(i)<30;r&&a?n.length>0&&(this._swipePoint=i,this._swipeTouch=n[0].identifier):this.reset()}else this._tap.touchstart(e,t,n)}touchmove(e,t,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=t[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,e.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(e,t,n)}touchend(e,t,n){if(this._tapTime)this._swipePoint&&0===n.length&&this.reset();else{const i=this._tap.touchend(e,t,n);i&&(this._tapTime=e.timeStamp,this._tapPoint=i)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sr{constructor(e,t,n){this._el=e,this._mousePan=t,this._touchPan=n}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class lr{constructor(e,t,n){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class cr{constructor(e,t,n,i){this._el=e,this._touchZoom=t,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ur{constructor(e,t){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=o.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const n=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),i=document.createElement("div");i.className="maplibregl-desktop-message",i.textContent=t,this._container.appendChild(i);const r=document.createElement("div");r.className="maplibregl-mobile-message",r.textContent=n,this._container.appendChild(r),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(o.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(1===e.touches.length)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){this._enabled&&e&&(this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const hr=e=>e.zoom||e.drag||e.pitch||e.rotate;class dr extends t.k{}function pr(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class fr{constructor(e,t){this.handleWindowEvent=e=>{this.handleEvent(e,`${e.type}Window`)},this.handleEvent=(e,t)=>{if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===e.type?void 0:e,i={needsRenderFrame:!1},r={},a={},s=e.touches,l=s?this._getMapTouches(s):void 0,c=l?o.touchPos(this._map.getCanvas(),l):o.mousePos(this._map.getCanvas(),e);for(const{handlerName:o,handler:d,allowed:p}of this._handlers){if(!d.isEnabled())continue;let s;this._blockedByActive(a,p,o)?d.reset():d[t||e.type]&&(s=d[t||e.type](e,c,l),this.mergeHandlerResult(i,r,s,o,n),s&&s.needsRenderFrame&&this._triggerRenderFrame()),(s||d.isActive())&&(a[o]=d)}const u={};for(const o in this._previousActiveHandlers)a[o]||(u[o]=n);this._previousActiveHandlers=a,(Object.keys(u).length||pr(i))&&(this._changes.push([i,r,u]),this._triggerRenderFrame()),(Object.keys(a).length||pr(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=i;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Si(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[i,r,a]of this._listeners)o.addEventListener(i,r,i===document?this.handleWindowEvent:this.handleEvent,a)}destroy(){for(const[e,t,n]of this._listeners)o.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){const t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new Pi(t,e));const i=t.boxZoom=new zi(t,e);this._add("boxZoom",i),e.interactive&&e.boxZoom&&i.enable();const r=t.cooperativeGestures=new ur(t,e.cooperativeGestures);this._add("cooperativeGestures",r),e.cooperativeGestures&&r.enable();const a=new Fi(t),s=new ar(t);t.doubleClickZoom=new rr(s,a),this._add("tapZoom",a),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();const l=new or;this._add("tapDragZoom",l);const c=t.touchPitch=new Ji(t);this._add("touchPitch",c),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);const u=ji(e),h=$i(e);t.dragRotate=new lr(e,u,h),this._add("mouseRotate",u,["mousePitch"]),this._add("mousePitch",h,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();const d=(e=>{let{enable:t,clickTolerance:n}=e;const i=new Ni({checkCorrectEvent:e=>0===o.mouseButton(e)&&!e.ctrlKey});return new Oi({clickTolerance:n,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:i,enable:t,assignEvents:Ui})})(e),p=new Hi(e,t);t.dragPan=new sr(n,d,p),this._add("mousePan",d),this._add("touchPan",p,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);const f=new Xi,m=new Wi;t.touchZoomRotate=new cr(n,m,f,l),this._add("touchRotate",f,["touchPan","touchZoom"]),this._add("touchZoom",m,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);const g=t.scrollZoom=new ir(t,(()=>this._triggerRenderFrame()));this._add("scrollZoom",g,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);const y=t.keyboard=new er(t);this._add("keyboard",y),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new Ai(t))}_add(e,t,n){this._handlers.push({handlerName:e,handler:t,allowed:n}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(hr(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,n){for(const i in e)if(i!==n&&(!t||t.indexOf(i)<0))return!0;return!1}_getMapTouches(e){const t=[];for(const n of e)this._el.contains(n.target)&&t.push(n);return t}mergeHandlerResult(e,n,i,r,a){if(!i)return;t.e(e,i);const o={handlerName:r,originalEvent:i.originalEvent||a};void 0!==i.zoomDelta&&(n.zoom=o),void 0!==i.panDelta&&(n.drag=o),void 0!==i.pitchDelta&&(n.pitch=o),void 0!==i.bearingDelta&&(n.rotate=o)}_applyChanges(){const e={},n={},i={};for(const[r,a,o]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(e.around=r.around),void 0!==r.pinchAround&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),t.e(n,a),t.e(i,o);this._updateMapTransform(e,n,i),this._changes=[]}_updateMapTransform(e,t,n){const i=this._map,r=i._getTransformForUpdate(),a=i.terrain;if(!(pr(e)||a&&this._terrainMovement))return this._fireEvents(t,n,!0);let{panDelta:o,zoomDelta:s,bearingDelta:l,pitchDelta:c,around:u,pinchAround:h}=e;void 0!==h&&(u=h),i._stop(!0),u=u||i.transform.centerPoint;const d=r.pointLocation(o?u.sub(o):u);l&&(r.bearing+=l),c&&(r.pitch+=c),s&&(r.zoom+=s),a?this._terrainMovement||!t.drag&&!t.zoom?t.drag&&this._terrainMovement?r.center=r.pointLocation(r.centerPoint.sub(o)):r.setLocationAtPoint(d,u):(this._terrainMovement=!0,this._map._elevationFreeze=!0,r.setLocationAtPoint(d,u)):r.setLocationAtPoint(d,u),i._applyUpdatedTransform(r),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,n,!0)}_fireEvents(e,n,i){const r=hr(this._eventsInProgress),o=hr(e),s={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(s[`${t}start`]=n),this._eventsInProgress[t]=e[t]}!r&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in s)this._fireEvent(t,s[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const l={};let c;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:i}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],c=n[e]||i,l[`${t}end`]=c)}for(const t in l)this._fireEvent(t,l[t]);const u=hr(this._eventsInProgress),h=(r||o)&&!u;if(h&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),i&&h){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;!e||!e.essential&&a.prefersReducedMotion?(this._map.fire(new t.k("moveend",{originalEvent:c})),n(this._map.getBearing())&&this._map.resetNorth()):(n(e.bearing||this._map.getBearing())&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:c})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.k(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new dr("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class mr extends t.E{constructor(e,t){super(),this._renderFrameCallback=()=>{const e=Math.min((a.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new t.M(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(e,n,i){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.e({offset:e},n),i)}panTo(e,n,i){return this.easeTo(t.e({center:e},n),i)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,n,i){return this.easeTo(t.e({zoom:e},n),i)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,n,i){return this.easeTo(t.e({bearing:e},n),i)}resetNorth(e,n){return this.rotateTo(0,t.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.e({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=H.convert(e);const n=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),n,t)}_cameraForBoxAndBearing(e,n,i,r){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=t.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){const e=r.padding;r.padding={top:e,bottom:e,right:e,left:e}}r.padding=t.e(a,r.padding);const o=this.transform,s=o.padding,l=new H(e,n),c=o.project(l.getNorthWest()),u=o.project(l.getNorthEast()),h=o.project(l.getSouthEast()),d=o.project(l.getSouthWest()),p=t.b9(-i),f=c.rotate(p),m=u.rotate(p),g=h.rotate(p),y=d.rotate(p),_=new t.P(Math.max(f.x,m.x,y.x,g.x),Math.max(f.y,m.y,y.y,g.y)),v=new t.P(Math.min(f.x,m.x,y.x,g.x),Math.min(f.y,m.y,y.y,g.y)),x=_.sub(v),b=(o.width-(s.left+s.right+r.padding.left+r.padding.right))/x.x,w=(o.height-(s.top+s.bottom+r.padding.top+r.padding.bottom))/x.y;if(w<0||b<0)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const S=Math.min(o.scaleZoom(o.scale*Math.min(b,w)),r.maxZoom),T=t.P.convert(r.offset),C=new t.P((r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2).rotate(t.b9(i)),I=T.add(C).mult(o.scale/o.zoomScale(S));return{center:o.unproject(c.add(h).div(2).sub(I)),zoom:S,bearing:i}}fitBounds(e,t,n){return this._fitInternal(this.cameraForBounds(e,t),t,n)}fitScreenCoordinates(e,n,i,r,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.P.convert(e)),this.transform.pointLocation(t.P.convert(n)),i,r),r,a)}_fitInternal(e,n,i){return e?(delete(n=t.e(e,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}jumpTo(e,n){this.stop();const i=this._getTransformForUpdate();let r=!1,a=!1,o=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(r=!0,i.zoom=+e.zoom),void 0!==e.center&&(i.center=t.M.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(a=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(o=!0,i.pitch=+e.pitch),null==e.padding||i.isPaddingEqual(e.padding)||(i.padding=e.padding),this._applyUpdatedTransform(i),this.fire(new t.k("movestart",n)).fire(new t.k("move",n)),r&&this.fire(new t.k("zoomstart",n)).fire(new t.k("zoom",n)).fire(new t.k("zoomend",n)),a&&this.fire(new t.k("rotatestart",n)).fire(new t.k("rotate",n)).fire(new t.k("rotateend",n)),o&&this.fire(new t.k("pitchstart",n)).fire(new t.k("pitch",n)).fire(new t.k("pitchend",n)),this.fire(new t.k("moveend",n))}calculateCameraOptionsFromTo(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a=t.Y.fromLngLat(e,n),o=t.Y.fromLngLat(i,r),s=o.x-a.x,l=o.y-a.y,c=o.z-a.z,u=Math.hypot(s,l,c);if(0===u)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(s,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/u/this.transform.tileSize),p=180*Math.atan2(s,-l)/Math.PI;let f=180*Math.acos(h/u)/Math.PI;return f=c<0?90-f:90+f,{center:o.toLngLat(),zoom:d,pitch:f,bearing:p}}easeTo(e,n){var i;this._stop(!1,e.easeId),(!1===(e=t.e({offset:[0,0],duration:500,easing:t.b8},e)).animate||!e.essential&&a.prefersReducedMotion)&&(e.duration=0);const r=this._getTransformForUpdate(),o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="bearing"in e?this._normalizeBearing(e.bearing,s):s,h="pitch"in e?+e.pitch:l,d="padding"in e?e.padding:r.padding,p=t.P.convert(e.offset);let f=r.centerPoint.add(p);const m=r.pointLocation(f),{center:g,zoom:y}=r.getConstrained(t.M.convert(e.center||m),null!==(i=e.zoom)&&void 0!==i?i:o);this._normalizeCenter(g);const _=r.project(m),v=r.project(g).sub(_),x=r.zoomScale(y-o);let b,w;e.around&&(b=t.M.convert(e.around),w=r.locationPoint(b));const S={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||y!==o,this._rotating=this._rotating||s!==u,this._pitching=this._pitching||h!==l,this._padding=!r.isPaddingEqual(d),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,S),this.terrain&&this._prepareElevation(g),this._ease((i=>{if(this._zooming&&(r.zoom=t.z.number(o,y,i)),this._rotating&&(r.bearing=t.z.number(s,u,i)),this._pitching&&(r.pitch=t.z.number(l,h,i)),this._padding&&(r.interpolatePadding(c,d,i),f=r.centerPoint.add(p)),this.terrain&&!e.freezeElevation&&this._updateElevation(i),b)r.setLocationAtPoint(b,w);else{const e=r.zoomScale(r.zoom-o),t=y>o?Math.min(2,x):Math.max(.5,x),n=Math.pow(t,1-i),a=r.unproject(_.add(v.mult(i*n)).mult(e));r.setLocationAtPoint(r.renderWorldCopies?a.wrap():a,f)}this._applyUpdatedTransform(r),this._fireMoveEvents(n)}),(t=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,t)}),e),this}_prepareEase(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,n||i.moving||this.fire(new t.k("movestart",e)),this._zooming&&!i.zooming&&this.fire(new t.k("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new t.k("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new t.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const t=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(t-(n-(t*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.elevation=t.z.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;const t=e.clone(),{center:n,zoom:i,pitch:r,bearing:a,elevation:o}=this.transformCameraUpdate(t);n&&(t.center=n),void 0!==i&&(t.zoom=i),void 0!==r&&(t.pitch=r),void 0!==a&&(t.bearing=a),void 0!==o&&(t.elevation=o),this.transform.apply(t)}_fireMoveEvents(e){this.fire(new t.k("move",e)),this._zooming&&this.fire(new t.k("zoom",e)),this._rotating&&this.fire(new t.k("rotate",e)),this._pitching&&this.fire(new t.k("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const i=this._zooming,r=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new t.k("zoomend",e)),r&&this.fire(new t.k("rotateend",e)),a&&this.fire(new t.k("pitchend",e)),this.fire(new t.k("moveend",e))}flyTo(e,n){var i;if(!e.essential&&a.prefersReducedMotion){const i=t.L(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),e=t.e({offset:[0,0],speed:1.2,curve:1.42,easing:t.b8},e);const r=this._getTransformForUpdate(),o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="bearing"in e?this._normalizeBearing(e.bearing,s):s,h="pitch"in e?+e.pitch:l,d="padding"in e?e.padding:r.padding,p=t.P.convert(e.offset);let f=r.centerPoint.add(p);const m=r.pointLocation(f),{center:g,zoom:y}=r.getConstrained(t.M.convert(e.center||m),null!==(i=e.zoom)&&void 0!==i?i:o);this._normalizeCenter(g);const _=r.zoomScale(y-o),v=r.project(m),x=r.project(g).sub(v);let b=e.curve;const w=Math.max(r.width,r.height),S=w/_,T=x.mag();if("minZoom"in e){const n=t.ac(Math.min(e.minZoom,o,y),r.minZoom,r.maxZoom),i=w/r.zoomScale(n-o);b=Math.sqrt(i/T*2)}const C=b*b;function I(e){const t=(S*S-w*w+(e?-1:1)*C*C*T*T)/(2*(e?S:w)*C*T);return Math.log(Math.sqrt(t*t+1)-t)}function k(e){return(Math.exp(e)-Math.exp(-e))/2}function E(e){return(Math.exp(e)+Math.exp(-e))/2}const P=I(!1);let A=function(e){return E(P)/E(P+b*e)},M=function(e){return w*((E(P)*(k(t=P+b*e)/E(t))-k(P))/C)/T;var t},z=(I(!0)-P)/b;if(Math.abs(T)<1e-6||!isFinite(z)){if(Math.abs(w-S)<1e-6)return this.easeTo(e,n);const t=S<w?-1:1;z=Math.abs(Math.log(S/w))/b,M=()=>0,A=e=>Math.exp(t*b*e)}return e.duration="duration"in e?+e.duration:1e3*z/("screenSpeed"in e?+e.screenSpeed/b:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==u,this._pitching=h!==l,this._padding=!r.isPaddingEqual(d),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(g),this._ease((i=>{const a=i*z,m=1/A(a);r.zoom=1===i?y:o+r.scaleZoom(m),this._rotating&&(r.bearing=t.z.number(s,u,i)),this._pitching&&(r.pitch=t.z.number(l,h,i)),this._padding&&(r.interpolatePadding(c,d,i),f=r.centerPoint.add(p)),this.terrain&&!e.freezeElevation&&this._updateElevation(i);const _=1===i?g:r.unproject(v.add(x.mult(M(a))).mult(m));r.setLocationAtPoint(r.renderWorldCopies?_.wrap():_,f),this._applyUpdatedTransform(r),this._fireMoveEvents(n)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){var n;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}return e||null===(n=this.handlers)||void 0===n||n.stop(!1),this}_ease(e,t,n){!1===n.animate||0===n.duration?(e(1),t()):(this._easeStart=a.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=t.b2(e,-180,180);const i=Math.abs(e-n);return Math.abs(e-360-n)<i&&(e-=360),Math.abs(e+360-n)<i&&(e+=360),e}_normalizeCenter(e){const t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;const n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(t.M.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const gr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class yr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gr;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=o.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=o.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const n=this._map._getUIString(`AttributionControl.${t}`);e.title=n,e.setAttribute("aria-label",n)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((e=>"string"!=typeof e?"":e))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style.sourceCaches;for(const i in t){const n=t[i];if(n.used||n.usedForTerrain){const t=n.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e=e.filter((e=>String(e).trim())),e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,n)=>{for(let i=n+1;i<e.length;i++)if(e[i].indexOf(t)>=0)return!1;return!0}));const n=e.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,e.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class _r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._updateCompact=()=>{const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact"):t.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=o.create("div","maplibregl-ctrl");const t=o.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class vr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,n=t?this._queue.concat(t):this._queue;for(const i of n)if(i.id===e)return void(i.cancelled=!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const t=this._currentlyRunning=this._queue;this._queue=[];for(const n of t)if(!n.cancelled&&(n.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var xr=t.X([{name:"a_pos3d",type:"Int16",components:3}]);class br extends t.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const i={};for(const r of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n}))i[r.key]=!0,this._renderableTilesKeys.push(r.key),this._tiles[r.key]||(r.posMatrix=new Float64Array(16),t.aO(r.posMatrix,0,t.W,0,t.W,0,1),this._tiles[r.key]=new oe(r,this.tileSize));for(const t in this._tiles)i[t]||delete this._tiles[t]}freeRtt(e){for(const t in this._tiles){const n=this._tiles[t];(!e||n.tileID.equals(e)||n.tileID.isChildOf(e)||e.isChildOf(n.tileID))&&(n.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const n={};for(const i of this._renderableTilesKeys){const r=this._tiles[i].tileID;if(r.canonical.equals(e.canonical)){const r=e.clone();r.posMatrix=new Float64Array(16),t.aO(r.posMatrix,0,t.W,0,t.W,0,1),n[i]=r}else if(r.canonical.isChildOf(e.canonical)){const a=e.clone();a.posMatrix=new Float64Array(16);const o=r.canonical.z-e.canonical.z,s=r.canonical.x-(r.canonical.x>>o<<o),l=r.canonical.y-(r.canonical.y>>o<<o),c=t.W>>o;t.aO(a.posMatrix,0,c,0,c,0,1),t.H(a.posMatrix,a.posMatrix,[-s*c,-l*c,0]),n[i]=a}else if(e.canonical.isChildOf(r.canonical)){const a=e.clone();a.posMatrix=new Float64Array(16);const o=e.canonical.z-r.canonical.z,s=e.canonical.x-(e.canonical.x>>o<<o),l=e.canonical.y-(e.canonical.y>>o<<o),c=t.W>>o;t.aO(a.posMatrix,0,t.W,0,t.W,0,1),t.H(a.posMatrix,a.posMatrix,[s*c,l*c,0]),t.J(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),n[i]=a}}return n}getSourceTile(e,t){const n=this.sourceCache._source;let i=e.overscaledZ-this.deltaZoom;if(i>n.maxzoom&&(i=n.maxzoom),i<n.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(i).key);let r=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!r||!r.dem)&&t)for(;i>=n.minzoom&&(!r||!r.dem);)r=this.sourceCache.getTileByID(e.scaledTo(i--).key);return r}tilesAfterTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return Object.values(this._tiles).filter((t=>t.timeAdded>=e))}}class wr{constructor(e,t,n){this.painter=e,this.sourceCache=new br(t),this.options=n,this.exaggeration="number"==typeof n.exaggeration?n.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.W;var a;if(!(n>=0&&n<r&&i>=0&&i<r))return 0;const o=this.getTerrainData(e),s=null===(a=o.tile)||void 0===a?void 0:a.dem;if(!s)return 0;const l=function(e,t,n){var i=t[0],r=t[1];return e[0]=n[0]*i+n[4]*r+n[12],e[1]=n[1]*i+n[5]*r+n[13],e}([],[n/r*t.W,i/r*t.W],o.u_terrain_matrix),c=[l[0]*s.dim,l[1]*s.dim],u=Math.floor(c[0]),h=Math.floor(c[1]),d=c[0]-u,p=c[1]-h;return s.get(u,h)*(1-d)*(1-p)+s.get(u+1,h)*d*(1-p)+s.get(u,h+1)*(1-d)*p+s.get(u+1,h+1)*d*p}getElevationForLngLatZoom(e,n){const{tileID:i,mercatorX:r,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(i,r%t.W,a%t.W,t.W)}getElevation(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.W;return this.getDEMElevation(e,n,i,r)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const e=this.painter.context,n=new t.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new b(e,n,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new b(e,new t.R({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.an([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const e=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new b(e,n.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),n.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const i=n&&n+n.tileID.key+e.key;if(i&&!this._demMatrixCache[i]){const i=this.sourceCache.sourceCache._source.maxzoom;let r=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=i?r=e.canonical.z-i:t.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=e.canonical.x-(e.canonical.x>>r<<r),o=e.canonical.y-(e.canonical.y>>r<<r),s=t.ba(new Float64Array(16),[1/(t.W<<r),1/(t.W<<r),0]);t.H(s,s,[a*t.W,o*t.W,0]),this._demMatrixCache[e.key]={matrix:s,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const t=this.painter,n=t.width/devicePixelRatio,i=t.height/devicePixelRatio;return!this._fbo||this._fbo.width===n&&this._fbo.height===i||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new b(t.context,{width:n,height:i,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new b(t.context,{width:n,height:i,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(n,i,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,n,i))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,a=0;t<this._coordsTextureSize;t++)for(let e=0;e<this._coordsTextureSize;e++,a+=4)n[a+0]=255&e,n[a+1]=255&t,n[a+2]=e>>8<<4|t>>8,n[a+3]=0;const i=new t.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),r=new b(e,i,e.gl.RGBA,{premultiply:!1});return r.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=r,r}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),i=this.painter.context,r=i.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),r.readPixels(a,s-o-1,1,1,r.RGBA,r.UNSIGNED_BYTE,n),i.bindFramebuffer.set(null);const l=n[0]+(n[2]>>4<<8),c=n[1]+((15&n[2])<<8),u=this.coordsIndex[255-n[3]],h=u&&this.sourceCache.getTileByID(u);if(!h)return null;const d=this._coordsTextureSize,p=(1<<h.tileID.canonical.z)*d;return new t.Y((h.tileID.canonical.x*d+l)/p+h.tileID.wrap,(h.tileID.canonical.y*d+c)/p,this.getElevation(h.tileID,l,c,d))}depthAtPoint(e){const t=new Uint8Array(4),n=this.painter.context,i=n.gl;return n.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),i.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,i.RGBA,i.UNSIGNED_BYTE,t),n.bindFramebuffer.set(null),(t[0]/16777216+t[1]/65536+t[2]/256+t[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,n=new t.bb,i=new t.aY,r=this.meshSize,a=t.W/r,o=r*r;for(let t=0;t<=r;t++)for(let e=0;e<=r;e++)n.emplaceBack(e*a,t*a,0);for(let t=0;t<o;t+=r+1)for(let e=0;e<r;e++)i.emplaceBack(e+t,r+e+t+1,r+e+t+2),i.emplaceBack(e+t,r+e+t+2,e+t+1);const s=n.length,l=s+2*(r+1);for(const h of[0,1])for(let e=0;e<=r;e++)for(const i of[0,1])n.emplaceBack(e*a,h*t.W,i);for(let t=0;t<2*r;t+=2)i.emplaceBack(l+t,l+t+1,l+t+3),i.emplaceBack(l+t,l+t+3,l+t+2),i.emplaceBack(s+t,s+t+3,s+t+1),i.emplaceBack(s+t,s+t+2,s+t+3);const c=n.length,u=c+2*(r+1);for(const h of[0,1])for(let e=0;e<=r;e++)for(const i of[0,1])n.emplaceBack(h*t.W,e*a,i);for(let t=0;t<2*r;t+=2)i.emplaceBack(c+t,c+t+1,c+t+3),i.emplaceBack(c+t,c+t+3,c+t+2),i.emplaceBack(u+t,u+t+3,u+t+1),i.emplaceBack(u+t,u+t+2,u+t+3);return this._mesh={indexBuffer:e.createIndexBuffer(i),vertexBuffer:e.createVertexBuffer(n,xr.members),segments:t.$.simpleSegment(0,0,n.length,i.length)},this._mesh}getMeshFrameDelta(e){return 2*Math.PI*t.bc/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,t){var n;const{tileID:i}=this._getOverscaledTileIDFromLngLatZoom(e,t);return null!==(n=this.getMinMaxElevation(i).minElevation)&&void 0!==n?n:0}getMinMaxElevation(e){const t=this.getTerrainData(e).tile,n={minElevation:null,maxElevation:null};return t&&t.dem&&(n.minElevation=t.dem.min*this.exaggeration,n.maxElevation=t.dem.max*this.exaggeration),n}_getOverscaledTileIDFromLngLatZoom(e,n){const i=t.Y.fromLngLat(e.wrap()),r=(1<<n)*t.W,a=i.x*r,o=i.y*r,s=Math.floor(a/t.W),l=Math.floor(o/t.W);return{tileID:new t.Q(n,0,n,s,l),mercatorX:a,mercatorY:o}}}class Sr{constructor(e,t,n){this._context=e,this._size=t,this._tileSize=n,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),n=new b(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return n.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(n.texture),{id:e,fbo:t,texture:n,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((t=>e.id!==t)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((e=>!e.inUse))}}const Tr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Cr{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new Sr(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((n=>!e._layers[n].isHidden(t))),this._coordsDescendingInv={};for(const n in e.sourceCaches){this._coordsDescendingInv[n]={};const t=e.sourceCaches[n].getVisibleCoordinates();for(const e of t){const t=this.terrain.sourceCache.getTerrainCoords(e);for(const e in t)this._coordsDescendingInv[n][e]||(this._coordsDescendingInv[n][e]=[]),this._coordsDescendingInv[n][e].push(t[e])}}this._coordsDescendingInvStr={};for(const n of e._order){const t=e._layers[n],i=t.source;if(Tr[t.type]&&!this._coordsDescendingInvStr[i]){this._coordsDescendingInvStr[i]={};for(const e in this._coordsDescendingInv[i])this._coordsDescendingInvStr[i][e]=this._coordsDescendingInv[i][e].map((e=>e.key)).sort().join()}}for(const n of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const t=this._coordsDescendingInvStr[e][n.tileID.key];t&&t!==n.rttCoords[e]&&(n.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const n=e.type,i=this.painter,r=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Tr[n]&&(this._prevType&&Tr[this._prevType]||this._stacks.push([]),this._prevType=n,this._stacks[this._stacks.length-1].push(e.id),!r))return!0;if(Tr[this._prevType]||Tr[n]&&r){this._prevType=n;const e=this._stacks.length-1,r=this._stacks[e]||[];for(const n of this._renderableTiles){if(this.pool.isFull()&&(ci(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(n),n.rtt[e]){const t=this.pool.getObjectForId(n.rtt[e].id);if(t.stamp===n.rtt[e].stamp){this.pool.useObject(t);continue}}const a=this.pool.getOrCreateFreeObject();this.pool.useObject(a),this.pool.stampObject(a),n.rtt[e]={id:a.id,stamp:a.stamp},i.context.bindFramebuffer.set(a.fbo.framebuffer),i.context.clear({color:t.aP.transparent,stencil:0}),i.currentStencilSource=void 0;for(let e=0;e<r.length;e++){const t=i.style._layers[r[e]],o=t.source?this._coordsDescendingInv[t.source][n.tileID.key]:[n.tileID];i.context.viewport.set([0,0,a.fbo.width,a.fbo.height]),i._renderTileClippingMasks(t,o),i.renderLayer(i,i.style.sourceCaches[t.source],t,o),t.source&&(n.rttCoords[t.source]=this._coordsDescendingInvStr[t.source][n.tileID.key])}}return ci(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Tr[n]}return!1}}const Ir={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},kr=n,Er={hash:!1,interactive:!0,bearingSnap:7,attributionControl:gr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Pr=e=>{e.touchstart=e.dragStart,e.touchmoveWindow=e.dragMove,e.touchend=e.dragEnd},Ar={showCompass:!0,showZoom:!0,visualizePitch:!1};class Mr{constructor(e,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.mousedown=e=>{this.startMouse(t.e({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),o.mousePos(this.element,e)),o.addEventListener(window,"mousemove",this.mousemove),o.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.moveMouse(e,o.mousePos(this.element,e))},this.mouseup=e=>{this.mouseRotate.dragEnd(e),this.mousePitch&&this.mousePitch.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,e.targetTouches)[0],this.startTouch(e,this._startPos),o.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,e.targetTouches)[0],this.moveTouch(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const r=e.dragRotate._mouseRotate.getClickTolerance(),a=e.dragRotate._mousePitch.getClickTolerance();this.element=n,this.mouseRotate=ji({clickTolerance:r,enable:!0}),this.touchRotate=(e=>{let{enable:t,clickTolerance:n,bearingDegreesPerPixelMoved:i=.8}=e;const r=new Vi;return new Oi({clickTolerance:n,move:(e,t)=>({bearingDelta:(t.x-e.x)*i}),moveStateManager:r,enable:t,assignEvents:Pr})})({clickTolerance:r,enable:!0}),this.map=e,i&&(this.mousePitch=$i({clickTolerance:a,enable:!0}),this.touchPitch=(e=>{let{enable:t,clickTolerance:n,pitchDegreesPerPixelMoved:i=-.5}=e;const r=new Vi;return new Oi({clickTolerance:n,move:(e,t)=>({pitchDelta:(t.y-e.y)*i}),moveStateManager:r,enable:t,assignEvents:Pr})})({clickTolerance:a,enable:!0})),o.addEventListener(n,"mousedown",this.mousedown),o.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(n,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),o.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),o.disableDrag()}moveMouse(e,t){const n=this.map,{bearingDelta:i}=this.mouseRotate.dragMove(e,t)||{};if(i&&n.setBearing(n.getBearing()+i),this.mousePitch){const{pitchDelta:i}=this.mousePitch.dragMove(e,t)||{};i&&n.setPitch(n.getPitch()+i)}}moveTouch(e,t){const n=this.map,{bearingDelta:i}=this.touchRotate.dragMove(e,t)||{};if(i&&n.setBearing(n.getBearing()+i),this.touchPitch){const{pitchDelta:i}=this.touchPitch.dragMove(e,t)||{};i&&n.setPitch(n.getPitch()+i)}}off(){const e=this.element;o.removeEventListener(e,"mousedown",this.mousedown),o.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend),o.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(window,"mousemove",this.mousemove),o.removeEventListener(window,"mouseup",this.mouseup),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend)}}let zr;function Lr(e,n,i){const r=new t.M(e.lng,e.lat);if(e=new t.M(e.lng,e.lat),n){const r=new t.M(e.lng-360,e.lat),a=new t.M(e.lng+360,e.lat),o=i.locationPoint(e).distSqr(n);i.locationPoint(r).distSqr(n)<o?e=r:i.locationPoint(a).distSqr(n)<o&&(e=a)}for(;Math.abs(e.lng-i.center.lng)>180;){const t=i.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=i.width&&t.y<=i.height)break;e.lng>i.center.lng?e.lng-=360:e.lng+=360}return e.lng!==r.lng&&i.locationPoint(e).y>i.height/2-i.getHorizon()?e:r}const Dr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Rr(e,t,n){const i=e.classList;for(const r in Dr)i.remove(`maplibregl-${n}-anchor-${r}`);i.add(`maplibregl-${n}-anchor-${t}`)}class Fr extends t.E{constructor(e){if(super(),this._onKeyPress=e=>{const t=e.code,n=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==n&&13!==n||this.togglePopup()},this._onMapClick=e=>{const t=e.originalEvent.target,n=this._element;this._popup&&(t===n||n.contains(t))&&this.togglePopup()},this._update=e=>{var t;if(!this._map)return;const n=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==e?void 0:e.type)||"render"===(null==e?void 0:e.type)&&!n)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Lr(this._lngLat,this._flatPos,this._map.transform):null===(t=this._lngLat)||void 0===t?void 0:t.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let i="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?i=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(i=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r=`rotateX(${this._map.getPitch()}deg)`),e&&"moveend"!==e.type||(this._pos=this._pos.round()),o.setTransform(this._element,`${Dr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${r} ${i}`),a.frameAsync(new AbortController).then((()=>{this._updateOpacity(e&&"moveend"===e.type)})).catch((()=>{}))},this._onMove=e=>{if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.k("dragstart"))),this.fire(new t.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.k("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(null==e?void 0:e.opacity,null==e?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div");const n=o.createNS("http://www.w3.org/2000/svg","svg"),i=41,r=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${i}px`),n.setAttributeNS(null,"width",`${r}px`),n.setAttributeNS(null,"viewBox",`0 0 ${r} ${i}`);const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const e of c){const t=o.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),l.appendChild(t)}const u=o.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);const h=o.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);const d=o.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=o.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const f=o.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=o.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=o.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=o.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),s.appendChild(l),s.appendChild(u),s.appendChild(d),s.appendChild(f),s.appendChild(m),n.appendChild(s),n.setAttributeNS(null,"height",i*this._scale+"px"),n.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(n),this._offset=t.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()})),Rr(this._element,this._anchor,"marker"),e&&e.className)for(const t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.M.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,n=13.5,i=Math.abs(n)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[i,-1*(t-n+i)],"bottom-right":[-i,-1*(t-n+i)],left:[n,-1*(t-n)],right:[-n,-1*(t-n)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var n,i;if(!(null===(n=this._map)||void 0===n?void 0:n.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const r=this._map,a=r.terrain.depthAtPoint(this._pos),o=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom);if(r.transform.lngLatToCameraDepth(this._lngLat,o)-a<.006)return void(this._element.style.opacity=this._opacity);const s=-this._offset.y/r.transform._pixelPerMeter,l=Math.sin(r.getPitch()*Math.PI/180)*s,c=r.terrain.depthAtPoint(new t.P(this._pos.x,this._pos.y-this._offset.y)),u=r.transform.lngLatToCameraDepth(this._lngLat,o+l)-c>.006;(null===(i=this._popup)||void 0===i?void 0:i.isOpen())&&u&&this._popup.remove(),this._element.style.opacity=u?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return void 0===e&&void 0===t&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==e&&(this._opacity=e),void 0!==t&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}}const Or={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Br=0,Nr=!1;const Vr={maxWidth:100,unit:"metric"};function Ur(e,t,n){const i=n&&n.maxWidth||100,r=e._container.clientHeight/2,a=e.unproject([0,r]),o=e.unproject([i,r]),s=a.distanceTo(o);if(n&&"imperial"===n.unit){const n=3.2808*s;n>5280?jr(t,i,n/5280,e._getUIString("ScaleControl.Miles")):jr(t,i,n,e._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?jr(t,i,s/1852,e._getUIString("ScaleControl.NauticalMiles")):s>=1e3?jr(t,i,s/1e3,e._getUIString("ScaleControl.Kilometers")):jr(t,i,s,e._getUIString("ScaleControl.Meters"))}function jr(e,t,n,i){const r=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let n=e/t;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(n),t*n}(n);e.style.width=t*(r/n)+"px",e.innerHTML=`${r}&nbsp;${i}`}const $r={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Hr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qr(e){if(e){if("number"==typeof e){const n=Math.round(Math.abs(e)/Math.SQRT2);return{center:new t.P(0,0),top:new t.P(0,e),"top-left":new t.P(n,n),"top-right":new t.P(-n,n),bottom:new t.P(0,-e),"bottom-left":new t.P(n,-n),"bottom-right":new t.P(-n,-n),left:new t.P(e,0),right:new t.P(-e,0)}}if(e instanceof t.P||Array.isArray(e)){const n=t.P.convert(e);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:t.P.convert(e.center||[0,0]),top:t.P.convert(e.top||[0,0]),"top-left":t.P.convert(e["top-left"]||[0,0]),"top-right":t.P.convert(e["top-right"]||[0,0]),bottom:t.P.convert(e.bottom||[0,0]),"bottom-left":t.P.convert(e["bottom-left"]||[0,0]),"bottom-right":t.P.convert(e["bottom-right"]||[0,0]),left:t.P.convert(e.left||[0,0]),right:t.P.convert(e.right||[0,0])}}return qr(new t.P(0,0))}const Zr=n;e.AJAXError=t.bf,e.Evented=t.E,e.LngLat=t.M,e.MercatorCoordinate=t.Y,e.Point=t.P,e.addProtocol=t.bg,e.config=t.a,e.removeProtocol=t.bh,e.AttributionControl=yr,e.BoxZoomHandler=zi,e.CanvasSource=Q,e.CooperativeGesturesHandler=ur,e.DoubleClickZoomHandler=rr,e.DragPanHandler=sr,e.DragRotateHandler=lr,e.EdgeInsets=pi,e.FullscreenControl=class extends t.E{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._onFullscreenChange=()=>{var e;let t=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(e=null==t?void 0:t.shadowRoot)||void 0===e?void 0:e.fullscreenElement;)t=t.shadowRoot.fullscreenElement;t===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const e=this._fullscreenButton=o.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);o.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new t.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=K,e.GeolocateControl=class extends t.E{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new t.M(e.coords.longitude,e.coords.latitude),i=e.coords.accuracy,r=this._map.getBearing(),a=t.e({bearing:r},this.options.fitBoundsOptions),o=H.fromLngLat(n,i);this._map.fitBounds(o,a,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new t.M(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Nr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=e=>{if(this._map){if(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=o.create("button","maplibregl-ctrl-geolocate",this._container),o.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Fr({element:this._dotElement}),this._circleElement=o.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Fr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.k("trackuserlocationend")),this.fire(new t.k("userlocationlostfocus")))}))}},this.options=t.e({},Or,e)}onAdd(e){return this._map=e,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return t._(this,arguments,void 0,(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function*(){if(void 0!==zr&&!e)return zr;if(void 0===window.navigator.permissions)return zr=!!window.navigator.geolocation,zr;try{const e=yield window.navigator.permissions.query({name:"geolocation"});zr="denied"!==e.state}catch(e){zr=!!window.navigator.geolocation}return zr}()}))}().then((e=>this._setupUI(e))),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Br=0,Nr=!1}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),n=e.coords;return t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const e=this._map.getBounds(),t=e.getSouthEast(),n=e.getNorthEast(),i=t.distanceTo(n),r=Math.ceil(this._accuracy/(i/this._map._container.clientHeight)*2);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Br--,Nr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.k("trackuserlocationstart")),this.fire(new t.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Br++,Br>1?(e={maximumAge:6e5,timeout:0},Nr=!0):(e=this.options.positionOptions,Nr=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.Hash=yi,e.ImageSource=Y,e.KeyboardHandler=er,e.LngLatBounds=H,e.LogoControl=_r,e.Map=class extends mr{constructor(e){t.bd.mark(t.be.create);const n=Object.assign(Object.assign({},Er),e);if(null!=n.minZoom&&null!=n.maxZoom&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=n.minPitch&&null!=n.maxPitch&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=n.minPitch&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=n.maxPitch&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new mi(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),{bearingSnap:n.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new vr,this._controls=[],this._mapId=t.a3(),this._contextLost=e=>{e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new t.k("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._setupPainter(),this.resize(),this._update(),this.fire(new t.k("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._maxTileCacheZoomLevels=n.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=!0===n.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=!0===n.preserveDrawingBuffer,this._antialias=!0===n.antialias,this._trackResize=!0===n.trackResize,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=!0===n.refreshExpiredTiles,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=!0===n.crossSourceCollisions,this._collectResourceTiming=!0===n.collectResourceTiming,this._locale=Object.assign(Object.assign({},Ir),n.locale),this._clickTolerance=n.clickTolerance,this._overridePixelRatio=n.pixelRatio,this._maxCanvasSize=n.maxCanvasSize,this.transformCameraUpdate=n.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===n.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=p.addThrottleControl((()=>this.isMoving())),this._requestManager=new f(n.transformRequest),"string"==typeof n.container){if(this._container=document.getElementById(n.container),!this._container)throw new Error(`Container '${n.container}' not found.`)}else{if(!(n.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let e=!1;const t=gi((e=>{this._trackResize&&!this._removed&&this.resize(e)._update()}),50);this._resizeObserver=new ResizeObserver((n=>{e?t(n):e=!0})),this._resizeObserver.observe(this._container)}this.handlers=new fr(this,n),this._hash=n.hash&&new yi("string"==typeof n.hash&&n.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,t.e({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,this._validateStyle=n.validateStyle,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new yr("boolean"==typeof n.attributionControl?void 0:n.attributionControl)),n.maplibreLogo&&this.addControl(new _r,n.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.k(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.k(`${e.dataType}dataloading`,e))})),this.on("dataabort",(e=>{this.fire(new t.k("sourcedataabort",e))}))}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=e.onAdd(this);this._controls.push(e);const r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,n,i){return null==i&&this.terrain&&(i=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,n,i)}resize(e){var n;const i=this._containerDimensions(),r=i[0],a=i[1],o=this._getClampedPixelRatio(r,a);if(this._resizeCanvas(r,a,o),this.painter.resize(r,a,o),this.painter.overLimit()){const e=this.painter.context.gl;this._maxCanvasSize=[e.drawingBufferWidth,e.drawingBufferHeight];const t=this._getClampedPixelRatio(r,a);this._resizeCanvas(r,a,t),this.painter.resize(r,a,t)}this.transform.resize(r,a),null===(n=this._requestedCameraState)||void 0===n||n.resize(r,a);const s=!this._moving;return s&&(this.stop(),this.fire(new t.k("movestart",e)).fire(new t.k("move",e))),this.fire(new t.k("resize",e)),s&&this.fire(new t.k("moveend",e)),this}_getClampedPixelRatio(e,t){const{0:n,1:i}=this._maxCanvasSize,r=this.getPixelRatio(),a=e*r,o=t*r;return Math.min(a>n?n/a:1,o>i?i/o:1)*r}getPixelRatio(){var e;return null!==(e=this._overridePixelRatio)&&void 0!==e?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(H.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(t.M.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(t.P.convert(e),this.terrain)}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating())}_createDelegatedListener(e,t,n){if("mouseenter"===e||"mouseover"===e){let i=!1;const r=r=>{const a=this.getLayer(t)?this.queryRenderedFeatures(r.point,{layers:[t]}):[];a.length?i||(i=!0,n.call(this,new Ii(e,this,r.originalEvent,{features:a}))):i=!1};return{layer:t,listener:n,delegates:{mousemove:r,mouseout:()=>{i=!1}}}}if("mouseleave"===e||"mouseout"===e){let i=!1;const r=r=>{(this.getLayer(t)?this.queryRenderedFeatures(r.point,{layers:[t]}):[]).length?i=!0:i&&(i=!1,n.call(this,new Ii(e,this,r.originalEvent)))},a=t=>{i&&(i=!1,n.call(this,new Ii(e,this,t.originalEvent)))};return{layer:t,listener:n,delegates:{mousemove:r,mouseout:a}}}{const i=e=>{const i=this.getLayer(t)?this.queryRenderedFeatures(e.point,{layers:[t]}):[];i.length&&(e.features=i,n.call(this,e),delete e.features)};return{layer:t,listener:n,delegates:{[e]:i}}}}on(e,t,n){if(void 0===n)return super.on(e,t);const i=this._createDelegatedListener(e,t,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(i);for(const r in i.delegates)this.on(r,i.delegates[r]);return this}once(e,t,n){if(void 0===n)return super.once(e,t);const i=this._createDelegatedListener(e,t,n);for(const r in i.delegates)this.once(r,i.delegates[r]);return this}off(e,t,n){return void 0===n?super.off(e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&(()=>{const i=this._delegatedListeners[e];for(let e=0;e<i.length;e++){const r=i[e];if(r.layer===t&&r.listener===n){for(const e in r.delegates)this.off(e,r.delegates[e]);return i.splice(e,1),this}}})(),this)}queryRenderedFeatures(e,n){if(!this.style)return[];let i;const r=e instanceof t.P||Array.isArray(e),a=r?e:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(r?{}:e)||{},a instanceof t.P||"number"==typeof a[0])i=[t.P.convert(a)];else{const e=t.P.convert(a[0]),n=t.P.convert(a[1]);i=[e,new t.P(n.x,e.y),n,new t.P(e.x,n.y),e]}return this.style.queryRenderedFeatures(i,n,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,n){return!1!==(n=t.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(e,t)));const n=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new ct(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,n):this.style.loadJSON(e,t,n),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ct(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const i=this._requestManager.transformRequest(e,"Style");t.h(i,new AbortController).then((e=>{this._updateDiff(e.data,n)})).catch((e=>{e&&this.fire(new t.j(e))}))}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e,n)&&this._update(!0)}catch(i){t.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.w("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){const n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.j(new Error(`There is no source with ID '${e}'`)))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){const n=this.style.sourceCaches[e.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);null===this.terrain&&n.reload();for(const i in this.style._layers){const n=this.style._layers[i];"hillshade"===n.type&&n.source===e.source&&t.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new wr(this.painter,n,e),this.painter.renderToTexture=new Cr(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=t=>{"style"===t.dataType?this.terrain.sourceCache.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new t.k("terrain",{terrain:e})),this}getTerrain(){var e,t;return null!==(t=null===(e=this.terrain)||void 0===e?void 0:e.options)&&void 0!==t?t:null}areTilesLoaded(){const e=this.style&&this.style.sourceCaches;for(const t in e){const n=e[t]._tiles;for(const e in n){const t=n[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{pixelRatio:r=1,sdf:o=!1,stretchX:s,stretchY:l,content:c,textFitWidth:u,textFitHeight:h}=i;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||t.b(n))){if(void 0===n.width||void 0===n.height)return this.fire(new t.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:i,height:a,data:d}=n,p=n;return this.style.addImage(e,{data:new t.R({width:i,height:a},new Uint8Array(d)),pixelRatio:r,stretchX:s,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:o,version:0,userImage:p}),p.onAdd&&p.onAdd(this,e),this}}{const{width:i,height:d,data:p}=a.getImageData(n);this.style.addImage(e,{data:new t.R({width:i,height:d},p),pixelRatio:r,stretchX:s,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:o,version:0})}}updateImage(e,n){const i=this.style.getImage(e);if(!i)return this.fire(new t.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=n instanceof HTMLImageElement||t.b(n)?a.getImageData(n):n,{width:o,height:s,data:l}=r;if(void 0===o||void 0===s)return this.fire(new t.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==i.data.width||s!==i.data.height)return this.fire(new t.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const c=!(n instanceof HTMLImageElement||t.b(n));return i.data.replace(l,c),this.style.updateImage(e,i),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.j(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return p.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,n){return this.style.setLayerZoomRange(e,t,n),this._update(!0)}setFilter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,n),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,n,i),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,n,i),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,n,(e=>{e||this._update(!0)})),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,(e=>{e||this._update(!0)})),this}setLight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){const e=this._container;e.classList.add("maplibregl-map");const t=this._canvasContainer=o.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=o.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),i=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],i);const r=this._controlContainer=o.create("div","maplibregl-control-container",e),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{a[e]=o.create("div",`maplibregl-ctrl-${e} `,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t,n){this._canvas.width=Math.floor(n*e),this._canvas.height=Math.floor(n*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",(n=>{t={requestedAttributes:e},n&&(t.statusMessage=n.statusMessage,t.type=n.type)}),{once:!0});const n=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!n){const e="Failed to initialize WebGL";throw t?(t.message=e,new Error(JSON.stringify(t))):new Error(e)}this.painter=new ui(n,this.transform),s.testSupport(n)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,r=a.now();this.style.zoomHistory.update(e,r);const o=new t.a8(e,{now:r,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),s=o.crossFadingFactor();1===s&&s===this._crossFadingFactor||(i=!0,this._crossFadingFactor=s),this.style.update(o)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new t.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.bd.mark(t.be.load),this.fire(new t.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,t.bd.mark(t.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),p.removeThrottleControl(this._imageQueueHandle),null===(e=this._resizeObserver)||void 0===e||e.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==n?void 0:n.loseContext)&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),o.remove(this._canvasContainer),o.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),t.bd.clearMetrics(),this._removed=!0,this.fire(new t.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((e=>{t.bd.frame(e),this._frameRequest=null,this._render(e)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return kr}getCameraTargetElevation(){return this.transform.elevation}},e.MapMouseEvent=Ii,e.MapTouchEvent=ki,e.MapWheelEvent=Ei,e.Marker=Fr,e.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{const e=this._map.getZoom(),t=e===this._map.getMaxZoom(),n=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,t)=>{const n=this._map._getUIString(`NavigationControl.${t}`);e.title=n,e.setAttribute("aria-label",n)},this.options=t.e({},Ar,e),this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),o.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),o.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=o.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){const n=o.create("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}},e.Popup=class extends t.E{constructor(e){super(),this.remove=()=>(this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new t.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var t;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=o.create("div","maplibregl-popup",this._map.getContainer()),this._tip=o.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const e of this.options.className.split(" "))this._container.classList.add(e);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Lr(this._lngLat,this._flatPos,this._map.transform):null===(t=this._lngLat)||void 0===t?void 0:t.wrap(),this._trackPointer&&!e)return;const n=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let i=this.options.anchor;const r=qr(this.options.offset);if(!i){const e=this._container.offsetWidth,t=this._container.offsetHeight;let a;a=n.y+r.bottom.y<t?["top"]:n.y>this._map.transform.height-t?["bottom"]:[],n.x<e/2?a.push("left"):n.x>this._map.transform.width-e/2&&a.push("right"),i=0===a.length?"bottom":a.join("-")}let a=n.add(r[i]);this.options.subpixelPositioning||(a=a.round()),o.setTransform(this._container,`${Dr[i]} translate(${a.x}px,${a.y}px)`),Rr(this._container,i,"popup")},this._onClose=()=>{this.remove()},this.options=t.e(Object.create($r),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.M.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),n=document.createElement("body");let i;for(n.innerHTML=e;i=n.firstChild,i;)t.appendChild(i);return this.setDOMContent(t)}getMaxWidth(){var e;return null===(e=this._container)||void 0===e?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){return this._container&&this._container.classList.add(e),this}removeClassName(e){return this._container&&this._container.classList.remove(e),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(Hr);e&&e.focus()}},e.RasterDEMTileSource=W,e.RasterTileSource=G,e.ScaleControl=class{constructor(e){this._onMove=()=>{Ur(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Ur(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Vr),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=ir,e.Style=ct,e.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=o.create("button","maplibregl-ctrl-terrain",this._container),o.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){o.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=Ji,e.TwoFingersTouchRotateHandler=Xi,e.TwoFingersTouchZoomHandler=Wi,e.TwoFingersTouchZoomRotateHandler=cr,e.VectorTileSource=Z,e.VideoSource=J,e.addSourceType=(e,n)=>t._(void 0,void 0,void 0,(function*(){if(te(e))throw new Error(`A source type called "${e}" already exists.`);((e,t)=>{ee[e]=t})(e,n)})),e.clearPrewarmedResources=function(){const e=R;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(z),R=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.getMaxParallelImageRequests=function(){return t.a.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return ae().getRTLTextPluginStatus()},e.getVersion=function(){return Zr},e.getWorkerCount=function(){return L.workerCount},e.getWorkerUrl=function(){return t.a.WORKER_URL},e.importScriptInWorkers=function(e){return N().broadcast("IS",e)},e.prewarm=function(){O().acquire(z)},e.setMaxParallelImageRequests=function(e){t.a.MAX_PARALLEL_IMAGE_REQUESTS=e},e.setRTLTextPlugin=function(e,t){return ae().setRTLTextPlugin(e,t)},e.setWorkerCount=function(e){L.workerCount=e},e.setWorkerUrl=function(e){t.a.WORKER_URL=e}})),e}()}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,n),a.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var a=Object.create(null);n.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&i;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>i[e]));return o.default=()=>i,n.d(a,o),a}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+".8e4c5fdf.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="coffee-website:";n.l=(i,r,a,o)=>{if(e[i])e[i].push(r);else{var s,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+a){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=i),e[i]=[r];var d=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/coffee-website/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var a=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=a);var o=n.p+n.u(t),s=new Error;n.l(o,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,a,o=i[0],s=i[1],l=i[2],c=0;if(o.some((t=>0!==e[t]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)l(n)}for(t&&t(i);c<o.length;c++)a=o[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},i=self.webpackChunkcoffee_website=self.webpackChunkcoffee_website||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e=n(43),t=n.t(e,2),i=n(391),r=n(719),a=n(284);Map,Symbol.iterator,Symbol.toStringTag;const o=new class{constructor(){this._apiKey="",this._fetch="undefined"!==typeof self?fetch.bind(self):"undefined"!==typeof global&&global.fetch?global.fetch:null,this.tileCacheSize=200}set apiKey(e){this._apiKey=e}get apiKey(){return this._apiKey}set fetch(e){this._fetch=e}get fetch(){return this._fetch}},s={AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"};new Set(Object.values(s));async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===o.fetch)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(""===new URL(e).searchParams.get("key").trim())throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return o.fetch(e,t)}const c={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(c);class u extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";super(`Call to enpoint ${e.url} failed with the status code ${e.status}. ${t}`),this.res=e}}const h={403:"Key is missing, invalid or restricted"};const d={info:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new URL("geolocation/ip.json",c.maptilerApiURL);t.searchParams.set("key",e.apiKey??o.apiKey);const n=t.toString(),i=await l(n);if(!i.ok)throw new u(i,i.status in h?h[i.status]:"");return await i.json()}};function p(e){let t;const n=e.trim();let i;return i=n.startsWith("http://")||n.startsWith("https://")?n:null!==(t=/^maptiler:\/\/(.*)/.exec(n))?`https://api.maptiler.com/maps/${t[1]}/style.json`:`https://api.maptiler.com/maps/${n}/style.json`,i}class f{constructor(e,t,n,i,r,a){this.name=e,this.variantType=t,this.id=n,this.referenceStyle=i,this.description=r,this.imageURL=a}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(e){return this.referenceStyle.hasVariant(e)}getVariant(e){return this.referenceStyle.getVariant(e)}getVariants(){return this.referenceStyle.getVariants().filter((e=>e!==this))}getImageURL(){return this.imageURL}getExpandedStyleURL(){return p(this.getId())}}class m{constructor(e,t){this.name=e,this.id=t,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(e){this.variants[e.getType()]=e,this.orderedVariants.push(e)}hasVariant(e){return e in this.variants}getVariant(e){return e in this.variants?this.variants[e]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const g=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function y(e){return new Proxy(e,{get:(t,n,i)=>t.hasVariant(n)?t.getVariant(n):n.toString().toUpperCase()===n?e.getDefaultVariant():Reflect.get(t,n,i)})}const _=function(){const e={};for(let t=0;t<g.length;t+=1){const n=g[t],i=y(new m(n.name,n.referenceStyleID));for(let e=0;e<n.variants.length;e+=1){const t=n.variants[e],r=new f(t.name,t.variantType,t.id,i,t.description,t.imageURL);i.addVariant(r)}e[n.referenceStyleID]=i}return e}();const v=6371008.8;Math.PI;const x={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let b;const w=new Uint8Array(16);function S(){if(!b&&(b="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!b))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return b(w)}const T=[];for(let n=0;n<256;++n)T.push((n+256).toString(16).slice(1));function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return T[e[t+0]]+T[e[t+1]]+T[e[t+2]]+T[e[t+3]]+"-"+T[e[t+4]]+T[e[t+5]]+"-"+T[e[t+6]]+T[e[t+7]]+"-"+T[e[t+8]]+T[e[t+9]]+"-"+T[e[t+10]]+T[e[t+11]]+T[e[t+12]]+T[e[t+13]]+T[e[t+14]]+T[e[t+15]]}const I=function(e,t,n){if(x.randomUUID&&!t&&!e)return x.randomUUID();const i=(e=e||{}).random||(e.rng||S)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return C(i)},k="function"===typeof Buffer,E=("function"===typeof TextDecoder&&new TextDecoder,"function"===typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),P=(e=>{let t={};return e.forEach(((e,n)=>t[e]=n)),t})(E),A=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,M=String.fromCharCode.bind(String),z=("function"===typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_"))),L=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),D=e=>{let t,n,i,r,a="";const o=e.length%3;for(let s=0;s<e.length;){if((n=e.charCodeAt(s++))>255||(i=e.charCodeAt(s++))>255||(r=e.charCodeAt(s++))>255)throw new TypeError("invalid character found");t=n<<16|i<<8|r,a+=E[t>>18&63]+E[t>>12&63]+E[t>>6&63]+E[63&t]}return o?a.slice(0,o-3)+"===".substring(o):a},R="function"===typeof btoa?e=>btoa(e):k?e=>Buffer.from(e,"binary").toString("base64"):D,F=k?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,i=e.length;n<i;n+=4096)t.push(M.apply(null,e.subarray(n,n+4096)));return R(t.join(""))},O=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?z(F(e)):F(e)},B=e=>{if(e=e.replace(/\s+/g,""),!A.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,i,r="";for(let a=0;a<e.length;)t=P[e.charAt(a++)]<<18|P[e.charAt(a++)]<<12|(n=P[e.charAt(a++)])<<6|(i=P[e.charAt(a++)]),r+=64===n?M(t>>16&255):64===i?M(t>>16&255,t>>8&255):M(t>>16&255,t>>8&255,255&t);return r},N=O;var V=Object.defineProperty,U=e=>{throw TypeError(e)},j=(e,t,n)=>((e,t,n)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),$=(e,t,n)=>t.has(e)||U("Cannot "+n),H=(e,t,n)=>($(e,t,"read from private field"),n?n.call(e):t.get(e)),q=(e,t,n)=>t.has(e)?U("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Z=(e,t,n,i)=>($(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),G=(e,t,n)=>($(e,t,"access private method"),n);const W={VISITOR:"visitor",VISITOR_ENGLISH:"visitor_en",STYLE:"style",AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"name:latin",NON_LATIN:"name:nonlatin",LOCAL:"name",INTERNATIONAL:"name_int",ALBANIAN:"name:sq",AMHARIC:"name:am",ARABIC:"name:ar",ARMENIAN:"name:hy",AZERBAIJANI:"name:az",BASQUE:"name:eu",BELORUSSIAN:"name:be",BENGALI:"name:bn",BOSNIAN:"name:bs",BRETON:"name:br",BULGARIAN:"name:bg",CATALAN:"name:ca",CHINESE:"name:zh",TRADITIONAL_CHINESE:"name:zh-Hant",SIMPLIFIED_CHINESE:"name:zh-Hans",CORSICAN:"name:co",CROATIAN:"name:hr",CZECH:"name:cs",DANISH:"name:da",DUTCH:"name:nl",ENGLISH:"name:en",ESPERANTO:"name:eo",ESTONIAN:"name:et",FINNISH:"name:fi",FRENCH:"name:fr",FRISIAN:"name:fy",GEORGIAN:"name:ka",GERMAN:"name:de",GREEK:"name:el",HEBREW:"name:he",HINDI:"name:hi",HUNGARIAN:"name:hu",ICELANDIC:"name:is",INDONESIAN:"name:id",IRISH:"name:ga",ITALIAN:"name:it",JAPANESE:"name:ja",JAPANESE_HIRAGANA:"name:ja-Hira",JAPANESE_KANA:"name:ja_kana",JAPANESE_LATIN:"name:ja_rm",JAPANESE_2018:"name:ja-Latn",KANNADA:"name:kn",KAZAKH:"name:kk",KOREAN:"name:ko",KOREAN_LATIN:"name:ko-Latn",KURDISH:"name:ku",ROMAN_LATIN:"name:la",LATVIAN:"name:lv",LITHUANIAN:"name:lt",LUXEMBOURGISH:"name:lb",MACEDONIAN:"name:mk",MALAYALAM:"name:ml",MALTESE:"name:mt",NORWEGIAN:"name:no",OCCITAN:"name:oc",PERSIAN:"name:fa",POLISH:"name:pl",PORTUGUESE:"name:pt",PUNJABI:"name:pa",WESTERN_PUNJABI:"name:pnb",ROMANIAN:"name:ro",ROMANSH:"name:rm",RUSSIAN:"name:ru",SCOTTISH_GAELIC:"name:gd",SERBIAN_CYRILLIC:"name:sr",SERBIAN_LATIN:"name:sr-Latn",SLOVAK:"name:sk",SLOVENE:"name:sl",SPANISH:"name:es",SWEDISH:"name:sv",TAMIL:"name:ta",TELUGU:"name:te",THAI:"name:th",TURKISH:"name:tr",UKRAINIAN:"name:uk",URDU:"name:ur",VIETNAMIAN_LATIN:"name:vi",WELSH:"name:cy"},K=new Set(Object.values(W));function X(e){return K.has(e)}const Y=new Set(Object.values(W));function J(){if(typeof navigator>"u")return`name:${Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0]}`;const e=Array.from(new Set(navigator.languages.map((e=>`name:${e.split("-")[0]}`)))).filter((e=>Y.has(e)));return e.length?e[0]:W.LOCAL}const Q={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:W.STYLE,secondaryLanguage:W.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Q);const ee=I();const te=new class extends a{constructor(){super(...arguments),j(this,"primaryLanguage",Q.primaryLanguage),j(this,"secondaryLanguage"),j(this,"session",!0),j(this,"caching",!0),j(this,"_unit","metric"),j(this,"_apiKey","")}set unit(e){this._unit=e,this.emit("unit",e)}get unit(){return this._unit}set apiKey(e){this._apiKey=e,o.apiKey=e,this.emit("apiKey",e)}get apiKey(){return this._apiKey}set fetch(e){o.fetch=e}get fetch(){return o.fetch}},{addProtocol:ne}=r,ie="localcache_source",re="localcache",ae="maptiler_sdk",oe=1e3,se=typeof caches<"u";function le(e,t){if(se&&te.caching&&te.session&&e.host===Q.maptilerApiHost){if("Source"===t&&e.href.includes("tiles.json"))return e.href.replace("https://",`${ie}://`);if("Tile"===t||"Glyphs"===t)return e.href.replace("https://",`${re}://`)}return e.href}let ce;async function ue(){return ce||(ce=await caches.open(ae)),ce}let he=0;function de(){ne(ie,(async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${ie}://`,"https://");const n=e;n.signal=t.signal;const i=await fetch(e.url,n),r=await i.json();return r.tiles&&r.tiles.length>0&&(r.tiles[0]+=`&last-modified=${i.headers.get("Last-Modified")}`),{data:r,cacheControl:i.headers.get("Cache-Control"),expires:i.headers.get("Expires")}})),ne(re,(async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${re}://`,"https://");const n=new URL(e.url),i=new URL(n);i.searchParams.delete("mtsid"),i.searchParams.delete("key");const r=i.toString(),a=new URL(n);a.searchParams.delete("last-modified");const o=a.toString(),s=async e=>({data:await e.arrayBuffer(),cacheControl:e.headers.get("Cache-Control"),expires:e.headers.get("Expires")}),l=await ue(),c=await l.match(r);if(c)return s(c);const u=e;u.signal=t.signal;const h=await fetch(o,u);return h.status>=200&&h.status<300&&(l.put(r,h.clone()).catch((()=>{})),++he>100&&(async function(){const e=await ue(),t=await e.keys(),n=t.slice(0,Math.max(t.length-oe,0));for(const i of n)e.delete(i)}(),he=0)),s(h)}))}function pe(e,t,n){const i=window.document.createElement(e);return void 0!==t&&(i.className=t),n&&n.appendChild(i),i}function fe(e){e.parentNode&&e.parentNode.removeChild(e)}function me(e,t){let n=null;try{n=new URL(e)}catch{return{url:e}}return n.host===Q.maptilerApiHost&&(n.searchParams.has("key")||n.searchParams.append("key",te.apiKey),te.session&&n.searchParams.append("mtsid",ee)),{url:le(n,t)}}function ge(e){return(t,n)=>{if(null!=e){const i=e(t,n),r=me((null==i?void 0:i.url)??"",n);return{...i,...r}}return me(t,n)}}function ye(e){const t=document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed.";if(!t)return;let n=null;if("string"==typeof e?n=document.getElementById(e):e instanceof HTMLElement&&(n=e),!n)throw new Error("The Map container must be provided.");const i=document.createElement("div");throw i.innerHTML=t,i.classList.add("no-webgl-support-div"),n.appendChild(i),new Error(t)}let _e=class extends r.Marker{addTo(e){return super.addTo(e)}};r.Popup;r.Style;r.CanvasSource;r.GeoJSONSource;r.ImageSource;r.RasterTileSource;r.RasterDEMTileSource;r.VectorTileSource;r.VideoSource;class ve extends r.NavigationControl{onAdd(e){return super.onAdd(e)}}class xe extends r.GeolocateControl{onAdd(e){return super.onAdd(e)}}r.AttributionControl;class be extends r.LogoControl{onAdd(e){return super.onAdd(e)}}class we extends r.ScaleControl{onAdd(e){return super.onAdd(e)}}class Se extends r.FullscreenControl{onAdd(e){return super.onAdd(e)}}r.TerrainControl;r.BoxZoomHandler;r.ScrollZoomHandler;r.CooperativeGesturesHandler;r.KeyboardHandler;r.TwoFingersTouchPitchHandler;r.MapWheelEvent;r.MapTouchEvent;r.MapMouseEvent;class Te extends be{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),j(this,"logoURL",""),j(this,"linkURL",""),this.logoURL=e.logoURL??Q.maptilerLogoURL,this.linkURL=e.linkURL??Q.maptilerURL}onAdd(e){this._map=e,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const t=window.document.createElement("a");return t.style.backgroundRepeat="no-repeat",t.style.cursor="pointer",t.style.display="block",t.style.height="23px",t.style.margin="0 0 -4px -4px",t.style.overflow="hidden",t.style.width="88px",t.style.backgroundImage=`url(${this.logoURL})`,t.style.backgroundSize="100px 30px",t.style.width="100px",t.style.height="30px",t.target="_blank",t.rel="noopener",t.href=this.linkURL,t.setAttribute("aria-label","MapTiler logo"),t.setAttribute("rel","noopener"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}function Ce(e){return e?"string"==typeof e||e instanceof String?!e.startsWith("http")&&e.toLowerCase().includes(".json")?e:p(e):e instanceof f?e.getExpandedStyleURL():e instanceof m?e.getDefaultVariant().getExpandedStyleURL():e:_[g[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}class Ie{constructor(){j(this,"_map"),j(this,"_container"),j(this,"_terrainButton"),function(e,t){for(const n of e)"function"==typeof t[n]&&(t[n]=t[n].bind(t))}(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(e){return this._map=e,this._container=pe("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=pe("button","maplibregl-ctrl-terrain",this._container),pe("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){fe(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class ke extends ve{constructor(){super({showCompass:!0,showZoom:!0,visualizePitch:!0}),j(this,"_rotateCompassArrow",(()=>{const e=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(this._map.transform.pitch*(Math.PI/180))**.5)}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e})),this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",(e=>{0===this._map.getPitch()?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}))}_createButton(e,t){const n=super._createButton(e,t);return n.clickFunction=t,n}}const Ee=r.Marker,Pe=r.LngLat,Ae=r.LngLatBounds;class Me extends xe{constructor(){super(...arguments),j(this,"lastUpdatedCenter",new Pe(0,0)),j(this,"_updateCamera",(e=>{var t,n;const i=new Pe(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,a={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},o=this._map.getZoom();o>((null==(n=null==(t=this.options)?void 0:t.fitBoundsOptions)?void 0:n.maxZoom)??30)&&(a.zoom=o),this._map.fitBounds(Ae.fromLngLat(i,r),a,{geolocateSource:!0});let s=!1;const l=()=>{s=!0};this._map.once("click",l),this._map.once("dblclick",l),this._map.once("dragstart",l),this._map.once("mousedown",l),this._map.once("touchstart",l),this._map.once("wheel",l),this._map.once("moveend",(()=>{this._map.off("click",l),this._map.off("dblclick",l),this._map.off("dragstart",l),this._map.off("mousedown",l),this._map.off("touchstart",l),this._map.off("wheel",l),!s&&(this.lastUpdatedCenter=this._map.getCenter())}))})),j(this,"_setupUI",(e=>{if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=pe("button","maplibregl-ctrl-geolocate",this._container),pe("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pe("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ee({element:this._dotElement}),this._circleElement=pe("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ee({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",(e=>{const t=e.originalEvent&&"resize"===e.originalEvent.type,n=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!e.geolocateSource&&"ACTIVE_LOCK"===this._watchState&&!t&&n>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))}))})),j(this,"_onZoom",(()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}))}_updateCircleRadius(){if("BACKGROUND"!==this._watchState&&"ACTIVE_LOCK"!==this._watchState)return;const e=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],t=this._map.project(e),n=this._map.unproject([t.x,t.y]),i=this._map.unproject([t.x+20,t.y]),r=n.distanceTo(i)/20,a=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=`${a}px`,this._circleElement.style.height=`${a}px`}}var ze,Le,De,Re,Fe,Oe,Be,Ne,Ve,Ue;class je{constructor(e,t){q(this,Be),q(this,ze),j(this,"map"),q(this,Le),q(this,De),q(this,Re),q(this,Fe,!1),q(this,Oe),void 0!==e.style&&Z(this,Fe,!0),Z(this,ze,{zoomAdjust:-4,position:"top-right",...t,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...e,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...e.containerStyle??{}}}),void 0!==e.lockZoom&&(H(this,ze).minZoom=e.lockZoom,H(this,ze).maxZoom=e.lockZoom)}setStyle(e,t){H(this,Fe)||this.map.setStyle(e,t),G(this,Be,Ve).call(this)}addLayer(e,t){return H(this,Fe)||this.map.addLayer(e,t),G(this,Be,Ve).call(this),this.map}moveLayer(e,t){return H(this,Fe)||this.map.moveLayer(e,t),G(this,Be,Ve).call(this),this.map}removeLayer(e){return H(this,Fe)||this.map.removeLayer(e),G(this,Be,Ve).call(this),this}setLayerZoomRange(e,t,n){return H(this,Fe)||this.map.setLayerZoomRange(e,t,n),G(this,Be,Ve).call(this),this}setFilter(e,t,n){return H(this,Fe)||this.map.setFilter(e,t,n),G(this,Be,Ve).call(this),this}setPaintProperty(e,t,n,i){return H(this,Fe)||this.map.setPaintProperty(e,t,n,i),G(this,Be,Ve).call(this),this}setLayoutProperty(e,t,n,i){return H(this,Fe)||this.map.setLayoutProperty(e,t,n,i),G(this,Be,Ve).call(this),this}setGlyphs(e,t){return H(this,Fe)||this.map.setGlyphs(e,t),G(this,Be,Ve).call(this),this}onAdd(e){Z(this,Le,e),Z(this,De,pe("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[t,n]of Object.entries(H(this,ze).containerStyle))H(this,De).style.setProperty(t,n);return H(this,ze).container=H(this,De),H(this,ze).zoom=e.getZoom()+H(this,ze).zoomAdjust,this.map=new He(H(this,ze)),this.map.once("style.load",(()=>{this.map.resize()})),this.map.once("load",(()=>{G(this,Be,Ne).call(this,H(this,ze).parentRect),Z(this,Oe,G(this,Be,Ue).call(this))})),H(this,De)}onRemove(){var e;null==(e=H(this,Oe))||e.call(this),fe(H(this,De))}}ze=new WeakMap,Le=new WeakMap,De=new WeakMap,Re=new WeakMap,Fe=new WeakMap,Oe=new WeakMap,Be=new WeakSet,Ne=function(e){void 0===e||void 0===e.linePaint&&void 0===e.fillPaint||(Z(this,Re,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:H(this,Re)}),(void 0!==e.lineLayout||void 0!==e.linePaint)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...e.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...e.linePaint}}),void 0!==e.fillPaint&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...e.fillPaint}}),G(this,Be,Ve).call(this))},Ve=function(){if(void 0===H(this,Re))return;const{devicePixelRatio:e}=window,t=H(this,Le).getCanvas(),n=t.width/e,i=t.height/e,r=H(this,Le).unproject.bind(H(this,Le)),a=r([0,0]),o=r([n,0]),s=r([0,i]),l=r([n,i]);H(this,Re).geometry.coordinates=[[s.toArray(),l.toArray(),o.toArray(),a.toArray(),s.toArray()]],this.map.getSource("parentRect").setData(H(this,Re))},Ue=function(){const{pitchAdjust:e}=H(this,ze),t=()=>{a("parent")},n=()=>{a("minimap")},i=()=>{H(this,Le).on("move",t),this.map.on("move",n)},r=()=>{H(this,Le).off("move",t),this.map.off("move",n)},a=t=>{r();const n="parent"===t?H(this,Le):this.map,a="parent"===t?this.map:H(this,Le),o=n.getCenter(),s=n.getZoom()+(H(this,ze).zoomAdjust??-4)*("parent"===t?1:-1),l=n.getBearing(),c=n.getPitch();a.jumpTo({center:o,zoom:s,bearing:l,pitch:e?c:0}),G(this,Be,Ve).call(this),i()};return i(),()=>{r()}};const $e="COUNTRY";class He extends r.Map{constructor(e){ye(e.container),e.apiKey&&(te.apiKey=e.apiKey);const t=Ce(e.style),n=location.hash;te.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");let i={compact:!1};e.customAttribution?i.customAttribution=e.customAttribution:e.attributionControl&&"object"==typeof e.attributionControl&&(i={...i,...e.attributionControl}),super({...e,style:t,maplibreLogo:!1,transformRequest:ge(e.transformRequest),attributionControl:!0!==e.forceNoAttributionControl&&i}),j(this,"isTerrainEnabled",!1),j(this,"terrainExaggeration",1),j(this,"primaryLanguage"),j(this,"terrainGrowing",!1),j(this,"terrainFlattening",!1),j(this,"minimap"),j(this,"forceLanguageUpdate"),j(this,"languageAlwaysBeenStyle"),j(this,"isReady",!1),te.caching&&!se&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),te.caching&&se&&de(),this.primaryLanguage=e.language??te.primaryLanguage,this.forceLanguageUpdate=!(this.primaryLanguage===W.STYLE||this.primaryLanguage===W.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===W.STYLE,this.terrainExaggeration=e.terrainExaggeration??this.terrainExaggeration,this.once("styledata",(async()=>{if(!e.geolocate||e.center||e.hash&&n)return;try{if(e.geolocate===$e)return void await this.fitToIpBounds()}catch(i){console.warn(i.message)}let t;try{await this.centerOnIpPoint(e.zoom),t=this.getCameraHash()}catch(i){console.warn(i.message)}"granted"===(await navigator.permissions.query({name:"geolocation"})).state&&navigator.geolocation.getCurrentPosition((n=>{t===this.getCameraHash()&&(this.terrain?this.easeTo({center:[n.coords.longitude,n.coords.latitude],zoom:e.zoom||12,duration:2e3}):this.once("terrain",(()=>{this.easeTo({center:[n.coords.longitude,n.coords.latitude],zoom:e.zoom||12,duration:2e3})})))}),null,{maximumAge:864e5,timeout:5e3,enableHighAccuracy:!1})})),this.on("styledata",(()=>{this.setPrimaryLanguage(this.primaryLanguage)})),this.on("styledata",(()=>{null===this.getTerrain()&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)})),this.once("load",(async()=>{let t={logo:null};try{const e=Object.keys(this.style.sourceCaches).map((e=>this.getSource(e))).filter((e=>e&&"url"in e&&"string"==typeof e.url&&(null==e?void 0:e.url.includes("tiles.json")))),n=new URL(e[0].url);n.searchParams.has("key")||n.searchParams.append("key",te.apiKey),t=await(await fetch(n.href)).json()}catch{}if(!0!==e.forceNoAttributionControl)if("logo"in t&&t.logo){const n=t.logo;this.addControl(new Te({logoURL:n}),e.logoPosition)}else e.maptilerLogo&&this.addControl(new Te,e.logoPosition);if(e.scaleControl){const t=!0===e.scaleControl||void 0===e.scaleControl?"bottom-right":e.scaleControl,n=new we({unit:te.unit});this.addControl(n,t),te.on("unit",(e=>{n.setUnit(e)}))}if(!1!==e.navigationControl){const t=!0===e.navigationControl||void 0===e.navigationControl?"top-right":e.navigationControl;this.addControl(new ke,t)}if(!1!==e.geolocateControl){const t=!0===e.geolocateControl||void 0===e.geolocateControl?"top-right":e.geolocateControl;this.addControl(new Me({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),t)}if(e.terrainControl){const t=!0===e.terrainControl||void 0===e.terrainControl?"top-right":e.terrainControl;this.addControl(new Ie,t)}if(e.fullscreenControl){const t=!0===e.fullscreenControl||void 0===e.fullscreenControl?"top-right":e.fullscreenControl;this.addControl(new Se({}),t)}this.isReady=!0,this.fire("ready",{target:this})}));let r,a=!1,o=!1;this.once("ready",(()=>{a=!0,o&&this.fire("loadWithTerrain",r)})),this.once("style.load",(()=>{const{minimap:t}=e;if("object"==typeof t){const{zoom:n,center:i,style:r,language:a,apiKey:o,maptilerLogo:s,antialias:l,refreshExpiredTiles:c,maxBounds:u,scrollZoom:h,minZoom:d,maxZoom:p,boxZoom:f,locale:m,fadeDuration:g,crossSourceCollisions:y,clickTolerance:_,bounds:v,fitBoundsOptions:x,pixelRatio:b,validateStyle:w}=e;this.minimap=new je(t,{zoom:n,center:i,style:r,language:a,apiKey:o,container:"null",maptilerLogo:s,antialias:l,refreshExpiredTiles:c,maxBounds:u,scrollZoom:h,minZoom:d,maxZoom:p,boxZoom:f,locale:m,fadeDuration:g,crossSourceCollisions:y,clickTolerance:_,bounds:v,fitBoundsOptions:x,pixelRatio:b,validateStyle:w}),this.addControl(this.minimap,t.position??"bottom-left")}else!0===t?(this.minimap=new je({},e),this.addControl(this.minimap,"bottom-left")):void 0!==t&&!1!==t&&(this.minimap=new je({},e),this.addControl(this.minimap,t))}));const s=e=>{e.terrain&&(o=!0,r={type:"loadWithTerrain",target:this,terrain:e.terrain},this.off("terrain",s),a&&this.fire("loadWithTerrain",r))};this.on("terrain",s),e.terrain&&this.enableTerrain(e.terrainExaggeration??this.terrainExaggeration)}async onLoadAsync(){return new Promise((e=>{if(this.loaded())return e(this);this.once("load",(()=>{e(this)}))}))}async onReadyAsync(){return new Promise((e=>{if(this.isReady)return e(this);this.once("ready",(()=>{e(this)}))}))}async onLoadWithTerrainAsync(){return new Promise((e=>{if(this.isReady&&this.terrain)return e(this);this.once("loadWithTerrain",(()=>{e(this)}))}))}setStyle(e,t){var n;return null==(n=this.minimap)||n.setStyle(e),this.forceLanguageUpdate=!0,this.once("idle",(()=>{this.forceLanguageUpdate=!1})),super.setStyle(Ce(e),t)}addLayer(e,t){var n;return null==(n=this.minimap)||n.addLayer(e,t),super.addLayer(e,t)}moveLayer(e,t){var n;return null==(n=this.minimap)||n.moveLayer(e,t),super.moveLayer(e,t)}removeLayer(e){var t;return null==(t=this.minimap)||t.removeLayer(e),super.removeLayer(e)}setLayerZoomRange(e,t,n){var i;return null==(i=this.minimap)||i.setLayerZoomRange(e,t,n),super.setLayerZoomRange(e,t,n)}setFilter(e,t,n){var i;return null==(i=this.minimap)||i.setFilter(e,t,n),super.setFilter(e,t,n)}setPaintProperty(e,t,n,i){var r;return null==(r=this.minimap)||r.setPaintProperty(e,t,n,i),super.setPaintProperty(e,t,n,i)}setLayoutProperty(e,t,n,i){var r;return null==(r=this.minimap)||r.setLayoutProperty(e,t,n,i),super.setLayoutProperty(e,t,n,i)}setGlyphs(e,t){var n;return null==(n=this.minimap)||n.setGlyphs(e,t),super.setGlyphs(e,t)}getStyleLanguage(){return this.style.stylesheet.metadata&&"object"==typeof this.style.stylesheet.metadata&&"maptiler:language"in this.style.stylesheet.metadata&&"string"==typeof this.style.stylesheet.metadata["maptiler:language"]?this.style.stylesheet.metadata["maptiler:language"]:null}setLanguage(e){var t,n;null==(n=null==(t=this.minimap)?void 0:t.map)||n.setLanguage(e),this.onStyleReady((()=>{this.setPrimaryLanguage(e)}))}setPrimaryLanguage(e){const t=this.getStyleLanguage();if((e!==W.STYLE||t!==W.AUTO&&t!==W.VISITOR)&&(e!==W.STYLE&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===e&&!this.forceLanguageUpdate))return;if(!X(e))return void console.warn(`The language "${e}" is not supported.`);if(this.primaryLanguage===W.STYLE_LOCK)return void console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");this.primaryLanguage=e;let n=e;if(e===W.STYLE){if(!t)return void console.warn("The style has no default languages.");if(!X(t))return void console.warn("The language defined in the style is not valid.");n=t}let i=W.LOCAL,r=`{${i}}`;n===W.VISITOR?(i=J(),r=["case",["all",["has",i],["has",W.LOCAL]],["case",["==",["get",i],["get",W.LOCAL]],["get",W.LOCAL],["format",["get",i],{"font-scale":.8},"\n",["get",W.LOCAL],{"font-scale":1.1}]],["get",W.LOCAL]]):n===W.VISITOR_ENGLISH?(i=W.ENGLISH,r=["case",["all",["has",i],["has",W.LOCAL]],["case",["==",["get",i],["get",W.LOCAL]],["get",W.LOCAL],["format",["get",i],{"font-scale":.8},"\n",["get",W.LOCAL],{"font-scale":1.1}]],["get",W.LOCAL]]):n===W.AUTO?(i=J(),r=["case",["has",i],["get",i],["get",W.LOCAL]]):n===W.LOCAL?(i=W.LOCAL,r=`{${i}}`):(i=n,r=["case",["has",i],["get",i],["get",W.LOCAL]]);const{layers:a}=this.getStyle();for(const o of a){if("symbol"!==o.type)continue;const e=o,t=this.getSource(e.source);if(!t||!("url"in t)||"string"!=typeof t.url||new URL(t.url).host!==Q.maptilerApiHost)continue;const{id:n,layout:i}=e;if(!i||!("text-field"in i))continue;const a=this.getLayoutProperty(n,"text-field");"string"==typeof a&&(a.toLowerCase().includes("ref")||a.toLowerCase().includes("housenumber"))||this.setLayoutProperty(n,"text-field",r)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(!this.terrain)return;const n=performance.now(),i=this.terrain.exaggeration,r=e-i,a=()=>{if(!this.terrain||this.terrainFlattening)return;const o=(performance.now()-n)/t;if(o<.99){const e=i+(1-(1-o)**4)*r;this.terrain.exaggeration=e,requestAnimationFrame(a)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=e;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(a)}enableTerrain(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.terrainExaggeration;if(e<0)return void console.warn("Terrain exaggeration cannot be negative.");const t=async n=>{!this.terrain||"data"!==n.type||"source"!==n.dataType||!("source"in n)||"maptiler-terrain"!==n.sourceId||"raster-dem"!==n.source.type||n.isSourceLoaded&&(this.off("data",t),this.growTerrain(e))},n=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=e,this.on("data",t),this.addSource(Q.terrainSourceId,{type:"raster-dem",url:Q.terrainSourceURL}),this.setTerrain({source:Q.terrainSourceId,exaggeration:0})};if(this.getTerrain())return this.isTerrainEnabled=!0,void this.growTerrain(e);this.loaded()||this.isTerrainEnabled?n():this.once("load",(()=>{this.getTerrain()&&this.getSource(Q.terrainSourceId)||n()}))}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const e=performance.now(),t=this.terrain.exaggeration,n=()=>{if(!this.terrain||this.terrainGrowing)return;const i=(performance.now()-e)/1e3;if(i<.99){const e=t*(1-i)**4;this.terrain.exaggeration=e,requestAnimationFrame(n)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Q.terrainSourceId)&&this.removeSource(Q.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(n)}setTerrainExaggeration(e){!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.terrain?(this.terrainExaggeration=e,this.terrain.exaggeration=e,this.triggerRepaint()):this.enableTerrain(e)}onStyleReady(e){this.isStyleLoaded()?e():this.once("styledata",(()=>{e()}))}async fitToIpBounds(){const e=await d.info();this.fitBounds(e.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(e){const t=await d.info();this.jumpTo({center:[(null==t?void 0:t.longitude)??0,(null==t?void 0:t.latitude)??0],zoom:e||11})}getCameraHash(){const e=new Float32Array(5),t=this.getCenter();return e[0]=t.lng,e[1]=t.lat,e[2]=this.getZoom(),e[3]=this.getPitch(),e[4]=this.getBearing(),N(new Uint8Array(e.buffer))}getSdkConfig(){return te}getMaptilerSessionId(){return ee}setTransformRequest(e){return super.setTransformRequest(ge(e)),this}}function qe(e){const t=e.toString(16);return 1===t.length?`0${t}`:t}class Ze extends Array{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),j(this,"min",0),j(this,"max",1),"min"in e&&(this.min=e.min),"max"in e&&(this.max=e.max),"stops"in e&&this.setStops(e.stops,{clone:!1})}static fromArrayDefinition(e){return new Ze({stops:e.map((e=>({value:e[0],color:e[1]})))})}setStops(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{clone:!0}).clone?this.clone():this;t.length=0;let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(let r=0;r<e.length;r+=1)n=Math.min(n,e[r].value),i=Math.max(i,e[r].value),t.push({value:e[r].value,color:e[r].color.slice()});return t.sort(((e,t)=>e.value<t.value?-1:1)),this.min=n,this.max=i,t}scale(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0}).clone,i=this[0].value,r=this.at(-1).value-i,a=t-e,o=[];for(let s=0;s<this.length;s+=1){const t=(this[s].value-i)/r*a+e;n?o.push({value:t,color:this[s].color.slice()}):this[s].value=t}return n?new Ze({stops:o}):this}at(e){return e<0?this[this.length+e]:this[e]}clone(){return new Ze({stops:this.getRawColorStops()})}getRawColorStops(){const e=[];for(let t=0;t<this.length;t+=1)e.push({value:this[t].value,color:this[t].color});return e}reverse(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clone:!0}).clone?this.clone():this;for(let t=0;t<~~(e.length/2);t+=1){const n=e[t].color;e[t].color=e.at(-(t+1)).color,e.at(-(t+1)).color=n}return e}getBounds(){return{min:this.min,max:this.max}}getColor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{smooth:!0};if(e<=this[0].value)return this[0].color;if(e>=this.at(-1).value)return this.at(-1).color;for(let n=0;n<this.length-1;n+=1){if(e>this[n+1].value)continue;const i=this[n].color;if(!t.smooth)return i.slice();const r=this[n].value,a=this[n+1].value,o=this[n+1].color,s=(a-e)/(a-r);return i.map(((e,t)=>Math.round(e*s+o[t]*(1-s))))}return[0,0,0]}getColorHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{smooth:!0,withAlpha:!1};return`#${qe((n=this.getColor(e,t))[0])}${qe(n[1])}${qe(n[2])}${4===n.length?qe(n[3]):""}`;var n}getColorRelative(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{smooth:!0};const n=this.getBounds();return this.getColor(n.min+e*(n.max-n.min),t)}getCanvasStrip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{horizontal:!0,size:512,smooth:!0};const t=document.createElement("canvas");t.width=e.horizontal?e.size:1,t.height=e.horizontal?1:e.size;const n=t.getContext("2d");if(!n)throw new Error("Canvs context is missing");const i=n.getImageData(0,0,t.width,t.height),r=i.data,a=e.size,o=this[0].value,s=(this.at(-1).value-o)/a;for(let l=0;l<a;l+=1){const t=this.getColor(o+l*s,{smooth:e.smooth});r[4*l]=t[0],r[4*l+1]=t[1],r[4*l+2]=t[2],r[4*l+3]=t.length>3?t[3]:255}return n.putImageData(i,0,0),t}resample(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;const n=this.getBounds(),i=this.scale(0,1),r=1/(t-1);let a;if("ease-in-square"===e)a=Array.from({length:t},((e,t)=>{const n=t*r,a=n**2;return{value:n,color:i.getColor(a)}}));else if("ease-out-square"===e)a=Array.from({length:t},((e,t)=>{const n=t*r,a=1-(1-n)**2;return{value:n,color:i.getColor(a)}}));else if("ease-out-sqrt"===e)a=Array.from({length:t},((e,t)=>{const n=t*r,a=n**.5;return{value:n,color:i.getColor(a)}}));else if("ease-in-sqrt"===e)a=Array.from({length:t},((e,t)=>{const n=t*r,a=1-(1-n)**.5;return{value:n,color:i.getColor(a)}}));else if("ease-out-exp"===e)a=Array.from({length:t},((e,t)=>{const n=t*r,a=1-2**(-10*n);return{value:n,color:i.getColor(a)}}));else{if("ease-in-exp"!==e)throw new Error("Invalid ressampling method.");a=Array.from({length:t},((e,t)=>{const n=t*r,a=2**(10*n-10);return{value:n,color:i.getColor(a)}}))}return new Ze({stops:a}).scale(n.min,n.max)}transparentStart(){const e=this.getRawColorStops();e.unshift({value:e[0].value,color:e[0].color.slice()}),e[1].value+=.001;for(const t of e)3===t.color.length&&t.color.push(255);return e[0].color[3]=0,new Ze({stops:e})}hasTransparentStart(){return 4===this[0].color.length&&0===this[0].color[3]}}new Ze({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new Ze({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new Ze({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new Ze({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new Ze({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new Ze({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new Ze({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new Ze({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new Ze({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new Ze({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new Ze({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new Ze({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new Ze({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new Ze({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new Ze({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new Ze({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new Ze({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new Ze({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new Ze({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new Ze({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new Ze({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new Ze({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new Ze({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new Ze({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new Ze({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new Ze({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new Ze({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new Ze({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new Ze({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new Ze({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new Ze({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new Ze({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new Ze({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new Ze({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new Ze({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new Ze({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new Ze({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new Ze({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new Ze({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new Ze({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new Ze({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new Ze({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]});!function(){if(typeof window>"u")return;const e=r.getRTLTextPluginStatus();if("unavailable"===e||"requested"===e)try{r.setRTLTextPlugin(Q.rtlPluginURL,!0)}catch{}}();r.Map,r.Marker,r.Popup,r.Style,r.CanvasSource,r.GeoJSONSource,r.ImageSource,r.RasterTileSource,r.RasterDEMTileSource,r.VectorTileSource,r.VideoSource,r.NavigationControl,r.GeolocateControl,r.AttributionControl,r.LogoControl,r.ScaleControl,r.FullscreenControl,r.TerrainControl,r.BoxZoomHandler,r.ScrollZoomHandler,r.CooperativeGesturesHandler,r.KeyboardHandler,r.TwoFingersTouchPitchHandler,r.MapWheelEvent,r.MapTouchEvent,r.MapMouseEvent,r.config,r.getVersion;const{setRTLTextPlugin:Ge,getRTLTextPluginStatus:We,LngLat:Ke,LngLatBounds:Xe,MercatorCoordinate:Ye,Evented:Je,AJAXError:Qe,prewarm:et,clearPrewarmedResources:tt,Hash:nt,Point:it,EdgeInsets:rt,DragRotateHandler:at,DragPanHandler:ot,TwoFingersTouchZoomRotateHandler:st,DoubleClickZoomHandler:lt,TwoFingersTouchZoomHandler:ct,TwoFingersTouchRotateHandler:ut,getWorkerCount:ht,setWorkerCount:dt,getMaxParallelImageRequests:pt,setMaxParallelImageRequests:ft,getWorkerUrl:mt,setWorkerUrl:gt,addSourceType:yt,importScriptInWorkers:_t,addProtocol:vt,removeProtocol:xt}=r;function bt(t){let{map:n,markerData:i,selectCafe:r}=t;const[a,o]=(0,e.useState)(null);return(0,e.useEffect)((()=>{if(n&&i.visible){a&&a.remove();var e=i.color_code;i.is_selected&&(e="#e6353d");const t=new _e({color:e}).setLngLat([i.longitude,i.latitude]).addTo(n);t.getElement().title=i.name,t.getElement().addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),r(i)})),o(t)}}),[n,i,r]),null}var wt=n(579);function St(t){let{lng:n,lat:i,zoom:r,data:a,selectCafe:o}=t;const s=(0,e.useRef)(null);te.apiKey="bFXUsq2lCBRLxW1UauI0";const[l,c]=(0,e.useState)(null);return(0,e.useEffect)((()=>{l&&l.remove(),c(new He({container:s.current,style:_.STREETS.PASTEL,center:[n,i],zoom:r}))}),[]),(0,e.useEffect)((()=>{l&&l.jumpTo({center:[n,i],zoom:r})}),[n,i,r]),(0,wt.jsxs)("div",{className:"map-wrap",children:[(0,wt.jsx)("div",{ref:s,className:"map"}),a.map(((e,t)=>(0,wt.jsx)(bt,{map:l,markerData:e,selectCafe:o},t)))]})}const Tt=e=>{let{show:t,handleClose:n,children:i}=e;return t?(0,wt.jsx)("div",{className:"modal-backdrop",onClick:n,children:(0,wt.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,wt.jsx)("button",{className:"close-button",onClick:n,children:(0,wt.jsx)("img",{className:"close-icon",src:"https://cdn-icons-png.flaticon.com/128/800/800878.png"})}),i]})}):null};function Ct(e){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ct(e)}function It(e){var t=function(e,t){if("object"!=Ct(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Ct(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ct(t)?t:t+""}function kt(e,t,n){return(t=It(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){kt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function Mt(e,t){if(e){if("string"==typeof e)return At(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(e,t):void 0}}function zt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,s=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(s.push(i.value),s.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return s}}(e,t)||Mt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.includes(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Dt=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function Rt(){return Rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Rt.apply(null,arguments)}function Ft(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,It(i.key),i)}}function Ot(e,t){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ot(e,t)}function Bt(e){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Bt(e)}function Nt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Nt=function(){return!!e})()}function Vt(e,t){if(t&&("object"==Ct(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ut(e){return function(e){if(Array.isArray(e))return At(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Mt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var jt=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(Ir){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),$t=Math.abs,Ht=String.fromCharCode,qt=Object.assign;function Zt(e){return e.trim()}function Gt(e,t,n){return e.replace(t,n)}function Wt(e,t){return e.indexOf(t)}function Kt(e,t){return 0|e.charCodeAt(t)}function Xt(e,t,n){return e.slice(t,n)}function Yt(e){return e.length}function Jt(e){return e.length}function Qt(e,t){return t.push(e),e}var en=1,tn=1,nn=0,rn=0,an=0,on="";function sn(e,t,n,i,r,a,o){return{value:e,root:t,parent:n,type:i,props:r,children:a,line:en,column:tn,length:o,return:""}}function ln(e,t){return qt(sn("",null,null,"",null,null,0),e,{length:-e.length},t)}function cn(){return an=rn>0?Kt(on,--rn):0,tn--,10===an&&(tn=1,en--),an}function un(){return an=rn<nn?Kt(on,rn++):0,tn++,10===an&&(tn=1,en++),an}function hn(){return Kt(on,rn)}function dn(){return rn}function pn(e,t){return Xt(on,e,t)}function fn(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function mn(e){return en=tn=1,nn=Yt(on=e),rn=0,[]}function gn(e){return on="",e}function yn(e){return Zt(pn(rn-1,xn(91===e?e+2:40===e?e+1:e)))}function _n(e){for(;(an=hn())&&an<33;)un();return fn(e)>2||fn(an)>3?"":" "}function vn(e,t){for(;--t&&un()&&!(an<48||an>102||an>57&&an<65||an>70&&an<97););return pn(e,dn()+(t<6&&32==hn()&&32==un()))}function xn(e){for(;un();)switch(an){case e:return rn;case 34:case 39:34!==e&&39!==e&&xn(an);break;case 40:41===e&&xn(e);break;case 92:un()}return rn}function bn(e,t){for(;un()&&e+an!==57&&(e+an!==84||47!==hn()););return"/*"+pn(t,rn-1)+"*"+Ht(47===e?e:un())}function wn(e){for(;!fn(hn());)un();return pn(e,rn)}var Sn="-ms-",Tn="-moz-",Cn="-webkit-",In="comm",kn="rule",En="decl",Pn="@keyframes";function An(e,t){for(var n="",i=Jt(e),r=0;r<i;r++)n+=t(e[r],r,e,t)||"";return n}function Mn(e,t,n,i){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case En:return e.return=e.return||e.value;case In:return"";case Pn:return e.return=e.value+"{"+An(e.children,i)+"}";case kn:e.value=e.props.join(",")}return Yt(n=An(e.children,i))?e.return=e.value+"{"+n+"}":""}function zn(e){return gn(Ln("",null,null,null,[""],e=mn(e),0,[0],e))}function Ln(e,t,n,i,r,a,o,s,l){for(var c=0,u=0,h=o,d=0,p=0,f=0,m=1,g=1,y=1,_=0,v="",x=r,b=a,w=i,S=v;g;)switch(f=_,_=un()){case 40:if(108!=f&&58==Kt(S,h-1)){-1!=Wt(S+=Gt(yn(_),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:S+=yn(_);break;case 9:case 10:case 13:case 32:S+=_n(f);break;case 92:S+=vn(dn()-1,7);continue;case 47:switch(hn()){case 42:case 47:Qt(Rn(bn(un(),dn()),t,n),l);break;default:S+="/"}break;case 123*m:s[c++]=Yt(S)*y;case 125*m:case 59:case 0:switch(_){case 0:case 125:g=0;case 59+u:-1==y&&(S=Gt(S,/\f/g,"")),p>0&&Yt(S)-h&&Qt(p>32?Fn(S+";",i,n,h-1):Fn(Gt(S," ","")+";",i,n,h-2),l);break;case 59:S+=";";default:if(Qt(w=Dn(S,t,n,c,u,r,s,v,x=[],b=[],h),a),123===_)if(0===u)Ln(S,t,w,w,x,a,h,s,b);else switch(99===d&&110===Kt(S,3)?100:d){case 100:case 108:case 109:case 115:Ln(e,w,w,i&&Qt(Dn(e,w,w,0,0,r,s,v,r,x=[],h),b),r,b,h,s,i?x:b);break;default:Ln(S,w,w,w,[""],b,0,s,b)}}c=u=p=0,m=y=1,v=S="",h=o;break;case 58:h=1+Yt(S),p=f;default:if(m<1)if(123==_)--m;else if(125==_&&0==m++&&125==cn())continue;switch(S+=Ht(_),_*m){case 38:y=u>0?1:(S+="\f",-1);break;case 44:s[c++]=(Yt(S)-1)*y,y=1;break;case 64:45===hn()&&(S+=yn(un())),d=hn(),u=h=Yt(v=S+=wn(dn())),_++;break;case 45:45===f&&2==Yt(S)&&(m=0)}}return a}function Dn(e,t,n,i,r,a,o,s,l,c,u){for(var h=r-1,d=0===r?a:[""],p=Jt(d),f=0,m=0,g=0;f<i;++f)for(var y=0,_=Xt(e,h+1,h=$t(m=o[f])),v=e;y<p;++y)(v=Zt(m>0?d[y]+" "+_:Gt(_,/&\f/g,d[y])))&&(l[g++]=v);return sn(e,t,n,0===r?kn:s,l,c,u)}function Rn(e,t,n){return sn(e,t,n,In,Ht(an),Xt(e,2,-2),0)}function Fn(e,t,n,i){return sn(e,t,n,En,Xt(e,0,i),Xt(e,i+1,-1),i)}var On=function(e,t,n){for(var i=0,r=0;i=r,r=hn(),38===i&&12===r&&(t[n]=1),!fn(r);)un();return pn(e,rn)},Bn=function(e,t){return gn(function(e,t){var n=-1,i=44;do{switch(fn(i)){case 0:38===i&&12===hn()&&(t[n]=1),e[n]+=On(rn-1,t,n);break;case 2:e[n]+=yn(i);break;case 4:if(44===i){e[++n]=58===hn()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Ht(i)}}while(i=un());return e}(mn(e),t))},Nn=new WeakMap,Vn=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Nn.get(n))&&!i){Nn.set(e,!0);for(var r=[],a=Bn(t,r),o=n.props,s=0,l=0;s<a.length;s++)for(var c=0;c<o.length;c++,l++)e.props[l]=r[s]?a[s].replace(/&\f/g,o[c]):o[c]+" "+a[s]}}},Un=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function jn(e,t){switch(function(e,t){return 45^Kt(e,0)?(((t<<2^Kt(e,0))<<2^Kt(e,1))<<2^Kt(e,2))<<2^Kt(e,3):0}(e,t)){case 5103:return Cn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Cn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Cn+e+Tn+e+Sn+e+e;case 6828:case 4268:return Cn+e+Sn+e+e;case 6165:return Cn+e+Sn+"flex-"+e+e;case 5187:return Cn+e+Gt(e,/(\w+).+(:[^]+)/,Cn+"box-$1$2"+Sn+"flex-$1$2")+e;case 5443:return Cn+e+Sn+"flex-item-"+Gt(e,/flex-|-self/,"")+e;case 4675:return Cn+e+Sn+"flex-line-pack"+Gt(e,/align-content|flex-|-self/,"")+e;case 5548:return Cn+e+Sn+Gt(e,"shrink","negative")+e;case 5292:return Cn+e+Sn+Gt(e,"basis","preferred-size")+e;case 6060:return Cn+"box-"+Gt(e,"-grow","")+Cn+e+Sn+Gt(e,"grow","positive")+e;case 4554:return Cn+Gt(e,/([^-])(transform)/g,"$1"+Cn+"$2")+e;case 6187:return Gt(Gt(Gt(e,/(zoom-|grab)/,Cn+"$1"),/(image-set)/,Cn+"$1"),e,"")+e;case 5495:case 3959:return Gt(e,/(image-set\([^]*)/,Cn+"$1$`$1");case 4968:return Gt(Gt(e,/(.+:)(flex-)?(.*)/,Cn+"box-pack:$3"+Sn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Cn+e+e;case 4095:case 3583:case 4068:case 2532:return Gt(e,/(.+)-inline(.+)/,Cn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Yt(e)-1-t>6)switch(Kt(e,t+1)){case 109:if(45!==Kt(e,t+4))break;case 102:return Gt(e,/(.+:)(.+)-([^]+)/,"$1"+Cn+"$2-$3$1"+Tn+(108==Kt(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Wt(e,"stretch")?jn(Gt(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Kt(e,t+1))break;case 6444:switch(Kt(e,Yt(e)-3-(~Wt(e,"!important")&&10))){case 107:return Gt(e,":",":"+Cn)+e;case 101:return Gt(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Cn+(45===Kt(e,14)?"inline-":"")+"box$3$1"+Cn+"$2$3$1"+Sn+"$2box$3")+e}break;case 5936:switch(Kt(e,t+11)){case 114:return Cn+e+Sn+Gt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Cn+e+Sn+Gt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Cn+e+Sn+Gt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Cn+e+Sn+e+e}return e}var $n=[function(e,t,n,i){if(e.length>-1&&!e.return)switch(e.type){case En:e.return=jn(e.value,e.length);break;case Pn:return An([ln(e,{value:Gt(e.value,"@","@"+Cn)})],i);case kn:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return An([ln(e,{props:[Gt(t,/:(read-\w+)/,":-moz-$1")]})],i);case"::placeholder":return An([ln(e,{props:[Gt(t,/:(plac\w+)/,":"+Cn+"input-$1")]}),ln(e,{props:[Gt(t,/:(plac\w+)/,":-moz-$1")]}),ln(e,{props:[Gt(t,/:(plac\w+)/,Sn+"input-$1")]})],i)}return""}))}}],Hn=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var i,r,a=e.stylisPlugins||$n,o={},s=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;s.push(e)}));var l,c,u=[Mn,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=Jt(e);return function(n,i,r,a){for(var o="",s=0;s<t;s++)o+=e[s](n,i,r,a)||"";return o}}([Vn,Un].concat(a,u));r=function(e,t,n,i){l=n,An(zn(e?e+"{"+t.styles+"}":t.styles),h),i&&(d.inserted[t.name]=!0)};var d={key:t,sheet:new jt({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:r};return d.sheet.hydrate(s),d};var qn=function(e,t,n){var i=e.key+"-"+t.name;!1===n&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};var Zn={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Gn(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var Wn=!1,Kn=/[A-Z]|^ms/g,Xn=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Yn=function(e){return 45===e.charCodeAt(1)},Jn=function(e){return null!=e&&"boolean"!==typeof e},Qn=Gn((function(e){return Yn(e)?e:e.replace(Kn,"-$&").toLowerCase()})),ei=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(Xn,(function(e,t,n){return ii={name:t,styles:n,next:ii},t}))}return 1===Zn[e]||Yn(e)||"number"!==typeof t||0===t?t:t+"px"},ti="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function ni(e,t,n){if(null==n)return"";var i=n;if(void 0!==i.__emotion_styles)return i;switch(typeof n){case"boolean":return"";case"object":var r=n;if(1===r.anim)return ii={name:r.name,styles:r.styles,next:ii},r.name;var a=n;if(void 0!==a.styles){var o=a.next;if(void 0!==o)for(;void 0!==o;)ii={name:o.name,styles:o.styles,next:ii},o=o.next;return a.styles+";"}return function(e,t,n){var i="";if(Array.isArray(n))for(var r=0;r<n.length;r++)i+=ni(e,t,n[r])+";";else for(var a in n){var o=n[a];if("object"!==typeof o){var s=o;null!=t&&void 0!==t[s]?i+=a+"{"+t[s]+"}":Jn(s)&&(i+=Qn(a)+":"+ei(a,s)+";")}else{if("NO_COMPONENT_SELECTOR"===a&&Wn)throw new Error(ti);if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var l=ni(e,t,o);switch(a){case"animation":case"animationName":i+=Qn(a)+":"+l+";";break;default:i+=a+"{"+l+"}"}}else for(var c=0;c<o.length;c++)Jn(o[c])&&(i+=Qn(a)+":"+ei(a,o[c])+";")}}return i}(e,t,n);case"function":if(void 0!==e){var s=ii,l=n(e);return ii=s,ni(e,t,l)}}var c=n;if(null==t)return c;var u=t[c];return void 0!==u?u:c}var ii,ri=/label:\s*([^\s;\n{]+)\s*(;|$)/g;function ai(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var i=!0,r="";ii=void 0;var a=e[0];null==a||void 0===a.raw?(i=!1,r+=ni(n,t,a)):r+=a[0];for(var o=1;o<e.length;o++){if(r+=ni(n,t,e[o]),i)r+=a[o]}ri.lastIndex=0;for(var s,l="";null!==(s=ri.exec(r));)l+="-"+s[1];var c=function(e){for(var t,n=0,i=0,r=e.length;r>=4;++i,r-=4)t=1540483477*(65535&(t=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(r){case 3:n^=(255&e.charCodeAt(i+2))<<16;case 2:n^=(255&e.charCodeAt(i+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(i)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(r)+l;return{name:c,styles:r,next:ii}}var oi=!!t.useInsertionEffect&&t.useInsertionEffect,si=oi||function(e){return e()},li=(oi||e.useLayoutEffect,e.createContext("undefined"!==typeof HTMLElement?Hn({key:"css"}):null)),ci=(li.Provider,function(t){return(0,e.forwardRef)((function(n,i){var r=(0,e.useContext)(li);return t(n,r,i)}))}),ui=e.createContext({});var hi={}.hasOwnProperty,di="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",pi=function(e){var t=e.cache,n=e.serialized,i=e.isStringTag;return qn(t,n,i),si((function(){return function(e,t,n){qn(e,t,n);var i=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r=t;do{e.insert(t===r?"."+i:"",r,e.sheet,!0),r=r.next}while(void 0!==r)}}(t,n,i)})),null},fi=ci((function(t,n,i){var r=t.css;"string"===typeof r&&void 0!==n.registered[r]&&(r=n.registered[r]);var a=t[di],o=[r],s="";"string"===typeof t.className?s=function(e,t,n){var i="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):i+=n+" "})),i}(n.registered,o,t.className):null!=t.className&&(s=t.className+" ");var l=ai(o,void 0,e.useContext(ui));s+=n.key+"-"+l.name;var c={};for(var u in t)hi.call(t,u)&&"css"!==u&&u!==di&&(c[u]=t[u]);return c.className=s,i&&(c.ref=i),e.createElement(e.Fragment,null,e.createElement(pi,{cache:n,serialized:l,isStringTag:"string"===typeof a}),e.createElement(a,c))})),mi=fi,gi=(n(219),function(t,n){var i=arguments;if(null==n||!hi.call(n,"css"))return e.createElement.apply(void 0,i);var r=i.length,a=new Array(r);a[0]=mi,a[1]=function(e,t){var n={};for(var i in t)hi.call(t,i)&&(n[i]=t[i]);return n[di]=e,n}(t,n);for(var o=2;o<r;o++)a[o]=i[o];return e.createElement.apply(null,a)});function yi(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ai(t)}var _i=n(950);const vi=Math.min,xi=Math.max,bi=Math.round,wi=Math.floor,Si=e=>({x:e,y:e});function Ti(e){const{x:t,y:n,width:i,height:r}=e;return{width:i,height:r,top:n,left:t,right:t+i,bottom:n+r,x:t,y:n}}function Ci(e){return Ei(e)?(e.nodeName||"").toLowerCase():"#document"}function Ii(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function ki(e){var t;return null==(t=(Ei(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Ei(e){return e instanceof Node||e instanceof Ii(e).Node}function Pi(e){return e instanceof Element||e instanceof Ii(e).Element}function Ai(e){return e instanceof HTMLElement||e instanceof Ii(e).HTMLElement}function Mi(e){return"undefined"!==typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof Ii(e).ShadowRoot)}function zi(e){const{overflow:t,overflowX:n,overflowY:i,display:r}=Ri(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(r)}function Li(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function Di(e){return["html","body","#document"].includes(Ci(e))}function Ri(e){return Ii(e).getComputedStyle(e)}function Fi(e){if("html"===Ci(e))return e;const t=e.assignedSlot||e.parentNode||Mi(e)&&e.host||ki(e);return Mi(t)?t.host:t}function Oi(e){const t=Fi(e);return Di(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ai(t)&&zi(t)?t:Oi(t)}function Bi(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=Oi(e),a=r===(null==(i=e.ownerDocument)?void 0:i.body),o=Ii(r);if(a){const e=Ni(o);return t.concat(o,o.visualViewport||[],zi(r)?r:[],e&&n?Bi(e):[])}return t.concat(r,Bi(r,[],n))}function Ni(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Vi(e){const t=Ri(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=Ai(e),a=r?e.offsetWidth:n,o=r?e.offsetHeight:i,s=bi(n)!==a||bi(i)!==o;return s&&(n=a,i=o),{width:n,height:i,$:s}}function Ui(e){return Pi(e)?e:e.contextElement}function ji(e){const t=Ui(e);if(!Ai(t))return Si(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:a}=Vi(t);let o=(a?bi(n.width):n.width)/i,s=(a?bi(n.height):n.height)/r;return o&&Number.isFinite(o)||(o=1),s&&Number.isFinite(s)||(s=1),{x:o,y:s}}const $i=Si(0);function Hi(e){const t=Ii(e);return Li()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:$i}function qi(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),a=Ui(e);let o=Si(1);t&&(i?Pi(i)&&(o=ji(i)):o=ji(e));const s=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Ii(e))&&t}(a,n,i)?Hi(a):Si(0);let l=(r.left+s.x)/o.x,c=(r.top+s.y)/o.y,u=r.width/o.x,h=r.height/o.y;if(a){const e=Ii(a),t=i&&Pi(i)?Ii(i):i;let n=e,r=Ni(n);for(;r&&i&&t!==n;){const e=ji(r),t=r.getBoundingClientRect(),i=Ri(r),a=t.left+(r.clientLeft+parseFloat(i.paddingLeft))*e.x,o=t.top+(r.clientTop+parseFloat(i.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,h*=e.y,l+=a,c+=o,n=Ii(r),r=Ni(n)}}return Ti({width:u,height:h,x:l,y:c})}function Zi(e,t,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:a=!0,elementResize:o="function"===typeof ResizeObserver,layoutShift:s="function"===typeof IntersectionObserver,animationFrame:l=!1}=i,c=Ui(e),u=r||a?[...c?Bi(c):[],...Bi(t)]:[];u.forEach((e=>{r&&e.addEventListener("scroll",n,{passive:!0}),a&&e.addEventListener("resize",n)}));const h=c&&s?function(e,t){let n,i=null;const r=ki(e);function a(){var e;clearTimeout(n),null==(e=i)||e.disconnect(),i=null}return function o(s,l){void 0===s&&(s=!1),void 0===l&&(l=1),a();const{left:c,top:u,width:h,height:d}=e.getBoundingClientRect();if(s||t(),!h||!d)return;const p={rootMargin:-wi(u)+"px "+-wi(r.clientWidth-(c+h))+"px "+-wi(r.clientHeight-(u+d))+"px "+-wi(c)+"px",threshold:xi(0,vi(1,l))||1};let f=!0;function m(e){const t=e[0].intersectionRatio;if(t!==l){if(!f)return o();t?o(!1,t):n=setTimeout((()=>{o(!1,1e-7)}),1e3)}f=!1}try{i=new IntersectionObserver(m,{...p,root:r.ownerDocument})}catch(Ir){i=new IntersectionObserver(m,p)}i.observe(e)}(!0),a}(c,n):null;let d,p=-1,f=null;o&&(f=new ResizeObserver((e=>{let[i]=e;i&&i.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame((()=>{var e;null==(e=f)||e.observe(t)}))),n()})),c&&!l&&f.observe(c),f.observe(t));let m=l?qi(e):null;return l&&function t(){const i=qi(e);!m||i.x===m.x&&i.y===m.y&&i.width===m.width&&i.height===m.height||n();m=i,d=requestAnimationFrame(t)}(),n(),()=>{var e;u.forEach((e=>{r&&e.removeEventListener("scroll",n),a&&e.removeEventListener("resize",n)})),null==h||h(),null==(e=f)||e.disconnect(),f=null,l&&cancelAnimationFrame(d)}}const Gi=e.useLayoutEffect;var Wi=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Ki=function(){};function Xi(e,t){return t?"-"===t[0]?e+t:e+"__"+t:e}function Yi(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];var a=[].concat(i);if(t&&e)for(var o in t)t.hasOwnProperty(o)&&t[o]&&a.push("".concat(Xi(e,o)));return a.filter((function(e){return e})).map((function(e){return String(e).trim()})).join(" ")}var Ji=function(e){return t=e,Array.isArray(t)?e.filter(Boolean):"object"===Ct(e)&&null!==e?[e]:[];var t},Qi=function(e){return e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme,Pt({},Lt(e,Wi))},er=function(e,t,n){var i=e.cx,r=e.getStyles,a=e.getClassNames,o=e.className;return{css:r(t,e),className:i(null!==n&&void 0!==n?n:{},a(t,e),o)}};function tr(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function nr(e){return tr(e)?window.pageYOffset:e.scrollTop}function ir(e,t){tr(e)?window.scrollTo(0,t):e.scrollTop=t}function rr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ki,r=nr(e),a=t-r,o=0;!function t(){var s=function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t}(o+=10,r,a,n);ir(e,s),o<n?window.requestAnimationFrame(t):i(e)}()}function ar(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=t.offsetHeight/3;i.bottom+r>n.bottom?ir(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+r,e.scrollHeight)):i.top-r<n.top&&ir(e,Math.max(t.offsetTop-r,0))}function or(){try{return document.createEvent("TouchEvent"),!0}catch(Ir){return!1}}var sr=!1,lr={get passive(){return sr=!0}},cr="undefined"!==typeof window?window:{};cr.addEventListener&&cr.removeEventListener&&(cr.addEventListener("p",Ki,lr),cr.removeEventListener("p",Ki,!1));var ur=sr;function hr(e){return null!=e}function dr(e,t,n){return e?t:n}var pr=["children","innerProps"],fr=["children","innerProps"];function mr(e){var t=e.maxHeight,n=e.menuEl,i=e.minHeight,r=e.placement,a=e.shouldScroll,o=e.isFixedPosition,s=e.controlHeight,l=function(e){var t=getComputedStyle(e),n="absolute"===t.position,i=/(auto|scroll)/;if("fixed"===t.position)return document.documentElement;for(var r=e;r=r.parentElement;)if(t=getComputedStyle(r),(!n||"static"!==t.position)&&i.test(t.overflow+t.overflowY+t.overflowX))return r;return document.documentElement}(n),c={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return c;var u,h=l.getBoundingClientRect().height,d=n.getBoundingClientRect(),p=d.bottom,f=d.height,m=d.top,g=n.offsetParent.getBoundingClientRect().top,y=o?window.innerHeight:tr(u=l)?window.innerHeight:u.clientHeight,_=nr(l),v=parseInt(getComputedStyle(n).marginBottom,10),x=parseInt(getComputedStyle(n).marginTop,10),b=g-x,w=y-m,S=b+_,T=h-_-m,C=p-y+_+v,I=_+m-x,k=160;switch(r){case"auto":case"bottom":if(w>=f)return{placement:"bottom",maxHeight:t};if(T>=f&&!o)return a&&rr(l,C,k),{placement:"bottom",maxHeight:t};if(!o&&T>=i||o&&w>=i)return a&&rr(l,C,k),{placement:"bottom",maxHeight:o?w-v:T-v};if("auto"===r||o){var E=t,P=o?b:S;return P>=i&&(E=Math.min(P-v-s,t)),{placement:"top",maxHeight:E}}if("bottom"===r)return a&&ir(l,C),{placement:"bottom",maxHeight:t};break;case"top":if(b>=f)return{placement:"top",maxHeight:t};if(S>=f&&!o)return a&&rr(l,I,k),{placement:"top",maxHeight:t};if(!o&&S>=i||o&&b>=i){var A=t;return(!o&&S>=i||o&&b>=i)&&(A=o?b-x:S-x),a&&rr(l,I,k),{placement:"top",maxHeight:A}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(r,'".'))}return c}var gr,yr=function(e){return"auto"===e?"bottom":e},_r=(0,e.createContext)(null),vr=function(t){var n=t.children,i=t.minMenuHeight,r=t.maxMenuHeight,a=t.menuPlacement,o=t.menuPosition,s=t.menuShouldScrollIntoView,l=t.theme,c=((0,e.useContext)(_r)||{}).setPortalPlacement,u=(0,e.useRef)(null),h=zt((0,e.useState)(r),2),d=h[0],p=h[1],f=zt((0,e.useState)(null),2),m=f[0],g=f[1],y=l.spacing.controlHeight;return Gi((function(){var e=u.current;if(e){var t="fixed"===o,n=mr({maxHeight:r,menuEl:e,minHeight:i,placement:a,shouldScroll:s&&!t,isFixedPosition:t,controlHeight:y});p(n.maxHeight),g(n.placement),null===c||void 0===c||c(n.placement)}}),[r,a,o,s,i,c,y]),n({ref:u,placerProps:Pt(Pt({},t),{},{placement:m||yr(a),maxHeight:d})})},xr=function(e){var t=e.children,n=e.innerRef,i=e.innerProps;return gi("div",Rt({},er(e,"menu",{menu:!0}),{ref:n},i),t)},br=function(e,t){var n=e.theme,i=n.spacing.baseUnit,r=n.colors;return Pt({textAlign:"center"},t?{}:{color:r.neutral40,padding:"".concat(2*i,"px ").concat(3*i,"px")})},wr=br,Sr=br,Tr=["size"],Cr=["innerProps","isRtl","size"];var Ir,kr,Er={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Pr=function(e){var t=e.size,n=Lt(e,Tr);return gi("svg",Rt({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Er},n))},Ar=function(e){return gi(Pr,Rt({size:20},e),gi("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Mr=function(e){return gi(Pr,Rt({size:20},e),gi("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},zr=function(e,t){var n=e.isFocused,i=e.theme,r=i.spacing.baseUnit,a=i.colors;return Pt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},t?{}:{color:n?a.neutral60:a.neutral20,padding:2*r,":hover":{color:n?a.neutral80:a.neutral40}})},Lr=zr,Dr=zr,Rr=function(){var e=yi.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}(gr||(Ir=["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"],kr||(kr=Ir.slice(0)),gr=Object.freeze(Object.defineProperties(Ir,{raw:{value:Object.freeze(kr)}})))),Fr=function(e){var t=e.delay,n=e.offset;return gi("span",{css:yi({animation:"".concat(Rr," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Or=function(e){var t=e.children,n=e.isDisabled,i=e.isFocused,r=e.innerRef,a=e.innerProps,o=e.menuIsOpen;return gi("div",Rt({ref:r},er(e,"control",{control:!0,"control--is-disabled":n,"control--is-focused":i,"control--menu-is-open":o}),a,{"aria-disabled":n||void 0}),t)},Br=["data"],Nr=function(e){var t=e.children,n=e.cx,i=e.getStyles,r=e.getClassNames,a=e.Heading,o=e.headingProps,s=e.innerProps,l=e.label,c=e.theme,u=e.selectProps;return gi("div",Rt({},er(e,"group",{group:!0}),s),gi(a,Rt({},o,{selectProps:u,theme:c,getStyles:i,getClassNames:r,cx:n}),l),gi("div",null,t))},Vr=["innerRef","isDisabled","isHidden","inputClassName"],Ur={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},jr={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Pt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Ur)},$r=function(e){return Pt({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},Ur)},Hr=function(e){var t=e.children,n=e.innerProps;return gi("div",n,t)};var qr=function(e){var t=e.children,n=e.components,i=e.data,r=e.innerProps,a=e.isDisabled,o=e.removeProps,s=e.selectProps,l=n.Container,c=n.Label,u=n.Remove;return gi(l,{data:i,innerProps:Pt(Pt({},er(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":a})),r),selectProps:s},gi(c,{data:i,innerProps:Pt({},er(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:s},t),gi(u,{data:i,innerProps:Pt(Pt({},er(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(t||"option")},o),selectProps:s}))},Zr={ClearIndicator:function(e){var t=e.children,n=e.innerProps;return gi("div",Rt({},er(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),t||gi(Ar,null))},Control:Or,DropdownIndicator:function(e){var t=e.children,n=e.innerProps;return gi("div",Rt({},er(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),t||gi(Mr,null))},DownChevron:Mr,CrossIcon:Ar,Group:Nr,GroupHeading:function(e){var t=Qi(e);t.data;var n=Lt(t,Br);return gi("div",Rt({},er(e,"groupHeading",{"group-heading":!0}),n))},IndicatorsContainer:function(e){var t=e.children,n=e.innerProps;return gi("div",Rt({},er(e,"indicatorsContainer",{indicators:!0}),n),t)},IndicatorSeparator:function(e){var t=e.innerProps;return gi("span",Rt({},t,er(e,"indicatorSeparator",{"indicator-separator":!0})))},Input:function(e){var t=e.cx,n=e.value,i=Qi(e),r=i.innerRef,a=i.isDisabled,o=i.isHidden,s=i.inputClassName,l=Lt(i,Vr);return gi("div",Rt({},er(e,"input",{"input-container":!0}),{"data-value":n||""}),gi("input",Rt({className:t({input:!0},s),ref:r,style:$r(o),disabled:a},l)))},LoadingIndicator:function(e){var t=e.innerProps,n=e.isRtl,i=e.size,r=void 0===i?4:i,a=Lt(e,Cr);return gi("div",Rt({},er(Pt(Pt({},a),{},{innerProps:t,isRtl:n,size:r}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),t),gi(Fr,{delay:0,offset:n}),gi(Fr,{delay:160,offset:!0}),gi(Fr,{delay:320,offset:!n}))},Menu:xr,MenuList:function(e){var t=e.children,n=e.innerProps,i=e.innerRef,r=e.isMulti;return gi("div",Rt({},er(e,"menuList",{"menu-list":!0,"menu-list--is-multi":r}),{ref:i},n),t)},MenuPortal:function(t){var n=t.appendTo,i=t.children,r=t.controlElement,a=t.innerProps,o=t.menuPlacement,s=t.menuPosition,l=(0,e.useRef)(null),c=(0,e.useRef)(null),u=zt((0,e.useState)(yr(o)),2),h=u[0],d=u[1],p=(0,e.useMemo)((function(){return{setPortalPlacement:d}}),[]),f=zt((0,e.useState)(null),2),m=f[0],g=f[1],y=(0,e.useCallback)((function(){if(r){var e=function(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}(r),t="fixed"===s?0:window.pageYOffset,n=e[h]+t;n===(null===m||void 0===m?void 0:m.offset)&&e.left===(null===m||void 0===m?void 0:m.rect.left)&&e.width===(null===m||void 0===m?void 0:m.rect.width)||g({offset:n,rect:e})}}),[r,s,h,null===m||void 0===m?void 0:m.offset,null===m||void 0===m?void 0:m.rect.left,null===m||void 0===m?void 0:m.rect.width]);Gi((function(){y()}),[y]);var _=(0,e.useCallback)((function(){"function"===typeof c.current&&(c.current(),c.current=null),r&&l.current&&(c.current=Zi(r,l.current,y,{elementResize:"ResizeObserver"in window}))}),[r,y]);Gi((function(){_()}),[_]);var v=(0,e.useCallback)((function(e){l.current=e,_()}),[_]);if(!n&&"fixed"!==s||!m)return null;var x=gi("div",Rt({ref:v},er(Pt(Pt({},t),{},{offset:m.offset,position:s,rect:m.rect}),"menuPortal",{"menu-portal":!0}),a),i);return gi(_r.Provider,{value:p},n?(0,_i.createPortal)(x,n):x)},LoadingMessage:function(e){var t=e.children,n=void 0===t?"Loading...":t,i=e.innerProps,r=Lt(e,fr);return gi("div",Rt({},er(Pt(Pt({},r),{},{children:n,innerProps:i}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),i),n)},NoOptionsMessage:function(e){var t=e.children,n=void 0===t?"No options":t,i=e.innerProps,r=Lt(e,pr);return gi("div",Rt({},er(Pt(Pt({},r),{},{children:n,innerProps:i}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),i),n)},MultiValue:qr,MultiValueContainer:Hr,MultiValueLabel:Hr,MultiValueRemove:function(e){var t=e.children,n=e.innerProps;return gi("div",Rt({role:"button"},n),t||gi(Ar,{size:14}))},Option:function(e){var t=e.children,n=e.isDisabled,i=e.isFocused,r=e.isSelected,a=e.innerRef,o=e.innerProps;return gi("div",Rt({},er(e,"option",{option:!0,"option--is-disabled":n,"option--is-focused":i,"option--is-selected":r}),{ref:a,"aria-disabled":n},o),t)},Placeholder:function(e){var t=e.children,n=e.innerProps;return gi("div",Rt({},er(e,"placeholder",{placeholder:!0}),n),t)},SelectContainer:function(e){var t=e.children,n=e.innerProps,i=e.isDisabled,r=e.isRtl;return gi("div",Rt({},er(e,"container",{"--is-disabled":i,"--is-rtl":r}),n),t)},SingleValue:function(e){var t=e.children,n=e.isDisabled,i=e.innerProps;return gi("div",Rt({},er(e,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),i),t)},ValueContainer:function(e){var t=e.children,n=e.innerProps,i=e.isMulti,r=e.hasValue;return gi("div",Rt({},er(e,"valueContainer",{"value-container":!0,"value-container--is-multi":i,"value-container--has-value":r}),n),t)}},Gr=Number.isNaN||function(e){return"number"===typeof e&&e!==e};function Wr(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(i=e[n],r=t[n],!(i===r||Gr(i)&&Gr(r)))return!1;var i,r;return!0}for(var Kr={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},Xr=function(e){return gi("span",Rt({css:Kr},e))},Yr={guidance:function(e){var t=e.isSearchable,n=e.isMulti,i=e.tabSelectsValue,r=e.context,a=e.isInitialFocus;switch(r){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return a?"".concat(e["aria-label"]||"Select"," is focused ").concat(t?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var t=e.action,n=e.label,i=void 0===n?"":n,r=e.labels,a=e.isDisabled;switch(t){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(i,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(r.length>1?"s":""," ").concat(r.join(","),", selected.");case"select-option":return"option ".concat(i,a?" is disabled. Select another option.":", selected.");default:return""}},onFocus:function(e){var t=e.context,n=e.focused,i=e.options,r=e.label,a=void 0===r?"":r,o=e.selectValue,s=e.isDisabled,l=e.isSelected,c=e.isAppleDevice,u=function(e,t){return e&&e.length?"".concat(e.indexOf(t)+1," of ").concat(e.length):""};if("value"===t&&o)return"value ".concat(a," focused, ").concat(u(o,n),".");if("menu"===t&&c){var h=s?" disabled":"",d="".concat(l?" selected":"").concat(h);return"".concat(a).concat(d,", ").concat(u(i,n),".")}return""},onFilter:function(e){var t=e.inputValue,n=e.resultsMessage;return"".concat(n).concat(t?" for search term "+t:"",".")}},Jr=function(t){var n=t.ariaSelection,i=t.focusedOption,r=t.focusedValue,a=t.focusableOptions,o=t.isFocused,s=t.selectValue,l=t.selectProps,c=t.id,u=t.isAppleDevice,h=l.ariaLiveMessages,d=l.getOptionLabel,p=l.inputValue,f=l.isMulti,m=l.isOptionDisabled,g=l.isSearchable,y=l.menuIsOpen,_=l.options,v=l.screenReaderStatus,x=l.tabSelectsValue,b=l.isLoading,w=l["aria-label"],S=l["aria-live"],T=(0,e.useMemo)((function(){return Pt(Pt({},Yr),h||{})}),[h]),C=(0,e.useMemo)((function(){var e,t="";if(n&&T.onChange){var i=n.option,r=n.options,a=n.removedValue,o=n.removedValues,l=n.value,c=a||i||(e=l,Array.isArray(e)?null:e),u=c?d(c):"",h=r||o||void 0,p=h?h.map(d):[],f=Pt({isDisabled:c&&m(c,s),label:u,labels:p},n);t=T.onChange(f)}return t}),[n,T,m,s,d]),I=(0,e.useMemo)((function(){var e="",t=i||r,n=!!(i&&s&&s.includes(i));if(t&&T.onFocus){var o={focused:t,label:d(t),isDisabled:m(t,s),isSelected:n,options:a,context:t===i?"menu":"value",selectValue:s,isAppleDevice:u};e=T.onFocus(o)}return e}),[i,r,d,m,T,a,s,u]),k=(0,e.useMemo)((function(){var e="";if(y&&_.length&&!b&&T.onFilter){var t=v({count:a.length});e=T.onFilter({inputValue:p,resultsMessage:t})}return e}),[a,p,y,T,_,v,b]),E="initial-input-focus"===(null===n||void 0===n?void 0:n.action),P=(0,e.useMemo)((function(){var e="";if(T.guidance){var t=r?"value":y?"menu":"input";e=T.guidance({"aria-label":w,context:t,isDisabled:i&&m(i,s),isMulti:f,isSearchable:g,tabSelectsValue:x,isInitialFocus:E})}return e}),[w,i,r,f,m,g,y,T,s,x,E]),A=gi(e.Fragment,null,gi("span",{id:"aria-selection"},C),gi("span",{id:"aria-focused"},I),gi("span",{id:"aria-results"},k),gi("span",{id:"aria-guidance"},P));return gi(e.Fragment,null,gi(Xr,{id:c},E&&A),gi(Xr,{"aria-live":S,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!E&&A))},Qr=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],ea=new RegExp("["+Qr.map((function(e){return e.letters})).join("")+"]","g"),ta={},na=0;na<Qr.length;na++)for(var ia=Qr[na],ra=0;ra<ia.letters.length;ra++)ta[ia.letters[ra]]=ia.base;var aa=function(e){return e.replace(ea,(function(e){return ta[e]}))},oa=function(e,t){void 0===t&&(t=Wr);var n=null;function i(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];if(n&&n.lastThis===this&&t(i,n.lastArgs))return n.lastResult;var a=e.apply(this,i);return n={lastResult:a,lastArgs:i,lastThis:this},a}return i.clear=function(){n=null},i}(aa),sa=function(e){return e.replace(/^\s+|\s+$/g,"")},la=function(e){return"".concat(e.label," ").concat(e.value)},ca=["innerRef"];function ua(e){var t=e.innerRef,n=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=Object.entries(e).filter((function(e){var t=zt(e,1)[0];return!n.includes(t)}));return r.reduce((function(e,t){var n=zt(t,2),i=n[0],r=n[1];return e[i]=r,e}),{})}(Lt(e,ca),"onExited","in","enter","exit","appear");return gi("input",Rt({ref:t},n,{css:yi({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var ha=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};var da=["boxSizing","height","overflow","paddingRight","position"],pa={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function fa(e){e.preventDefault()}function ma(e){e.stopPropagation()}function ga(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;0===e?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function ya(){return"ontouchstart"in window||navigator.maxTouchPoints}var _a=!("undefined"===typeof window||!window.document||!window.document.createElement),va=0,xa={capture:!1,passive:!1};var ba=function(e){var t=e.target;return t.ownerDocument.activeElement&&t.ownerDocument.activeElement.blur()},wa={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function Sa(t){var n=t.children,i=t.lockEnabled,r=t.captureEnabled,a=function(t){var n=t.isEnabled,i=t.onBottomArrive,r=t.onBottomLeave,a=t.onTopArrive,o=t.onTopLeave,s=(0,e.useRef)(!1),l=(0,e.useRef)(!1),c=(0,e.useRef)(0),u=(0,e.useRef)(null),h=(0,e.useCallback)((function(e,t){if(null!==u.current){var n=u.current,c=n.scrollTop,h=n.scrollHeight,d=n.clientHeight,p=u.current,f=t>0,m=h-d-c,g=!1;m>t&&s.current&&(r&&r(e),s.current=!1),f&&l.current&&(o&&o(e),l.current=!1),f&&t>m?(i&&!s.current&&i(e),p.scrollTop=h,g=!0,s.current=!0):!f&&-t>c&&(a&&!l.current&&a(e),p.scrollTop=0,g=!0,l.current=!0),g&&ha(e)}}),[i,r,a,o]),d=(0,e.useCallback)((function(e){h(e,e.deltaY)}),[h]),p=(0,e.useCallback)((function(e){c.current=e.changedTouches[0].clientY}),[]),f=(0,e.useCallback)((function(e){var t=c.current-e.changedTouches[0].clientY;h(e,t)}),[h]),m=(0,e.useCallback)((function(e){if(e){var t=!!ur&&{passive:!1};e.addEventListener("wheel",d,t),e.addEventListener("touchstart",p,t),e.addEventListener("touchmove",f,t)}}),[f,p,d]),g=(0,e.useCallback)((function(e){e&&(e.removeEventListener("wheel",d,!1),e.removeEventListener("touchstart",p,!1),e.removeEventListener("touchmove",f,!1))}),[f,p,d]);return(0,e.useEffect)((function(){if(n){var e=u.current;return m(e),function(){g(e)}}}),[n,m,g]),function(e){u.current=e}}({isEnabled:void 0===r||r,onBottomArrive:t.onBottomArrive,onBottomLeave:t.onBottomLeave,onTopArrive:t.onTopArrive,onTopLeave:t.onTopLeave}),o=function(t){var n=t.isEnabled,i=t.accountForScrollbars,r=void 0===i||i,a=(0,e.useRef)({}),o=(0,e.useRef)(null),s=(0,e.useCallback)((function(e){if(_a){var t=document.body,n=t&&t.style;if(r&&da.forEach((function(e){var t=n&&n[e];a.current[e]=t})),r&&va<1){var i=parseInt(a.current.paddingRight,10)||0,o=document.body?document.body.clientWidth:0,s=window.innerWidth-o+i||0;Object.keys(pa).forEach((function(e){var t=pa[e];n&&(n[e]=t)})),n&&(n.paddingRight="".concat(s,"px"))}t&&ya()&&(t.addEventListener("touchmove",fa,xa),e&&(e.addEventListener("touchstart",ga,xa),e.addEventListener("touchmove",ma,xa))),va+=1}}),[r]),l=(0,e.useCallback)((function(e){if(_a){var t=document.body,n=t&&t.style;va=Math.max(va-1,0),r&&va<1&&da.forEach((function(e){var t=a.current[e];n&&(n[e]=t)})),t&&ya()&&(t.removeEventListener("touchmove",fa,xa),e&&(e.removeEventListener("touchstart",ga,xa),e.removeEventListener("touchmove",ma,xa)))}}),[r]);return(0,e.useEffect)((function(){if(n){var e=o.current;return s(e),function(){l(e)}}}),[n,s,l]),function(e){o.current=e}}({isEnabled:i});return gi(e.Fragment,null,i&&gi("div",{onClick:ba,css:wa}),n((function(e){a(e),o(e)})))}var Ta={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},Ca=function(e){var t=e.name,n=e.onFocus;return gi("input",{required:!0,name:t,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:Ta,value:"",onChange:function(){}})};function Ia(e){var t;return"undefined"!==typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform)}function ka(){return Ia(/^Mac/i)}function Ea(){return Ia(/^iPhone/i)||Ia(/^iPad/i)||ka()&&navigator.maxTouchPoints>1}var Pa={clearIndicator:Dr,container:function(e){var t=e.isDisabled;return{label:"container",direction:e.isRtl?"rtl":void 0,pointerEvents:t?"none":void 0,position:"relative"}},control:function(e,t){var n=e.isDisabled,i=e.isFocused,r=e.theme,a=r.colors,o=r.borderRadius;return Pt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:r.spacing.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},t?{}:{backgroundColor:n?a.neutral5:a.neutral0,borderColor:n?a.neutral10:i?a.primary:a.neutral20,borderRadius:o,borderStyle:"solid",borderWidth:1,boxShadow:i?"0 0 0 1px ".concat(a.primary):void 0,"&:hover":{borderColor:i?a.primary:a.neutral30}})},dropdownIndicator:Lr,group:function(e,t){var n=e.theme.spacing;return t?{}:{paddingBottom:2*n.baseUnit,paddingTop:2*n.baseUnit}},groupHeading:function(e,t){var n=e.theme,i=n.colors,r=n.spacing;return Pt({label:"group",cursor:"default",display:"block"},t?{}:{color:i.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:3*r.baseUnit,paddingRight:3*r.baseUnit,textTransform:"uppercase"})},indicatorsContainer:function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},indicatorSeparator:function(e,t){var n=e.isDisabled,i=e.theme,r=i.spacing.baseUnit,a=i.colors;return Pt({label:"indicatorSeparator",alignSelf:"stretch",width:1},t?{}:{backgroundColor:n?a.neutral10:a.neutral20,marginBottom:2*r,marginTop:2*r})},input:function(e,t){var n=e.isDisabled,i=e.value,r=e.theme,a=r.spacing,o=r.colors;return Pt(Pt({visibility:n?"hidden":"visible",transform:i?"translateZ(0)":""},jr),t?{}:{margin:a.baseUnit/2,paddingBottom:a.baseUnit/2,paddingTop:a.baseUnit/2,color:o.neutral80})},loadingIndicator:function(e,t){var n=e.isFocused,i=e.size,r=e.theme,a=r.colors,o=r.spacing.baseUnit;return Pt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:i,lineHeight:1,marginRight:i,textAlign:"center",verticalAlign:"middle"},t?{}:{color:n?a.neutral60:a.neutral20,padding:2*o})},loadingMessage:Sr,menu:function(e,t){var n,i=e.placement,r=e.theme,a=r.borderRadius,o=r.spacing,s=r.colors;return Pt((kt(n={label:"menu"},function(e){return e?{bottom:"top",top:"bottom"}[e]:"bottom"}(i),"100%"),kt(n,"position","absolute"),kt(n,"width","100%"),kt(n,"zIndex",1),n),t?{}:{backgroundColor:s.neutral0,borderRadius:a,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:o.menuGutter,marginTop:o.menuGutter})},menuList:function(e,t){var n=e.maxHeight,i=e.theme.spacing.baseUnit;return Pt({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},t?{}:{paddingBottom:i,paddingTop:i})},menuPortal:function(e){var t=e.rect,n=e.offset,i=e.position;return{left:t.left,position:i,top:n,width:t.width,zIndex:1}},multiValue:function(e,t){var n=e.theme,i=n.spacing,r=n.borderRadius,a=n.colors;return Pt({label:"multiValue",display:"flex",minWidth:0},t?{}:{backgroundColor:a.neutral10,borderRadius:r/2,margin:i.baseUnit/2})},multiValueLabel:function(e,t){var n=e.theme,i=n.borderRadius,r=n.colors,a=e.cropWithEllipsis;return Pt({overflow:"hidden",textOverflow:a||void 0===a?"ellipsis":void 0,whiteSpace:"nowrap"},t?{}:{borderRadius:i/2,color:r.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},multiValueRemove:function(e,t){var n=e.theme,i=n.spacing,r=n.borderRadius,a=n.colors,o=e.isFocused;return Pt({alignItems:"center",display:"flex"},t?{}:{borderRadius:r/2,backgroundColor:o?a.dangerLight:void 0,paddingLeft:i.baseUnit,paddingRight:i.baseUnit,":hover":{backgroundColor:a.dangerLight,color:a.danger}})},noOptionsMessage:wr,option:function(e,t){var n=e.isDisabled,i=e.isFocused,r=e.isSelected,a=e.theme,o=a.spacing,s=a.colors;return Pt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},t?{}:{backgroundColor:r?s.primary:i?s.primary25:"transparent",color:n?s.neutral20:r?s.neutral0:"inherit",padding:"".concat(2*o.baseUnit,"px ").concat(3*o.baseUnit,"px"),":active":{backgroundColor:n?void 0:r?s.primary:s.primary50}})},placeholder:function(e,t){var n=e.theme,i=n.spacing,r=n.colors;return Pt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},t?{}:{color:r.neutral50,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},singleValue:function(e,t){var n=e.isDisabled,i=e.theme,r=i.spacing,a=i.colors;return Pt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t?{}:{color:n?a.neutral40:a.neutral80,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2})},valueContainer:function(e,t){var n=e.theme.spacing,i=e.isMulti,r=e.hasValue,a=e.selectProps.controlShouldRenderValue;return Pt({alignItems:"center",display:i&&r&&a?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},t?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(2*n.baseUnit,"px")})}};var Aa={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}},Ma={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:or(),captureMenuScroll:!or(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(e){return function(t,n){if(t.data.__isNew__)return!0;var i=Pt({ignoreCase:!0,ignoreAccents:!0,stringify:la,trim:!0,matchFrom:"any"},e),r=i.ignoreCase,a=i.ignoreAccents,o=i.stringify,s=i.trim,l=i.matchFrom,c=s?sa(n):n,u=s?sa(o(t)):o(t);return r&&(c=c.toLowerCase(),u=u.toLowerCase()),a&&(c=oa(c),u=aa(u)),"start"===l?u.substr(0,c.length)===c:u.indexOf(c)>-1}}(),formatGroupLabel:function(e){return e.label},getOptionLabel:function(e){return e.label},getOptionValue:function(e){return e.value},isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:function(e){return!!e.isDisabled},loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!function(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(Ir){return!1}}(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(1!==t?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function za(e,t,n,i){return{type:"option",data:t,isDisabled:Va(e,t,n),isSelected:Ua(e,t,n),label:Ba(e,t),value:Na(e,t),index:i}}function La(e,t){return e.options.map((function(n,i){if("options"in n){var r=n.options.map((function(n,i){return za(e,n,t,i)})).filter((function(t){return Fa(e,t)}));return r.length>0?{type:"group",data:n,options:r,index:i}:void 0}var a=za(e,n,t,i);return Fa(e,a)?a:void 0})).filter(hr)}function Da(e){return e.reduce((function(e,t){return"group"===t.type?e.push.apply(e,Ut(t.options.map((function(e){return e.data})))):e.push(t.data),e}),[])}function Ra(e,t){return e.reduce((function(e,n){return"group"===n.type?e.push.apply(e,Ut(n.options.map((function(e){return{data:e.data,id:"".concat(t,"-").concat(n.index,"-").concat(e.index)}})))):e.push({data:n.data,id:"".concat(t,"-").concat(n.index)}),e}),[])}function Fa(e,t){var n=e.inputValue,i=void 0===n?"":n,r=t.data,a=t.isSelected,o=t.label,s=t.value;return(!$a(e)||!a)&&ja(e,{label:o,value:s,data:r},i)}var Oa=function(e,t){var n;return(null===(n=e.find((function(e){return e.data===t})))||void 0===n?void 0:n.id)||null},Ba=function(e,t){return e.getOptionLabel(t)},Na=function(e,t){return e.getOptionValue(t)};function Va(e,t,n){return"function"===typeof e.isOptionDisabled&&e.isOptionDisabled(t,n)}function Ua(e,t,n){if(n.indexOf(t)>-1)return!0;if("function"===typeof e.isOptionSelected)return e.isOptionSelected(t,n);var i=Na(e,t);return n.some((function(t){return Na(e,t)===i}))}function ja(e,t,n){return!e.filterOption||e.filterOption(t,n)}var $a=function(e){var t=e.hideSelectedOptions,n=e.isMulti;return void 0===t?n:t},Ha=1,qa=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ot(e,t)}(i,t);var n=function(e){var t=Nt();return function(){var n,i=Bt(e);if(t){var r=Bt(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Vt(this,n)}}(i);function i(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e)).state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},t.blockOptionHover=!1,t.isComposing=!1,t.commonProps=void 0,t.initialTouchX=0,t.initialTouchY=0,t.openAfterFocus=!1,t.scrollToFocusedOptionOnUpdate=!1,t.userIsDragging=void 0,t.isAppleDevice=ka()||Ea(),t.controlRef=null,t.getControlRef=function(e){t.controlRef=e},t.focusedOptionRef=null,t.getFocusedOptionRef=function(e){t.focusedOptionRef=e},t.menuListRef=null,t.getMenuListRef=function(e){t.menuListRef=e},t.inputRef=null,t.getInputRef=function(e){t.inputRef=e},t.focus=t.focusInput,t.blur=t.blurInput,t.onChange=function(e,n){var i=t.props,r=i.onChange,a=i.name;n.name=a,t.ariaOnChange(e,n),r(e,n)},t.setValue=function(e,n,i){var r=t.props,a=r.closeMenuOnSelect,o=r.isMulti,s=r.inputValue;t.onInputChange("",{action:"set-value",prevInputValue:s}),a&&(t.setState({inputIsHiddenAfterUpdate:!o}),t.onMenuClose()),t.setState({clearFocusValueOnUpdate:!0}),t.onChange(e,{action:n,option:i})},t.selectOption=function(e){var n=t.props,i=n.blurInputOnSelect,r=n.isMulti,a=n.name,o=t.state.selectValue,s=r&&t.isOptionSelected(e,o),l=t.isOptionDisabled(e,o);if(s){var c=t.getOptionValue(e);t.setValue(o.filter((function(e){return t.getOptionValue(e)!==c})),"deselect-option",e)}else{if(l)return void t.ariaOnChange(e,{action:"select-option",option:e,name:a});r?t.setValue([].concat(Ut(o),[e]),"select-option",e):t.setValue(e,"select-option")}i&&t.blurInput()},t.removeValue=function(e){var n=t.props.isMulti,i=t.state.selectValue,r=t.getOptionValue(e),a=i.filter((function(e){return t.getOptionValue(e)!==r})),o=dr(n,a,a[0]||null);t.onChange(o,{action:"remove-value",removedValue:e}),t.focusInput()},t.clearValue=function(){var e=t.state.selectValue;t.onChange(dr(t.props.isMulti,[],null),{action:"clear",removedValues:e})},t.popValue=function(){var e=t.props.isMulti,n=t.state.selectValue,i=n[n.length-1],r=n.slice(0,n.length-1),a=dr(e,r,r[0]||null);i&&t.onChange(a,{action:"pop-value",removedValue:i})},t.getFocusedOptionId=function(e){return Oa(t.state.focusableOptionsWithIds,e)},t.getFocusableOptionsWithIds=function(){return Ra(La(t.props,t.state.selectValue),t.getElementId("option"))},t.getValue=function(){return t.state.selectValue},t.cx=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Yi.apply(void 0,[t.props.classNamePrefix].concat(n))},t.getOptionLabel=function(e){return Ba(t.props,e)},t.getOptionValue=function(e){return Na(t.props,e)},t.getStyles=function(e,n){var i=t.props.unstyled,r=Pa[e](n,i);r.boxSizing="border-box";var a=t.props.styles[e];return a?a(r,n):r},t.getClassNames=function(e,n){var i,r;return null===(i=(r=t.props.classNames)[e])||void 0===i?void 0:i.call(r,n)},t.getElementId=function(e){return"".concat(t.state.instancePrefix,"-").concat(e)},t.getComponents=function(){return e=t.props,Pt(Pt({},Zr),e.components);var e},t.buildCategorizedOptions=function(){return La(t.props,t.state.selectValue)},t.getCategorizedOptions=function(){return t.props.menuIsOpen?t.buildCategorizedOptions():[]},t.buildFocusableOptions=function(){return Da(t.buildCategorizedOptions())},t.getFocusableOptions=function(){return t.props.menuIsOpen?t.buildFocusableOptions():[]},t.ariaOnChange=function(e,n){t.setState({ariaSelection:Pt({value:e},n)})},t.onMenuMouseDown=function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),t.focusInput())},t.onMenuMouseMove=function(e){t.blockOptionHover=!1},t.onControlMouseDown=function(e){if(!e.defaultPrevented){var n=t.props.openMenuOnClick;t.state.isFocused?t.props.menuIsOpen?"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&t.onMenuClose():n&&t.openMenu("first"):(n&&(t.openAfterFocus=!0),t.focusInput()),"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&e.preventDefault()}},t.onDropdownIndicatorMouseDown=function(e){if((!e||"mousedown"!==e.type||0===e.button)&&!t.props.isDisabled){var n=t.props,i=n.isMulti,r=n.menuIsOpen;t.focusInput(),r?(t.setState({inputIsHiddenAfterUpdate:!i}),t.onMenuClose()):t.openMenu("first"),e.preventDefault()}},t.onClearIndicatorMouseDown=function(e){e&&"mousedown"===e.type&&0!==e.button||(t.clearValue(),e.preventDefault(),t.openAfterFocus=!1,"touchend"===e.type?t.focusInput():setTimeout((function(){return t.focusInput()})))},t.onScroll=function(e){"boolean"===typeof t.props.closeMenuOnScroll?e.target instanceof HTMLElement&&tr(e.target)&&t.props.onMenuClose():"function"===typeof t.props.closeMenuOnScroll&&t.props.closeMenuOnScroll(e)&&t.props.onMenuClose()},t.onCompositionStart=function(){t.isComposing=!0},t.onCompositionEnd=function(){t.isComposing=!1},t.onTouchStart=function(e){var n=e.touches,i=n&&n.item(0);i&&(t.initialTouchX=i.clientX,t.initialTouchY=i.clientY,t.userIsDragging=!1)},t.onTouchMove=function(e){var n=e.touches,i=n&&n.item(0);if(i){var r=Math.abs(i.clientX-t.initialTouchX),a=Math.abs(i.clientY-t.initialTouchY);t.userIsDragging=r>5||a>5}},t.onTouchEnd=function(e){t.userIsDragging||(t.controlRef&&!t.controlRef.contains(e.target)&&t.menuListRef&&!t.menuListRef.contains(e.target)&&t.blurInput(),t.initialTouchX=0,t.initialTouchY=0)},t.onControlTouchEnd=function(e){t.userIsDragging||t.onControlMouseDown(e)},t.onClearIndicatorTouchEnd=function(e){t.userIsDragging||t.onClearIndicatorMouseDown(e)},t.onDropdownIndicatorTouchEnd=function(e){t.userIsDragging||t.onDropdownIndicatorMouseDown(e)},t.handleInputChange=function(e){var n=t.props.inputValue,i=e.currentTarget.value;t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange(i,{action:"input-change",prevInputValue:n}),t.props.menuIsOpen||t.onMenuOpen()},t.onInputFocus=function(e){t.props.onFocus&&t.props.onFocus(e),t.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(t.openAfterFocus||t.props.openMenuOnFocus)&&t.openMenu("first"),t.openAfterFocus=!1},t.onInputBlur=function(e){var n=t.props.inputValue;t.menuListRef&&t.menuListRef.contains(document.activeElement)?t.inputRef.focus():(t.props.onBlur&&t.props.onBlur(e),t.onInputChange("",{action:"input-blur",prevInputValue:n}),t.onMenuClose(),t.setState({focusedValue:null,isFocused:!1}))},t.onOptionHover=function(e){if(!t.blockOptionHover&&t.state.focusedOption!==e){var n=t.getFocusableOptions().indexOf(e);t.setState({focusedOption:e,focusedOptionId:n>-1?t.getFocusedOptionId(e):null})}},t.shouldHideSelectedOptions=function(){return $a(t.props)},t.onValueInputFocus=function(e){e.preventDefault(),e.stopPropagation(),t.focus()},t.onKeyDown=function(e){var n=t.props,i=n.isMulti,r=n.backspaceRemovesValue,a=n.escapeClearsValue,o=n.inputValue,s=n.isClearable,l=n.isDisabled,c=n.menuIsOpen,u=n.onKeyDown,h=n.tabSelectsValue,d=n.openMenuOnFocus,p=t.state,f=p.focusedOption,m=p.focusedValue,g=p.selectValue;if(!l&&("function"!==typeof u||(u(e),!e.defaultPrevented))){switch(t.blockOptionHover=!0,e.key){case"ArrowLeft":if(!i||o)return;t.focusValue("previous");break;case"ArrowRight":if(!i||o)return;t.focusValue("next");break;case"Delete":case"Backspace":if(o)return;if(m)t.removeValue(m);else{if(!r)return;i?t.popValue():s&&t.clearValue()}break;case"Tab":if(t.isComposing)return;if(e.shiftKey||!c||!h||!f||d&&t.isOptionSelected(f,g))return;t.selectOption(f);break;case"Enter":if(229===e.keyCode)break;if(c){if(!f)return;if(t.isComposing)return;t.selectOption(f);break}return;case"Escape":c?(t.setState({inputIsHiddenAfterUpdate:!1}),t.onInputChange("",{action:"menu-close",prevInputValue:o}),t.onMenuClose()):s&&a&&t.clearValue();break;case" ":if(o)return;if(!c){t.openMenu("first");break}if(!f)return;t.selectOption(f);break;case"ArrowUp":c?t.focusOption("up"):t.openMenu("last");break;case"ArrowDown":c?t.focusOption("down"):t.openMenu("first");break;case"PageUp":if(!c)return;t.focusOption("pageup");break;case"PageDown":if(!c)return;t.focusOption("pagedown");break;case"Home":if(!c)return;t.focusOption("first");break;case"End":if(!c)return;t.focusOption("last");break;default:return}e.preventDefault()}},t.state.instancePrefix="react-select-"+(t.props.instanceId||++Ha),t.state.selectValue=Ji(e.value),e.menuIsOpen&&t.state.selectValue.length){var r=t.getFocusableOptionsWithIds(),a=t.buildFocusableOptions(),o=a.indexOf(t.state.selectValue[0]);t.state.focusableOptionsWithIds=r,t.state.focusedOption=a[o],t.state.focusedOptionId=Oa(r,a[o])}return t}return function(e,t,n){t&&Ft(e.prototype,t),n&&Ft(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(i,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&ar(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isDisabled,i=t.menuIsOpen,r=this.state.isFocused;(r&&!n&&e.isDisabled||r&&i&&!e.menuIsOpen)&&this.focusInput(),r&&n&&!e.isDisabled?this.setState({isFocused:!1},this.onMenuClose):r||n||!e.isDisabled||this.inputRef!==document.activeElement||this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(ar(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(e,t){this.props.onInputChange(e,t)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(e){var t=this,n=this.state,i=n.selectValue,r=n.isFocused,a=this.buildFocusableOptions(),o="first"===e?0:a.length-1;if(!this.props.isMulti){var s=a.indexOf(i[0]);s>-1&&(o=s)}this.scrollToFocusedOptionOnUpdate=!(r&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:a[o],focusedOptionId:this.getFocusedOptionId(a[o])},(function(){return t.onMenuOpen()}))}},{key:"focusValue",value:function(e){var t=this.state,n=t.selectValue,i=t.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var r=n.indexOf(i);i||(r=-1);var a=n.length-1,o=-1;if(n.length){switch(e){case"previous":o=0===r?0:-1===r?a:r-1;break;case"next":r>-1&&r<a&&(o=r+1)}this.setState({inputIsHidden:-1!==o,focusedValue:n[o]})}}}},{key:"focusOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",t=this.props.pageSize,n=this.state.focusedOption,i=this.getFocusableOptions();if(i.length){var r=0,a=i.indexOf(n);n||(a=-1),"up"===e?r=a>0?a-1:i.length-1:"down"===e?r=(a+1)%i.length:"pageup"===e?(r=a-t)<0&&(r=0):"pagedown"===e?(r=a+t)>i.length-1&&(r=i.length-1):"last"===e&&(r=i.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:i[r],focusedValue:null,focusedOptionId:this.getFocusedOptionId(i[r])})}}},{key:"getTheme",value:function(){return this.props.theme?"function"===typeof this.props.theme?this.props.theme(Aa):Pt(Pt({},Aa),this.props.theme):Aa}},{key:"getCommonProps",value:function(){var e=this.clearValue,t=this.cx,n=this.getStyles,i=this.getClassNames,r=this.getValue,a=this.selectOption,o=this.setValue,s=this.props,l=s.isMulti,c=s.isRtl,u=s.options;return{clearValue:e,cx:t,getStyles:n,getClassNames:i,getValue:r,hasValue:this.hasValue(),isMulti:l,isRtl:c,options:u,selectOption:a,selectProps:s,setValue:o,theme:this.getTheme()}}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var e=this.props,t=e.isClearable,n=e.isMulti;return void 0===t?n:t}},{key:"isOptionDisabled",value:function(e,t){return Va(this.props,e,t)}},{key:"isOptionSelected",value:function(e,t){return Ua(this.props,e,t)}},{key:"filterOption",value:function(e,t){return ja(this.props,e,t)}},{key:"formatOptionLabel",value:function(e,t){if("function"===typeof this.props.formatOptionLabel){var n=this.props.inputValue,i=this.state.selectValue;return this.props.formatOptionLabel(e,{context:t,inputValue:n,selectValue:i})}return this.getOptionLabel(e)}},{key:"formatGroupLabel",value:function(e){return this.props.formatGroupLabel(e)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var t=this.props,n=t.isDisabled,i=t.isSearchable,r=t.inputId,a=t.inputValue,o=t.tabIndex,s=t.form,l=t.menuIsOpen,c=t.required,u=this.getComponents().Input,h=this.state,d=h.inputIsHidden,p=h.ariaSelection,f=this.commonProps,m=r||this.getElementId("input"),g=Pt(Pt(Pt({"aria-autocomplete":"list","aria-expanded":l,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":c,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},l&&{"aria-controls":this.getElementId("listbox")}),!i&&{"aria-readonly":!0}),this.hasValue()?"initial-input-focus"===(null===p||void 0===p?void 0:p.action)&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return i?e.createElement(u,Rt({},f,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:m,innerRef:this.getInputRef,isDisabled:n,isHidden:d,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:o,form:s,type:"text",value:a},g)):e.createElement(ua,Rt({id:m,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Ki,onFocus:this.onInputFocus,disabled:n,tabIndex:o,inputMode:"none",form:s,value:""},g))}},{key:"renderPlaceholderOrValue",value:function(){var t=this,n=this.getComponents(),i=n.MultiValue,r=n.MultiValueContainer,a=n.MultiValueLabel,o=n.MultiValueRemove,s=n.SingleValue,l=n.Placeholder,c=this.commonProps,u=this.props,h=u.controlShouldRenderValue,d=u.isDisabled,p=u.isMulti,f=u.inputValue,m=u.placeholder,g=this.state,y=g.selectValue,_=g.focusedValue,v=g.isFocused;if(!this.hasValue()||!h)return f?null:e.createElement(l,Rt({},c,{key:"placeholder",isDisabled:d,isFocused:v,innerProps:{id:this.getElementId("placeholder")}}),m);if(p)return y.map((function(n,s){var l=n===_,u="".concat(t.getOptionLabel(n),"-").concat(t.getOptionValue(n));return e.createElement(i,Rt({},c,{components:{Container:r,Label:a,Remove:o},isFocused:l,isDisabled:d,key:u,index:s,removeProps:{onClick:function(){return t.removeValue(n)},onTouchEnd:function(){return t.removeValue(n)},onMouseDown:function(e){e.preventDefault()}},data:n}),t.formatOptionLabel(n,"value"))}));if(f)return null;var x=y[0];return e.createElement(s,Rt({},c,{data:x,isDisabled:d}),this.formatOptionLabel(x,"value"))}},{key:"renderClearIndicator",value:function(){var t=this.getComponents().ClearIndicator,n=this.commonProps,i=this.props,r=i.isDisabled,a=i.isLoading,o=this.state.isFocused;if(!this.isClearable()||!t||r||!this.hasValue()||a)return null;var s={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return e.createElement(t,Rt({},n,{innerProps:s,isFocused:o}))}},{key:"renderLoadingIndicator",value:function(){var t=this.getComponents().LoadingIndicator,n=this.commonProps,i=this.props,r=i.isDisabled,a=i.isLoading,o=this.state.isFocused;if(!t||!a)return null;return e.createElement(t,Rt({},n,{innerProps:{"aria-hidden":"true"},isDisabled:r,isFocused:o}))}},{key:"renderIndicatorSeparator",value:function(){var t=this.getComponents(),n=t.DropdownIndicator,i=t.IndicatorSeparator;if(!n||!i)return null;var r=this.commonProps,a=this.props.isDisabled,o=this.state.isFocused;return e.createElement(i,Rt({},r,{isDisabled:a,isFocused:o}))}},{key:"renderDropdownIndicator",value:function(){var t=this.getComponents().DropdownIndicator;if(!t)return null;var n=this.commonProps,i=this.props.isDisabled,r=this.state.isFocused,a={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return e.createElement(t,Rt({},n,{innerProps:a,isDisabled:i,isFocused:r}))}},{key:"renderMenu",value:function(){var t=this,n=this.getComponents(),i=n.Group,r=n.GroupHeading,a=n.Menu,o=n.MenuList,s=n.MenuPortal,l=n.LoadingMessage,c=n.NoOptionsMessage,u=n.Option,h=this.commonProps,d=this.state.focusedOption,p=this.props,f=p.captureMenuScroll,m=p.inputValue,g=p.isLoading,y=p.loadingMessage,_=p.minMenuHeight,v=p.maxMenuHeight,x=p.menuIsOpen,b=p.menuPlacement,w=p.menuPosition,S=p.menuPortalTarget,T=p.menuShouldBlockScroll,C=p.menuShouldScrollIntoView,I=p.noOptionsMessage,k=p.onMenuScrollToTop,E=p.onMenuScrollToBottom;if(!x)return null;var P,A=function(n,i){var r=n.type,a=n.data,o=n.isDisabled,s=n.isSelected,l=n.label,c=n.value,p=d===a,f=o?void 0:function(){return t.onOptionHover(a)},m=o?void 0:function(){return t.selectOption(a)},g="".concat(t.getElementId("option"),"-").concat(i),y={id:g,onClick:m,onMouseMove:f,onMouseOver:f,tabIndex:-1,role:"option","aria-selected":t.isAppleDevice?void 0:s};return e.createElement(u,Rt({},h,{innerProps:y,data:a,isDisabled:o,isSelected:s,key:g,label:l,type:r,value:c,isFocused:p,innerRef:p?t.getFocusedOptionRef:void 0}),t.formatOptionLabel(n.data,"menu"))};if(this.hasOptions())P=this.getCategorizedOptions().map((function(n){if("group"===n.type){var a=n.data,o=n.options,s=n.index,l="".concat(t.getElementId("group"),"-").concat(s),c="".concat(l,"-heading");return e.createElement(i,Rt({},h,{key:l,data:a,options:o,Heading:r,headingProps:{id:c,data:n.data},label:t.formatGroupLabel(n.data)}),n.options.map((function(e){return A(e,"".concat(s,"-").concat(e.index))})))}if("option"===n.type)return A(n,"".concat(n.index))}));else if(g){var M=y({inputValue:m});if(null===M)return null;P=e.createElement(l,h,M)}else{var z=I({inputValue:m});if(null===z)return null;P=e.createElement(c,h,z)}var L={minMenuHeight:_,maxMenuHeight:v,menuPlacement:b,menuPosition:w,menuShouldScrollIntoView:C},D=e.createElement(vr,Rt({},h,L),(function(n){var i=n.ref,r=n.placerProps,s=r.placement,l=r.maxHeight;return e.createElement(a,Rt({},h,L,{innerRef:i,innerProps:{onMouseDown:t.onMenuMouseDown,onMouseMove:t.onMenuMouseMove},isLoading:g,placement:s}),e.createElement(Sa,{captureEnabled:f,onTopArrive:k,onBottomArrive:E,lockEnabled:T},(function(n){return e.createElement(o,Rt({},h,{innerRef:function(e){t.getMenuListRef(e),n(e)},innerProps:{role:"listbox","aria-multiselectable":h.isMulti,id:t.getElementId("listbox")},isLoading:g,maxHeight:l,focusedOption:d}),P)})))}));return S||"fixed"===w?e.createElement(s,Rt({},h,{appendTo:S,controlElement:this.controlRef,menuPlacement:b,menuPosition:w}),D):D}},{key:"renderFormField",value:function(){var t=this,n=this.props,i=n.delimiter,r=n.isDisabled,a=n.isMulti,o=n.name,s=n.required,l=this.state.selectValue;if(s&&!this.hasValue()&&!r)return e.createElement(Ca,{name:o,onFocus:this.onValueInputFocus});if(o&&!r){if(a){if(i){var c=l.map((function(e){return t.getOptionValue(e)})).join(i);return e.createElement("input",{name:o,type:"hidden",value:c})}var u=l.length>0?l.map((function(n,i){return e.createElement("input",{key:"i-".concat(i),name:o,type:"hidden",value:t.getOptionValue(n)})})):e.createElement("input",{name:o,type:"hidden",value:""});return e.createElement("div",null,u)}var h=l[0]?this.getOptionValue(l[0]):"";return e.createElement("input",{name:o,type:"hidden",value:h})}}},{key:"renderLiveRegion",value:function(){var t=this.commonProps,n=this.state,i=n.ariaSelection,r=n.focusedOption,a=n.focusedValue,o=n.isFocused,s=n.selectValue,l=this.getFocusableOptions();return e.createElement(Jr,Rt({},t,{id:this.getElementId("live-region"),ariaSelection:i,focusedOption:r,focusedValue:a,isFocused:o,selectValue:s,focusableOptions:l,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var t=this.getComponents(),n=t.Control,i=t.IndicatorsContainer,r=t.SelectContainer,a=t.ValueContainer,o=this.props,s=o.className,l=o.id,c=o.isDisabled,u=o.menuIsOpen,h=this.state.isFocused,d=this.commonProps=this.getCommonProps();return e.createElement(r,Rt({},d,{className:s,innerProps:{id:l,onKeyDown:this.onKeyDown},isDisabled:c,isFocused:h}),this.renderLiveRegion(),e.createElement(n,Rt({},d,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:c,isFocused:h,menuIsOpen:u}),e.createElement(a,Rt({},d,{isDisabled:c}),this.renderPlaceholderOrValue(),this.renderInput()),e.createElement(i,Rt({},d,{isDisabled:c}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.prevProps,i=t.clearFocusValueOnUpdate,r=t.inputIsHiddenAfterUpdate,a=t.ariaSelection,o=t.isFocused,s=t.prevWasFocused,l=t.instancePrefix,c=e.options,u=e.value,h=e.menuIsOpen,d=e.inputValue,p=e.isMulti,f=Ji(u),m={};if(n&&(u!==n.value||c!==n.options||h!==n.menuIsOpen||d!==n.inputValue)){var g=h?function(e,t){return Da(La(e,t))}(e,f):[],y=h?Ra(La(e,f),"".concat(l,"-option")):[],_=i?function(e,t){var n=e.focusedValue,i=e.selectValue.indexOf(n);if(i>-1){if(t.indexOf(n)>-1)return n;if(i<t.length)return t[i]}return null}(t,f):null,v=function(e,t){var n=e.focusedOption;return n&&t.indexOf(n)>-1?n:t[0]}(t,g);m={selectValue:f,focusedOption:v,focusedOptionId:Oa(y,v),focusableOptionsWithIds:y,focusedValue:_,clearFocusValueOnUpdate:!1}}var x=null!=r&&e!==n?{inputIsHidden:r,inputIsHiddenAfterUpdate:void 0}:{},b=a,w=o&&s;return o&&!w&&(b={value:dr(p,f,f[0]||null),options:f,action:"initial-input-focus"},w=!s),"initial-input-focus"===(null===a||void 0===a?void 0:a.action)&&(b=null),Pt(Pt(Pt({},m),x),{},{prevProps:e,ariaSelection:b,prevWasFocused:w})}}]),i}(e.Component);qa.defaultProps=Ma;var Za=(0,e.forwardRef)((function(t,n){var i=function(t){var n=t.defaultInputValue,i=void 0===n?"":n,r=t.defaultMenuIsOpen,a=void 0!==r&&r,o=t.defaultValue,s=void 0===o?null:o,l=t.inputValue,c=t.menuIsOpen,u=t.onChange,h=t.onInputChange,d=t.onMenuClose,p=t.onMenuOpen,f=t.value,m=Lt(t,Dt),g=zt((0,e.useState)(void 0!==l?l:i),2),y=g[0],_=g[1],v=zt((0,e.useState)(void 0!==c?c:a),2),x=v[0],b=v[1],w=zt((0,e.useState)(void 0!==f?f:s),2),S=w[0],T=w[1],C=(0,e.useCallback)((function(e,t){"function"===typeof u&&u(e,t),T(e)}),[u]),I=(0,e.useCallback)((function(e,t){var n;"function"===typeof h&&(n=h(e,t)),_(void 0!==n?n:e)}),[h]),k=(0,e.useCallback)((function(){"function"===typeof p&&p(),b(!0)}),[p]),E=(0,e.useCallback)((function(){"function"===typeof d&&d(),b(!1)}),[d]),P=void 0!==l?l:y,A=void 0!==c?c:x,M=void 0!==f?f:S;return Pt(Pt({},m),{},{inputValue:P,menuIsOpen:A,onChange:C,onInputChange:I,onMenuClose:E,onMenuOpen:k,value:M})}(t);return e.createElement(qa,Rt({ref:n},i))})),Ga=Za;const Wa=t=>{let{hour:n,minute:i,ampm:r,day:a,isActive:o,setIsActive:s,changeTime:l}=t;const[c,u]=(0,e.useState)(!1),h=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}],d=(e,t,n)=>{let i=e;"PM"===n&&12!==e?i+=12:"AM"===n&&12===e&&(i=0);return 100*i+t},p={control:e=>({...e,boxShadow:"none",border:o?"2px solid #000000":"2px solid transparent",borderRadius:"3px",fontSize:"clamp(0.7rem, 1.0vw, 1.2rem)",cursor:"pointer",":hover":{backgroundColor:"#000000",borderColor:"#000000"},backgroundColor:c?"#000000":"#FFFFFF",transition:"border 0.3s ease, background-color 0.3s ease",width:"10vw",height:"0.8vw"}),valueContainer:e=>({...e,padding:"8.5px 8px",height:"100%"}),option:(e,t)=>{let{isFocused:n,isSelected:i}=t;return{...e,backgroundColor:n||i?"#000000":"#FFFFFF",color:n||i?"#FFFFFF":"#000000",cursor:"pointer"}},menu:e=>({...e,marginTop:0,marginBottom:0,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}),menuList:e=>({...e,paddingTop:0,paddingBottom:0,fontSize:"clamp(0.7rem, 1.0vw, 1.2rem)",backgroundColor:"black"}),singleValue:e=>({...e,height:"100%",color:c&&o?"#FFFFFF":"#000000"}),indicatorsContainer:e=>({...e,height:"100%"}),dropdownIndicator:e=>({...e,color:c&&o?"#FFFFFF":"#000000",marginLeft:"0",paddingLeft:"0"}),indicatorSeparator:e=>({...e,display:"none"}),input:e=>({...e,color:c?"#FFFFFF":"#000000"})};return(0,wt.jsxs)("div",{className:"time-input"+(o?"-active":"-inactive"),children:[(0,wt.jsxs)("div",{id:"time-clock",className:"input-group",children:[(0,wt.jsxs)("div",{className:"input-control",children:[(0,wt.jsx)("button",{className:"stacked-button",onClick:()=>{if(o){const e=12===n?1:n+1,t=d(e,i,r);l({hour:e,minute:i,ampm:r,day:a,number:t})}},children:"+"}),(0,wt.jsx)("button",{className:"stacked-button",onClick:()=>{if(o){const e=0===n?11:n-1,t=d(e,i,r);l({hour:e,minute:i,ampm:r,day:a,number:t})}},children:"-"})]}),(0,wt.jsx)("input",{type:"text",className:"time-field",value:0===n?12:n.toString().padStart(2,"0"),readOnly:!0}),(0,wt.jsx)("span",{id:"time-colon",children:":"}),(0,wt.jsx)("input",{type:"text",className:"time-field",value:i.toString().padStart(2,"0"),readOnly:!0}),(0,wt.jsxs)("div",{className:"input-control",children:[(0,wt.jsx)("button",{className:"stacked-button",onClick:()=>{if(o){const e=45===i?0:i+15,t=d(n,e,r);l({hour:n,minute:e,ampm:r,day:a,number:t})}},children:"+"}),(0,wt.jsx)("button",{className:"stacked-button",onClick:()=>{if(o){const e=0===i?45:i-15,t=d(n,e,r);l({hour:n,minute:e,ampm:r,day:a,number:t})}},children:"-"})]})]}),(0,wt.jsx)("div",{id:"time-input-ampm"+(o?"-active":"-inactive"),className:"input-group ampm-group",onClick:()=>{if(o){const e="AM"===r?"PM":"AM",t=d(n,i,e);l({hour:n,minute:i,ampm:e,day:a,number:t})}},children:r}),(0,wt.jsx)("div",{id:"time-input-day",className:"input-group day-group",onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:(0,wt.jsx)(Ga,{defaultValue:h[a],onChange:e=>{if(o){const t=parseInt(e.value),a=d(n,i,r);l({hour:n,minute:i,ampm:r,day:t,number:a})}},options:h,styles:p,isDisabled:!o,isSearchable:!1})})]})};var Ka;function Xa(){return Xa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Xa.apply(null,arguments)}function Ya(t,n){let{title:i,titleId:r,...a}=t;return e.createElement("svg",Xa({fill:"#000000",width:"800px",height:"800px",viewBox:"0 0 24 24",id:"a",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":r},a),i?e.createElement("title",{id:r},i):null,Ka||(Ka=e.createElement("path",{d:"M10,12h-2V7h2v5Zm6-4.5h-2v4h2V7.5Zm-2.5,8.75c0-.4-.16-.78-.44-1.06-.28-.28-.66-.44-1.06-.44s-.78,.16-1.06,.44c-.28,.28-.44,.66-.44,1.06v.75h3v-.75ZM22,4V20c0,1.1-.9,2-2,2H4c-1.1,0-2-.9-2-2V4c0-1.1,.9-2,2-2H20c1.1,0,2,.9,2,2Zm-2,0H4V20H20V4Z",fillRule:"evenodd"})))}const Ja=e.forwardRef(Ya);n.p;var Qa,eo;function to(){return to=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},to.apply(null,arguments)}function no(t,n){let{title:i,titleId:r,...a}=t;return e.createElement("svg",to({width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":r},a),i?e.createElement("title",{id:r},i):null,Qa||(Qa=e.createElement("path",{d:"M8.25 9C7.83579 9 7.5 9.33579 7.5 9.75V14.25C7.5 14.6642 7.83579 15 8.25 15H12.75C13.1642 15 13.5 14.6642 13.5 14.25V9.75C13.5 9.33579 13.1642 9 12.75 9H8.25ZM9 13.5V10.5H12V13.5H9Z",fill:"#212121"})),eo||(eo=e.createElement("path",{d:"M2 7.75C2 5.12665 4.12665 3 6.75 3H17.2501C19.8734 3 22.0001 5.12665 22.0001 7.75C22.0001 8.98811 21.5256 10.1164 20.7501 10.9613V18.75C20.7501 19.9926 19.7427 21 18.5001 21H5.5C4.25736 21 3.25 19.9926 3.25 18.75V10.9613C2.47451 10.1164 2 8.98811 2 7.75ZM6.75 4.5C4.95507 4.5 3.5 5.95507 3.5 7.75C3.5 8.67951 3.88924 9.51689 4.51572 10.1102C4.66528 10.2518 4.75 10.4488 4.75 10.6548V18.75C4.75 19.1642 5.08579 19.5 5.5 19.5H15.5C15.9142 19.5 16.25 19.1642 16.25 18.75V11.0577C16.25 10.8096 16.3726 10.5776 16.5776 10.4379C17.4378 9.85165 18 8.86637 18 7.75C18 5.95507 16.5449 4.5 14.75 4.5H6.75Z",fill:"#212121"})))}const io=e.forwardRef(no);n.p;var ro,ao;function oo(){return oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},oo.apply(null,arguments)}function so(t,n){let{title:i,titleId:r,...a}=t;return e.createElement("svg",oo({width:"800px",height:"800px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":r},a),i?e.createElement("title",{id:r},i):null,ro||(ro=e.createElement("path",{d:"M23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12ZM3.00683 12C3.00683 16.9668 7.03321 20.9932 12 20.9932C16.9668 20.9932 20.9932 16.9668 20.9932 12C20.9932 7.03321 16.9668 3.00683 12 3.00683C7.03321 3.00683 3.00683 7.03321 3.00683 12Z",fill:"#0F0F0F"})),ao||(ao=e.createElement("path",{d:"M12 5C11.4477 5 11 5.44771 11 6V12.4667C11 12.4667 11 12.7274 11.1267 12.9235C11.2115 13.0898 11.3437 13.2343 11.5174 13.3346L16.1372 16.0019C16.6155 16.278 17.2271 16.1141 17.5032 15.6358C17.7793 15.1575 17.6155 14.5459 17.1372 14.2698L13 11.8812V6C13 5.44772 12.5523 5 12 5Z",fill:"#0F0F0F"})))}const lo=e.forwardRef(so);n.p;function co(t){let{data:n,addFilter:i}=t;const[r,a]=(0,e.useState)(!1),o=()=>{a(!r)},[s,l]=(0,e.useState)(!1),[c,u]=(0,e.useState)({hour:(new Date).getHours()>12?(new Date).getHours()-12:(new Date).getHours(),minute:15*Math.floor((new Date).getMinutes()/15),ampm:(new Date).getHours()>=12?"PM":"AM",day:(new Date).getDay(),number:((e,t,n)=>{let i=e;"PM"===n&&12!==e?i+=12:"AM"===n&&12===e&&(i=0);return 100*i+t})((new Date).getHours()>=12?(new Date).getHours()-12:(new Date).getHours(),15*Math.floor((new Date).getMinutes()/15),(new Date).getHours()>=12?"PM":"AM")}),[h,d]=(0,e.useState)({neighborhood:"All Neighborhoods",has_outlets:!1,has_food:!1,high_prices:!1,wifi_issues:!1,outdoor_area:!1}),p=e=>{let t=!0;return s&&(t=t&&((e,t,n)=>e.hours[n].open&&e.hours[n].open<=t&&e.hours[n].close>t)(e,c.number,c.day)),"All Neighborhoods"!=h.neighborhood&&(t=t&&((e,t)=>e.neighborhood===t)(e,h.neighborhood)),h.has_outlets&&(t=t&&(e=>e.outlets>0)(e)),h.open_late&&(t=t&&(e=>e.open_late)(e)),h.closes_early&&(t=t&&(e=>e.closes_early)(e)),h.has_food&&(t=t&&(e=>e.has_food)(e)),h.high_prices&&(t=t&&(e=>e.high_prices)(e)),h.wifi_issues&&(t=t&&(e=>e.wifi_issues)(e)),h.outdoor_area&&(t=t&&(e=>e.outdoor_area)(e)),t},f=()=>{l((e=>!e))},m=e=>{d((t=>({...t,[e]:!t[e]})))},[g,y]=(0,e.useState)(!1),[_,v]=(0,e.useState)(!1),x=[{value:"All Neighborhoods",label:"All Neighborhoods",color:"#000000"},{value:"USC/South Central",label:"USC/South Central",color:"#FF6961"},{value:"Koreatown/Mid-City",label:"Koreatown/Mid-City",color:"#867BC0"},{value:"Echo Park/Silver Lake/Chinatown",label:"Echo Park/Silver Lake/Chinatown",color:"#F6C25C"},{value:"Arts District/Little Tokyo",label:"Arts District/Little Tokyo",color:"#5FC5F9"},{value:"Culver City/Mar Vista",label:"Culver City/Mar Vista",color:"#74B78C"},{value:"Downtown",label:"Downtown",color:"#3683C2"},{value:"WeHo/Melrose/Beverly Hills",label:"WeHo/Melrose/Beverly Hills",color:"#F2729F"}],[b,w]=(0,e.useState)(x[0]),S={control:e=>({...e,border:"2px solid"+b.color,boxShadow:"none",fontSize:"clamp(0.8rem, 1.2vw, 1.5rem)",cursor:"pointer",":hover":{cursor:"pointer",borderColor:b.color},backgroundColor:g&&!_?b.color:"transparent"}),option:(e,t)=>{let{data:n,isFocused:i}=t;return{...e,backgroundColor:i?"#FFFFFF":n.color,color:i?n.color:"#FFFFFF",cursor:"pointer"}},menu:e=>({...e,marginTop:0,marginBottom:0,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}),menuList:e=>({...e,paddingTop:0,paddingBottom:0}),singleValue:(e,t)=>{let{menuIsOpen:n}=t;return{...e,padding:"3px 40px",color:_?b.color:g?"#FFFFFF":b.color,transition:"color 0.2s ease"}},dropdownIndicator:e=>({...e,transform:"rotate(180deg)",transition:"transform 0.2s ease",color:_?b.color:g?"#FFFFFF":b.color,":hover":_?{color:b.color}:{color:"#FFFFFF"}}),indicatorSeparator:e=>({...e,backgroundColor:_?b.color:g?"#FFFFFF":b.color}),input:e=>({...e,paddingLeft:"40px",color:g?b.color:"#FFFFFF"})};return(0,e.useEffect)((()=>{i(p),y(!1)}),[h,b,c,s]),(0,wt.jsxs)("div",{id:"filters-panel",children:[(0,wt.jsx)("div",{id:"neighborhood-container",onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:(0,wt.jsx)(Ga,{id:"neighborhood-select",options:x,onChange:e=>{w(e),d((t=>({...t,neighborhood:e.value})))},styles:S,defaultValue:x[0],menuPlacement:"top",isSearchable:!1,onMenuOpen:()=>v(!0),onMenuClose:()=>v(!1)})}),(0,wt.jsxs)("div",{id:"more-filters-container",children:[(0,wt.jsx)("button",{id:"more-filters-button",onClick:o,children:"More Filters +"}),(0,wt.jsxs)(Tt,{show:r,handleClose:o,children:[(0,wt.jsx)("div",{id:"more-filters-title",children:(0,wt.jsx)("h2",{children:"More Filters"})}),(0,wt.jsxs)("div",{className:"filter-row",children:[(0,wt.jsxs)("div",{id:"filter-has-outlets",className:"filter-item bubble "+(h.has_outlets?"selected":""),onClick:()=>m("has_outlets"),children:[(0,wt.jsx)(Ja,{id:"filter-outlet-icon",className:"filter-icon"}),(0,wt.jsx)("span",{className:"filter-checkbox",children:"Outlets"}),(0,wt.jsxs)("span",{className:"info-icon",children:["i",(0,wt.jsx)("span",{className:"info-tooltip",children:"Coffee shops with some accessible outlets for charging."})]})]}),(0,wt.jsxs)("div",{id:"filter-has-food",className:"filter-item bubble "+(h.has_food?"selected":""),onClick:()=>m("has_food"),children:[(0,wt.jsx)(io,{id:"filter-food-icon",className:"filter-icon"}),(0,wt.jsx)("span",{className:"filter-checkbox",children:"Food Menu"}),(0,wt.jsxs)("span",{className:"info-icon",children:["i",(0,wt.jsx)("span",{className:"info-tooltip",children:"Coffee shops that offer sufficient food menus (more than traditional pastries)."})]})]})]}),(0,wt.jsxs)("div",{id:"filter-row-time",className:"filter-row",children:[(0,wt.jsxs)("div",{className:`filter-item bubble ${s?"selected":""} time`,onClick:f,children:[(0,wt.jsx)(lo,{id:"filter-time-icon",className:"filter-icon"}),(0,wt.jsx)("span",{className:"filter-checkbox",children:"Open From/Until"}),(0,wt.jsxs)("span",{className:"info-icon",children:["i",(0,wt.jsx)("span",{className:"info-tooltip",children:"Coffee shops that are open from and until designated times."})]})]}),(0,wt.jsx)("div",{id:"time-input-container",children:(0,wt.jsx)(Wa,{hour:c.hour>=12?c.hour-12:c.hour,minute:c.minute,ampm:c.ampm,day:c.day,changeTime:e=>{s&&u((t=>({...t,...e})))},isActive:s,setIsActive:f})})]})]})]})]})}const uo=n.p+"static/media/googlemapslogo.afb7d7f9259f705190ea.png",ho=n.p+"static/media/yelplogo.5d7ca8e18f5c4df64ab6.png";function po(t){let{cardData:n,isExpanded:i,handleCardClick:r,addFilter:a}=t;const[o,s]=(0,e.useState)(!1);return(0,wt.jsxs)("div",{className:"card-container "+(i?"expanded":""),style:o&&!i?{backgroundColor:n.color_code,color:"#FFFFFF"}:{color:"#000000"},onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[(0,wt.jsxs)("div",{className:"card-header",onClick:()=>r(n),children:[(0,wt.jsxs)("div",{className:"card-name-neighborhood",children:[(0,wt.jsxs)("div",{className:"card-name",children:[n.name,(0,wt.jsx)("span",{className:"card-subname",children:n.subname})]}),(0,wt.jsx)("div",{className:"card-neighborhood",style:o&&!i?{backgroundColor:n.color_code,border:"2px solid #FFFFFF"}:{color:n.color_code,border:"2px solid"+n.color_code},children:n.neighborhood})]}),(0,wt.jsx)("div",{className:"card-toggle",children:i?"\u2014":"+"})]}),(0,wt.jsxs)("div",{className:"card-content",children:[(0,wt.jsx)("hr",{className:"card-divider"}),(0,wt.jsx)("div",{className:"card-image-container",children:(0,wt.jsx)("img",{src:n.image,alt:n.name,className:"card-image"})}),(0,wt.jsxs)("div",{className:"card-address",children:["Address: ",n.address]}),(0,wt.jsxs)("div",{className:"card-score",children:["Score: ",n.score]}),(0,wt.jsxs)("div",{className:"card-external-links",children:[(0,wt.jsx)("div",{className:"card-google-maps-container",children:(0,wt.jsxs)("a",{href:n.google_maps,target:"_blank",rel:"noopener noreferrer",className:"card-google-maps",children:[(0,wt.jsx)("img",{src:uo,alt:"Google Maps Logo",className:"card-google-maps-logo"}),"Get Directions"]})}),(0,wt.jsx)("div",{className:"card-yelp-container",children:(0,wt.jsxs)("a",{href:n.yelp,target:"_blank",rel:"noopener noreferrer",className:"card-yelp",children:[(0,wt.jsx)("img",{src:ho,alt:"Yelp Logo",className:"card-yelp-logo"}),"Open on Yelp"]})})]})]})]})}function fo(t){let{data:n,selectCafe:i,pickSortingOption:r,addFilter:a}=t;const o=(e,t)=>e.latitude<t.latitude?1:e.latitude>t.latitude?-1:0,[s,l]=(0,e.useState)(null);(0,e.useEffect)((()=>{const e=n.find((e=>e.is_selected));l(e?e.id:null)}),[n]);const c=e=>{l((t=>t===e.id?null:e.id)),i(e)};return(0,wt.jsxs)("div",{children:[(0,wt.jsxs)("div",{id:"sorting-options",children:[(0,wt.jsx)("button",{onClick:()=>r(((e,t)=>o(e,t))),children:"sort by ascending latitude"}),(0,wt.jsx)("button",{onClick:()=>r(((e,t)=>((e,t)=>-o(e,t))(e,t))),children:"sort by descending latitude"})]}),(0,wt.jsx)("div",{id:"data-cards",children:n.map((e=>e.visible&&(0,wt.jsx)(po,{cardData:e,selectCafe:i,isExpanded:e.id===s,handleCardClick:c,addFilter:a},e.id)))})]})}function mo(){const[t,n]=(0,e.useState)([]),[i,r]=(0,e.useState)(34.070295856986654),[a,o]=(0,e.useState)(-118.32681636751984),[s,l]=(0,e.useState)(11),c=e=>{const t=e.filter((e=>e.visible));t.length>0&&t.every((e=>e.neighborhood===t[0].neighborhood))?(r(t[0].n_latitude),o(t[0].n_longitude),l(t[0].n_zoom)):(r(34.070295856986654),o(-118.32681636751984),l(11))},u=e=>{var i=[...t];i.forEach((t=>{t===e?t.is_selected?(t.is_selected=!1,c(i)):(t.is_selected=!0,r(e.latitude),o(e.longitude),l(16),console.log(t)):t.is_selected=!1})),n(i)},h=e=>{var i=[...t].map((e=>({...e,visible:!0})));i.forEach((t=>{e(t)||(t.visible=!1)})),n(i),c(i)};return(0,e.useEffect)((()=>{n([{id:0,name:"Steep",subname:"",neighborhood:"Echo Park/Silver Lake/Chinatown",color_code:"#F6C25C",address:"970 N Broadway Ste 112",hours:[{open:800,close:2300},{open:800,close:2300},{open:800,close:2300},{open:800,close:2300},{open:800,close:2300},{open:800,close:2300},{open:800,close:2300}],latitude:34.065980698261825,longitude:-118.23590397358777,image:"https://cdn.vox-cdn.com/thumbor/BTmcOX2vhW8udQ4xevNSTf8IOLI=/0x0:2000x1333/1200x0/filters:focal(0x0:2000x1333):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/24140219/2022_10_21_SteepAfterDark_036.jpg",yelp:"https://www.yelp.com/biz/steep-los-angeles-2",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.065980698261825,-118.23590397358777",score:14.5,ambiance:5,workability:5,drinks:4,outlets:.5,open_late:!0,closes_early:!1,has_food:!0,high_prices:!1,wifi_issues:!1,outdoor_area:!0,difficult_seating:!1,hidden_gem:!0,visible:!0,is_selected:!1,n_latitude:34.07769323298075,n_longitude:-118.26541833326623,n_zoom:13},{id:1,name:"Coffee MCO",neighborhood:"Koreatown/Mid-City",color_code:"#867BC0",address:"621 S Western Ave Ste 101",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:34.05215005585242,longitude:-118.28749757582946,image:"https://res.cloudinary.com/the-infatuation/image/upload/f_auto/q_auto/v1697052310/images/Coffee%20MCO_Second%20Floor_Andrew%20Chan_LA.jpg",yelp:"https://www.yelp.com/biz/coffee-mco-los-angeles?osq=mco",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.05215005585242,-118.28749757582946",score:14,ambiance:5,workability:4,drinks:4,outlets:1,open_late:!1,closes_early:!1,has_food:!0,high_prices:!1,wifi_issues:!1,outdoor_area:!0,difficult_seating:!1,hidden_gem:!1,visible:!0,is_selected:!1,n_latitude:34.06254827176307,n_longitude:-118.30903945608391,n_zoom:13},{id:2,name:"3THYME Coffee",subname:"[Koreatown]",neighborhood:"Koreatown/Mid-City",color_code:"#867BC0",address:"600 S Harvard Blvd Ste 100",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:34.063171032463835,longitude:-118.30380608841607,image:"/coffee-website/Images/3thymecoffee.jpg",yelp:"https://www.yelp.com/biz/3thyme-coffee-los-angeles-5",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.063171032463835,-118.30380608841607",score:14,ambiance:4,workability:4,drinks:5,outlets:1,open_late:!1,closes_early:!1,has_food:!1,high_prices:!1,wifi_issues:!0,outdoor_area:!0,difficult_seating:!1,hidden_gem:!0,visible:!0,is_selected:!1,n_latitude:34.06254827176307,n_longitude:-118.30903945608391,n_zoom:13},{id:3,name:"Maru Coffee",subname:"[Arts District]",neighborhood:"Arts District/Little Tokyo",color_code:"#5FC5F9",address:"1019 S Santa Fe Ave",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:34.03096990269932,longitude:-118.23014421972013,image:"/coffee-website/Images/marucoffee.jpg",yelp:"https://www.yelp.com/biz/maru-coffee-los-angeles-3",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.03096990269932,-118.23014421972013",score:13.5,ambiance:5,workability:3,drinks:5,outlets:.5,open_late:!1,closes_early:!1,has_food:!1,high_prices:!1,wifi_issues:!1,outdoor_area:!1,difficult_seating:!0,hidden_gem:!1,visible:!0,is_selected:!1,n_latitude:34.039445379039236,n_longitude:-118.23574419308747,n_zoom:13},{id:4,name:"Alchemist Coffee Project",subname:"(The Pearl)",neighborhood:"Koreatown/Mid-City",color_code:"#867BC0",address:"698 S Vermont Ave Ste 103",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:34.06155472235852,longitude:-118.30576172865544,image:"/coffee-website/Images/alchemistcoffeeprojectthepearl.jpeg",yelp:"https://www.yelp.com/biz/alchemist-coffee-project-los-angeles-8",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.06155472235852,-118.30576172865544",score:13,ambiance:5,workability:4,drinks:3,outlets:1,open_late:!1,closes_early:!1,has_food:!1,high_prices:!0,wifi_issues:!1,outdoor_area:!1,difficult_seating:!1,hidden_gem:!1,visible:!0,is_selected:!1,n_latitude:34.06254827176307,n_longitude:-118.30903945608391,n_zoom:13},{id:5,name:"Blue Bottle Coffee",subname:"[Downtown]",neighborhood:"Downtown",color_code:"#3683C2",address:"300 South Broadway",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:34.05076601382609,longitude:-118.2479196504731,image:"/coffee-website/Images/bluebottlecoffeedowntown.jpg",yelp:"https://www.yelp.com/biz/blue-bottle-coffee-bradbury-los-angeles",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.05076601382609,-118.2479196504731",score:13,ambiance:5,workability:4,drinks:4,outlets:0,open_late:!1,closes_early:!1,has_food:!1,high_prices:!0,wifi_issues:!1,outdoor_area:!1,difficult_seating:!1,hidden_gem:!1,visible:!0,is_selected:!1,n_latitude:34.05378215141337,n_longitude:-118.25311219086959,n_zoom:13},{id:6,name:"Coffee for Sasquatch",subname:"",neighborhood:"WeHo/Melrose/Beverly Hills",color_code:"#F2729F",address:"7020 Melrose Ave",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:34.083245482521974,longitude:-118.34347519482917,image:"https://cdn.vox-cdn.com/thumbor/x0ksWBOi6euOLKmb4IV1MbKgryI=/0x0:2000x1335/1200x0/filters:focal(0x0:2000x1335):no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/9131315/2017_08_25_coffe_for_sasquatch_003.jpg",yelp:"https://www.yelp.com/biz/coffee-for-sasquatch-los-angeles",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.083245482521974,-118.34347519482917",score:13,ambiance:4,workability:4,drinks:4,outlets:1,open_late:!1,closes_early:!1,has_food:!1,high_prices:!1,wifi_issues:!1,outdoor_area:!1,difficult_seating:!1,hidden_gem:!0,visible:!0,is_selected:!1,n_latitude:34.07642731026826,n_longitude:-118.36747691330106,n_zoom:13},{id:7,name:"SACHI.LA",subname:"",neighborhood:"Culver City/Mar Vista",color_code:"#74B78C",address:"4574 S Centinela Ave",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:33.991673897492916,longitude:-118.42146945648837,image:"https://fastly.4sqi.net/img/general/600x600/12291826_bc0ukUR6IXJJ9wHp0Zb7SvjfACzkjjbdJVsfB4d5EWQ.jpg",yelp:"https://www.yelp.com/biz/sachi-la-los-angeles",google_maps:"https://www.google.com/maps/dir/?api=1&destination=33.991673897492916,-118.42146945648837",score:13,ambiance:5,workability:3,drinks:4,outlets:1,open_late:!1,closes_early:!0,has_food:!1,high_prices:!1,wifi_issues:!1,outdoor_area:!0,difficult_seating:!0,hidden_gem:!0,visible:!0,is_selected:!1,n_latitude:34.011619693012875,n_longitude:-118.40393034238527,n_zoom:13},{id:8,name:"CAFE/5",subname:"",neighborhood:"USC/South Central",color_code:"#FF6961",address:"2025 W Jefferson Blvd",hours:[{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900},{open:800,close:1900}],latitude:34.02569149773806,longitude:-118.31596208574616,image:"/coffee-website/Images/cafe5.jpg",yelp:"https://www.yelp.com/biz/cafe-5-los-angeles",google_maps:"https://www.google.com/maps/dir/?api=1&destination=34.02569149773806,-118.31596208574616",score:13,ambiance:3,workability:5,drinks:3,outlets:1,open_late:!1,closes_early:!1,has_food:!1,high_prices:!0,wifi_issues:!1,outdoor_area:!1,difficult_seating:!0,hidden_gem:!0,visible:!0,is_selected:!1,n_latitude:34.029020022579864,n_longitude:-118.30010983746013,n_zoom:13}])}),[]),(0,wt.jsxs)("div",{className:"home-content",children:[(0,wt.jsxs)("div",{className:"home-left",children:[(0,wt.jsx)(St,{data:t,lat:i,lng:a,zoom:s,selectCafe:u}),(0,wt.jsx)("div",{className:"home-title-container",children:(0,wt.jsx)("div",{className:"home-title",children:"A Guide to LA Coffee Shops"})}),(0,wt.jsx)(co,{data:t,addFilter:h})]}),(0,wt.jsx)("div",{className:"home-right",children:(0,wt.jsx)(fo,{data:t,selectCafe:u,pickSortingOption:e=>{var i=[...t];i.sort(e),n(i)},addFilter:h})})]})}const go=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:a,getTTFB:o}=t;n(e),i(e),r(e),a(e),o(e)}))};i.createRoot(document.getElementById("root")).render((0,wt.jsx)(e.StrictMode,{children:(0,wt.jsx)(mo,{})})),go()})()})();
//# sourceMappingURL=main.d0be52e9.js.map